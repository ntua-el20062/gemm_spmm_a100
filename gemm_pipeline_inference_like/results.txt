------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 5 (num_steps = 20)
number of batches= 4
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 2137.404388 ms
t_h2d = 838.843451 ms
t_gpu_alloc = 0.876904 ms
t_cpu_alloc = 4267.072916 ms
t_init = 1147.618055 ms
t_d2h = 155.520201 ms
t_end_2_end = 10864.778996 ms
Generating '/tmp/nsys-report-45a5.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [======35%                   ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [=======36%                  ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [==============64%           ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_5_20.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_20.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [1%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [2%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [3%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [4%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [5%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [6%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [7%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [8%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [9%                          ] nsys_report_ia_10000_5_20.sqlite[2/7] [10%                         ] nsys_report_ia_10000_5_20.sqlite[2/7] [11%                         ] nsys_report_ia_10000_5_20.sqlite[2/7] [12%                         ] nsys_report_ia_10000_5_20.sqlite[2/7] [13%                         ] nsys_report_ia_10000_5_20.sqlite[2/7] [14%                         ] nsys_report_ia_10000_5_20.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_5_20.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_5_20.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_5_20.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_5_20.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_5_20.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_5_20.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_5_20.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_5_20.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_5_20.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_5_20.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_5_20.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_5_20.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_5_20.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_5_20.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_5_20.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_5_20.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_5_20.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_5_20.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_5_20.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_5_20.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_5_20.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_5_20.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_5_20.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_5_20.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_5_20.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_5_20.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_5_20.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_5_20.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_5_20.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_5_20.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_5_20.sqlite[2/7] [============54%             ] nsys_report_ia_10000_5_20.sqlite[2/7] [============55%             ] nsys_report_ia_10000_5_20.sqlite[2/7] [============56%             ] nsys_report_ia_10000_5_20.sqlite[2/7] [============57%             ] nsys_report_ia_10000_5_20.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_5_20.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_5_20.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_5_20.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_5_20.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_5_20.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_5_20.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_5_20.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_5_20.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_5_20.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_5_20.sqlite[2/7] [================68%         ] nsys_report_ia_10000_5_20.sqlite[2/7] [================69%         ] nsys_report_ia_10000_5_20.sqlite[2/7] [================70%         ] nsys_report_ia_10000_5_20.sqlite[2/7] [================71%         ] nsys_report_ia_10000_5_20.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_5_20.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_5_20.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_5_20.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_5_20.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_5_20.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_5_20.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_5_20.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_5_20.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_5_20.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_5_20.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_5_20.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_5_20.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_5_20.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_5_20.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_5_20.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_5_20.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_5_20.sqlite[2/7] [========================97% ] nsys_report_ia_10000_5_20.sqlite[2/7] [========================98% ] nsys_report_ia_10000_5_20.sqlite[2/7] [========================99% ] nsys_report_ia_10000_5_20.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_20.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        339982128          1  339982128.0  339982128.0  339982128  339982128          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     47.9       4267067887          1  4267067887.0  4267067887.0  4267067887  4267067887          0.0  cudaHostAlloc                     
     24.4       2175286052         12   181273837.7       19856.0        6340   745235560  328046277.3  cudaMemcpyAsync                   
     21.0       1873205173          1  1873205173.0  1873205173.0  1873205173  1873205173          0.0  cudaFreeHost                      
      2.2        195323396          8    24415424.5     1398220.5       98161   185478726   65094978.0  cudaFree                          
      2.0        180229198         20     9011459.9         310.0         280   180216558   40297498.7  cuKernelGetFunction               
      1.5        130004831          2    65002415.5    65002415.5    52766865    77237966   17303681.5  cudaMemcpy                        
      0.9         81240320          1    81240320.0    81240320.0    81240320    81240320          0.0  cudaDeviceReset                   
      0.0          4053515         15      270234.3      286183.0      115191      460125     110369.3  cuLibraryLoadData                 
      0.0          1435806         12      119650.5        8620.0        4200     1281585     366096.3  cudaLaunchKernel                  
      0.0          1323755          6      220625.8        3290.0        2770     1141513     456060.5  cudaStreamSynchronize             
      0.0          1099372          7      157053.1      127281.0        8400      302604     101693.6  cudaMalloc                        
      0.0           527206        814         647.7         380.0         130      198582       6949.5  cuGetProcAddress_v2               
      0.0           501986         20       25099.3         520.0         410      472625     105402.5  cudaEventCreateWithFlags          
      0.0           308704         20       15435.2         385.0         310      291924      65085.4  cudaStreamGetCaptureInfo_v2_v11030
      0.0           187412         56        3346.6        2490.0         680       30290       4049.7  cudaEventRecord                   
      0.0           185902          1      185902.0      185902.0      185902      185902          0.0  cudaEventQuery                    
      0.0           146133         20        7306.7        4205.0        3380       55171      11386.6  cuLaunchKernel                    
      0.0            72190         68        1061.6         500.0         360       20430       2607.9  cudaEventDestroy                  
      0.0            57580          4       14395.0        4145.0        2910       46380      21337.4  cudaDeviceSynchronize             
      0.0            49221         48        1025.4         600.0         480       15691       2189.6  cudaEventCreate                   
      0.0            39500          2       19750.0       19750.0        1960       37540      25158.9  cudaStreamCreateWithFlags         
      0.0            23390          2       11695.0       11695.0        6500       16890       7346.8  cudaStreamDestroy                 
      0.0            10890          4        2722.5        2250.0        1410        4980       1684.6  cudaStreamWaitEvent               
      0.0            10890         16         680.6         575.0         410        1660        316.3  cuLibraryGetKernel                
      0.0             8410          3        2803.3        3470.0         670        4270       1890.3  cuInit                            
      0.0             4220          3        1406.7         550.0         160        3510       1831.9  cuModuleGetLoadingMode            
      0.0             1570          1        1570.0        1570.0        1570        1570          0.0  cuCtxSynchronize                  
      0.0              840          2         420.0         420.0         310         530        155.6  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7       2136924450         20  106846222.5  107073405.0  104346906  109073924    1069929.1  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2          4599905          4    1149976.3    1152824.0    1140872    1153385       6077.0  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          2601716          8     325214.5     323267.0      12544     641861     334146.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     91.6        838539417      9  93171046.3  52578669.0      1600  217911060  101007660.9  [CUDA memcpy Host-to-Device]
      8.4         77009345      5  15401869.0      1952.0      1952   77000033   34434420.5  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  16800.042      9  1866.671   800.000     0.010  4000.000     2039.603  [CUDA memcpy Host-to-Device]
    800.000      5   160.000     0.000     0.000   800.000      357.771  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 5 (num_steps = 20)
number of batches= 4
t_gemm = 2314.411560 ms
t_h2d = 797.717703 ms
t_d2h = 156.995058 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.608921 ms
t_cpu_alloc = 4375.524044 ms
t_init = 1164.216042 ms
t_end_2_end = 10689.169168 ms
Generating '/tmp/nsys-report-52d5.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_5_20.nsys-rep[1/7] [======35%                   ] nsys_report_db_10000_5_20.nsys-rep[1/7] [==============62%           ] nsys_report_db_10000_5_20.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_5_20.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_5_20.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_5_20.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_5_20.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_5_20.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_5_20.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_5_20.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_5_20.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_5_20.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_20.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [1%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [2%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [3%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [4%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [5%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [6%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [7%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [8%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [9%                          ] nsys_report_db_10000_5_20.sqlite[2/7] [10%                         ] nsys_report_db_10000_5_20.sqlite[2/7] [11%                         ] nsys_report_db_10000_5_20.sqlite[2/7] [12%                         ] nsys_report_db_10000_5_20.sqlite[2/7] [13%                         ] nsys_report_db_10000_5_20.sqlite[2/7] [14%                         ] nsys_report_db_10000_5_20.sqlite[2/7] [=15%                        ] nsys_report_db_10000_5_20.sqlite[2/7] [=16%                        ] nsys_report_db_10000_5_20.sqlite[2/7] [=17%                        ] nsys_report_db_10000_5_20.sqlite[2/7] [==18%                       ] nsys_report_db_10000_5_20.sqlite[2/7] [==19%                       ] nsys_report_db_10000_5_20.sqlite[2/7] [==20%                       ] nsys_report_db_10000_5_20.sqlite[2/7] [==21%                       ] nsys_report_db_10000_5_20.sqlite[2/7] [===22%                      ] nsys_report_db_10000_5_20.sqlite[2/7] [===23%                      ] nsys_report_db_10000_5_20.sqlite[2/7] [===24%                      ] nsys_report_db_10000_5_20.sqlite[2/7] [====25%                     ] nsys_report_db_10000_5_20.sqlite[2/7] [====26%                     ] nsys_report_db_10000_5_20.sqlite[2/7] [====27%                     ] nsys_report_db_10000_5_20.sqlite[2/7] [====28%                     ] nsys_report_db_10000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_5_20.sqlite[2/7] [======33%                   ] nsys_report_db_10000_5_20.sqlite[2/7] [======34%                   ] nsys_report_db_10000_5_20.sqlite[2/7] [======35%                   ] nsys_report_db_10000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_5_20.sqlite[2/7] [========40%                 ] nsys_report_db_10000_5_20.sqlite[2/7] [========41%                 ] nsys_report_db_10000_5_20.sqlite[2/7] [========42%                 ] nsys_report_db_10000_5_20.sqlite[2/7] [=========43%                ] nsys_report_db_10000_5_20.sqlite[2/7] [=========44%                ] nsys_report_db_10000_5_20.sqlite[2/7] [=========45%                ] nsys_report_db_10000_5_20.sqlite[2/7] [=========46%                ] nsys_report_db_10000_5_20.sqlite[2/7] [==========47%               ] nsys_report_db_10000_5_20.sqlite[2/7] [==========48%               ] nsys_report_db_10000_5_20.sqlite[2/7] [==========49%               ] nsys_report_db_10000_5_20.sqlite[2/7] [===========50%              ] nsys_report_db_10000_5_20.sqlite[2/7] [===========51%              ] nsys_report_db_10000_5_20.sqlite[2/7] [===========52%              ] nsys_report_db_10000_5_20.sqlite[2/7] [===========53%              ] nsys_report_db_10000_5_20.sqlite[2/7] [============54%             ] nsys_report_db_10000_5_20.sqlite[2/7] [============55%             ] nsys_report_db_10000_5_20.sqlite[2/7] [============56%             ] nsys_report_db_10000_5_20.sqlite[2/7] [============57%             ] nsys_report_db_10000_5_20.sqlite[2/7] [=============58%            ] nsys_report_db_10000_5_20.sqlite[2/7] [=============59%            ] nsys_report_db_10000_5_20.sqlite[2/7] [=============60%            ] nsys_report_db_10000_5_20.sqlite[2/7] [==============61%           ] nsys_report_db_10000_5_20.sqlite[2/7] [==============62%           ] nsys_report_db_10000_5_20.sqlite[2/7] [==============63%           ] nsys_report_db_10000_5_20.sqlite[2/7] [==============64%           ] nsys_report_db_10000_5_20.sqlite[2/7] [===============65%          ] nsys_report_db_10000_5_20.sqlite[2/7] [===============66%          ] nsys_report_db_10000_5_20.sqlite[2/7] [===============67%          ] nsys_report_db_10000_5_20.sqlite[2/7] [================68%         ] nsys_report_db_10000_5_20.sqlite[2/7] [================69%         ] nsys_report_db_10000_5_20.sqlite[2/7] [================70%         ] nsys_report_db_10000_5_20.sqlite[2/7] [================71%         ] nsys_report_db_10000_5_20.sqlite[2/7] [=================72%        ] nsys_report_db_10000_5_20.sqlite[2/7] [=================73%        ] nsys_report_db_10000_5_20.sqlite[2/7] [=================74%        ] nsys_report_db_10000_5_20.sqlite[2/7] [==================75%       ] nsys_report_db_10000_5_20.sqlite[2/7] [==================76%       ] nsys_report_db_10000_5_20.sqlite[2/7] [==================77%       ] nsys_report_db_10000_5_20.sqlite[2/7] [==================78%       ] nsys_report_db_10000_5_20.sqlite[2/7] [===================79%      ] nsys_report_db_10000_5_20.sqlite[2/7] [===================80%      ] nsys_report_db_10000_5_20.sqlite[2/7] [===================81%      ] nsys_report_db_10000_5_20.sqlite[2/7] [===================82%      ] nsys_report_db_10000_5_20.sqlite[2/7] [====================83%     ] nsys_report_db_10000_5_20.sqlite[2/7] [====================84%     ] nsys_report_db_10000_5_20.sqlite[2/7] [====================85%     ] nsys_report_db_10000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_5_20.sqlite[2/7] [======================90%   ] nsys_report_db_10000_5_20.sqlite[2/7] [======================91%   ] nsys_report_db_10000_5_20.sqlite[2/7] [======================92%   ] nsys_report_db_10000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_5_20.sqlite[2/7] [========================97% ] nsys_report_db_10000_5_20.sqlite[2/7] [========================98% ] nsys_report_db_10000_5_20.sqlite[2/7] [========================99% ] nsys_report_db_10000_5_20.sqlite[2/7] [========================100%] nsys_report_db_10000_5_20.sqlite[2/7] [========================100%] nsys_report_db_10000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        284099980          1  284099980.0  284099980.0  284099980  284099980          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     49.9       4375518231          1  4375518231.0  4375518231.0  4375518231  4375518231          0.0  cudaHostAlloc                     
     22.4       1961929856          1  1961929856.0  1961929856.0  1961929856  1961929856          0.0  cudaFreeHost                      
     18.5       1619101015         12   134925084.6       15110.0        6400   541352573  243939236.4  cudaMemcpyAsync                   
      4.6        402464403         20    20123220.2         305.0         290   402451773   89990803.6  cuKernelGetFunction               
      2.0        171328240          8    21416030.0     1344679.5       55150   163249790   57318524.6  cudaFree                          
      1.5        131754511          2    65877255.5    65877255.5    53145579    78608932   18005309.6  cudaMemcpy                        
      1.2        103887792          1   103887792.0   103887792.0   103887792   103887792          0.0  cudaDeviceReset                   
      0.0          4036854         15      269123.6      282293.0      117881      436345     105555.0  cuLibraryLoadData                 
      0.0          1156693          6      192782.2        3120.0        2250     1141093     464576.0  cudaStreamSynchronize             
      0.0          1084642          7      154948.9      142392.0        3920      320663     113082.5  cudaMalloc                        
      0.0           378273         12       31522.8        7605.0        4330      262712      73120.6  cudaLaunchKernel                  
      0.0           263151        814         323.3         290.0         120        1160        158.2  cuGetProcAddress_v2               
      0.0           166551         56        2974.1        2580.0         520       13920       1996.8  cudaEventRecord                   
      0.0           127370         20        6368.5        4440.0        4010       30110       5833.5  cuLaunchKernel                    
      0.0            57880         68         851.2         470.0         320       17660       2195.8  cudaEventDestroy                  
      0.0            42650         20        2132.5         495.0         380       13220       3951.3  cudaEventCreateWithFlags          
      0.0            38421         48         800.4         590.0         480        4560        721.9  cudaEventCreate                   
      0.0            38390          2       19195.0       19195.0        1780       36610      24628.5  cudaStreamCreateWithFlags         
      0.0            34331          4        8582.8        2490.0        1460       27891      12884.0  cudaDeviceSynchronize             
      0.0            18451          2        9225.5        9225.5        4811       13640       6243.0  cudaStreamDestroy                 
      0.0            17560         20         878.0         385.0         290        3320       1065.4  cudaStreamGetCaptureInfo_v2_v11030
      0.0            11130         16         695.6         570.0         510        1730        320.1  cuLibraryGetKernel                
      0.0            10490          4        2622.5        2640.0        1760        3450        819.0  cudaStreamWaitEvent               
      0.0             5431          1        5431.0        5431.0        5431        5431          0.0  cudaEventQuery                    
      0.0             5151          3        1717.0        1640.0         690        2821       1067.6  cuInit                            
      0.0             3360          3        1120.0         260.0         170        2930       1568.2  cuModuleGetLoadingMode            
      0.0             1810          1        1810.0        1810.0        1810        1810          0.0  cuCtxSynchronize                  
      0.0             1110          2         555.0         555.0         420         690        190.9  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7       2145209359         20  107260468.0  107429879.0  104626448  108836632     970424.2  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2          4587202          4    1146800.5    1146760.5    1140105    1153576       7479.0  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          2596403          8     324550.4     323618.5      12576     638084     333448.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     91.0        797473957      9  88608217.4  52992348.0      1569  252262645   97834300.6  [CUDA memcpy Host-to-Device]
      9.0         78423675      5  15684735.0      2144.0      1952   78414171   35066820.8  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  16800.042      9  1866.671   800.000     0.010  4000.000     2039.603  [CUDA memcpy Host-to-Device]
    800.000      5   160.000     0.000     0.000   800.000      357.771  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 5 (num_steps = 20), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  33.79 GB
Used GPU Memory:  5.70 GB
------------------------

Process RSS:  17.90 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 0.904083 ms
t_alloc_cpu = 4354.138136 ms
t_init      = 1266.022921 ms
t_h2d       = 857.440422 ms
t_d2h       = 155.874014 ms
t_gemm      = 2296.091286 ms
t_end_2_end = 10571.528912 ms
Generating '/tmp/nsys-report-a082.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [===============65%          ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [=====================88%    ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [=====================89%    ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [======================90%   ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [======================91%   ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [======================92%   ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [=======================93%  ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [=======================95%  ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [=======================96%  ] nsys_report_fo_10000_5_20.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_20.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [1%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [2%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [3%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [4%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [5%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [6%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [7%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [8%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [9%                          ] nsys_report_fo_10000_5_20.sqlite[2/7] [10%                         ] nsys_report_fo_10000_5_20.sqlite[2/7] [11%                         ] nsys_report_fo_10000_5_20.sqlite[2/7] [12%                         ] nsys_report_fo_10000_5_20.sqlite[2/7] [13%                         ] nsys_report_fo_10000_5_20.sqlite[2/7] [14%                         ] nsys_report_fo_10000_5_20.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_5_20.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_5_20.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_5_20.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_5_20.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_5_20.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_5_20.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_5_20.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_5_20.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_5_20.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_5_20.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_5_20.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_5_20.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_5_20.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_5_20.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_5_20.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_5_20.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_5_20.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_5_20.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_5_20.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_5_20.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_5_20.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_5_20.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_5_20.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_5_20.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_5_20.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_5_20.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_5_20.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_5_20.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_5_20.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_5_20.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_5_20.sqlite[2/7] [============54%             ] nsys_report_fo_10000_5_20.sqlite[2/7] [============55%             ] nsys_report_fo_10000_5_20.sqlite[2/7] [============56%             ] nsys_report_fo_10000_5_20.sqlite[2/7] [============57%             ] nsys_report_fo_10000_5_20.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_5_20.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_5_20.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_5_20.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_5_20.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_5_20.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_5_20.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_5_20.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_5_20.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_5_20.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_5_20.sqlite[2/7] [================68%         ] nsys_report_fo_10000_5_20.sqlite[2/7] [================69%         ] nsys_report_fo_10000_5_20.sqlite[2/7] [================70%         ] nsys_report_fo_10000_5_20.sqlite[2/7] [================71%         ] nsys_report_fo_10000_5_20.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_5_20.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_5_20.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_5_20.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_5_20.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_5_20.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_5_20.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_5_20.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_5_20.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_5_20.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_5_20.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_5_20.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_5_20.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_5_20.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_5_20.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_5_20.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_5_20.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_5_20.sqlite[2/7] [========================97% ] nsys_report_fo_10000_5_20.sqlite[2/7] [========================98% ] nsys_report_fo_10000_5_20.sqlite[2/7] [========================99% ] nsys_report_fo_10000_5_20.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_20.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        295229665          1  295229665.0  295229665.0  295229665  295229665          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     48.5       4354131926          1  4354131926.0  4354131926.0  4354131926  4354131926          0.0  cudaHostAlloc                     
     23.1       2074368565         60    34572809.4        8640.0        4190   110256873   51183343.4  cudaMemcpyAsync                   
     22.0       1976286955          1  1976286955.0  1976286955.0  1976286955  1976286955          0.0  cudaFreeHost                      
      2.0        178034445         11    16184949.5      461545.0       49671   173030829   52021249.7  cudaFree                          
      2.0        175793080         20     8789654.0         505.0         430   175780890   39305658.5  cuKernelGetFunction               
      1.5        130652060          2    65326030.0    65326030.0    52626804    78025256   17959417.6  cudaMemcpy                        
      0.9         82809609          1    82809609.0    82809609.0    82809609    82809609          0.0  cudaDeviceReset                   
      0.0          4038486         15      269232.4      283863.0      119361      440185     106452.4  cuLibraryLoadData                 
      0.0          1196273         22       54376.0        2395.0        1840     1143593     243280.7  cudaStreamSynchronize             
      0.0          1081142         10      108114.2      114411.0        3820      151552      42512.4  cudaMalloc                        
      0.0           563006         60        9383.4        4720.0        4080      241422      30543.9  cudaLaunchKernel                  
      0.0           295253        140        2109.0        2390.0         500       23571       2262.4  cudaEventRecord                   
      0.0           275363        814         338.3         290.0         120        1220        169.2  cuGetProcAddress_v2               
      0.0           127402         20        6370.1        4940.0        4360       30691       5791.7  cuLaunchKernel                    
      0.0            81391          1       81391.0       81391.0       81391       81391          0.0  cudaMemGetInfo                    
      0.0            73290         80         916.1         520.0         470       15470       1760.0  cudaEventCreate                   
      0.0            69932         28        2497.6         515.0         380       21541       5219.5  cudaEventCreateWithFlags          
      0.0            50081          4       12520.3        2755.0        1300       43271      20523.0  cudaDeviceSynchronize             
      0.0            46591          2       23295.5       23295.5        2040       44551      30059.8  cudaStreamCreateWithFlags         
      0.0            40430        100         404.3         305.0         270        2160        285.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0            34540         35         986.9         830.0         590        3700        611.0  cudaStreamWaitEvent               
      0.0            23650         28         844.6         530.0         340        5530       1063.7  cudaEventDestroy                  
      0.0            18890          2        9445.0        9445.0        3890       15000       7856.0  cudaStreamDestroy                 
      0.0            16701         16        1043.8         605.0         500        6961       1588.3  cuLibraryGetKernel                
      0.0             5420          3        1806.7        2060.0         710        2650        994.5  cuInit                            
      0.0             5120          1        5120.0        5120.0        5120        5120          0.0  cudaEventQuery                    
      0.0             3340          3        1113.3         270.0         260        2810       1469.4  cuModuleGetLoadingMode            
      0.0             1280          1        1280.0        1280.0        1280        1280          0.0  cuCtxSynchronize                  
      0.0              920          2         460.0         460.0         290         630        240.4  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       2144381610         20  107219080.5  107462570.5  104731078  108482155     902745.6  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.1         22974985         20    1148749.3    1150664.5    1139592    1154217       5445.0  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         12940991         40     323524.8     321187.0      12449     639556     314804.5  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     91.7        857120894     41  20905387.7  32019661.0      1568  54387858   21584082.1  [CUDA memcpy Host-to-Device]
      8.3         77884454     21   3708783.5      1952.0      1920  77843718   16986447.4  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  16800.208     41   409.761   800.000     0.010   800.000      404.843  [CUDA memcpy Host-to-Device]
    800.000     21    38.095     0.000     0.000   800.000      174.574  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 5 (num_steps = 40)
number of batches= 8
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 4291.101807 ms
t_h2d = 1544.666170 ms
t_gpu_alloc = 0.875950 ms
t_cpu_alloc = 8437.207937 ms
t_init = 2171.067953 ms
t_d2h = 156.962872 ms
t_end_2_end = 20586.851120 ms
Generating '/tmp/nsys-report-00b6.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [=======39%                  ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [==============63%           ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_5_40.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_40.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [1%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [2%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [3%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [4%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [5%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [6%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [7%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [8%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [9%                          ] nsys_report_ia_10000_5_40.sqlite[2/7] [10%                         ] nsys_report_ia_10000_5_40.sqlite[2/7] [11%                         ] nsys_report_ia_10000_5_40.sqlite[2/7] [12%                         ] nsys_report_ia_10000_5_40.sqlite[2/7] [13%                         ] nsys_report_ia_10000_5_40.sqlite[2/7] [14%                         ] nsys_report_ia_10000_5_40.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_5_40.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_5_40.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_5_40.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_5_40.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_5_40.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_5_40.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_5_40.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_5_40.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_5_40.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_5_40.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_5_40.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_5_40.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_5_40.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_5_40.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_5_40.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_5_40.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_5_40.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_5_40.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_5_40.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_5_40.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_5_40.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_5_40.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_5_40.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_5_40.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_5_40.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_5_40.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_5_40.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_5_40.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_5_40.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_5_40.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_5_40.sqlite[2/7] [============54%             ] nsys_report_ia_10000_5_40.sqlite[2/7] [============55%             ] nsys_report_ia_10000_5_40.sqlite[2/7] [============56%             ] nsys_report_ia_10000_5_40.sqlite[2/7] [============57%             ] nsys_report_ia_10000_5_40.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_5_40.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_5_40.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_5_40.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_5_40.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_5_40.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_5_40.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_5_40.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_5_40.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_5_40.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_5_40.sqlite[2/7] [================68%         ] nsys_report_ia_10000_5_40.sqlite[2/7] [================69%         ] nsys_report_ia_10000_5_40.sqlite[2/7] [================70%         ] nsys_report_ia_10000_5_40.sqlite[2/7] [================71%         ] nsys_report_ia_10000_5_40.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_5_40.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_5_40.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_5_40.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_5_40.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_5_40.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_5_40.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_5_40.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_5_40.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_5_40.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_5_40.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_5_40.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_5_40.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_5_40.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_5_40.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_5_40.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_5_40.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_5_40.sqlite[2/7] [========================97% ] nsys_report_ia_10000_5_40.sqlite[2/7] [========================98% ] nsys_report_ia_10000_5_40.sqlite[2/7] [========================99% ] nsys_report_ia_10000_5_40.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_40.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        284243826          1  284243826.0  284243826.0  284243826  284243826          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     47.8       8437202282          1  8437202282.0  8437202282.0  8437202282  8437202282          0.0  cudaHostAlloc                     
     28.6       5059959006         24   210831625.3       14315.0        6000   780671137  335969989.6  cudaMemcpyAsync                   
     20.1       3559527399          1  3559527399.0  3559527399.0  3559527399  3559527399          0.0  cudaFreeHost                      
      1.0        180265112          8    22533139.0     1349405.0       27560   172104981   60445097.0  cudaFree                          
      1.0        170525684         40     4263142.1         330.5         300   170497503   26957908.0  cuKernelGetFunction               
      0.8        132721723          2    66360861.5    66360861.5    53807617    78914106   17752968.6  cudaMemcpy                        
      0.7        119060642          1   119060642.0   119060642.0   119060642   119060642          0.0  cudaDeviceReset                   
      0.0          3950034         15      263335.6      278203.0      113871      426714     103943.9  cuLibraryLoadData                 
      0.0          1169833         10      116983.3        3125.0        2731     1141042     359817.9  cudaStreamSynchronize             
      0.0          1051253          7      150179.0      138492.0        3950      291403     104980.5  cudaMalloc                        
      0.0           509889         24       21245.4        7985.5        4290      253653      50039.8  cudaLaunchKernel                  
      0.0           339320        112        3029.6        2745.0         530       15010       1662.8  cudaEventRecord                   
      0.0           290193        814         356.5         310.0         120        1420        177.3  cuGetProcAddress_v2               
      0.0           240652         40        6016.3        4395.0        3600       36091       5191.7  cuLaunchKernel                    
      0.0            75351        116         649.6         400.0         350       16801       1624.1  cudaEventDestroy                  
      0.0            70721         96         736.7         520.0         490        4760        577.7  cudaEventCreate                   
      0.0            41490         20        2074.5         510.0         400       19730       4690.8  cudaEventCreateWithFlags          
      0.0            37210         40         930.3         405.0         290        6010       1228.7  cudaStreamGetCaptureInfo_v2_v11030
      0.0            36310          2       18155.0       18155.0        1980       34330      22874.9  cudaStreamCreateWithFlags         
      0.0            35271          4        8817.8        3180.0        1390       27521      12505.7  cudaDeviceSynchronize             
      0.0            18480          2        9240.0        9240.0        4790       13690       6293.3  cudaStreamDestroy                 
      0.0            12720          8        1590.0         975.0         880        3990       1154.4  cudaStreamWaitEvent               
      0.0            11470         16         716.9         615.0         480        1870        338.6  cuLibraryGetKernel                
      0.0             5850          1        5850.0        5850.0        5850        5850          0.0  cudaEventQuery                    
      0.0             4790          3        1596.7        1770.0         550        2470        971.7  cuInit                            
      0.0             3550          3        1183.3         270.0         170        3110       1669.3  cuModuleGetLoadingMode            
      0.0             1030          1        1030.0        1030.0        1030        1030          0.0  cuCtxSynchronize                  
      0.0              960          2         480.0         480.0         310         650        240.4  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7       4290580414         40  107264510.4  107663508.5  104942395  110199868    1186118.6  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2          9205766          8    1150720.8    1152393.0    1141033    1154056       4300.9  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          5196102         16     324756.4     323410.0      12544     643301     322255.6  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     95.1       1544203661     17  90835509.5  53493331.0      1569  243506675   95710781.7  [CUDA memcpy Host-to-Device]
      4.9         78732230      9   8748025.6      1984.0      1951   78714502   26237428.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  32800.083     17  1929.417   800.000     0.010  4000.000     2021.061  [CUDA memcpy Host-to-Device]
    800.000      9    88.889     0.000     0.000   800.000      266.667  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 5 (num_steps = 40)
number of batches= 8
t_gemm = 4487.418510 ms
t_h2d = 1604.029457 ms
t_d2h = 155.865908 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.567913 ms
t_cpu_alloc = 8436.862946 ms
t_init = 2188.781023 ms
t_end_2_end = 19564.532042 ms
Generating '/tmp/nsys-report-3c35.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_5_40.nsys-rep[1/7] [========41%                 ] nsys_report_db_10000_5_40.nsys-rep[1/7] [===============65%          ] nsys_report_db_10000_5_40.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_5_40.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_5_40.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_5_40.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_5_40.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_5_40.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_5_40.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_5_40.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_5_40.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_5_40.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_40.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [1%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [2%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [3%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [4%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [5%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [6%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [7%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [8%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [9%                          ] nsys_report_db_10000_5_40.sqlite[2/7] [10%                         ] nsys_report_db_10000_5_40.sqlite[2/7] [11%                         ] nsys_report_db_10000_5_40.sqlite[2/7] [12%                         ] nsys_report_db_10000_5_40.sqlite[2/7] [13%                         ] nsys_report_db_10000_5_40.sqlite[2/7] [14%                         ] nsys_report_db_10000_5_40.sqlite[2/7] [=15%                        ] nsys_report_db_10000_5_40.sqlite[2/7] [=16%                        ] nsys_report_db_10000_5_40.sqlite[2/7] [=17%                        ] nsys_report_db_10000_5_40.sqlite[2/7] [==18%                       ] nsys_report_db_10000_5_40.sqlite[2/7] [==19%                       ] nsys_report_db_10000_5_40.sqlite[2/7] [==20%                       ] nsys_report_db_10000_5_40.sqlite[2/7] [==21%                       ] nsys_report_db_10000_5_40.sqlite[2/7] [===22%                      ] nsys_report_db_10000_5_40.sqlite[2/7] [===23%                      ] nsys_report_db_10000_5_40.sqlite[2/7] [===24%                      ] nsys_report_db_10000_5_40.sqlite[2/7] [====25%                     ] nsys_report_db_10000_5_40.sqlite[2/7] [====26%                     ] nsys_report_db_10000_5_40.sqlite[2/7] [====27%                     ] nsys_report_db_10000_5_40.sqlite[2/7] [====28%                     ] nsys_report_db_10000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_5_40.sqlite[2/7] [======33%                   ] nsys_report_db_10000_5_40.sqlite[2/7] [======34%                   ] nsys_report_db_10000_5_40.sqlite[2/7] [======35%                   ] nsys_report_db_10000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_5_40.sqlite[2/7] [========40%                 ] nsys_report_db_10000_5_40.sqlite[2/7] [========41%                 ] nsys_report_db_10000_5_40.sqlite[2/7] [========42%                 ] nsys_report_db_10000_5_40.sqlite[2/7] [=========43%                ] nsys_report_db_10000_5_40.sqlite[2/7] [=========44%                ] nsys_report_db_10000_5_40.sqlite[2/7] [=========45%                ] nsys_report_db_10000_5_40.sqlite[2/7] [=========46%                ] nsys_report_db_10000_5_40.sqlite[2/7] [==========47%               ] nsys_report_db_10000_5_40.sqlite[2/7] [==========48%               ] nsys_report_db_10000_5_40.sqlite[2/7] [==========49%               ] nsys_report_db_10000_5_40.sqlite[2/7] [===========50%              ] nsys_report_db_10000_5_40.sqlite[2/7] [===========51%              ] nsys_report_db_10000_5_40.sqlite[2/7] [===========52%              ] nsys_report_db_10000_5_40.sqlite[2/7] [===========53%              ] nsys_report_db_10000_5_40.sqlite[2/7] [============54%             ] nsys_report_db_10000_5_40.sqlite[2/7] [============55%             ] nsys_report_db_10000_5_40.sqlite[2/7] [============56%             ] nsys_report_db_10000_5_40.sqlite[2/7] [============57%             ] nsys_report_db_10000_5_40.sqlite[2/7] [=============58%            ] nsys_report_db_10000_5_40.sqlite[2/7] [=============59%            ] nsys_report_db_10000_5_40.sqlite[2/7] [=============60%            ] nsys_report_db_10000_5_40.sqlite[2/7] [==============61%           ] nsys_report_db_10000_5_40.sqlite[2/7] [==============62%           ] nsys_report_db_10000_5_40.sqlite[2/7] [==============63%           ] nsys_report_db_10000_5_40.sqlite[2/7] [==============64%           ] nsys_report_db_10000_5_40.sqlite[2/7] [===============65%          ] nsys_report_db_10000_5_40.sqlite[2/7] [===============66%          ] nsys_report_db_10000_5_40.sqlite[2/7] [===============67%          ] nsys_report_db_10000_5_40.sqlite[2/7] [================68%         ] nsys_report_db_10000_5_40.sqlite[2/7] [================69%         ] nsys_report_db_10000_5_40.sqlite[2/7] [================70%         ] nsys_report_db_10000_5_40.sqlite[2/7] [================71%         ] nsys_report_db_10000_5_40.sqlite[2/7] [=================72%        ] nsys_report_db_10000_5_40.sqlite[2/7] [=================73%        ] nsys_report_db_10000_5_40.sqlite[2/7] [=================74%        ] nsys_report_db_10000_5_40.sqlite[2/7] [==================75%       ] nsys_report_db_10000_5_40.sqlite[2/7] [==================76%       ] nsys_report_db_10000_5_40.sqlite[2/7] [==================77%       ] nsys_report_db_10000_5_40.sqlite[2/7] [==================78%       ] nsys_report_db_10000_5_40.sqlite[2/7] [===================79%      ] nsys_report_db_10000_5_40.sqlite[2/7] [===================80%      ] nsys_report_db_10000_5_40.sqlite[2/7] [===================81%      ] nsys_report_db_10000_5_40.sqlite[2/7] [===================82%      ] nsys_report_db_10000_5_40.sqlite[2/7] [====================83%     ] nsys_report_db_10000_5_40.sqlite[2/7] [====================84%     ] nsys_report_db_10000_5_40.sqlite[2/7] [====================85%     ] nsys_report_db_10000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_5_40.sqlite[2/7] [======================90%   ] nsys_report_db_10000_5_40.sqlite[2/7] [======================91%   ] nsys_report_db_10000_5_40.sqlite[2/7] [======================92%   ] nsys_report_db_10000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_5_40.sqlite[2/7] [========================97% ] nsys_report_db_10000_5_40.sqlite[2/7] [========================98% ] nsys_report_db_10000_5_40.sqlite[2/7] [========================99% ] nsys_report_db_10000_5_40.sqlite[2/7] [========================100%] nsys_report_db_10000_5_40.sqlite[2/7] [========================100%] nsys_report_db_10000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        285571893          1  285571893.0  285571893.0  285571893  285571893          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     50.8       8436852779          1  8436852779.0  8436852779.0  8436852779  8436852779          0.0  cudaHostAlloc                     
     22.8       3797829903         24   158242912.6       14220.0        6250   543987124  251829059.8  cudaMemcpyAsync                   
     21.6       3584664318          1  3584664318.0  3584664318.0  3584664318  3584664318          0.0  cudaFreeHost                      
      2.2        370807970         40     9270199.3         300.0         280   370779870   58625331.1  cuKernelGetFunction               
      1.0        171420266          8    21427533.3     1345740.5       53841   163209954   57298229.8  cudaFree                          
      0.8        130926854          2    65463427.0    65463427.0    53104890    77821964   17477610.6  cudaMemcpy                        
      0.7        120942234          1   120942234.0   120942234.0   120942234   120942234          0.0  cudaDeviceReset                   
      0.0          3976686         15      265112.4      280423.0      113702      421865     103957.2  cuLibraryLoadData                 
      0.0          1169134         10      116913.4        3030.5        2240     1141293     359930.9  cudaStreamSynchronize             
      0.0          1053951          7      150564.4      144842.0        3820      286433     103730.5  cudaMalloc                        
      0.0           498817         24       20784.0        7671.0        4280      255393      50433.1  cudaLaunchKernel                  
      0.0           344374        112        3074.8        2695.0         510       27880       2649.4  cudaEventRecord                   
      0.0           260013        814         319.4         280.0         120        1230        163.1  cuGetProcAddress_v2               
      0.0           232582         40        5814.6        4365.0        3790       31990       4606.4  cuLaunchKernel                    
      0.0            84240        116         726.2         460.0         350       21940       2117.2  cudaEventDestroy                  
      0.0            70670         96         736.1         600.0         480        4280        526.3  cudaEventCreate                   
      0.0            48041          2       24020.5       24020.5        1850       46191      31353.8  cudaStreamCreateWithFlags         
      0.0            39960         20        1998.0         495.0         390       19430       4582.2  cudaEventCreateWithFlags          
      0.0            36710          4        9177.5        2955.0        1350       29450      13542.0  cudaDeviceSynchronize             
      0.0            36300         40         907.5         395.0         280        3380       1082.7  cudaStreamGetCaptureInfo_v2_v11030
      0.0            17970          2        8985.0        8985.0        5150       12820       5423.5  cudaStreamDestroy                 
      0.0            17640          8        2205.0        1970.0        1570        3500        676.8  cudaStreamWaitEvent               
      0.0            10690         16         668.1         570.0         530        1530        259.2  cuLibraryGetKernel                
      0.0             5140          1        5140.0        5140.0        5140        5140          0.0  cudaEventQuery                    
      0.0             4850          3        1616.7        2010.0         600        2240        887.9  cuInit                            
      0.0             3661          3        1220.3         600.0         290        2771       1351.8  cuModuleGetLoadingMode            
      0.0             1120          1        1120.0        1120.0        1120        1120          0.0  cuCtxSynchronize                  
      0.0              910          2         455.0         455.0         420         490         49.5  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7       4318116024         40  107952900.6  108179293.0  105528825  109260782     819565.6  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2          9192171          8    1149021.4    1151209.5    1140202    1154697       5623.2  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          5177710         16     323606.9     322419.0      12449     637190     321163.2  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     95.4       1603707197     17  94335717.5  52928062.0      1567  244782794   99404166.5  [CUDA memcpy Host-to-Device]
      4.6         77639376      9   8626597.3      1952.0      1920   77622032   25873288.0  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  32800.083     17  1929.417   800.000     0.010  4000.000     2021.061  [CUDA memcpy Host-to-Device]
    800.000      9    88.889     0.000     0.000   800.000      266.667  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 5 (num_steps = 40), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  33.77 GB
Used GPU Memory:  5.73 GB
------------------------

Process RSS:  32.81 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 0.946999 ms
t_alloc_cpu = 8443.724871 ms
t_init      = 2236.536026 ms
t_h2d       = 1680.848883 ms
t_d2h       = 155.997992 ms
t_gemm      = 4519.611084 ms
t_end_2_end = 19535.429001 ms
Generating '/tmp/nsys-report-4477.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [==19%                       ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [========42%                 ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [=========43%                ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [=========44%                ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [=========45%                ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [=========46%                ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [==========47%               ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [==========48%               ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [=======================95%  ] nsys_report_fo_10000_5_40.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_40.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [1%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [2%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [3%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [4%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [5%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [6%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [7%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [8%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [9%                          ] nsys_report_fo_10000_5_40.sqlite[2/7] [10%                         ] nsys_report_fo_10000_5_40.sqlite[2/7] [11%                         ] nsys_report_fo_10000_5_40.sqlite[2/7] [12%                         ] nsys_report_fo_10000_5_40.sqlite[2/7] [13%                         ] nsys_report_fo_10000_5_40.sqlite[2/7] [14%                         ] nsys_report_fo_10000_5_40.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_5_40.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_5_40.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_5_40.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_5_40.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_5_40.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_5_40.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_5_40.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_5_40.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_5_40.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_5_40.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_5_40.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_5_40.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_5_40.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_5_40.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_5_40.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_5_40.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_5_40.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_5_40.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_5_40.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_5_40.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_5_40.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_5_40.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_5_40.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_5_40.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_5_40.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_5_40.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_5_40.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_5_40.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_5_40.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_5_40.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_5_40.sqlite[2/7] [============54%             ] nsys_report_fo_10000_5_40.sqlite[2/7] [============55%             ] nsys_report_fo_10000_5_40.sqlite[2/7] [============56%             ] nsys_report_fo_10000_5_40.sqlite[2/7] [============57%             ] nsys_report_fo_10000_5_40.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_5_40.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_5_40.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_5_40.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_5_40.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_5_40.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_5_40.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_5_40.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_5_40.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_5_40.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_5_40.sqlite[2/7] [================68%         ] nsys_report_fo_10000_5_40.sqlite[2/7] [================69%         ] nsys_report_fo_10000_5_40.sqlite[2/7] [================70%         ] nsys_report_fo_10000_5_40.sqlite[2/7] [================71%         ] nsys_report_fo_10000_5_40.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_5_40.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_5_40.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_5_40.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_5_40.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_5_40.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_5_40.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_5_40.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_5_40.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_5_40.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_5_40.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_5_40.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_5_40.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_5_40.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_5_40.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_5_40.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_5_40.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_5_40.sqlite[2/7] [========================97% ] nsys_report_fo_10000_5_40.sqlite[2/7] [========================98% ] nsys_report_fo_10000_5_40.sqlite[2/7] [========================99% ] nsys_report_fo_10000_5_40.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_40.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        312868379          1  312868379.0  312868379.0  312868379  312868379          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     49.8       8443718854          1  8443718854.0  8443718854.0  8443718854  8443718854          0.0  cudaHostAlloc                     
     25.3       4287624159        120    35730201.3        7400.0        3930   110810582   51689218.1  cudaMemcpyAsync                   
     21.0       3563947337          1  3563947337.0  3563947337.0  3563947337  3563947337          0.0  cudaFreeHost                      
      1.3        220541123         40     5513528.1         510.0         450   220519142   34867048.7  cuKernelGetFunction               
      1.1        191350837         11    17395530.6      463335.0       61021   187081110   56278702.2  cudaFree                          
      0.8        131151259          2    65575629.5    65575629.5    53689417    77461842   16809642.9  cudaMemcpy                        
      0.7        120559311          1   120559311.0   120559311.0   120559311   120559311          0.0  cudaDeviceReset                   
      0.0          3945413         15      263027.5      276793.0      115911      428805     103313.8  cuLibraryLoadData                 
      0.0          1246953         42       29689.4        2345.0        2060     1146303     176500.3  cudaStreamSynchronize             
      0.0          1118383         10      111838.3      120462.0        3930      160432      44689.8  cudaMalloc                        
      0.0           873017        120        7275.1        4745.0        4080      241273      21609.1  cudaLaunchKernel                  
      0.0           589423        280        2105.1        2540.0         510       15530       1588.0  cudaEventRecord                   
      0.0           260694        814         320.3         280.0         120        1120        166.1  cuGetProcAddress_v2               
      0.0           244702         40        6117.6        5155.0        4490       39000       5373.6  cuLaunchKernel                    
      0.0           120380        160         752.4         610.0         500        4030        531.1  cudaEventCreate                   
      0.0            84490          1       84490.0       84490.0       84490       84490          0.0  cudaMemGetInfo                    
      0.0            82713        200         413.6         300.0         280        5860        426.2  cudaStreamGetCaptureInfo_v2_v11030
      0.0            66010         75         880.1         830.0         590        3300        410.1  cudaStreamWaitEvent               
      0.0            55222         28        1972.2         540.0         410       12771       3571.0  cudaEventCreateWithFlags          
      0.0            39630          4        9907.5        3120.0        1310       32080      14817.3  cudaDeviceSynchronize             
      0.0            37330          2       18665.0       18665.0        2030       35300      23525.4  cudaStreamCreateWithFlags         
      0.0            22330         28         797.5         575.0         360        4320        824.4  cudaEventDestroy                  
      0.0            20350          2       10175.0       10175.0        5470       14880       6653.9  cudaStreamDestroy                 
      0.0            10720         16         670.0         535.0         490        1640        301.5  cuLibraryGetKernel                
      0.0             4891          1        4891.0        4891.0        4891        4891          0.0  cudaEventQuery                    
      0.0             4660          3        1553.3        1740.0         590        2330        884.9  cuInit                            
      0.0             3350          3        1116.7         290.0         220        2840       1492.9  cuModuleGetLoadingMode            
      0.0             1060          1        1060.0        1060.0        1060        1060          0.0  cuCtxSynchronize                  
      0.0              840          2         420.0         420.0         310         530        155.6  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       4322115901         40  108052897.5  108263787.0  104888779  109034562     817813.6  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         46004755         40    1150118.9    1152537.0    1139945    1154345       4363.2  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         25901971         80     323774.6     321826.5      12416     642117     312965.4  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     95.6       1680409303     81  20745793.9  32796682.0      1568  54232057   21663089.6  [CUDA memcpy Host-to-Device]
      4.4         77367770     41   1887018.8      1952.0      1920  77287324   12069938.0  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  32800.415     81   404.943   800.000     0.010   800.000      402.456  [CUDA memcpy Host-to-Device]
    800.000     41    19.512     0.000     0.000   800.000      124.939  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 5 (num_steps = 60)
number of batches= 12
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 6466.434181 ms
t_h2d = 2092.333725 ms
t_gpu_alloc = 0.890017 ms
t_cpu_alloc = 13269.469023 ms
t_init = 7402.535915 ms
t_d2h = 252.105951 ms
t_end_2_end = 35626.369953 ms
Generating '/tmp/nsys-report-e4f1.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=16%                        ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [======33%                   ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [======34%                   ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [======35%                   ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=======36%                  ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=======37%                  ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=======38%                  ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=======39%                  ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [========40%                 ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [========41%                 ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [========42%                 ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=========43%                ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=========44%                ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=========45%                ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=========46%                ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [==========47%               ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [==========48%               ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [==========49%               ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [===========50%              ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [===========51%              ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [===========52%              ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [===========53%              ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [============54%             ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [============55%             ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [============56%             ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [============57%             ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=============58%            ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=============59%            ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [=============60%            ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [==============61%           ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [==============62%           ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [==============63%           ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [===============65%          ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [===============66%          ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_5_60.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_60.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [1%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [2%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [3%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [4%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [5%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [6%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [7%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [8%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [9%                          ] nsys_report_ia_10000_5_60.sqlite[2/7] [10%                         ] nsys_report_ia_10000_5_60.sqlite[2/7] [11%                         ] nsys_report_ia_10000_5_60.sqlite[2/7] [12%                         ] nsys_report_ia_10000_5_60.sqlite[2/7] [13%                         ] nsys_report_ia_10000_5_60.sqlite[2/7] [14%                         ] nsys_report_ia_10000_5_60.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_5_60.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_5_60.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_5_60.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_5_60.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_5_60.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_5_60.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_5_60.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_5_60.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_5_60.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_5_60.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_5_60.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_5_60.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_5_60.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_5_60.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_5_60.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_5_60.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_5_60.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_5_60.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_5_60.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_5_60.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_5_60.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_5_60.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_5_60.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_5_60.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_5_60.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_5_60.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_5_60.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_5_60.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_5_60.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_5_60.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_5_60.sqlite[2/7] [============54%             ] nsys_report_ia_10000_5_60.sqlite[2/7] [============55%             ] nsys_report_ia_10000_5_60.sqlite[2/7] [============56%             ] nsys_report_ia_10000_5_60.sqlite[2/7] [============57%             ] nsys_report_ia_10000_5_60.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_5_60.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_5_60.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_5_60.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_5_60.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_5_60.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_5_60.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_5_60.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_5_60.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_5_60.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_5_60.sqlite[2/7] [================68%         ] nsys_report_ia_10000_5_60.sqlite[2/7] [================69%         ] nsys_report_ia_10000_5_60.sqlite[2/7] [================70%         ] nsys_report_ia_10000_5_60.sqlite[2/7] [================71%         ] nsys_report_ia_10000_5_60.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_5_60.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_5_60.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_5_60.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_5_60.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_5_60.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_5_60.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_5_60.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_5_60.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_5_60.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_5_60.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_5_60.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_5_60.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_5_60.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_5_60.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_5_60.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_5_60.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_5_60.sqlite[2/7] [========================97% ] nsys_report_ia_10000_5_60.sqlite[2/7] [========================98% ] nsys_report_ia_10000_5_60.sqlite[2/7] [========================99% ] nsys_report_ia_10000_5_60.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_60.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        288601782          1  288601782.0  288601782.0  288601782  288601782          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     48.5      13269457025          1  13269457025.0  13269457025.0  13269457025  13269457025          0.0  cudaHostAlloc                     
     28.3       7751032010         36    215306444.7        19685.5         6100    750629793  329244031.0  cudaMemcpyAsync                   
     20.9       5708880534          1   5708880534.0   5708880534.0   5708880534   5708880534          0.0  cudaFreeHost                      
      0.7        194520275         60      3242004.6          320.0          300    194476315   25106688.1  cuKernelGetFunction               
      0.6        172061155          8     21507644.4      1384055.5        55481    164603422   57825923.1  cudaFree                          
      0.5        132905230          2     66452615.0     66452615.0     55590949     77314281   15360715.4  cudaMemcpy                        
      0.4        119972745          1    119972745.0    119972745.0    119972745    119972745          0.0  cudaDeviceReset                   
      0.0          4596992         15       306466.1       317204.0       131561       520086     128075.0  cuLibraryLoadData                 
      0.0          1184523         14        84608.8         3140.0         2510      1141023     304057.7  cudaStreamSynchronize             
      0.0          1063750          7       151964.3       133441.0         3600       300103     106027.9  cudaMalloc                        
      0.0           749577         36        20821.6         8000.0         3960       337464      55297.8  cudaLaunchKernel                  
      0.0           486815        168         2897.7         2460.0          510        29690       2494.4  cudaEventRecord                   
      0.0           352704         60         5878.4         4075.5         3700        43971       5508.3  cuLaunchKernel                    
      0.0           298603        814          366.8          310.0          120         1610        226.7  cuGetProcAddress_v2               
      0.0           114122        144          792.5          510.0          490         5520        722.6  cudaEventCreate                   
      0.0           113010        164          689.1          470.0          330        25900       2123.1  cudaEventDestroy                  
      0.0            92381         20         4619.1          530.0          400        51720      12252.2  cudaEventCreateWithFlags          
      0.0            54342         60          905.7          320.0          280         5060       1155.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0            44561          4        11140.3         3630.0         1540        35761      16455.7  cudaDeviceSynchronize             
      0.0            40961          2        20480.5        20480.5         2061        38900      26049.1  cudaStreamCreateWithFlags         
      0.0            25470          2        12735.0        12735.0         5360        20110      10429.8  cudaStreamDestroy                 
      0.0            20061         12         1671.8         1200.5          910         5330       1315.3  cudaStreamWaitEvent               
      0.0            17340         16         1083.8          595.0          480         7580       1752.0  cuLibraryGetKernel                
      0.0             7331          3         2443.7         3031.0          930         3370       1321.8  cuInit                            
      0.0             6150          1         6150.0         6150.0         6150         6150          0.0  cudaEventQuery                    
      0.0             4940          3         1646.7          410.0          170         4360       2352.9  cuModuleGetLoadingMode            
      0.0             2070          1         2070.0         2070.0         2070         2070          0.0  cuCtxSynchronize                  
      0.0              860          2          430.0          430.0          310          550        169.7  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7       6465730314         60  107762171.9  108004491.0  104812213  114706138    1449200.7  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2         13816691         12    1151390.9    1152265.5    1140650    1155369       3813.9  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          7783969         24     324332.0     321570.5      12544     644774     318312.8  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     96.4       2091801685     25  83672067.4  55343356.0      1568  214146553   86162674.9  [CUDA memcpy Host-to-Device]
      3.6         77098789     13   5930676.1      1984.0      1920   77073348   21375712.6  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  48800.125     25  1952.005   800.000     0.010  4000.000     2014.344  [CUDA memcpy Host-to-Device]
    800.000     13    61.538     0.000     0.000   800.000      221.880  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 5 (num_steps = 60)
number of batches= 12
t_gemm = 6656.875893 ms
t_h2d = 2136.069685 ms
t_d2h = 155.399084 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.589132 ms
t_cpu_alloc = 12857.072830 ms
t_init = 3182.943106 ms
t_end_2_end = 29231.503963 ms
Generating '/tmp/nsys-report-acba.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=======39%                  ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=============59%            ] nsys_report_db_10000_5_60.nsys-rep[1/7] [===================79%      ] nsys_report_db_10000_5_60.nsys-rep[1/7] [===================80%      ] nsys_report_db_10000_5_60.nsys-rep[1/7] [===================81%      ] nsys_report_db_10000_5_60.nsys-rep[1/7] [===================82%      ] nsys_report_db_10000_5_60.nsys-rep[1/7] [====================83%     ] nsys_report_db_10000_5_60.nsys-rep[1/7] [====================84%     ] nsys_report_db_10000_5_60.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_5_60.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_5_60.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_5_60.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_5_60.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_5_60.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_5_60.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_60.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [1%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [2%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [3%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [4%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [5%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [6%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [7%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [8%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [9%                          ] nsys_report_db_10000_5_60.sqlite[2/7] [10%                         ] nsys_report_db_10000_5_60.sqlite[2/7] [11%                         ] nsys_report_db_10000_5_60.sqlite[2/7] [12%                         ] nsys_report_db_10000_5_60.sqlite[2/7] [13%                         ] nsys_report_db_10000_5_60.sqlite[2/7] [14%                         ] nsys_report_db_10000_5_60.sqlite[2/7] [=15%                        ] nsys_report_db_10000_5_60.sqlite[2/7] [=16%                        ] nsys_report_db_10000_5_60.sqlite[2/7] [=17%                        ] nsys_report_db_10000_5_60.sqlite[2/7] [==18%                       ] nsys_report_db_10000_5_60.sqlite[2/7] [==19%                       ] nsys_report_db_10000_5_60.sqlite[2/7] [==20%                       ] nsys_report_db_10000_5_60.sqlite[2/7] [==21%                       ] nsys_report_db_10000_5_60.sqlite[2/7] [===22%                      ] nsys_report_db_10000_5_60.sqlite[2/7] [===23%                      ] nsys_report_db_10000_5_60.sqlite[2/7] [===24%                      ] nsys_report_db_10000_5_60.sqlite[2/7] [====25%                     ] nsys_report_db_10000_5_60.sqlite[2/7] [====26%                     ] nsys_report_db_10000_5_60.sqlite[2/7] [====27%                     ] nsys_report_db_10000_5_60.sqlite[2/7] [====28%                     ] nsys_report_db_10000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_5_60.sqlite[2/7] [======33%                   ] nsys_report_db_10000_5_60.sqlite[2/7] [======34%                   ] nsys_report_db_10000_5_60.sqlite[2/7] [======35%                   ] nsys_report_db_10000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_5_60.sqlite[2/7] [========40%                 ] nsys_report_db_10000_5_60.sqlite[2/7] [========41%                 ] nsys_report_db_10000_5_60.sqlite[2/7] [========42%                 ] nsys_report_db_10000_5_60.sqlite[2/7] [=========43%                ] nsys_report_db_10000_5_60.sqlite[2/7] [=========44%                ] nsys_report_db_10000_5_60.sqlite[2/7] [=========45%                ] nsys_report_db_10000_5_60.sqlite[2/7] [=========46%                ] nsys_report_db_10000_5_60.sqlite[2/7] [==========47%               ] nsys_report_db_10000_5_60.sqlite[2/7] [==========48%               ] nsys_report_db_10000_5_60.sqlite[2/7] [==========49%               ] nsys_report_db_10000_5_60.sqlite[2/7] [===========50%              ] nsys_report_db_10000_5_60.sqlite[2/7] [===========51%              ] nsys_report_db_10000_5_60.sqlite[2/7] [===========52%              ] nsys_report_db_10000_5_60.sqlite[2/7] [===========53%              ] nsys_report_db_10000_5_60.sqlite[2/7] [============54%             ] nsys_report_db_10000_5_60.sqlite[2/7] [============55%             ] nsys_report_db_10000_5_60.sqlite[2/7] [============56%             ] nsys_report_db_10000_5_60.sqlite[2/7] [============57%             ] nsys_report_db_10000_5_60.sqlite[2/7] [=============58%            ] nsys_report_db_10000_5_60.sqlite[2/7] [=============59%            ] nsys_report_db_10000_5_60.sqlite[2/7] [=============60%            ] nsys_report_db_10000_5_60.sqlite[2/7] [==============61%           ] nsys_report_db_10000_5_60.sqlite[2/7] [==============62%           ] nsys_report_db_10000_5_60.sqlite[2/7] [==============63%           ] nsys_report_db_10000_5_60.sqlite[2/7] [==============64%           ] nsys_report_db_10000_5_60.sqlite[2/7] [===============65%          ] nsys_report_db_10000_5_60.sqlite[2/7] [===============66%          ] nsys_report_db_10000_5_60.sqlite[2/7] [===============67%          ] nsys_report_db_10000_5_60.sqlite[2/7] [================68%         ] nsys_report_db_10000_5_60.sqlite[2/7] [================69%         ] nsys_report_db_10000_5_60.sqlite[2/7] [================70%         ] nsys_report_db_10000_5_60.sqlite[2/7] [================71%         ] nsys_report_db_10000_5_60.sqlite[2/7] [=================72%        ] nsys_report_db_10000_5_60.sqlite[2/7] [=================73%        ] nsys_report_db_10000_5_60.sqlite[2/7] [=================74%        ] nsys_report_db_10000_5_60.sqlite[2/7] [==================75%       ] nsys_report_db_10000_5_60.sqlite[2/7] [==================76%       ] nsys_report_db_10000_5_60.sqlite[2/7] [==================77%       ] nsys_report_db_10000_5_60.sqlite[2/7] [==================78%       ] nsys_report_db_10000_5_60.sqlite[2/7] [===================79%      ] nsys_report_db_10000_5_60.sqlite[2/7] [===================80%      ] nsys_report_db_10000_5_60.sqlite[2/7] [===================81%      ] nsys_report_db_10000_5_60.sqlite[2/7] [===================82%      ] nsys_report_db_10000_5_60.sqlite[2/7] [====================83%     ] nsys_report_db_10000_5_60.sqlite[2/7] [====================84%     ] nsys_report_db_10000_5_60.sqlite[2/7] [====================85%     ] nsys_report_db_10000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_5_60.sqlite[2/7] [======================90%   ] nsys_report_db_10000_5_60.sqlite[2/7] [======================91%   ] nsys_report_db_10000_5_60.sqlite[2/7] [======================92%   ] nsys_report_db_10000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_5_60.sqlite[2/7] [========================97% ] nsys_report_db_10000_5_60.sqlite[2/7] [========================98% ] nsys_report_db_10000_5_60.sqlite[2/7] [========================99% ] nsys_report_db_10000_5_60.sqlite[2/7] [========================100%] nsys_report_db_10000_5_60.sqlite[2/7] [========================100%] nsys_report_db_10000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        287032548          1  287032548.0  287032548.0  287032548  287032548          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     50.8      12857062441          1  12857062441.0  12857062441.0  12857062441  12857062441          0.0  cudaHostAlloc                     
     23.7       5986443732         36    166290103.7        25081.0         6130    546219975  254185565.6  cudaMemcpyAsync                   
     22.4       5655174320          1   5655174320.0   5655174320.0   5655174320   5655174320          0.0  cudaFreeHost                      
      1.4        358997959         60      5983299.3          340.0          290    358955969   46340924.5  cuKernelGetFunction               
      0.7        171392811          8     21424101.4      1179108.5        36361    164358671   57760037.8  cudaFree                          
      0.5        130132360          2     65066180.0     65066180.0     53120032     77012328   16894404.5  cudaMemcpy                        
      0.5        122173831          1    122173831.0    122173831.0    122173831    122173831          0.0  cudaDeviceReset                   
      0.0          4084236         15       272282.4       288683.0       118551       434085     108272.4  cuLibraryLoadData                 
      0.0          1183113         14        84508.1         3030.0         2510      1142203     304426.0  cudaStreamSynchronize             
      0.0          1058731          7       151247.3       117822.0         4110       317783     110710.0  cudaMalloc                        
      0.0           690489         36        19180.3         8180.0         3980       282953      45808.9  cudaLaunchKernel                  
      0.0           472689        168         2813.6         2550.0          530        17641       1759.8  cudaEventRecord                   
      0.0           348853         60         5814.2         4220.0         3610        46651       5672.0  cuLaunchKernel                    
      0.0           337485        814          414.6          370.0          120         1550        249.9  cuGetProcAddress_v2               
      0.0           130440        164          795.4          480.0          330        32160       2545.9  cudaEventDestroy                  
      0.0           104411        144          725.1          510.0          460         4700        605.7  cudaEventCreate                   
      0.0            73902         20         3695.1          525.0          400        49541      11160.7  cudaEventCreateWithFlags          
      0.0            57560         60          959.3          375.0          290         7460       1313.4  cudaStreamGetCaptureInfo_v2_v11030
      0.0            40370          2        20185.0        20185.0         2020        38350      25689.2  cudaStreamCreateWithFlags         
      0.0            35130          4         8782.5         3730.0         1460        26210      11678.1  cudaDeviceSynchronize             
      0.0            28460         12         2371.7         1855.0         1610         5340       1167.8  cudaStreamWaitEvent               
      0.0            26150          2        13075.0        13075.0         4670        21480      11886.5  cudaStreamDestroy                 
      0.0            11961         16          747.6          615.0          480         1810        365.0  cuLibraryGetKernel                
      0.0             7190          3         2396.7         2890.0          880         3420       1339.9  cuInit                            
      0.0             4950          1         4950.0         4950.0         4950         4950          0.0  cudaEventQuery                    
      0.0             4660          3         1553.3          530.0          290         3840       1983.9  cuModuleGetLoadingMode            
      0.0             1450          1         1450.0         1450.0         1450         1450          0.0  cuCtxSynchronize                  
      0.0              970          2          485.0          485.0          420          550         91.9  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7       6499431918         60  108323865.3  108435406.5  105432937  109829972     899620.7  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2         13809935         12    1150827.9    1153145.0    1141033    1154346       4745.0  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          7769761         24     323740.0     320627.0      12544     637797     317623.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     96.5       2135437840     25  85417513.6  52767941.0      1568  221537351   88243134.2  [CUDA memcpy Host-to-Device]
      3.5         76752472     13   5904036.3      1952.0      1951   76726938   21279633.6  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  48800.125     25  1952.005   800.000     0.010  4000.000     2014.344  [CUDA memcpy Host-to-Device]
    800.000     13    61.538     0.000     0.000   800.000      221.880  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 5 (num_steps = 60), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  33.74 GB
Used GPU Memory:  5.76 GB
------------------------

Process RSS:  47.71 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 0.920057 ms
t_alloc_cpu = 12755.959034 ms
t_init      = 4630.165100 ms
t_h2d       = 2177.360876 ms
t_d2h       = 167.730093 ms
t_gemm      = 6645.167549 ms
t_end_2_end = 30769.695997 ms
Generating '/tmp/nsys-report-18bd.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [14%                         ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [========42%                 ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=========43%                ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=========44%                ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=========45%                ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=========46%                ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [==========47%               ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [==========48%               ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [==========49%               ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [===========50%              ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [=======================95%  ] nsys_report_fo_10000_5_60.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_60.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [1%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [2%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [3%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [4%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [5%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [6%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [7%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [8%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [9%                          ] nsys_report_fo_10000_5_60.sqlite[2/7] [10%                         ] nsys_report_fo_10000_5_60.sqlite[2/7] [11%                         ] nsys_report_fo_10000_5_60.sqlite[2/7] [12%                         ] nsys_report_fo_10000_5_60.sqlite[2/7] [13%                         ] nsys_report_fo_10000_5_60.sqlite[2/7] [14%                         ] nsys_report_fo_10000_5_60.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_5_60.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_5_60.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_5_60.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_5_60.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_5_60.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_5_60.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_5_60.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_5_60.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_5_60.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_5_60.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_5_60.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_5_60.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_5_60.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_5_60.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_5_60.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_5_60.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_5_60.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_5_60.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_5_60.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_5_60.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_5_60.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_5_60.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_5_60.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_5_60.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_5_60.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_5_60.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_5_60.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_5_60.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_5_60.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_5_60.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_5_60.sqlite[2/7] [============54%             ] nsys_report_fo_10000_5_60.sqlite[2/7] [============55%             ] nsys_report_fo_10000_5_60.sqlite[2/7] [============56%             ] nsys_report_fo_10000_5_60.sqlite[2/7] [============57%             ] nsys_report_fo_10000_5_60.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_5_60.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_5_60.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_5_60.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_5_60.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_5_60.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_5_60.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_5_60.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_5_60.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_5_60.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_5_60.sqlite[2/7] [================68%         ] nsys_report_fo_10000_5_60.sqlite[2/7] [================69%         ] nsys_report_fo_10000_5_60.sqlite[2/7] [================70%         ] nsys_report_fo_10000_5_60.sqlite[2/7] [================71%         ] nsys_report_fo_10000_5_60.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_5_60.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_5_60.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_5_60.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_5_60.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_5_60.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_5_60.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_5_60.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_5_60.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_5_60.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_5_60.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_5_60.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_5_60.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_5_60.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_5_60.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_5_60.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_5_60.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_5_60.sqlite[2/7] [========================97% ] nsys_report_fo_10000_5_60.sqlite[2/7] [========================98% ] nsys_report_fo_10000_5_60.sqlite[2/7] [========================99% ] nsys_report_fo_10000_5_60.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_60.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        276463333          1  276463333.0  276463333.0  276463333  276463333          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.5      12755939809          1  12755939809.0  12755939809.0  12755939809  12755939809          0.0  cudaHostAlloc                     
     25.1       6483913605        180     36021742.3        13415.0         3590    111546743   51709333.3  cudaMemcpyAsync                   
     23.0       5941388657          1   5941388657.0   5941388657.0   5941388657   5941388657          0.0  cudaFreeHost                      
      0.7        167764550         60      2796075.8          540.0          420    167718040   21652204.1  cuKernelGetFunction               
      0.6        160766393         11     14615126.6       466515.0        75061    156785968   47153099.0  cudaFree                          
      0.6        144561752          2     72280876.0     72280876.0     54799821     89761931   24721945.1  cudaMemcpy                        
      0.5        130319963          1    130319963.0    130319963.0    130319963    130319963          0.0  cudaDeviceReset                   
      0.0          4435318         15       295687.9       309833.0       132741       471645     116658.8  cuLibraryLoadData                 
      0.0          1418656        180         7881.4         4805.0         3910       298213      22121.5  cudaLaunchKernel                  
      0.0          1298594         62        20945.1         2370.0         1980      1141682     144668.5  cudaStreamSynchronize             
      0.0          1098012         10       109801.2       122896.5         3570       160342      43201.2  cudaMalloc                        
      0.0          1009450        420         2403.5         2470.0          500        37621       2885.8  cudaEventRecord                   
      0.0           396782         60         6613.0         5085.0         4270        66221       7945.8  cuLaunchKernel                    
      0.0           241482        814          296.7          280.0          120         1040        137.2  cuGetProcAddress_v2               
      0.0           183452        240          764.4          480.0          460        16410       1345.0  cudaEventCreate                   
      0.0           139235        300          464.1          300.0          270         9930        732.9  cudaStreamGetCaptureInfo_v2_v11030
      0.0           123552          1       123552.0       123552.0       123552       123552          0.0  cudaMemGetInfo                    
      0.0           105280        115          915.5          810.0          570         4620        516.6  cudaStreamWaitEvent               
      0.0            88251          4        22062.8         3010.0         1560        80671      39080.6  cudaDeviceSynchronize             
      0.0            55092         28         1967.6          500.5          390        25321       4978.5  cudaEventCreateWithFlags          
      0.0            40081          2        20040.5        20040.5         6900        33181      18583.5  cudaStreamDestroy                 
      0.0            37681          2        18840.5        18840.5         1910        35771      23943.3  cudaStreamCreateWithFlags         
      0.0            29860         28         1066.4          525.0          320        10900       2026.2  cudaEventDestroy                  
      0.0            10810         16          675.6          590.0          490         1360        254.3  cuLibraryGetKernel                
      0.0             5160          1         5160.0         5160.0         5160         5160          0.0  cudaEventQuery                    
      0.0             4550          3         1516.7         1420.0          640         2490        928.8  cuInit                            
      0.0             3080          3         1026.7          260.0          150         2670       1424.2  cuModuleGetLoadingMode            
      0.0             1590          1         1590.0         1590.0         1590         1590          0.0  cuCtxSynchronize                  
      0.0              930          2          465.0          465.0          300          630        233.3  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       6499726164         60  108328769.4  108119933.5  106386722  122047325    1919601.2  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         69085061         60    1151417.7    1153001.0    1139466    1155113       3868.3  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         38947867        120     324565.6     322066.5      12544     642309     313108.7  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     96.0       2175997865    121  17983453.4  30940121.0      1567  54147145   18395001.8  [CUDA memcpy Host-to-Device]
      4.0         89653113     61   1469723.2      1952.0      1889  89533368   11463317.6  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  48800.623    121   403.311   800.000     0.010   800.000      401.644  [CUDA memcpy Host-to-Device]
    800.000     61    13.115     0.000     0.000   800.000      102.430  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 5 (num_steps = 80)
number of batches= 16
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 8603.157997 ms
t_h2d = 3102.629612 ms
t_gpu_alloc = 0.885963 ms
t_cpu_alloc = 17422.758102 ms
t_init = 4416.347027 ms
t_d2h = 608.025074 ms
t_end_2_end = 44270.055056 ms
Generating '/tmp/nsys-report-3ea3.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=======37%                  ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [============54%             ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [================71%         ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=================72%        ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=================73%        ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=================74%        ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [==================75%       ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [==================76%       ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [==================77%       ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [==================78%       ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [===================79%      ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [===================80%      ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [===================81%      ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_5_80.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_80.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [1%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [2%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [3%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [4%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [5%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [6%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [7%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [8%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [9%                          ] nsys_report_ia_10000_5_80.sqlite[2/7] [10%                         ] nsys_report_ia_10000_5_80.sqlite[2/7] [11%                         ] nsys_report_ia_10000_5_80.sqlite[2/7] [12%                         ] nsys_report_ia_10000_5_80.sqlite[2/7] [13%                         ] nsys_report_ia_10000_5_80.sqlite[2/7] [14%                         ] nsys_report_ia_10000_5_80.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_5_80.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_5_80.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_5_80.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_5_80.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_5_80.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_5_80.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_5_80.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_5_80.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_5_80.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_5_80.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_5_80.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_5_80.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_5_80.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_5_80.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_5_80.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_5_80.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_5_80.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_5_80.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_5_80.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_5_80.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_5_80.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_5_80.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_5_80.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_5_80.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_5_80.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_5_80.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_5_80.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_5_80.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_5_80.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_5_80.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_5_80.sqlite[2/7] [============54%             ] nsys_report_ia_10000_5_80.sqlite[2/7] [============55%             ] nsys_report_ia_10000_5_80.sqlite[2/7] [============56%             ] nsys_report_ia_10000_5_80.sqlite[2/7] [============57%             ] nsys_report_ia_10000_5_80.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_5_80.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_5_80.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_5_80.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_5_80.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_5_80.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_5_80.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_5_80.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_5_80.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_5_80.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_5_80.sqlite[2/7] [================68%         ] nsys_report_ia_10000_5_80.sqlite[2/7] [================69%         ] nsys_report_ia_10000_5_80.sqlite[2/7] [================70%         ] nsys_report_ia_10000_5_80.sqlite[2/7] [================71%         ] nsys_report_ia_10000_5_80.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_5_80.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_5_80.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_5_80.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_5_80.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_5_80.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_5_80.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_5_80.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_5_80.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_5_80.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_5_80.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_5_80.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_5_80.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_5_80.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_5_80.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_5_80.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_5_80.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_5_80.sqlite[2/7] [========================97% ] nsys_report_ia_10000_5_80.sqlite[2/7] [========================98% ] nsys_report_ia_10000_5_80.sqlite[2/7] [========================99% ] nsys_report_ia_10000_5_80.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_80.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        289545642          1  289545642.0  289545642.0  289545642  289545642          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     45.0      17422753057          1  17422753057.0  17422753057.0  17422753057  17422753057          0.0  cudaHostAlloc                     
     28.1      10899158472         48    227065801.5        22070.0         6480    792843389  340595199.0  cudaMemcpyAsync                   
     25.0       9673483667          1   9673483667.0   9673483667.0   9673483667   9673483667          0.0  cudaFreeHost                      
      0.6        213546083          2    106773041.5    106773041.5     54538068    159008015   73871408.0  cudaMemcpy                        
      0.5        205299261         80      2566240.8          370.0          290    205209310   22942971.1  cuKernelGetFunction               
      0.5        175544738          8     21943092.3      1226179.0        54050    168268279   59129933.8  cudaFree                          
      0.3        123542329          1    123542329.0    123542329.0    123542329    123542329          0.0  cudaDeviceReset                   
      0.0          4180688         15       278712.5       294883.0       122282       456035     110110.4  cuLibraryLoadData                 
      0.0          1210532         18        67251.8         4120.0         3140      1128972     264975.4  cudaStreamSynchronize             
      0.0          1170878         48        24393.3         8885.0         4340       294414      43555.5  cudaLaunchKernel                  
      0.0          1060341          7       151477.3       141641.0         3920       290333     105419.9  cudaMalloc                        
      0.0           924785        224         4128.5         3190.0          690        19640       2530.6  cudaEventRecord                   
      0.0           595017         80         7437.7         4750.0         3710        33730       5118.9  cuLaunchKernel                    
      0.0           266985        814          328.0          300.0          120         1610        166.2  cuGetProcAddress_v2               
      0.0           204504        212          964.6          440.0          340        31610       2262.0  cudaEventDestroy                  
      0.0           149032        192          776.2          590.0          470        10071        890.1  cudaEventCreate                   
      0.0           117343         80         1466.8          465.0          280        10940       2115.3  cudaStreamGetCaptureInfo_v2_v11030
      0.0            48322         20         2416.1          495.0          390        21731       5563.7  cudaEventCreateWithFlags          
      0.0            37940          2        18970.0        18970.0         3370        34570      22061.7  cudaStreamCreateWithFlags         
      0.0            33650          4         8412.5         2910.0         1530        26300      11965.3  cudaDeviceSynchronize             
      0.0            32260         16         2016.3         1780.0         1310         3860        711.0  cudaStreamWaitEvent               
      0.0            18860          2         9430.0         9430.0         5370        13490       5741.7  cudaStreamDestroy                 
      0.0            16510         16         1031.9          645.0          530         6020       1351.5  cuLibraryGetKernel                
      0.0             6370          1         6370.0         6370.0         6370         6370          0.0  cudaEventQuery                    
      0.0             5360          3         1786.7         2260.0          620         2480       1016.3  cuInit                            
      0.0             3320          3         1106.7          280.0          170         2870       1528.1  cuModuleGetLoadingMode            
      0.0             1090          1         1090.0         1090.0         1090         1090          0.0  cuCtxSynchronize                  
      0.0              920          2          460.0          460.0          330          590        183.8  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7       8602476579         80  107530957.2  107769714.5  104938463  109472770    1083531.9  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2         18411282         16    1150705.1    1151722.0    1140201    1154633       3518.1  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         10395986         32     324874.6     322050.5      12576     644901     317098.2  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     95.1       3102088834     33  94002691.9  54381054.0      1568  258901205   97321320.6  [CUDA memcpy Host-to-Device]
      4.9        158592161     17   9328950.6      1952.0      1920  158559330   38455788.5  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  64800.166     33  1963.641   800.000     0.010  4000.000     2010.874  [CUDA memcpy Host-to-Device]
    800.000     17    47.059     0.000     0.000   800.000      194.028  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 5 (num_steps = 80)
number of batches= 16
t_gemm = 8899.749367 ms
t_h2d = 3144.097902 ms
t_d2h = 155.729055 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.586033 ms
t_cpu_alloc = 16831.809044 ms
t_init = 4260.478973 ms
t_end_2_end = 39225.266933 ms
Generating '/tmp/nsys-report-b940.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_5_80.nsys-rep[1/7] [========42%                 ] nsys_report_db_10000_5_80.nsys-rep[1/7] [==============61%           ] nsys_report_db_10000_5_80.nsys-rep[1/7] [===================79%      ] nsys_report_db_10000_5_80.nsys-rep[1/7] [===================80%      ] nsys_report_db_10000_5_80.nsys-rep[1/7] [===================81%      ] nsys_report_db_10000_5_80.nsys-rep[1/7] [===================82%      ] nsys_report_db_10000_5_80.nsys-rep[1/7] [====================83%     ] nsys_report_db_10000_5_80.nsys-rep[1/7] [====================84%     ] nsys_report_db_10000_5_80.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_5_80.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_5_80.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_5_80.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_5_80.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_5_80.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_5_80.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_5_80.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_5_80.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_5_80.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_5_80.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_5_80.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_5_80.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_80.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [1%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [2%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [3%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [4%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [5%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [6%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [7%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [8%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [9%                          ] nsys_report_db_10000_5_80.sqlite[2/7] [10%                         ] nsys_report_db_10000_5_80.sqlite[2/7] [11%                         ] nsys_report_db_10000_5_80.sqlite[2/7] [12%                         ] nsys_report_db_10000_5_80.sqlite[2/7] [13%                         ] nsys_report_db_10000_5_80.sqlite[2/7] [14%                         ] nsys_report_db_10000_5_80.sqlite[2/7] [=15%                        ] nsys_report_db_10000_5_80.sqlite[2/7] [=16%                        ] nsys_report_db_10000_5_80.sqlite[2/7] [=17%                        ] nsys_report_db_10000_5_80.sqlite[2/7] [==18%                       ] nsys_report_db_10000_5_80.sqlite[2/7] [==19%                       ] nsys_report_db_10000_5_80.sqlite[2/7] [==20%                       ] nsys_report_db_10000_5_80.sqlite[2/7] [==21%                       ] nsys_report_db_10000_5_80.sqlite[2/7] [===22%                      ] nsys_report_db_10000_5_80.sqlite[2/7] [===23%                      ] nsys_report_db_10000_5_80.sqlite[2/7] [===24%                      ] nsys_report_db_10000_5_80.sqlite[2/7] [====25%                     ] nsys_report_db_10000_5_80.sqlite[2/7] [====26%                     ] nsys_report_db_10000_5_80.sqlite[2/7] [====27%                     ] nsys_report_db_10000_5_80.sqlite[2/7] [====28%                     ] nsys_report_db_10000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_5_80.sqlite[2/7] [======33%                   ] nsys_report_db_10000_5_80.sqlite[2/7] [======34%                   ] nsys_report_db_10000_5_80.sqlite[2/7] [======35%                   ] nsys_report_db_10000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_5_80.sqlite[2/7] [========40%                 ] nsys_report_db_10000_5_80.sqlite[2/7] [========41%                 ] nsys_report_db_10000_5_80.sqlite[2/7] [========42%                 ] nsys_report_db_10000_5_80.sqlite[2/7] [=========43%                ] nsys_report_db_10000_5_80.sqlite[2/7] [=========44%                ] nsys_report_db_10000_5_80.sqlite[2/7] [=========45%                ] nsys_report_db_10000_5_80.sqlite[2/7] [=========46%                ] nsys_report_db_10000_5_80.sqlite[2/7] [==========47%               ] nsys_report_db_10000_5_80.sqlite[2/7] [==========48%               ] nsys_report_db_10000_5_80.sqlite[2/7] [==========49%               ] nsys_report_db_10000_5_80.sqlite[2/7] [===========50%              ] nsys_report_db_10000_5_80.sqlite[2/7] [===========51%              ] nsys_report_db_10000_5_80.sqlite[2/7] [===========52%              ] nsys_report_db_10000_5_80.sqlite[2/7] [===========53%              ] nsys_report_db_10000_5_80.sqlite[2/7] [============54%             ] nsys_report_db_10000_5_80.sqlite[2/7] [============55%             ] nsys_report_db_10000_5_80.sqlite[2/7] [============56%             ] nsys_report_db_10000_5_80.sqlite[2/7] [============57%             ] nsys_report_db_10000_5_80.sqlite[2/7] [=============58%            ] nsys_report_db_10000_5_80.sqlite[2/7] [=============59%            ] nsys_report_db_10000_5_80.sqlite[2/7] [=============60%            ] nsys_report_db_10000_5_80.sqlite[2/7] [==============61%           ] nsys_report_db_10000_5_80.sqlite[2/7] [==============62%           ] nsys_report_db_10000_5_80.sqlite[2/7] [==============63%           ] nsys_report_db_10000_5_80.sqlite[2/7] [==============64%           ] nsys_report_db_10000_5_80.sqlite[2/7] [===============65%          ] nsys_report_db_10000_5_80.sqlite[2/7] [===============66%          ] nsys_report_db_10000_5_80.sqlite[2/7] [===============67%          ] nsys_report_db_10000_5_80.sqlite[2/7] [================68%         ] nsys_report_db_10000_5_80.sqlite[2/7] [================69%         ] nsys_report_db_10000_5_80.sqlite[2/7] [================70%         ] nsys_report_db_10000_5_80.sqlite[2/7] [================71%         ] nsys_report_db_10000_5_80.sqlite[2/7] [=================72%        ] nsys_report_db_10000_5_80.sqlite[2/7] [=================73%        ] nsys_report_db_10000_5_80.sqlite[2/7] [=================74%        ] nsys_report_db_10000_5_80.sqlite[2/7] [==================75%       ] nsys_report_db_10000_5_80.sqlite[2/7] [==================76%       ] nsys_report_db_10000_5_80.sqlite[2/7] [==================77%       ] nsys_report_db_10000_5_80.sqlite[2/7] [==================78%       ] nsys_report_db_10000_5_80.sqlite[2/7] [===================79%      ] nsys_report_db_10000_5_80.sqlite[2/7] [===================80%      ] nsys_report_db_10000_5_80.sqlite[2/7] [===================81%      ] nsys_report_db_10000_5_80.sqlite[2/7] [===================82%      ] nsys_report_db_10000_5_80.sqlite[2/7] [====================83%     ] nsys_report_db_10000_5_80.sqlite[2/7] [====================84%     ] nsys_report_db_10000_5_80.sqlite[2/7] [====================85%     ] nsys_report_db_10000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_5_80.sqlite[2/7] [======================90%   ] nsys_report_db_10000_5_80.sqlite[2/7] [======================91%   ] nsys_report_db_10000_5_80.sqlite[2/7] [======================92%   ] nsys_report_db_10000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_5_80.sqlite[2/7] [========================97% ] nsys_report_db_10000_5_80.sqlite[2/7] [========================98% ] nsys_report_db_10000_5_80.sqlite[2/7] [========================99% ] nsys_report_db_10000_5_80.sqlite[2/7] [========================100%] nsys_report_db_10000_5_80.sqlite[2/7] [========================100%] nsys_report_db_10000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        377307105          1  377307105.0  377307105.0  377307105  377307105          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.2      16831792814          1  16831792814.0  16831792814.0  16831792814  16831792814          0.0  cudaHostAlloc                     
     24.2       8269266249          1   8269266249.0   8269266249.0   8269266249   8269266249          0.0  cudaFreeHost                      
     23.8       8150893284         48    169810276.8        21830.0         6630    545625926  254485448.6  cudaMemcpyAsync                   
      1.3        431859625         80      5398245.3          325.0          290    431799485   48276565.0  cuKernelGetFunction               
      0.8        259584200          8     32448025.0      1107202.0        27881    252711323   89003551.6  cudaFree                          
      0.4        131747023          2     65873511.5     65873511.5     54116925     77630098   16626324.1  cudaMemcpy                        
      0.4        121475407          1    121475407.0    121475407.0    121475407    121475407          0.0  cudaDeviceReset                   
      0.0          4029865         15       268657.7       286873.0       115152       421345     106123.5  cuLibraryLoadData                 
      0.0          1191683         18        66204.6         2880.0         2110      1141583     268379.4  cudaStreamSynchronize             
      0.0          1065362          7       152194.6       128381.0         3780       303243     108730.3  cudaMalloc                        
      0.0           811919         48        16915.0         7820.0         4310       281804      39814.1  cudaLaunchKernel                  
      0.0           666480        224         2975.4         2740.0          540        18630       1592.3  cudaEventRecord                   
      0.0           473251         80         5915.6         4425.0         3880        36540       4268.4  cuLaunchKernel                    
      0.0           321154        814          394.5          380.0          120         1540        227.1  cuGetProcAddress_v2               
      0.0           147362        212          695.1          480.0          340        27520       1927.8  cudaEventDestroy                  
      0.0           143822        192          749.1          520.0          480        10830        863.4  cudaEventCreate                   
      0.0            72331         80          904.1          335.0          280         6290       1160.1  cudaStreamGetCaptureInfo_v2_v11030
      0.0            57900         20         2895.0          520.0          390        33210       7428.8  cudaEventCreateWithFlags          
      0.0            37821          2        18910.5        18910.5         2010        35811      23900.9  cudaStreamCreateWithFlags         
      0.0            36090          4         9022.5         3320.0         1350        28100      12770.2  cudaDeviceSynchronize             
      0.0            35290         16         2205.6         2030.0         1690         3270        461.7  cudaStreamWaitEvent               
      0.0            21670          2        10835.0        10835.0         4950        16720       8322.6  cudaStreamDestroy                 
      0.0            12350         16          771.9          665.0          600         1580        273.5  cuLibraryGetKernel                
      0.0             5040          1         5040.0         5040.0         5040         5040          0.0  cudaEventQuery                    
      0.0             4140          3         1380.0         1100.0          740         2300        816.8  cuInit                            
      0.0             3600          3         1200.0          260.0          170         3170       1706.7  cuModuleGetLoadingMode            
      0.0             1510          1         1510.0         1510.0         1510         1510          0.0  cuCtxSynchronize                  
      0.0              940          2          470.0          470.0          330          610        198.0  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7       8657344300         80  108216803.8  108299909.0  105326493  110069362     870953.6  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2         18395439         16    1149714.9    1151704.5    1140585    1153610       4094.4  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         10381999         32     324437.5     322482.0      12576     641733     316635.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     97.6       3143608156     33  95260853.2  53938936.0      1568  262241388   99691395.7  [CUDA memcpy Host-to-Device]
      2.4         77436943     17   4555114.3      1952.0      1951   77403821   18772682.0  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  64800.166     33  1963.641   800.000     0.010  4000.000     2010.874  [CUDA memcpy Host-to-Device]
    800.000     17    47.059     0.000     0.000   800.000      194.028  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 5 (num_steps = 80), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  33.71 GB
Used GPU Memory:  5.79 GB
------------------------

Process RSS:  62.61 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 0.949144 ms
t_alloc_cpu = 16708.769798 ms
t_init      = 4275.269985 ms
t_h2d       = 3131.786205 ms
t_d2h       = 156.538963 ms
t_gemm      = 8807.021034 ms
t_end_2_end = 38492.159128 ms
Generating '/tmp/nsys-report-49f9.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [13%                         ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [====25%                     ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [====26%                     ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [========42%                 ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=========43%                ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_10000_5_80.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_80.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [1%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [2%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [3%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [4%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [5%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [6%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [7%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [8%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [9%                          ] nsys_report_fo_10000_5_80.sqlite[2/7] [10%                         ] nsys_report_fo_10000_5_80.sqlite[2/7] [11%                         ] nsys_report_fo_10000_5_80.sqlite[2/7] [12%                         ] nsys_report_fo_10000_5_80.sqlite[2/7] [13%                         ] nsys_report_fo_10000_5_80.sqlite[2/7] [14%                         ] nsys_report_fo_10000_5_80.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_5_80.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_5_80.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_5_80.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_5_80.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_5_80.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_5_80.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_5_80.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_5_80.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_5_80.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_5_80.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_5_80.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_5_80.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_5_80.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_5_80.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_5_80.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_5_80.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_5_80.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_5_80.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_5_80.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_5_80.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_5_80.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_5_80.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_5_80.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_5_80.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_5_80.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_5_80.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_5_80.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_5_80.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_5_80.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_5_80.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_5_80.sqlite[2/7] [============54%             ] nsys_report_fo_10000_5_80.sqlite[2/7] [============55%             ] nsys_report_fo_10000_5_80.sqlite[2/7] [============56%             ] nsys_report_fo_10000_5_80.sqlite[2/7] [============57%             ] nsys_report_fo_10000_5_80.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_5_80.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_5_80.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_5_80.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_5_80.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_5_80.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_5_80.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_5_80.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_5_80.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_5_80.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_5_80.sqlite[2/7] [================68%         ] nsys_report_fo_10000_5_80.sqlite[2/7] [================69%         ] nsys_report_fo_10000_5_80.sqlite[2/7] [================70%         ] nsys_report_fo_10000_5_80.sqlite[2/7] [================71%         ] nsys_report_fo_10000_5_80.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_5_80.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_5_80.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_5_80.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_5_80.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_5_80.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_5_80.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_5_80.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_5_80.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_5_80.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_5_80.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_5_80.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_5_80.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_5_80.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_5_80.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_5_80.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_5_80.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_5_80.sqlite[2/7] [========================97% ] nsys_report_fo_10000_5_80.sqlite[2/7] [========================98% ] nsys_report_fo_10000_5_80.sqlite[2/7] [========================99% ] nsys_report_fo_10000_5_80.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_80.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        305092991          1  305092991.0  305092991.0  305092991  305092991          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.3      16708763160          1  16708763160.0  16708763160.0  16708763160  16708763160          0.0  cudaHostAlloc                     
     25.6       8688397138        240     36201654.7         9320.0         4120    111044402   51773591.4  cudaMemcpyAsync                   
     23.2       7865693865          1   7865693865.0   7865693865.0   7865693865   7865693865          0.0  cudaFreeHost                      
      0.6        186743327         11     16976666.1       461906.0        32340    183049426   55080417.6  cudaFree                          
      0.5        177416393         80      2217704.9          515.0          390    177354673   19828767.9  cuKernelGetFunction               
      0.4        132116107          2     66058053.5     66058053.5     53613839     78502268   17598776.9  cudaMemcpy                        
      0.4        119267274          1    119267274.0    119267274.0    119267274    119267274          0.0  cudaDeviceReset                   
      0.0          3938857         15       262590.5       273453.0       115592       424635     102997.7  cuLibraryLoadData                 
      0.0          1677390        240         6989.1         4705.0         4120       237242      15285.1  cudaLaunchKernel                  
      0.0          1338394         82        16321.9         2335.0         1750      1144973     126177.9  cudaStreamSynchronize             
      0.0          1196158        560         2136.0         2545.0          500        13700       1414.3  cudaEventRecord                   
      0.0          1121003         10       112100.3       122921.0         4670       166482      44656.1  cudaMalloc                        
      0.0           493625         80         6170.3         5010.0         4400        31570       3259.2  cuLaunchKernel                    
      0.0           254254        814          312.4          280.0          120         1220        157.7  cuGetProcAddress_v2               
      0.0           230673        320          720.9          525.0          460        10720        740.2  cudaEventCreate                   
      0.0           169680        400          424.2          310.0          270         2450        337.4  cudaStreamGetCaptureInfo_v2_v11030
      0.0           144580        155          932.8          830.0          580         3550        433.6  cudaStreamWaitEvent               
      0.0            80071          1        80071.0        80071.0        80071        80071          0.0  cudaMemGetInfo                    
      0.0            42600         28         1521.4          495.0          380        11900       3097.1  cudaEventCreateWithFlags          
      0.0            36780          2        18390.0        18390.0         1830        34950      23419.4  cudaStreamCreateWithFlags         
      0.0            35030          4         8757.5         2975.0         1340        27740      12691.5  cudaDeviceSynchronize             
      0.0            20921         28          747.2          500.0          320         4350        889.9  cudaEventDestroy                  
      0.0            19000          2         9500.0         9500.0         5400        13600       5798.3  cudaStreamDestroy                 
      0.0            10700         16          668.8          600.0          510         1710        290.8  cuLibraryGetKernel                
      0.0             4860          3         1620.0         1430.0          660         2770       1067.8  cuInit                            
      0.0             4540          1         4540.0         4540.0         4540         4540          0.0  cudaEventQuery                    
      0.0             3210          3         1070.0          280.0          250         2680       1394.4  cuModuleGetLoadingMode            
      0.0             1500          1         1500.0         1500.0         1500         1500          0.0  cuCtxSynchronize                  
      0.0              890          2          445.0          445.0          330          560        162.6  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       8651294781         80  108141184.8  108249356.0  104713332  109279102     698737.1  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         92048176         80    1150602.2    1151865.0    1139849    1154217       3405.3  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         51861490        160     324134.3     321570.5      12448     641318     312335.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     97.6       3131022023    161  19447341.8  31930072.0      1568  54243931   20164325.3  [CUDA memcpy Host-to-Device]
      2.4         78485359     81    968955.0      1952.0      1920  78327217    8702804.5  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  64800.830    161   402.490   800.000     0.010   800.000      401.235  [CUDA memcpy Host-to-Device]
    800.001     81     9.877     0.000     0.000   800.000       88.889  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 5 (num_steps = 100)
number of batches= 20
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 10770.817200 ms
t_h2d = 3758.691767 ms
t_gpu_alloc = 0.871897 ms
t_cpu_alloc = 21276.165009 ms
t_init = 5358.417034 ms
t_d2h = 290.521145 ms
t_end_2_end = 52729.280949 ms
Generating '/tmp/nsys-report-968a.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [14%                         ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [====27%                     ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [====28%                     ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=====29%                    ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=====31%                    ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=====32%                    ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [======33%                   ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [======34%                   ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [======35%                   ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=======36%                  ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=======37%                  ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=======38%                  ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=======39%                  ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [========40%                 ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [========41%                 ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [========42%                 ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=========43%                ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=========44%                ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=========45%                ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=========46%                ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [==========47%               ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [==========48%               ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [==========49%               ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [===========50%              ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [===========51%              ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [===========52%              ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [===========53%              ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [============54%             ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [============55%             ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [============56%             ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [============57%             ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=============58%            ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=============59%            ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [=============60%            ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [==============61%           ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [==============62%           ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_5_100.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_100.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [1%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [2%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [3%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [4%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [5%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [6%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [7%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [8%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [9%                          ] nsys_report_ia_10000_5_100.sqlite[2/7] [10%                         ] nsys_report_ia_10000_5_100.sqlite[2/7] [11%                         ] nsys_report_ia_10000_5_100.sqlite[2/7] [12%                         ] nsys_report_ia_10000_5_100.sqlite[2/7] [13%                         ] nsys_report_ia_10000_5_100.sqlite[2/7] [14%                         ] nsys_report_ia_10000_5_100.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_5_100.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_5_100.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_5_100.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_5_100.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_5_100.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_5_100.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_5_100.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_5_100.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_5_100.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_5_100.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_5_100.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_5_100.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_5_100.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_5_100.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_5_100.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_5_100.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_5_100.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_5_100.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_5_100.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_5_100.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_5_100.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_5_100.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_5_100.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_5_100.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_5_100.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_5_100.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_5_100.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_5_100.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_5_100.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_5_100.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_5_100.sqlite[2/7] [============54%             ] nsys_report_ia_10000_5_100.sqlite[2/7] [============55%             ] nsys_report_ia_10000_5_100.sqlite[2/7] [============56%             ] nsys_report_ia_10000_5_100.sqlite[2/7] [============57%             ] nsys_report_ia_10000_5_100.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_5_100.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_5_100.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_5_100.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_5_100.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_5_100.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_5_100.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_5_100.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_5_100.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_5_100.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_5_100.sqlite[2/7] [================68%         ] nsys_report_ia_10000_5_100.sqlite[2/7] [================69%         ] nsys_report_ia_10000_5_100.sqlite[2/7] [================70%         ] nsys_report_ia_10000_5_100.sqlite[2/7] [================71%         ] nsys_report_ia_10000_5_100.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_5_100.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_5_100.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_5_100.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_5_100.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_5_100.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_5_100.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_5_100.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_5_100.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_5_100.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_5_100.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_5_100.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_5_100.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_5_100.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_5_100.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_5_100.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_5_100.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_5_100.sqlite[2/7] [========================97% ] nsys_report_ia_10000_5_100.sqlite[2/7] [========================98% ] nsys_report_ia_10000_5_100.sqlite[2/7] [========================99% ] nsys_report_ia_10000_5_100.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_100.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        319235103          1  319235103.0  319235103.0  319235103  319235103          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     45.8      21276159585          1  21276159585.0  21276159585.0  21276159585  21276159585          0.0  cudaHostAlloc                     
     29.5      13707687491         60    228461458.2        13860.0         6570    790230104  338684768.4  cudaMemcpyAsync                   
     23.2      10805142387          1  10805142387.0  10805142387.0  10805142387  10805142387          0.0  cudaFreeHost                      
      0.5        225096220        100      2250962.2          310.0          280    225026518   22502581.4  cuKernelGetFunction               
      0.4        194491686          8     24311460.8       558856.0        29700    188972775   66538221.6  cudaFree                          
      0.3        158102060          2     79051030.0     79051030.0     54775733    103326327   34330454.2  cudaMemcpy                        
      0.3        119288625          1    119288625.0    119288625.0    119288625    119288625          0.0  cudaDeviceReset                   
      0.0          4452429         15       296828.6       306274.0       132011       494415     117781.4  cuLibraryLoadData                 
      0.0          1203443         22        54702.0         2890.0         2610      1140643     242548.6  cudaStreamSynchronize             
      0.0          1062402          7       151771.7       142402.0         4870       289423     105541.8  cudaMalloc                        
      0.0           943551         60        15725.9         7880.5         4250       290633      36818.8  cudaLaunchKernel                  
      0.0           861760        280         3077.7         2825.0          590        19230       1494.8  cudaEventRecord                   
      0.0           576218        100         5762.2         4435.5         3550        31011       3332.1  cuLaunchKernel                    
      0.0           239434        814          294.1          270.0          120         1500        140.2  cuGetProcAddress_v2               
      0.0           193052        240          804.4          580.0          470         9710        927.9  cudaEventCreate                   
      0.0           128981        260          496.1          360.0          330        15700       1050.5  cudaEventDestroy                  
      0.0            74912        100          749.1          375.0          280         3390        793.4  cudaStreamGetCaptureInfo_v2_v11030
      0.0            37741         20         1887.1          505.0          390        16730       4283.8  cudaEventCreateWithFlags          
      0.0            36020          2        18010.0        18010.0         1990        34030      22655.7  cudaStreamCreateWithFlags         
      0.0            31851          4         7962.8         2980.0         1370        24521      11082.7  cudaDeviceSynchronize             
      0.0            27270         20         1363.5         1105.0         1000         3350        594.6  cudaStreamWaitEvent               
      0.0            16550          2         8275.0         8275.0         4750        11800       4985.1  cudaStreamDestroy                 
      0.0            16380         16         1023.8          555.0          520         6240       1435.9  cuLibraryGetKernel                
      0.0             5600          1         5600.0         5600.0         5600         5600          0.0  cudaEventQuery                    
      0.0             4750          3         1583.3         1260.0          770         2720       1014.4  cuInit                            
      0.0             3350          3         1116.7          270.0          150         2930       1571.5  cuModuleGetLoadingMode            
      0.0             1300          1         1300.0         1300.0         1300         1300          0.0  cuCtxSynchronize                  
      0.0              920          2          460.0          460.0          310          610        212.1  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7      10770066037        100  107700660.4  108015369.0  104793102  109265991    1035222.5  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2         23019218         20    1150960.9    1151865.0    1140713    1154345       3118.2  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         12992998         40     324825.0     322195.0      12608     640228     315991.4  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     97.3       3758241940     41  91664437.6  54622615.0      1600  250642882   94842940.0  [CUDA memcpy Host-to-Device]
      2.7        103165316     21   4912634.1      1952.0      1952  103124642   22503198.0  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  80800.208     41  1970.737   800.000     0.010  4000.000     2008.756  [CUDA memcpy Host-to-Device]
    800.000     21    38.095     0.000     0.000   800.000      174.574  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 5 (num_steps = 100)
number of batches= 20
t_gemm = 11002.706886 ms
t_h2d = 3839.236561 ms
t_d2h = 156.220198 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.615835 ms
t_cpu_alloc = 20974.092007 ms
t_init = 5252.596140 ms
t_end_2_end = 47605.375051 ms
Generating '/tmp/nsys-report-6025.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=16%                        ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=====31%                    ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=====32%                    ] nsys_report_db_10000_5_100.nsys-rep[1/7] [======33%                   ] nsys_report_db_10000_5_100.nsys-rep[1/7] [======34%                   ] nsys_report_db_10000_5_100.nsys-rep[1/7] [======35%                   ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=======36%                  ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=======37%                  ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=======38%                  ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=======39%                  ] nsys_report_db_10000_5_100.nsys-rep[1/7] [========40%                 ] nsys_report_db_10000_5_100.nsys-rep[1/7] [========41%                 ] nsys_report_db_10000_5_100.nsys-rep[1/7] [========42%                 ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=========43%                ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=========44%                ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=========45%                ] nsys_report_db_10000_5_100.nsys-rep[1/7] [=========46%                ] nsys_report_db_10000_5_100.nsys-rep[1/7] [==========47%               ] nsys_report_db_10000_5_100.nsys-rep[1/7] [==========48%               ] nsys_report_db_10000_5_100.nsys-rep[1/7] [==========49%               ] nsys_report_db_10000_5_100.nsys-rep[1/7] [===========50%              ] nsys_report_db_10000_5_100.nsys-rep[1/7] [===========51%              ] nsys_report_db_10000_5_100.nsys-rep[1/7] [===========52%              ] nsys_report_db_10000_5_100.nsys-rep[1/7] [===========53%              ] nsys_report_db_10000_5_100.nsys-rep[1/7] [============54%             ] nsys_report_db_10000_5_100.nsys-rep[1/7] [============55%             ] nsys_report_db_10000_5_100.nsys-rep[1/7] [============56%             ] nsys_report_db_10000_5_100.nsys-rep[1/7] [============57%             ] nsys_report_db_10000_5_100.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_5_100.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_100.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [1%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [2%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [3%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [4%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [5%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [6%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [7%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [8%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [9%                          ] nsys_report_db_10000_5_100.sqlite[2/7] [10%                         ] nsys_report_db_10000_5_100.sqlite[2/7] [11%                         ] nsys_report_db_10000_5_100.sqlite[2/7] [12%                         ] nsys_report_db_10000_5_100.sqlite[2/7] [13%                         ] nsys_report_db_10000_5_100.sqlite[2/7] [14%                         ] nsys_report_db_10000_5_100.sqlite[2/7] [=15%                        ] nsys_report_db_10000_5_100.sqlite[2/7] [=16%                        ] nsys_report_db_10000_5_100.sqlite[2/7] [=17%                        ] nsys_report_db_10000_5_100.sqlite[2/7] [==18%                       ] nsys_report_db_10000_5_100.sqlite[2/7] [==19%                       ] nsys_report_db_10000_5_100.sqlite[2/7] [==20%                       ] nsys_report_db_10000_5_100.sqlite[2/7] [==21%                       ] nsys_report_db_10000_5_100.sqlite[2/7] [===22%                      ] nsys_report_db_10000_5_100.sqlite[2/7] [===23%                      ] nsys_report_db_10000_5_100.sqlite[2/7] [===24%                      ] nsys_report_db_10000_5_100.sqlite[2/7] [====25%                     ] nsys_report_db_10000_5_100.sqlite[2/7] [====26%                     ] nsys_report_db_10000_5_100.sqlite[2/7] [====27%                     ] nsys_report_db_10000_5_100.sqlite[2/7] [====28%                     ] nsys_report_db_10000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_5_100.sqlite[2/7] [======33%                   ] nsys_report_db_10000_5_100.sqlite[2/7] [======34%                   ] nsys_report_db_10000_5_100.sqlite[2/7] [======35%                   ] nsys_report_db_10000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_5_100.sqlite[2/7] [========40%                 ] nsys_report_db_10000_5_100.sqlite[2/7] [========41%                 ] nsys_report_db_10000_5_100.sqlite[2/7] [========42%                 ] nsys_report_db_10000_5_100.sqlite[2/7] [=========43%                ] nsys_report_db_10000_5_100.sqlite[2/7] [=========44%                ] nsys_report_db_10000_5_100.sqlite[2/7] [=========45%                ] nsys_report_db_10000_5_100.sqlite[2/7] [=========46%                ] nsys_report_db_10000_5_100.sqlite[2/7] [==========47%               ] nsys_report_db_10000_5_100.sqlite[2/7] [==========48%               ] nsys_report_db_10000_5_100.sqlite[2/7] [==========49%               ] nsys_report_db_10000_5_100.sqlite[2/7] [===========50%              ] nsys_report_db_10000_5_100.sqlite[2/7] [===========51%              ] nsys_report_db_10000_5_100.sqlite[2/7] [===========52%              ] nsys_report_db_10000_5_100.sqlite[2/7] [===========53%              ] nsys_report_db_10000_5_100.sqlite[2/7] [============54%             ] nsys_report_db_10000_5_100.sqlite[2/7] [============55%             ] nsys_report_db_10000_5_100.sqlite[2/7] [============56%             ] nsys_report_db_10000_5_100.sqlite[2/7] [============57%             ] nsys_report_db_10000_5_100.sqlite[2/7] [=============58%            ] nsys_report_db_10000_5_100.sqlite[2/7] [=============59%            ] nsys_report_db_10000_5_100.sqlite[2/7] [=============60%            ] nsys_report_db_10000_5_100.sqlite[2/7] [==============61%           ] nsys_report_db_10000_5_100.sqlite[2/7] [==============62%           ] nsys_report_db_10000_5_100.sqlite[2/7] [==============63%           ] nsys_report_db_10000_5_100.sqlite[2/7] [==============64%           ] nsys_report_db_10000_5_100.sqlite[2/7] [===============65%          ] nsys_report_db_10000_5_100.sqlite[2/7] [===============66%          ] nsys_report_db_10000_5_100.sqlite[2/7] [===============67%          ] nsys_report_db_10000_5_100.sqlite[2/7] [================68%         ] nsys_report_db_10000_5_100.sqlite[2/7] [================69%         ] nsys_report_db_10000_5_100.sqlite[2/7] [================70%         ] nsys_report_db_10000_5_100.sqlite[2/7] [================71%         ] nsys_report_db_10000_5_100.sqlite[2/7] [=================72%        ] nsys_report_db_10000_5_100.sqlite[2/7] [=================73%        ] nsys_report_db_10000_5_100.sqlite[2/7] [=================74%        ] nsys_report_db_10000_5_100.sqlite[2/7] [==================75%       ] nsys_report_db_10000_5_100.sqlite[2/7] [==================76%       ] nsys_report_db_10000_5_100.sqlite[2/7] [==================77%       ] nsys_report_db_10000_5_100.sqlite[2/7] [==================78%       ] nsys_report_db_10000_5_100.sqlite[2/7] [===================79%      ] nsys_report_db_10000_5_100.sqlite[2/7] [===================80%      ] nsys_report_db_10000_5_100.sqlite[2/7] [===================81%      ] nsys_report_db_10000_5_100.sqlite[2/7] [===================82%      ] nsys_report_db_10000_5_100.sqlite[2/7] [====================83%     ] nsys_report_db_10000_5_100.sqlite[2/7] [====================84%     ] nsys_report_db_10000_5_100.sqlite[2/7] [====================85%     ] nsys_report_db_10000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_5_100.sqlite[2/7] [======================90%   ] nsys_report_db_10000_5_100.sqlite[2/7] [======================91%   ] nsys_report_db_10000_5_100.sqlite[2/7] [======================92%   ] nsys_report_db_10000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_5_100.sqlite[2/7] [========================97% ] nsys_report_db_10000_5_100.sqlite[2/7] [========================98% ] nsys_report_db_10000_5_100.sqlite[2/7] [========================99% ] nsys_report_db_10000_5_100.sqlite[2/7] [========================100%] nsys_report_db_10000_5_100.sqlite[2/7] [========================100%] nsys_report_db_10000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        331226800          1  331226800.0  331226800.0  331226800  331226800          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     50.4      20974085992          1  20974085992.0  20974085992.0  20974085992  20974085992          0.0  cudaHostAlloc                     
     24.8      10330969715         60    172182828.6        13855.5         6390    548710718  255029640.7  cudaMemcpyAsync                   
     22.6       9418335683          1   9418335683.0   9418335683.0   9418335683   9418335683          0.0  cudaFreeHost                      
      0.9        391295083        100      3912950.8          310.0          280    391220903   39122015.4  cuKernelGetFunction               
      0.5        211791573          8     26473946.6       564971.5        29110    206266230   72651620.2  cudaFree                          
      0.3        130963927          2     65481963.5     65481963.5     53514810     77449117   16924110.8  cudaMemcpy                        
      0.3        123372492          1    123372492.0    123372492.0    123372492    123372492          0.0  cudaDeviceReset                   
      0.0          3906112         15       260407.5       272513.0       116241       421984     101853.9  cuLibraryLoadData                 
      0.0          1203034         22        54683.4         2940.0         2370      1140393     242497.0  cudaStreamSynchronize             
      0.0          1100132          7       157161.7       145311.0         4070       315284     114395.0  cudaMalloc                        
      0.0           881212         60        14686.9         7945.0         4270       255613      32296.1  cudaLaunchKernel                  
      0.0           811759        280         2899.1         2720.0          500        13130       1249.9  cudaEventRecord                   
      0.0           578171        100         5781.7         4350.0         3760        35400       3715.9  cuLaunchKernel                    
      0.0           288843        814          354.8          310.0          120         1340        179.6  cuGetProcAddress_v2               
      0.0           182152        240          759.0          530.0          490        11170        866.2  cudaEventCreate                   
      0.0           161002        260          619.2          460.0          330        21571       1381.4  cudaEventDestroy                  
      0.0            91250        100          912.5          335.0          290         7340       1210.1  cudaStreamGetCaptureInfo_v2_v11030
      0.0            43680         20         2184.0          495.0          400        13770       3966.4  cudaEventCreateWithFlags          
      0.0            43490         20         2174.5         2050.0         1700         3900        525.9  cudaStreamWaitEvent               
      0.0            39951          2        19975.5        19975.5         1950        38001      25491.9  cudaStreamCreateWithFlags         
      0.0            32621          4         8155.3         3215.0         1410        24781      11145.5  cudaDeviceSynchronize             
      0.0            19780          2         9890.0         9890.0         6520        13260       4765.9  cudaStreamDestroy                 
      0.0            11530         16          720.6          620.0          500         2060        376.8  cuLibraryGetKernel                
      0.0             5420          3         1806.7         1770.0          750         2900       1075.5  cuInit                            
      0.0             4960          1         4960.0         4960.0         4960         4960          0.0  cudaEventQuery                    
      0.0             3290          3         1096.7          270.0          150         2870       1536.9  cuModuleGetLoadingMode            
      0.0             1000          1         1000.0         1000.0         1000         1000          0.0  cuCtxSynchronize                  
      0.0              820          2          410.0          410.0          300          520        155.6  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7      10832975638        100  108329756.4  108443041.0  106092002  110226013     795529.5  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2         23009937         20    1150496.9    1152136.5    1140073    1154921       4092.6  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         12974822         40     324370.6     321522.5      12544     642918     315564.6  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     98.0       3838794967     41  93629145.5  53349044.0      1568  266424941   97628617.6  [CUDA memcpy Host-to-Device]
      2.0         77293333     21   3680634.9      1952.0      1920   77252658   16857468.2  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  80800.208     41  1970.737   800.000     0.010  4000.000     2008.756  [CUDA memcpy Host-to-Device]
    800.000     21    38.095     0.000     0.000   800.000      174.574  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 5 (num_steps = 100), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  33.68 GB
Used GPU Memory:  5.82 GB
------------------------

Process RSS:  77.51 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 0.920057 ms
t_alloc_cpu = 20917.589903 ms
t_init      = 5375.344038 ms
t_h2d       = 3886.377188 ms
t_d2h       = 156.690836 ms
t_gemm      = 11026.198471 ms
t_end_2_end = 48290.453911 ms
Generating '/tmp/nsys-report-a795.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [11%                         ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [==21%                       ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [===22%                      ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [===23%                      ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [===24%                      ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [====25%                     ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [====26%                     ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [========42%                 ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_10000_5_100.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_100.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [1%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [2%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [3%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [4%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [5%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [6%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [7%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [8%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [9%                          ] nsys_report_fo_10000_5_100.sqlite[2/7] [10%                         ] nsys_report_fo_10000_5_100.sqlite[2/7] [11%                         ] nsys_report_fo_10000_5_100.sqlite[2/7] [12%                         ] nsys_report_fo_10000_5_100.sqlite[2/7] [13%                         ] nsys_report_fo_10000_5_100.sqlite[2/7] [14%                         ] nsys_report_fo_10000_5_100.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_5_100.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_5_100.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_5_100.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_5_100.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_5_100.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_5_100.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_5_100.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_5_100.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_5_100.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_5_100.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_5_100.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_5_100.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_5_100.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_5_100.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_5_100.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_5_100.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_5_100.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_5_100.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_5_100.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_5_100.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_5_100.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_5_100.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_5_100.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_5_100.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_5_100.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_5_100.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_5_100.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_5_100.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_5_100.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_5_100.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_5_100.sqlite[2/7] [============54%             ] nsys_report_fo_10000_5_100.sqlite[2/7] [============55%             ] nsys_report_fo_10000_5_100.sqlite[2/7] [============56%             ] nsys_report_fo_10000_5_100.sqlite[2/7] [============57%             ] nsys_report_fo_10000_5_100.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_5_100.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_5_100.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_5_100.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_5_100.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_5_100.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_5_100.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_5_100.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_5_100.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_5_100.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_5_100.sqlite[2/7] [================68%         ] nsys_report_fo_10000_5_100.sqlite[2/7] [================69%         ] nsys_report_fo_10000_5_100.sqlite[2/7] [================70%         ] nsys_report_fo_10000_5_100.sqlite[2/7] [================71%         ] nsys_report_fo_10000_5_100.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_5_100.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_5_100.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_5_100.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_5_100.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_5_100.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_5_100.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_5_100.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_5_100.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_5_100.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_5_100.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_5_100.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_5_100.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_5_100.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_5_100.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_5_100.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_5_100.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_5_100.sqlite[2/7] [========================97% ] nsys_report_fo_10000_5_100.sqlite[2/7] [========================98% ] nsys_report_fo_10000_5_100.sqlite[2/7] [========================99% ] nsys_report_fo_10000_5_100.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_100.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        282532658          1  282532658.0  282532658.0  282532658  282532658          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.1      20917583665          1  20917583665.0  20917583665.0  20917583665  20917583665          0.0  cudaHostAlloc                     
     25.6      10907848476        300     36359494.9         9530.0         3970    111796883   51880394.8  cudaMemcpyAsync                   
     23.8      10116525025          1  10116525025.0  10116525025.0  10116525025  10116525025          0.0  cudaFreeHost                      
      0.5        212468853        100      2124688.5          570.0          400    212370121   21236912.4  cuKernelGetFunction               
      0.4        165679426         11     15061766.0       455385.0        32090    162003166   48735288.9  cudaFree                          
      0.3        131809287          2     65904643.5     65904643.5     53349888     78459399   17755105.5  cudaMemcpy                        
      0.3        122533414          1    122533414.0    122533414.0    122533414    122533414          0.0  cudaDeviceReset                   
      0.0          3914905         15       260993.7       276234.0       116551       430235     101317.1  cuLibraryLoadData                 
      0.0          2157014        300         7190.0         4880.0         4160       238953      13892.2  cudaLaunchKernel                  
      0.0          1570350        700         2243.4         2575.0          500        20460       1566.4  cudaEventRecord                   
      0.0          1402124        102        13746.3         2485.0         2110      1144603     113080.5  cudaStreamSynchronize             
      0.0          1092093         10       109209.3       115636.5         3980       155142      43356.3  cudaMalloc                        
      0.0           638044        100         6380.4         5890.0         4500        32510       2959.0  cuLaunchKernel                    
      0.0           299493        400          748.7          590.0          470        14611        945.5  cudaEventCreate                   
      0.0           250342        814          307.5          280.0          130         1340        145.6  cuGetProcAddress_v2               
      0.0           244193        500          488.4          310.0          280         6340        486.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0           189010        195          969.3          840.0          570         3790        465.3  cudaStreamWaitEvent               
      0.0            79751          1        79751.0        79751.0        79751        79751          0.0  cudaMemGetInfo                    
      0.0            50510         28         1803.9          500.0          390        12230       3303.5  cudaEventCreateWithFlags          
      0.0            38190          4         9547.5         3275.0         1550        30090      13728.3  cudaDeviceSynchronize             
      0.0            31910          2        15955.0        15955.0         1680        30230      20187.9  cudaStreamCreateWithFlags         
      0.0            24311         28          868.3          530.0          350         4971        983.2  cudaEventDestroy                  
      0.0            18100          2         9050.0         9050.0         4170        13930       6901.4  cudaStreamDestroy                 
      0.0            10370         16          648.1          540.0          510         1620        281.9  cuLibraryGetKernel                
      0.0             5290          3         1763.3         2130.0          560         2600       1068.3  cuInit                            
      0.0             5020          1         5020.0         5020.0         5020         5020          0.0  cudaEventQuery                    
      0.0             3360          3         1120.0          270.0          180         2910       1550.8  cuModuleGetLoadingMode            
      0.0             1460          1         1460.0         1460.0         1460         1460          0.0  cuCtxSynchronize                  
      0.0              900          2          450.0          450.0          310          590        198.0  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4      10835291035        100  108352910.4  108411441.0  105161152  110007829     647035.9  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0        115097321        100    1150973.2    1152153.5    1139594    1154921       3178.5  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         64821694        200     324108.5     321650.5      12576     642757     312082.8  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     98.0       3885421358    201  19330454.5  31847932.0      1567  54207813   20062085.5  [CUDA memcpy Host-to-Device]
      2.0         78455488    101    776787.0      1952.0      1920  78257565    7786721.8  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  80801.038    201   401.995   800.000     0.010   800.000      400.989  [CUDA memcpy Host-to-Device]
    800.001    101     7.921     0.000     0.000   800.000       79.603  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 5 (num_steps = 150)
number of batches= 30
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 16217.397148 ms
t_h2d = 5672.624405 ms
t_gpu_alloc = 0.880003 ms
t_cpu_alloc = 32593.748093 ms
t_init = 7997.578859 ms
t_d2h = 275.089979 ms
t_end_2_end = 79192.214012 ms
Generating '/tmp/nsys-report-8e1e.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [11%                         ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [===22%                      ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [===23%                      ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [===24%                      ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [====25%                     ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [====26%                     ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [====27%                     ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [====28%                     ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=====29%                    ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=====31%                    ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=====32%                    ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [======33%                   ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [======34%                   ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [======35%                   ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=======36%                  ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=======37%                  ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=======38%                  ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=======39%                  ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [========40%                 ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [========41%                 ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [========42%                 ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=========43%                ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=========44%                ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=========45%                ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=========46%                ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [==========47%               ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [==========48%               ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [==========49%               ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [===========50%              ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [===========51%              ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [===========52%              ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [===========53%              ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [============54%             ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [============55%             ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [============56%             ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [============57%             ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=============58%            ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=============59%            ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [=============60%            ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [==============61%           ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_5_150.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_150.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [1%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [2%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [3%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [4%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [5%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [6%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [7%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [8%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [9%                          ] nsys_report_ia_10000_5_150.sqlite[2/7] [10%                         ] nsys_report_ia_10000_5_150.sqlite[2/7] [11%                         ] nsys_report_ia_10000_5_150.sqlite[2/7] [12%                         ] nsys_report_ia_10000_5_150.sqlite[2/7] [13%                         ] nsys_report_ia_10000_5_150.sqlite[2/7] [14%                         ] nsys_report_ia_10000_5_150.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_5_150.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_5_150.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_5_150.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_5_150.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_5_150.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_5_150.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_5_150.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_5_150.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_5_150.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_5_150.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_5_150.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_5_150.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_5_150.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_5_150.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_5_150.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_5_150.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_5_150.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_5_150.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_5_150.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_5_150.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_5_150.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_5_150.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_5_150.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_5_150.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_5_150.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_5_150.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_5_150.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_5_150.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_5_150.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_5_150.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_5_150.sqlite[2/7] [============54%             ] nsys_report_ia_10000_5_150.sqlite[2/7] [============55%             ] nsys_report_ia_10000_5_150.sqlite[2/7] [============56%             ] nsys_report_ia_10000_5_150.sqlite[2/7] [============57%             ] nsys_report_ia_10000_5_150.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_5_150.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_5_150.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_5_150.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_5_150.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_5_150.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_5_150.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_5_150.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_5_150.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_5_150.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_5_150.sqlite[2/7] [================68%         ] nsys_report_ia_10000_5_150.sqlite[2/7] [================69%         ] nsys_report_ia_10000_5_150.sqlite[2/7] [================70%         ] nsys_report_ia_10000_5_150.sqlite[2/7] [================71%         ] nsys_report_ia_10000_5_150.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_5_150.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_5_150.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_5_150.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_5_150.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_5_150.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_5_150.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_5_150.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_5_150.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_5_150.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_5_150.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_5_150.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_5_150.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_5_150.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_5_150.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_5_150.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_5_150.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_5_150.sqlite[2/7] [========================97% ] nsys_report_ia_10000_5_150.sqlite[2/7] [========================98% ] nsys_report_ia_10000_5_150.sqlite[2/7] [========================99% ] nsys_report_ia_10000_5_150.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_150.sqlite[2/7] [========================100%] nsys_report_ia_10000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        303384385          1  303384385.0  303384385.0  303384385  303384385          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     46.3      32593743513          1  32593743513.0  32593743513.0  32593743513  32593743513          0.0  cudaHostAlloc                     
     30.0      21074190778         90    234157675.3        13980.0         6530    808441613  341862125.8  cudaMemcpyAsync                   
     22.7      15968331450          1  15968331450.0  15968331450.0  15968331450  15968331450          0.0  cudaFreeHost                      
      0.3        200901957        150      1339346.4          330.0          290    200794084   16394709.2  cuKernelGetFunction               
      0.3        184683702          8     23085462.8       571156.5        28650    179140530   63061031.7  cudaFree                          
      0.2        171816328          2     85908164.0     85908164.0     67954932    103861396   25389704.2  cudaMemcpy                        
      0.2        122282223          1    122282223.0    122282223.0    122282223    122282223          0.0  cudaDeviceReset                   
      0.0          4122607         15       274840.5       286374.0       120432       445955     107721.9  cuLibraryLoadData                 
      0.0          1516266        380         3990.2          370.0          330      1346765      69065.4  cudaEventDestroy                  
      0.0          1297054         90        14411.7         8375.0         4290       298483      31146.6  cudaLaunchKernel                  
      0.0          1265363        420         3012.8         2770.0          500        23131       1519.9  cudaEventRecord                   
      0.0          1237143         32        38660.7         2990.0         2630      1141833     201306.4  cudaStreamSynchronize             
      0.0          1056852          7       150978.9       139862.0         3870       293564     108097.8  cudaMalloc                        
      0.0           830456        150         5536.4         4370.0         3680        34520       3113.7  cuLaunchKernel                    
      0.0           544134        150         3627.6          350.0          290       423904      34557.2  cudaStreamGetCaptureInfo_v2_v11030
      0.0           267343        360          742.6          570.0          460        11510        802.9  cudaEventCreate                   
      0.0           253354        814          311.2          275.0          120         1160        157.6  cuGetProcAddress_v2               
      0.0            55981         20         2799.1          520.0          400        18180       5377.8  cudaEventCreateWithFlags          
      0.0            35431          4         8857.8         3445.0         1370        27171      12279.4  cudaDeviceSynchronize             
      0.0            35100         30         1170.0         1035.0          850         3290        487.8  cudaStreamWaitEvent               
      0.0            34481          2        17240.5        17240.5         1930        32551      21652.3  cudaStreamCreateWithFlags         
      0.0            19820          2         9910.0         9910.0         5490        14330       6250.8  cudaStreamDestroy                 
      0.0            11010         16          688.1          540.0          490         1810        375.7  cuLibraryGetKernel                
      0.0             6320          1         6320.0         6320.0         6320         6320          0.0  cudaEventQuery                    
      0.0             4920          3         1640.0         1850.0          660         2410        893.7  cuInit                            
      0.0             3490          3         1163.3          250.0          190         3050       1634.2  cuModuleGetLoadingMode            
      0.0             1111          1         1111.0         1111.0         1111         1111          0.0  cuCtxSynchronize                  
      0.0              800          2          400.0          400.0          300          500        141.4  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7      16216474832        150  108109832.2  108410509.0  104342156  113752781    1347390.2  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2         34535956         30    1151198.5    1151978.0    1141034    1154345       2829.3  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         19666171         60     327769.5     322658.5      12576     662053     317483.4  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     98.2       5669391287     61  92940840.8  65142980.0      1568  266991654   95715753.2  [CUDA memcpy Host-to-Device]
      1.8        103706151     31   3345359.7      1952.0      1920  103645761   18614966.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 120800.311     61  1980.333   800.000     0.010  4000.000     2005.888  [CUDA memcpy Host-to-Device]
    800.000     31    25.806     0.000     0.000   800.000      143.684  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_5_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 5 (num_steps = 150)
number of batches= 30
t_gemm = 16492.667320 ms
t_h2d = 5653.558594 ms
t_d2h = 155.744076 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.576973 ms
t_cpu_alloc = 30966.397047 ms
t_init = 7702.842951 ms
t_end_2_end = 71786.891937 ms
Generating '/tmp/nsys-report-fd54.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_5_150.nsys-rep[1/7] [11%                         ] nsys_report_db_10000_5_150.nsys-rep[1/7] [===22%                      ] nsys_report_db_10000_5_150.nsys-rep[1/7] [===23%                      ] nsys_report_db_10000_5_150.nsys-rep[1/7] [===24%                      ] nsys_report_db_10000_5_150.nsys-rep[1/7] [====25%                     ] nsys_report_db_10000_5_150.nsys-rep[1/7] [====26%                     ] nsys_report_db_10000_5_150.nsys-rep[1/7] [====27%                     ] nsys_report_db_10000_5_150.nsys-rep[1/7] [====28%                     ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=====29%                    ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=====31%                    ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=====32%                    ] nsys_report_db_10000_5_150.nsys-rep[1/7] [======33%                   ] nsys_report_db_10000_5_150.nsys-rep[1/7] [======34%                   ] nsys_report_db_10000_5_150.nsys-rep[1/7] [======35%                   ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=======36%                  ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=======37%                  ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=======38%                  ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=======39%                  ] nsys_report_db_10000_5_150.nsys-rep[1/7] [========40%                 ] nsys_report_db_10000_5_150.nsys-rep[1/7] [========41%                 ] nsys_report_db_10000_5_150.nsys-rep[1/7] [========42%                 ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=========43%                ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=========44%                ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=========45%                ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=========46%                ] nsys_report_db_10000_5_150.nsys-rep[1/7] [==========47%               ] nsys_report_db_10000_5_150.nsys-rep[1/7] [==========48%               ] nsys_report_db_10000_5_150.nsys-rep[1/7] [==========49%               ] nsys_report_db_10000_5_150.nsys-rep[1/7] [===========50%              ] nsys_report_db_10000_5_150.nsys-rep[1/7] [===========51%              ] nsys_report_db_10000_5_150.nsys-rep[1/7] [===========52%              ] nsys_report_db_10000_5_150.nsys-rep[1/7] [===========53%              ] nsys_report_db_10000_5_150.nsys-rep[1/7] [============54%             ] nsys_report_db_10000_5_150.nsys-rep[1/7] [============55%             ] nsys_report_db_10000_5_150.nsys-rep[1/7] [============56%             ] nsys_report_db_10000_5_150.nsys-rep[1/7] [============57%             ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=============58%            ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=============59%            ] nsys_report_db_10000_5_150.nsys-rep[1/7] [=============60%            ] nsys_report_db_10000_5_150.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_5_150.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_150.nsys-rep[1/7] [========================100%] nsys_report_db_10000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [1%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [2%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [3%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [4%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [5%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [6%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [7%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [8%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [9%                          ] nsys_report_db_10000_5_150.sqlite[2/7] [10%                         ] nsys_report_db_10000_5_150.sqlite[2/7] [11%                         ] nsys_report_db_10000_5_150.sqlite[2/7] [12%                         ] nsys_report_db_10000_5_150.sqlite[2/7] [13%                         ] nsys_report_db_10000_5_150.sqlite[2/7] [14%                         ] nsys_report_db_10000_5_150.sqlite[2/7] [=15%                        ] nsys_report_db_10000_5_150.sqlite[2/7] [=16%                        ] nsys_report_db_10000_5_150.sqlite[2/7] [=17%                        ] nsys_report_db_10000_5_150.sqlite[2/7] [==18%                       ] nsys_report_db_10000_5_150.sqlite[2/7] [==19%                       ] nsys_report_db_10000_5_150.sqlite[2/7] [==20%                       ] nsys_report_db_10000_5_150.sqlite[2/7] [==21%                       ] nsys_report_db_10000_5_150.sqlite[2/7] [===22%                      ] nsys_report_db_10000_5_150.sqlite[2/7] [===23%                      ] nsys_report_db_10000_5_150.sqlite[2/7] [===24%                      ] nsys_report_db_10000_5_150.sqlite[2/7] [====25%                     ] nsys_report_db_10000_5_150.sqlite[2/7] [====26%                     ] nsys_report_db_10000_5_150.sqlite[2/7] [====27%                     ] nsys_report_db_10000_5_150.sqlite[2/7] [====28%                     ] nsys_report_db_10000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_5_150.sqlite[2/7] [======33%                   ] nsys_report_db_10000_5_150.sqlite[2/7] [======34%                   ] nsys_report_db_10000_5_150.sqlite[2/7] [======35%                   ] nsys_report_db_10000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_5_150.sqlite[2/7] [========40%                 ] nsys_report_db_10000_5_150.sqlite[2/7] [========41%                 ] nsys_report_db_10000_5_150.sqlite[2/7] [========42%                 ] nsys_report_db_10000_5_150.sqlite[2/7] [=========43%                ] nsys_report_db_10000_5_150.sqlite[2/7] [=========44%                ] nsys_report_db_10000_5_150.sqlite[2/7] [=========45%                ] nsys_report_db_10000_5_150.sqlite[2/7] [=========46%                ] nsys_report_db_10000_5_150.sqlite[2/7] [==========47%               ] nsys_report_db_10000_5_150.sqlite[2/7] [==========48%               ] nsys_report_db_10000_5_150.sqlite[2/7] [==========49%               ] nsys_report_db_10000_5_150.sqlite[2/7] [===========50%              ] nsys_report_db_10000_5_150.sqlite[2/7] [===========51%              ] nsys_report_db_10000_5_150.sqlite[2/7] [===========52%              ] nsys_report_db_10000_5_150.sqlite[2/7] [===========53%              ] nsys_report_db_10000_5_150.sqlite[2/7] [============54%             ] nsys_report_db_10000_5_150.sqlite[2/7] [============55%             ] nsys_report_db_10000_5_150.sqlite[2/7] [============56%             ] nsys_report_db_10000_5_150.sqlite[2/7] [============57%             ] nsys_report_db_10000_5_150.sqlite[2/7] [=============58%            ] nsys_report_db_10000_5_150.sqlite[2/7] [=============59%            ] nsys_report_db_10000_5_150.sqlite[2/7] [=============60%            ] nsys_report_db_10000_5_150.sqlite[2/7] [==============61%           ] nsys_report_db_10000_5_150.sqlite[2/7] [==============62%           ] nsys_report_db_10000_5_150.sqlite[2/7] [==============63%           ] nsys_report_db_10000_5_150.sqlite[2/7] [==============64%           ] nsys_report_db_10000_5_150.sqlite[2/7] [===============65%          ] nsys_report_db_10000_5_150.sqlite[2/7] [===============66%          ] nsys_report_db_10000_5_150.sqlite[2/7] [===============67%          ] nsys_report_db_10000_5_150.sqlite[2/7] [================68%         ] nsys_report_db_10000_5_150.sqlite[2/7] [================69%         ] nsys_report_db_10000_5_150.sqlite[2/7] [================70%         ] nsys_report_db_10000_5_150.sqlite[2/7] [================71%         ] nsys_report_db_10000_5_150.sqlite[2/7] [=================72%        ] nsys_report_db_10000_5_150.sqlite[2/7] [=================73%        ] nsys_report_db_10000_5_150.sqlite[2/7] [=================74%        ] nsys_report_db_10000_5_150.sqlite[2/7] [==================75%       ] nsys_report_db_10000_5_150.sqlite[2/7] [==================76%       ] nsys_report_db_10000_5_150.sqlite[2/7] [==================77%       ] nsys_report_db_10000_5_150.sqlite[2/7] [==================78%       ] nsys_report_db_10000_5_150.sqlite[2/7] [===================79%      ] nsys_report_db_10000_5_150.sqlite[2/7] [===================80%      ] nsys_report_db_10000_5_150.sqlite[2/7] [===================81%      ] nsys_report_db_10000_5_150.sqlite[2/7] [===================82%      ] nsys_report_db_10000_5_150.sqlite[2/7] [====================83%     ] nsys_report_db_10000_5_150.sqlite[2/7] [====================84%     ] nsys_report_db_10000_5_150.sqlite[2/7] [====================85%     ] nsys_report_db_10000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_5_150.sqlite[2/7] [======================90%   ] nsys_report_db_10000_5_150.sqlite[2/7] [======================91%   ] nsys_report_db_10000_5_150.sqlite[2/7] [======================92%   ] nsys_report_db_10000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_5_150.sqlite[2/7] [========================97% ] nsys_report_db_10000_5_150.sqlite[2/7] [========================98% ] nsys_report_db_10000_5_150.sqlite[2/7] [========================99% ] nsys_report_db_10000_5_150.sqlite[2/7] [========================100%] nsys_report_db_10000_5_150.sqlite[2/7] [========================100%] nsys_report_db_10000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        355524947          1  355524947.0  355524947.0  355524947  355524947          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     48.9      30966377110          1  30966377110.0  30966377110.0  30966377110  30966377110          0.0  cudaHostAlloc                     
     25.0      15839702138         90    175996690.4        14100.0         6410    551313725  256655686.6  cudaMemcpyAsync                   
     24.7      15632343464          1  15632343464.0  15632343464.0  15632343464  15632343464          0.0  cudaFreeHost                      
      0.6        385590321        150      2570602.1          320.0          290    385483580   31474544.0  cuKernelGetFunction               
      0.4        239045436          8     29880679.5       558356.0        27151    233552566   82299947.7  cudaFree                          
      0.2        131829727          2     65914863.5     65914863.5     54030525     77799202   16806992.7  cudaMemcpy                        
      0.2        120260471          1    120260471.0    120260471.0    120260471    120260471          0.0  cudaDeviceReset                   
      0.0          3937532         15       262502.1       274853.0       118081       430504     103017.5  cuLibraryLoadData                 
      0.0          1236285         90        13736.5         8920.0         4240       256203      26569.0  cudaLaunchKernel                  
      0.0          1235193         32        38599.8         2820.0         2200      1144122     201735.4  cudaStreamSynchronize             
      0.0          1211308        420         2884.1         2730.0          520        17261       1206.1  cudaEventRecord                   
      0.0          1076011          7       153715.9       128751.0         4190       303653     107084.9  cudaMalloc                        
      0.0           807516        150         5383.4         4280.0         3690        29180       2768.9  cuLaunchKernel                    
      0.0           260983        814          320.6          280.0          110         8190        310.9  cuGetProcAddress_v2               
      0.0           258922        360          719.2          565.0          470        10430        702.4  cudaEventCreate                   
      0.0           224502        380          590.8          470.0          330        18730       1007.8  cudaEventDestroy                  
      0.0           126600        150          844.0          335.0          290         3470       1007.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0            61930         30         2064.3         1920.0         1600         3680        458.3  cudaStreamWaitEvent               
      0.0            48491         20         2424.6          490.0          390        17271       4657.1  cudaEventCreateWithFlags          
      0.0            36331          2        18165.5        18165.5         1890        34441      23017.0  cudaStreamCreateWithFlags         
      0.0            33090          4         8272.5         3345.0         1230        25170      11334.8  cudaDeviceSynchronize             
      0.0            17640          2         8820.0         8820.0         4170        13470       6576.1  cudaStreamDestroy                 
      0.0            16040         16         1002.5          600.0          490         5870       1345.2  cuLibraryGetKernel                
      0.0             5330          1         5330.0         5330.0         5330         5330          0.0  cudaEventQuery                    
      0.0             5090          3         1696.7         1910.0          610         2570        997.3  cuInit                            
      0.0             3630          3         1210.0          610.0          170         2850       1437.2  cuModuleGetLoadingMode            
      0.0             1210          1         1210.0         1210.0         1210         1210          0.0  cuCtxSynchronize                  
      0.0             1070          2          535.0          535.0          300          770        332.3  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.7      16322800712        150  108818671.4  108886659.0  105755886  110977552     971879.9  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.2         34537446         30    1151248.2    1152408.5    1141737    1155401       3173.5  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         19652280         60     327538.0     322658.5      12577     657509     317196.7  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ----------------------------
     98.6       5653012311     61  92672333.0  53879294.0      1600  257991113   95730546.4  [CUDA memcpy Host-to-Device]
      1.4         77656043     31   2505033.6      1952.0      1952   77595623   13936223.6  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 120800.311     61  1980.333   800.000     0.010  4000.000     2005.888  [CUDA memcpy Host-to-Device]
    800.000     31    25.806     0.000     0.000   800.000      143.684  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_5_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 5 (num_steps = 150), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  33.60 GB
Used GPU Memory:  5.89 GB
------------------------

Process RSS:  114.76 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 0.904799 ms
t_alloc_cpu = 31068.542004 ms
t_init      = 7908.303976 ms
t_h2d       = 5867.115240 ms
t_d2h       = 156.244040 ms
t_gemm      = 16441.157295 ms
t_end_2_end = 70839.329004 ms
Generating '/tmp/nsys-report-728f.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [8%                          ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=16%                        ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=17%                        ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [==18%                       ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [==19%                       ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [==20%                       ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [==21%                       ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [===22%                      ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [===23%                      ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [===24%                      ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [====25%                     ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [====26%                     ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [=======================93%  ] nsys_report_fo_10000_5_150.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_150.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [1%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [2%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [3%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [4%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [5%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [6%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [7%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [8%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [9%                          ] nsys_report_fo_10000_5_150.sqlite[2/7] [10%                         ] nsys_report_fo_10000_5_150.sqlite[2/7] [11%                         ] nsys_report_fo_10000_5_150.sqlite[2/7] [12%                         ] nsys_report_fo_10000_5_150.sqlite[2/7] [13%                         ] nsys_report_fo_10000_5_150.sqlite[2/7] [14%                         ] nsys_report_fo_10000_5_150.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_5_150.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_5_150.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_5_150.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_5_150.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_5_150.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_5_150.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_5_150.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_5_150.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_5_150.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_5_150.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_5_150.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_5_150.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_5_150.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_5_150.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_5_150.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_5_150.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_5_150.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_5_150.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_5_150.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_5_150.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_5_150.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_5_150.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_5_150.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_5_150.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_5_150.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_5_150.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_5_150.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_5_150.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_5_150.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_5_150.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_5_150.sqlite[2/7] [============54%             ] nsys_report_fo_10000_5_150.sqlite[2/7] [============55%             ] nsys_report_fo_10000_5_150.sqlite[2/7] [============56%             ] nsys_report_fo_10000_5_150.sqlite[2/7] [============57%             ] nsys_report_fo_10000_5_150.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_5_150.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_5_150.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_5_150.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_5_150.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_5_150.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_5_150.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_5_150.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_5_150.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_5_150.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_5_150.sqlite[2/7] [================68%         ] nsys_report_fo_10000_5_150.sqlite[2/7] [================69%         ] nsys_report_fo_10000_5_150.sqlite[2/7] [================70%         ] nsys_report_fo_10000_5_150.sqlite[2/7] [================71%         ] nsys_report_fo_10000_5_150.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_5_150.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_5_150.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_5_150.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_5_150.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_5_150.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_5_150.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_5_150.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_5_150.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_5_150.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_5_150.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_5_150.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_5_150.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_5_150.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_5_150.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_5_150.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_5_150.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_5_150.sqlite[2/7] [========================97% ] nsys_report_fo_10000_5_150.sqlite[2/7] [========================98% ] nsys_report_fo_10000_5_150.sqlite[2/7] [========================99% ] nsys_report_fo_10000_5_150.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_150.sqlite[2/7] [========================100%] nsys_report_fo_10000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        303392299          1  303392299.0  303392299.0  303392299  303392299          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.6      31068539309          1  31068539309.0  31068539309.0  31068539309  31068539309          0.0  cudaHostAlloc                     
     26.3      16456392348        450     36569760.8         9770.0         3720    112099278   52022867.7  cudaMemcpyAsync                   
     23.1      14449324975          1  14449324975.0  14449324975.0  14449324975  14449324975          0.0  cudaFreeHost                      
      0.3        184383843         11     16762167.5       457095.0        30360    180692326   54369793.6  cudaFree                          
      0.3        169477856        150      1129852.4          585.0          390    169294794   13822761.8  cuKernelGetFunction               
      0.2        130767122          2     65383561.0     65383561.0     53141785     77625337   17312485.6  cudaMemcpy                        
      0.2        121864855          1    121864855.0    121864855.0    121864855    121864855          0.0  cudaDeviceReset                   
      0.0          3930317         15       262021.1       274073.0       118521       421434     101462.2  cuLibraryLoadData                 
      0.0          3539849        450         7866.3         4920.0         4130       246052      12028.6  cudaLaunchKernel                  
      0.0          2453502       1050         2336.7         2680.0          510        20630       1527.3  cudaEventRecord                   
      0.0          1548613        152        10188.2         2570.0         2120      1145102      92664.5  cudaStreamSynchronize             
      0.0          1071050         10       107105.0       115246.0         4250       144542      42067.3  cudaMalloc                        
      0.0          1039191        150         6927.9         5965.0         4540        33130       2724.8  cuLaunchKernel                    
      0.0           426154        750          568.2          310.0          280         4820        602.7  cudaStreamGetCaptureInfo_v2_v11030
      0.0           410574        600          684.3          580.0          460         9260        526.2  cudaEventCreate                   
      0.0           315967        295         1071.1          920.0          580         3381        463.4  cudaStreamWaitEvent               
      0.0           263713        814          324.0          290.0          120         1070        152.7  cuGetProcAddress_v2               
      0.0            76711          1        76711.0        76711.0        76711        76711          0.0  cudaMemGetInfo                    
      0.0            54842         28         1958.6          455.0          390        18661       4391.4  cudaEventCreateWithFlags          
      0.0            35860          2        17930.0        17930.0         2080        33780      22415.3  cudaStreamCreateWithFlags         
      0.0            35250          4         8812.5         3390.0         1470        27000      12184.0  cudaDeviceSynchronize             
      0.0            22930         28          818.9          560.0          330         4500        925.1  cudaEventDestroy                  
      0.0            20121          2        10060.5        10060.5         6130        13991       5558.6  cudaStreamDestroy                 
      0.0            17450         16         1090.6          635.0          520         6880       1570.4  cuLibraryGetKernel                
      0.0             5380          1         5380.0         5380.0         5380         5380          0.0  cudaEventQuery                    
      0.0             5130          3         1710.0         2160.0          780         2190        805.5  cuInit                            
      0.0             3780          3         1260.0          280.0          170         3330       1793.5  cuModuleGetLoadingMode            
      0.0             1120          1         1120.0         1120.0         1120         1120          0.0  cuCtxSynchronize                  
      0.0              920          2          460.0          460.0          320          600        198.0  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4      16295084138        150  108633894.3  108573945.0  104877160  110336999     943742.9  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0        172679384        150    1151195.9    1152263.0    1139879    1155464       2876.3  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         97316964        300     324389.9     321202.0      12544     643300     312079.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     98.7       5865590000    301  19487010.0  31916843.0      1568  54483103   20326317.9  [CUDA memcpy Host-to-Device]
      1.3         77718365    151    514691.2      1952.0      1920  77421536    6300314.2  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 120801.556    301   401.334   800.000     0.010   800.000      400.659  [CUDA memcpy Host-to-Device]
    800.001    151     5.298     0.000     0.000   800.000       65.103  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_5_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 10 (num_steps = 20)
number of batches= 2
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 2158.750175 ms
t_h2d = 804.975735 ms
t_gpu_alloc = 1.213789 ms
t_cpu_alloc = 4426.771164 ms
t_init = 1158.886909 ms
t_d2h = 156.308889 ms
t_end_2_end = 11281.110048 ms
Generating '/tmp/nsys-report-609e.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [=====29%                    ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [============57%             ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [=============58%            ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [=============59%            ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [=============60%            ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [==============61%           ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [==============62%           ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [==============63%           ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_10_20.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_20.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [1%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [2%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [3%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [4%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [5%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [6%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [7%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [8%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [9%                          ] nsys_report_ia_10000_10_20.sqlite[2/7] [10%                         ] nsys_report_ia_10000_10_20.sqlite[2/7] [11%                         ] nsys_report_ia_10000_10_20.sqlite[2/7] [12%                         ] nsys_report_ia_10000_10_20.sqlite[2/7] [13%                         ] nsys_report_ia_10000_10_20.sqlite[2/7] [14%                         ] nsys_report_ia_10000_10_20.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_10_20.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_10_20.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_10_20.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_10_20.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_10_20.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_10_20.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_10_20.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_10_20.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_10_20.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_10_20.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_10_20.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_10_20.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_10_20.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_10_20.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_10_20.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_10_20.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_10_20.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_10_20.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_10_20.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_10_20.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_10_20.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_10_20.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_10_20.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_10_20.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_10_20.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_10_20.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_10_20.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_10_20.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_10_20.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_10_20.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_10_20.sqlite[2/7] [============54%             ] nsys_report_ia_10000_10_20.sqlite[2/7] [============55%             ] nsys_report_ia_10000_10_20.sqlite[2/7] [============56%             ] nsys_report_ia_10000_10_20.sqlite[2/7] [============57%             ] nsys_report_ia_10000_10_20.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_10_20.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_10_20.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_10_20.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_10_20.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_10_20.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_10_20.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_10_20.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_10_20.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_10_20.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_10_20.sqlite[2/7] [================68%         ] nsys_report_ia_10000_10_20.sqlite[2/7] [================69%         ] nsys_report_ia_10000_10_20.sqlite[2/7] [================70%         ] nsys_report_ia_10000_10_20.sqlite[2/7] [================71%         ] nsys_report_ia_10000_10_20.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_10_20.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_10_20.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_10_20.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_10_20.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_10_20.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_10_20.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_10_20.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_10_20.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_10_20.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_10_20.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_10_20.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_10_20.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_10_20.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_10_20.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_10_20.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_10_20.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_10_20.sqlite[2/7] [========================97% ] nsys_report_ia_10000_10_20.sqlite[2/7] [========================98% ] nsys_report_ia_10000_10_20.sqlite[2/7] [========================99% ] nsys_report_ia_10000_10_20.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_20.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        279934486          1  279934486.0  279934486.0  279934486  279934486          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     50.2       4426763184          1  4426763184.0  4426763184.0  4426763184  4426763184          0.0  cudaHostAlloc                     
     24.4       2154412263          1  2154412263.0  2154412263.0  2154412263  2154412263          0.0  cudaFreeHost                      
     16.1       1420014519          6   236669086.5       18005.0        6440  1419288352  579362811.9  cudaMemcpyAsync                   
      4.5        395037194         20    19751859.7         290.0         280   395029264   88331135.4  cuKernelGetFunction               
      2.0        173481063          8    21685132.9     2337408.5       54720   158816376   55449431.1  cudaFree                          
      1.5        131490222          2    65745111.0    65745111.0    53708136    77782086   17022853.3  cudaMemcpy                        
      1.3        116671526          1   116671526.0   116671526.0   116671526   116671526          0.0  cudaDeviceReset                   
      0.0          4169424         15      277961.6      289723.0      125382      459065     109670.0  cuLibraryLoadData                 
      0.0          1384054          7      197722.0      139761.0        4730      475565     184703.5  cudaMalloc                        
      0.0          1150921          4      287730.3        3685.0        3050     1140501     568514.1  cudaStreamSynchronize             
      0.0           327423          6       54570.5       12270.0        4680      271783     106673.7  cudaLaunchKernel                  
      0.0           251291        814         308.7         280.0         120        1140        138.8  cuGetProcAddress_v2               
      0.0           149562         48        3115.9        2560.0         670       17910       2548.2  cudaEventRecord                   
      0.0           112051         20        5602.6        4195.0        3550       29020       5582.6  cuLaunchKernel                    
      0.0            59531         64         930.2         490.0         350       17990       2381.2  cudaEventDestroy                  
      0.0            43391          2       21695.5       21695.5        2010       41381      27839.5  cudaStreamCreateWithFlags         
      0.0            41941         44         953.2         615.0         490       11300       1645.4  cudaEventCreate                   
      0.0            36570          4        9142.5        3150.0        1410       28860      13191.5  cudaDeviceSynchronize             
      0.0            35881         20        1794.1         520.0         400       13691       3907.8  cudaEventCreateWithFlags          
      0.0            17910          2        8955.0        8955.0        5020       12890       5564.9  cudaStreamDestroy                 
      0.0            16930         16        1058.1         550.0         510        6640       1517.9  cuLibraryGetKernel                
      0.0             9260         10         926.0         410.0         300        3300       1143.2  cudaStreamGetCaptureInfo_v2_v11030
      0.0             5860          2        2930.0        2930.0        2200        3660       1032.4  cudaStreamWaitEvent               
      0.0             5490          1        5490.0        5490.0        5490        5490          0.0  cudaEventQuery                    
      0.0             4290          3        1430.0        1260.0         820        2210        710.4  cuInit                            
      0.0             4090          3        1363.3         460.0         270        3360       1731.8  cuModuleGetLoadingMode            
      0.0             1200          1        1200.0        1200.0        1200        1200          0.0  cuCtxSynchronize                  
      0.0              900          2         450.0         450.0         310         590        198.0  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8       2158286932         20  107914346.6  108054796.5  105567576  109309176     975035.7  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          2293520          2    1146760.0    1146760.0    1140168    1153352       9322.5  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          1337193          4     334298.3     333490.5      16448     653764     366840.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     91.2        804599918      5  160919983.6  53412306.0      1600  413694789  199009592.3  [CUDA memcpy Host-to-Device]
      8.8         77603485      3   25867828.3      3488.0      1953   77598044   44799680.9  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  16800.021      5  3360.004   800.000     0.010  8000.000     4248.290  [CUDA memcpy Host-to-Device]
    800.000      3   266.667     0.000     0.000   800.000      461.880  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 10 (num_steps = 20)
number of batches= 2
t_gemm = 2497.961456 ms
t_h2d = 798.908285 ms
t_d2h = 156.703949 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.950813 ms
t_cpu_alloc = 4409.296036 ms
t_init = 1162.980080 ms
t_end_2_end = 11217.015028 ms
Generating '/tmp/nsys-report-3058.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_10_20.nsys-rep[1/7] [======34%                   ] nsys_report_db_10000_10_20.nsys-rep[1/7] [==============62%           ] nsys_report_db_10000_10_20.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_10_20.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_10_20.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_10_20.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_10_20.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_10_20.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_10_20.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_10_20.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_10_20.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_10_20.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_20.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [1%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [2%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [3%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [4%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [5%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [6%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [7%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [8%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [9%                          ] nsys_report_db_10000_10_20.sqlite[2/7] [10%                         ] nsys_report_db_10000_10_20.sqlite[2/7] [11%                         ] nsys_report_db_10000_10_20.sqlite[2/7] [12%                         ] nsys_report_db_10000_10_20.sqlite[2/7] [13%                         ] nsys_report_db_10000_10_20.sqlite[2/7] [14%                         ] nsys_report_db_10000_10_20.sqlite[2/7] [=15%                        ] nsys_report_db_10000_10_20.sqlite[2/7] [=16%                        ] nsys_report_db_10000_10_20.sqlite[2/7] [=17%                        ] nsys_report_db_10000_10_20.sqlite[2/7] [==18%                       ] nsys_report_db_10000_10_20.sqlite[2/7] [==19%                       ] nsys_report_db_10000_10_20.sqlite[2/7] [==20%                       ] nsys_report_db_10000_10_20.sqlite[2/7] [==21%                       ] nsys_report_db_10000_10_20.sqlite[2/7] [===22%                      ] nsys_report_db_10000_10_20.sqlite[2/7] [===23%                      ] nsys_report_db_10000_10_20.sqlite[2/7] [===24%                      ] nsys_report_db_10000_10_20.sqlite[2/7] [====25%                     ] nsys_report_db_10000_10_20.sqlite[2/7] [====26%                     ] nsys_report_db_10000_10_20.sqlite[2/7] [====27%                     ] nsys_report_db_10000_10_20.sqlite[2/7] [====28%                     ] nsys_report_db_10000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_10_20.sqlite[2/7] [======33%                   ] nsys_report_db_10000_10_20.sqlite[2/7] [======34%                   ] nsys_report_db_10000_10_20.sqlite[2/7] [======35%                   ] nsys_report_db_10000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_10_20.sqlite[2/7] [========40%                 ] nsys_report_db_10000_10_20.sqlite[2/7] [========41%                 ] nsys_report_db_10000_10_20.sqlite[2/7] [========42%                 ] nsys_report_db_10000_10_20.sqlite[2/7] [=========43%                ] nsys_report_db_10000_10_20.sqlite[2/7] [=========44%                ] nsys_report_db_10000_10_20.sqlite[2/7] [=========45%                ] nsys_report_db_10000_10_20.sqlite[2/7] [=========46%                ] nsys_report_db_10000_10_20.sqlite[2/7] [==========47%               ] nsys_report_db_10000_10_20.sqlite[2/7] [==========48%               ] nsys_report_db_10000_10_20.sqlite[2/7] [==========49%               ] nsys_report_db_10000_10_20.sqlite[2/7] [===========50%              ] nsys_report_db_10000_10_20.sqlite[2/7] [===========51%              ] nsys_report_db_10000_10_20.sqlite[2/7] [===========52%              ] nsys_report_db_10000_10_20.sqlite[2/7] [===========53%              ] nsys_report_db_10000_10_20.sqlite[2/7] [============54%             ] nsys_report_db_10000_10_20.sqlite[2/7] [============55%             ] nsys_report_db_10000_10_20.sqlite[2/7] [============56%             ] nsys_report_db_10000_10_20.sqlite[2/7] [============57%             ] nsys_report_db_10000_10_20.sqlite[2/7] [=============58%            ] nsys_report_db_10000_10_20.sqlite[2/7] [=============59%            ] nsys_report_db_10000_10_20.sqlite[2/7] [=============60%            ] nsys_report_db_10000_10_20.sqlite[2/7] [==============61%           ] nsys_report_db_10000_10_20.sqlite[2/7] [==============62%           ] nsys_report_db_10000_10_20.sqlite[2/7] [==============63%           ] nsys_report_db_10000_10_20.sqlite[2/7] [==============64%           ] nsys_report_db_10000_10_20.sqlite[2/7] [===============65%          ] nsys_report_db_10000_10_20.sqlite[2/7] [===============66%          ] nsys_report_db_10000_10_20.sqlite[2/7] [===============67%          ] nsys_report_db_10000_10_20.sqlite[2/7] [================68%         ] nsys_report_db_10000_10_20.sqlite[2/7] [================69%         ] nsys_report_db_10000_10_20.sqlite[2/7] [================70%         ] nsys_report_db_10000_10_20.sqlite[2/7] [================71%         ] nsys_report_db_10000_10_20.sqlite[2/7] [=================72%        ] nsys_report_db_10000_10_20.sqlite[2/7] [=================73%        ] nsys_report_db_10000_10_20.sqlite[2/7] [=================74%        ] nsys_report_db_10000_10_20.sqlite[2/7] [==================75%       ] nsys_report_db_10000_10_20.sqlite[2/7] [==================76%       ] nsys_report_db_10000_10_20.sqlite[2/7] [==================77%       ] nsys_report_db_10000_10_20.sqlite[2/7] [==================78%       ] nsys_report_db_10000_10_20.sqlite[2/7] [===================79%      ] nsys_report_db_10000_10_20.sqlite[2/7] [===================80%      ] nsys_report_db_10000_10_20.sqlite[2/7] [===================81%      ] nsys_report_db_10000_10_20.sqlite[2/7] [===================82%      ] nsys_report_db_10000_10_20.sqlite[2/7] [====================83%     ] nsys_report_db_10000_10_20.sqlite[2/7] [====================84%     ] nsys_report_db_10000_10_20.sqlite[2/7] [====================85%     ] nsys_report_db_10000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_10_20.sqlite[2/7] [======================90%   ] nsys_report_db_10000_10_20.sqlite[2/7] [======================91%   ] nsys_report_db_10000_10_20.sqlite[2/7] [======================92%   ] nsys_report_db_10000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_10_20.sqlite[2/7] [========================97% ] nsys_report_db_10000_10_20.sqlite[2/7] [========================98% ] nsys_report_db_10000_10_20.sqlite[2/7] [========================99% ] nsys_report_db_10000_10_20.sqlite[2/7] [========================100%] nsys_report_db_10000_10_20.sqlite[2/7] [========================100%] nsys_report_db_10000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        300388869          1  300388869.0  300388869.0  300388869  300388869          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     50.3       4409291025          1  4409291025.0  4409291025.0  4409291025  4409291025          0.0  cudaHostAlloc                     
     24.2       2119801253          1  2119801253.0  2119801253.0  2119801253  2119801253          0.0  cudaFreeHost                      
     12.4       1086553861          6   181092310.2       20455.0        6510  1085813175  443220973.9  cudaMemcpyAsync                   
      8.3        726335655         20    36316782.8         290.0         270   726326605  162411459.8  cuKernelGetFunction               
      2.3        204111756          8    25513969.5     2327483.5       55681   187901842   65659518.7  cudaFree                          
      1.5        132211534          2    66105767.0    66105767.0    54037951    78173583   17066469.1  cudaMemcpy                        
      0.9         80607697          1    80607697.0    80607697.0    80607697    80607697          0.0  cudaDeviceReset                   
      0.0          4092892         15      272859.5      283623.0      121751      444334     106717.0  cuLibraryLoadData                 
      0.0          1418183          7      202597.6      124142.0        3860      479264     192315.5  cudaMalloc                        
      0.0          1151991          4      287997.8        4415.0        2310     1140851     568569.8  cudaStreamSynchronize             
      0.0           335235          6       55872.5       15725.5        4531      267133     104048.9  cudaLaunchKernel                  
      0.0           267045        814         328.1         300.0         120        1210        163.7  cuGetProcAddress_v2               
      0.0           147472         48        3072.3        2420.5         520       22040       3154.1  cudaEventRecord                   
      0.0           120900         20        6045.0        4260.0        3690       33970       6699.9  cuLaunchKernel                    
      0.0            68860         64        1075.9         490.0         360       20830       2776.4  cudaEventDestroy                  
      0.0            63030          4       15757.5       16080.0        1420       29450      13968.3  cudaDeviceSynchronize             
      0.0            45382         20        2269.1         465.0         380       20761       5267.5  cudaEventCreateWithFlags          
      0.0            36470         44         828.9         600.0         470        4080        743.9  cudaEventCreate                   
      0.0            33700          2       16850.0       16850.0        9680       24020      10139.9  cudaStreamDestroy                 
      0.0            33651          2       16825.5       16825.5        2730       30921      19934.0  cudaStreamCreateWithFlags         
      0.0            16350         16        1021.9         605.0         490        6390       1448.0  cuLibraryGetKernel                
      0.0            10340         10        1034.0         410.0         300        3690       1373.1  cudaStreamGetCaptureInfo_v2_v11030
      0.0             7480          2        3740.0        3740.0        3470        4010        381.8  cudaStreamWaitEvent               
      0.0             5560          1        5560.0        5560.0        5560        5560          0.0  cudaEventQuery                    
      0.0             4180          3        1393.3        1610.0         530        2040        778.0  cuInit                            
      0.0             3490          3        1163.3         270.0         250        2970       1564.7  cuModuleGetLoadingMode            
      0.0             2480          1        2480.0        2480.0        2480        2480          0.0  cuCtxSynchronize                  
      0.0              930          2         465.0         465.0         290         640        247.5  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8       2159936429         20  107996821.5  108008429.0  106272387  109191028     770754.4  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          2280912          2    1140456.0    1140456.0    1140392    1140520         90.5  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          1348394          4     337098.5     335218.5      16640     661317     370046.3  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     91.1        798670114      5  159734022.8  53879600.0      1600  407366473  196931756.4  [CUDA memcpy Host-to-Device]
      8.9         77992701      3   25997567.0      3712.0      1952   77987037   45024201.8  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  16800.021      5  3360.004   800.000     0.010  8000.000     4248.290  [CUDA memcpy Host-to-Device]
    800.000      3   266.667     0.000     0.000   800.000      461.880  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 10 (num_steps = 20), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  30.06 GB
Used GPU Memory:  9.43 GB
------------------------

Process RSS:  17.91 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 1.553059 ms
t_alloc_cpu = 4435.372829 ms
t_init      = 1271.888971 ms
t_h2d       = 850.139065 ms
t_d2h       = 156.158924 ms
t_gemm      = 2560.942146 ms
t_end_2_end = 11121.002197 ms
Generating '/tmp/nsys-report-e3c0.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [===24%                      ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [==========47%               ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [==========48%               ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [==========49%               ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [===========50%              ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [===========51%              ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [===========52%              ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [===========53%              ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [============54%             ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [============55%             ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [=======================96%  ] nsys_report_fo_10000_10_20.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_20.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [1%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [2%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [3%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [4%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [5%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [6%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [7%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [8%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [9%                          ] nsys_report_fo_10000_10_20.sqlite[2/7] [10%                         ] nsys_report_fo_10000_10_20.sqlite[2/7] [11%                         ] nsys_report_fo_10000_10_20.sqlite[2/7] [12%                         ] nsys_report_fo_10000_10_20.sqlite[2/7] [13%                         ] nsys_report_fo_10000_10_20.sqlite[2/7] [14%                         ] nsys_report_fo_10000_10_20.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_10_20.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_10_20.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_10_20.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_10_20.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_10_20.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_10_20.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_10_20.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_10_20.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_10_20.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_10_20.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_10_20.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_10_20.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_10_20.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_10_20.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_10_20.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_10_20.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_10_20.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_10_20.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_10_20.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_10_20.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_10_20.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_10_20.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_10_20.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_10_20.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_10_20.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_10_20.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_10_20.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_10_20.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_10_20.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_10_20.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_10_20.sqlite[2/7] [============54%             ] nsys_report_fo_10000_10_20.sqlite[2/7] [============55%             ] nsys_report_fo_10000_10_20.sqlite[2/7] [============56%             ] nsys_report_fo_10000_10_20.sqlite[2/7] [============57%             ] nsys_report_fo_10000_10_20.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_10_20.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_10_20.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_10_20.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_10_20.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_10_20.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_10_20.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_10_20.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_10_20.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_10_20.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_10_20.sqlite[2/7] [================68%         ] nsys_report_fo_10000_10_20.sqlite[2/7] [================69%         ] nsys_report_fo_10000_10_20.sqlite[2/7] [================70%         ] nsys_report_fo_10000_10_20.sqlite[2/7] [================71%         ] nsys_report_fo_10000_10_20.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_10_20.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_10_20.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_10_20.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_10_20.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_10_20.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_10_20.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_10_20.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_10_20.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_10_20.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_10_20.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_10_20.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_10_20.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_10_20.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_10_20.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_10_20.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_10_20.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_10_20.sqlite[2/7] [========================97% ] nsys_report_fo_10000_10_20.sqlite[2/7] [========================98% ] nsys_report_fo_10000_10_20.sqlite[2/7] [========================99% ] nsys_report_fo_10000_10_20.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_20.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        280891552          1  280891552.0  280891552.0  280891552  280891552          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     46.6       4435367846          1  4435367846.0  4435367846.0  4435367846  4435367846          0.0  cudaHostAlloc                     
     22.6       2149141929          1  2149141929.0  2149141929.0  2149141929  2149141929          0.0  cudaFreeHost                      
     21.9       2087858795         60    34797646.6        9945.0        3440   110774543   51514518.7  cudaMemcpyAsync                   
      4.4        423342424         20    21167121.2         530.0         431   423330473   94659430.8  cuKernelGetFunction               
      1.8        168473643         16    10529602.7      459549.5       47340   159833436   39819276.2  cudaFree                          
      1.4        131590402          2    65795201.0    65795201.0    53631369    77959033   17202256.2  cudaMemcpy                        
      1.3        119438900          1   119438900.0   119438900.0   119438900   119438900          0.0  cudaDeviceReset                   
      0.0          4159174         15      277278.3      291393.0      125381      449715     107229.6  cuLibraryLoadData                 
      0.0          1724967         15      114997.8      121932.0        3830      161641      35448.9  cudaMalloc                        
      0.0          1196051         22       54366.0        2340.0        1710     1144211     243420.9  cudaStreamSynchronize             
      0.0           567612         60        9460.2        4575.0        4030      246302      31179.8  cudaLaunchKernel                  
      0.0           283183        140        2022.7        1900.0         490       14080       1686.3  cudaEventRecord                   
      0.0           258763        814         317.9         290.0         120        1160        160.8  cuGetProcAddress_v2               
      0.0           126124         20        6306.2        4645.0        4140       33520       6480.1  cuLaunchKernel                    
      0.0            76381          1       76381.0       76381.0       76381       76381          0.0  cudaMemGetInfo                    
      0.0            64091         80         801.1         545.0         470        7210       1003.7  cudaEventCreate                   
      0.0            52671          4       13167.8        3180.0        1320       44991      21245.8  cudaDeviceSynchronize             
      0.0            51531         38        1356.1         530.0         400       12381       2736.0  cudaEventCreateWithFlags          
      0.0            43580        100         435.8         305.0         280        6120        613.2  cudaStreamGetCaptureInfo_v2_v11030
      0.0            35261          2       17630.5       17630.5        1790       33471      22401.8  cudaStreamCreateWithFlags         
      0.0            31762         30        1058.7         885.0         580        3250        595.2  cudaStreamWaitEvent               
      0.0            28830         38         758.7         535.0         360        4950        837.0  cudaEventDestroy                  
      0.0            17110          2        8555.0        8555.0        3490       13620       7163.0  cudaStreamDestroy                 
      0.0            11890         16         743.1         635.0         490        1530        287.7  cuLibraryGetKernel                
      0.0             5120          1        5120.0        5120.0        5120        5120          0.0  cudaEventQuery                    
      0.0             4750          3        1583.3        1970.0         560        2220        895.0  cuInit                            
      0.0             3430          3        1143.3         310.0         260        2860       1486.9  cuModuleGetLoadingMode            
      0.0             1200          1        1200.0        1200.0        1200        1200          0.0  cuCtxSynchronize                  
      0.0              850          2         425.0         425.0         320         530        148.5  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       2158457177         20  107922858.9  108001878.5  105193907  109005357     759717.7  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         22923868         20    1146193.4    1145144.0    1139367    1153479       6049.1  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         12949785         40     323744.6     321011.0      12576     640516     314925.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     91.6        849823569     41  20727404.1  32261982.0      1567  53506640   21332704.3  [CUDA memcpy Host-to-Device]
      8.4         77814362     21   3705445.8      1952.0      1920  77773371   16971093.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  16800.208     41   409.761   800.000     0.010   800.000      404.843  [CUDA memcpy Host-to-Device]
    800.000     21    38.095     0.000     0.000   800.000      174.574  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 10 (num_steps = 40)
number of batches= 4
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 4322.394737 ms
t_h2d = 1549.533155 ms
t_gpu_alloc = 1.235008 ms
t_cpu_alloc = 8579.369068 ms
t_init = 2180.772066 ms
t_d2h = 156.039953 ms
t_end_2_end = 21153.279066 ms
Generating '/tmp/nsys-report-62fa.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [======35%                   ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [=============59%            ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_10_40.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_40.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [1%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [2%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [3%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [4%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [5%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [6%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [7%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [8%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [9%                          ] nsys_report_ia_10000_10_40.sqlite[2/7] [10%                         ] nsys_report_ia_10000_10_40.sqlite[2/7] [11%                         ] nsys_report_ia_10000_10_40.sqlite[2/7] [12%                         ] nsys_report_ia_10000_10_40.sqlite[2/7] [13%                         ] nsys_report_ia_10000_10_40.sqlite[2/7] [14%                         ] nsys_report_ia_10000_10_40.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_10_40.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_10_40.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_10_40.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_10_40.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_10_40.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_10_40.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_10_40.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_10_40.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_10_40.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_10_40.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_10_40.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_10_40.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_10_40.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_10_40.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_10_40.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_10_40.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_10_40.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_10_40.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_10_40.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_10_40.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_10_40.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_10_40.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_10_40.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_10_40.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_10_40.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_10_40.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_10_40.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_10_40.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_10_40.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_10_40.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_10_40.sqlite[2/7] [============54%             ] nsys_report_ia_10000_10_40.sqlite[2/7] [============55%             ] nsys_report_ia_10000_10_40.sqlite[2/7] [============56%             ] nsys_report_ia_10000_10_40.sqlite[2/7] [============57%             ] nsys_report_ia_10000_10_40.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_10_40.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_10_40.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_10_40.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_10_40.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_10_40.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_10_40.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_10_40.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_10_40.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_10_40.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_10_40.sqlite[2/7] [================68%         ] nsys_report_ia_10000_10_40.sqlite[2/7] [================69%         ] nsys_report_ia_10000_10_40.sqlite[2/7] [================70%         ] nsys_report_ia_10000_10_40.sqlite[2/7] [================71%         ] nsys_report_ia_10000_10_40.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_10_40.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_10_40.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_10_40.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_10_40.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_10_40.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_10_40.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_10_40.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_10_40.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_10_40.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_10_40.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_10_40.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_10_40.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_10_40.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_10_40.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_10_40.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_10_40.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_10_40.sqlite[2/7] [========================97% ] nsys_report_ia_10000_10_40.sqlite[2/7] [========================98% ] nsys_report_ia_10000_10_40.sqlite[2/7] [========================99% ] nsys_report_ia_10000_10_40.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_40.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        295310188          1  295310188.0  295310188.0  295310188  295310188          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     48.5       8579361562          1  8579361562.0  8579361562.0  8579361562  8579361562          0.0  cudaHostAlloc                     
     24.2       4278228157         12   356519013.1       16696.0        6750  1430858310  644813284.4  cudaMemcpyAsync                   
     22.2       3922804471          1  3922804471.0  3922804471.0  3922804471  3922804471          0.0  cudaFreeHost                      
      2.5        447221570         40    11180539.3         310.0         300   447201570   70708695.6  cuKernelGetFunction               
      1.1        187566431          8    23445803.9     2333689.0       30150   172964334   60451390.1  cudaFree                          
      0.7        131932910          2    65966455.0    65966455.0    54374788    77558122   16393092.7  cudaMemcpy                        
      0.7        120576686          1   120576686.0   120576686.0   120576686   120576686          0.0  cudaDeviceReset                   
      0.0          4047522         15      269834.8      279113.0      121192      445825     106853.6  cuLibraryLoadData                 
      0.0          1409364          7      201337.7      127522.0        3600      476774     190356.2  cudaMalloc                        
      0.0          1157962          6      192993.7        3255.5        2890     1141361     464603.4  cudaStreamSynchronize             
      0.0           392083         12       32673.6        8050.0        4340      260763      72333.5  cudaLaunchKernel                  
      0.0           280501         96        2921.9        2675.0         520       13990       1606.9  cudaEventRecord                   
      0.0           267622        814         328.8         280.0         120       12370        450.2  cuGetProcAddress_v2               
      0.0           211321         40        5283.0        4270.0        3740       30430       4259.9  cuLaunchKernel                    
      0.0            69711        108         645.5         425.0         320       17040       1694.6  cudaEventDestroy                  
      0.0            64791         88         736.3         600.0         480        3601        495.4  cudaEventCreate                   
      0.0            43240         20        2162.0         500.0         390       14460       4011.3  cudaEventCreateWithFlags          
      0.0            35151          2       17575.5       17575.5        1860       33291      22225.1  cudaStreamCreateWithFlags         
      0.0            33590          4        8397.5        3150.0        1400       25890      11701.1  cudaDeviceSynchronize             
      0.0            19110         20         955.5         370.0         280        3430       1214.3  cudaStreamGetCaptureInfo_v2_v11030
      0.0            17490          2        8745.0        8745.0        4380       13110       6173.0  cudaStreamDestroy                 
      0.0            11650         16         728.1         615.0         490        1960        386.0  cuLibraryGetKernel                
      0.0             8560          4        2140.0        1965.0        1190        3440       1094.3  cudaStreamWaitEvent               
      0.0             5090          3        1696.7        2190.0         580        2320        969.2  cuInit                            
      0.0             4940          1        4940.0        4940.0        4940        4940          0.0  cudaEventQuery                    
      0.0             3500          3        1166.7         240.0         160        3100       1674.8  cuModuleGetLoadingMode            
      0.0             1310          1        1310.0        1310.0        1310        1310          0.0  cuCtxSynchronize                  
      0.0              900          2         450.0         450.0         330         570        169.7  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8       4321840640         40  108046016.0  108204313.5  105292049  109988347     946955.1  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          4595264          4    1148816.0    1150536.0    1140712    1153480       5830.9  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          2677074          8     334634.3     333282.5      16448     656804     339844.9  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     95.2       1549140831      9  172126759.0  54083727.0      1600  465606932  195690684.4  [CUDA memcpy Host-to-Device]
      4.8         77372313      5   15474462.6      1953.0      1952   77362616   34596529.5  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  32800.042      9  3644.449   800.000     0.010  8000.000     4139.775  [CUDA memcpy Host-to-Device]
    800.000      5   160.000     0.000     0.000   800.000      357.771  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 10 (num_steps = 40)
number of batches= 4
t_gemm = 4683.208679 ms
t_h2d = 1608.428228 ms
t_d2h = 156.532049 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.941038 ms
t_cpu_alloc = 8672.440052 ms
t_init = 2195.523977 ms
t_end_2_end = 20627.187014 ms
Generating '/tmp/nsys-report-ce64.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_10_40.nsys-rep[1/7] [======35%                   ] nsys_report_db_10000_10_40.nsys-rep[1/7] [=============58%            ] nsys_report_db_10000_10_40.nsys-rep[1/7] [===================81%      ] nsys_report_db_10000_10_40.nsys-rep[1/7] [===================82%      ] nsys_report_db_10000_10_40.nsys-rep[1/7] [====================83%     ] nsys_report_db_10000_10_40.nsys-rep[1/7] [====================84%     ] nsys_report_db_10000_10_40.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_10_40.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_10_40.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_10_40.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_10_40.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_10_40.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_10_40.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_10_40.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_10_40.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_10_40.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_10_40.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_10_40.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_10_40.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_10_40.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_40.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [1%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [2%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [3%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [4%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [5%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [6%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [7%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [8%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [9%                          ] nsys_report_db_10000_10_40.sqlite[2/7] [10%                         ] nsys_report_db_10000_10_40.sqlite[2/7] [11%                         ] nsys_report_db_10000_10_40.sqlite[2/7] [12%                         ] nsys_report_db_10000_10_40.sqlite[2/7] [13%                         ] nsys_report_db_10000_10_40.sqlite[2/7] [14%                         ] nsys_report_db_10000_10_40.sqlite[2/7] [=15%                        ] nsys_report_db_10000_10_40.sqlite[2/7] [=16%                        ] nsys_report_db_10000_10_40.sqlite[2/7] [=17%                        ] nsys_report_db_10000_10_40.sqlite[2/7] [==18%                       ] nsys_report_db_10000_10_40.sqlite[2/7] [==19%                       ] nsys_report_db_10000_10_40.sqlite[2/7] [==20%                       ] nsys_report_db_10000_10_40.sqlite[2/7] [==21%                       ] nsys_report_db_10000_10_40.sqlite[2/7] [===22%                      ] nsys_report_db_10000_10_40.sqlite[2/7] [===23%                      ] nsys_report_db_10000_10_40.sqlite[2/7] [===24%                      ] nsys_report_db_10000_10_40.sqlite[2/7] [====25%                     ] nsys_report_db_10000_10_40.sqlite[2/7] [====26%                     ] nsys_report_db_10000_10_40.sqlite[2/7] [====27%                     ] nsys_report_db_10000_10_40.sqlite[2/7] [====28%                     ] nsys_report_db_10000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_10_40.sqlite[2/7] [======33%                   ] nsys_report_db_10000_10_40.sqlite[2/7] [======34%                   ] nsys_report_db_10000_10_40.sqlite[2/7] [======35%                   ] nsys_report_db_10000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_10_40.sqlite[2/7] [========40%                 ] nsys_report_db_10000_10_40.sqlite[2/7] [========41%                 ] nsys_report_db_10000_10_40.sqlite[2/7] [========42%                 ] nsys_report_db_10000_10_40.sqlite[2/7] [=========43%                ] nsys_report_db_10000_10_40.sqlite[2/7] [=========44%                ] nsys_report_db_10000_10_40.sqlite[2/7] [=========45%                ] nsys_report_db_10000_10_40.sqlite[2/7] [=========46%                ] nsys_report_db_10000_10_40.sqlite[2/7] [==========47%               ] nsys_report_db_10000_10_40.sqlite[2/7] [==========48%               ] nsys_report_db_10000_10_40.sqlite[2/7] [==========49%               ] nsys_report_db_10000_10_40.sqlite[2/7] [===========50%              ] nsys_report_db_10000_10_40.sqlite[2/7] [===========51%              ] nsys_report_db_10000_10_40.sqlite[2/7] [===========52%              ] nsys_report_db_10000_10_40.sqlite[2/7] [===========53%              ] nsys_report_db_10000_10_40.sqlite[2/7] [============54%             ] nsys_report_db_10000_10_40.sqlite[2/7] [============55%             ] nsys_report_db_10000_10_40.sqlite[2/7] [============56%             ] nsys_report_db_10000_10_40.sqlite[2/7] [============57%             ] nsys_report_db_10000_10_40.sqlite[2/7] [=============58%            ] nsys_report_db_10000_10_40.sqlite[2/7] [=============59%            ] nsys_report_db_10000_10_40.sqlite[2/7] [=============60%            ] nsys_report_db_10000_10_40.sqlite[2/7] [==============61%           ] nsys_report_db_10000_10_40.sqlite[2/7] [==============62%           ] nsys_report_db_10000_10_40.sqlite[2/7] [==============63%           ] nsys_report_db_10000_10_40.sqlite[2/7] [==============64%           ] nsys_report_db_10000_10_40.sqlite[2/7] [===============65%          ] nsys_report_db_10000_10_40.sqlite[2/7] [===============66%          ] nsys_report_db_10000_10_40.sqlite[2/7] [===============67%          ] nsys_report_db_10000_10_40.sqlite[2/7] [================68%         ] nsys_report_db_10000_10_40.sqlite[2/7] [================69%         ] nsys_report_db_10000_10_40.sqlite[2/7] [================70%         ] nsys_report_db_10000_10_40.sqlite[2/7] [================71%         ] nsys_report_db_10000_10_40.sqlite[2/7] [=================72%        ] nsys_report_db_10000_10_40.sqlite[2/7] [=================73%        ] nsys_report_db_10000_10_40.sqlite[2/7] [=================74%        ] nsys_report_db_10000_10_40.sqlite[2/7] [==================75%       ] nsys_report_db_10000_10_40.sqlite[2/7] [==================76%       ] nsys_report_db_10000_10_40.sqlite[2/7] [==================77%       ] nsys_report_db_10000_10_40.sqlite[2/7] [==================78%       ] nsys_report_db_10000_10_40.sqlite[2/7] [===================79%      ] nsys_report_db_10000_10_40.sqlite[2/7] [===================80%      ] nsys_report_db_10000_10_40.sqlite[2/7] [===================81%      ] nsys_report_db_10000_10_40.sqlite[2/7] [===================82%      ] nsys_report_db_10000_10_40.sqlite[2/7] [====================83%     ] nsys_report_db_10000_10_40.sqlite[2/7] [====================84%     ] nsys_report_db_10000_10_40.sqlite[2/7] [====================85%     ] nsys_report_db_10000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_10_40.sqlite[2/7] [======================90%   ] nsys_report_db_10000_10_40.sqlite[2/7] [======================91%   ] nsys_report_db_10000_10_40.sqlite[2/7] [======================92%   ] nsys_report_db_10000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_10_40.sqlite[2/7] [========================97% ] nsys_report_db_10000_10_40.sqlite[2/7] [========================98% ] nsys_report_db_10000_10_40.sqlite[2/7] [========================99% ] nsys_report_db_10000_10_40.sqlite[2/7] [========================100%] nsys_report_db_10000_10_40.sqlite[2/7] [========================100%] nsys_report_db_10000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        283923927          1  283923927.0  283923927.0  283923927  283923927          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     50.6       8672430623          1  8672430623.0  8672430623.0  8672430623  8672430623          0.0  cudaHostAlloc                     
     23.4       4011725634          1  4011725634.0  4011725634.0  4011725634  4011725634          0.0  cudaFreeHost                      
     19.0       3260838618         12   271736551.5       24935.5        6390  1089868532  491426005.3  cudaMemcpyAsync                   
      4.4        750324743         40    18758118.6         305.5         290   750305362  118633615.7  cuKernelGetFunction               
      1.0        177012244          8    22126530.5     2346829.0       57310   162285665   56672199.8  cudaFree                          
      0.8        131786616          2    65893308.0    65893308.0    54474472    77312144   16148672.7  cudaMemcpy                        
      0.7        121403010          1   121403010.0   121403010.0   121403010   121403010          0.0  cudaDeviceReset                   
      0.0          4151322         15      276754.8      298403.0      121811      436404     108978.7  cuLibraryLoadData                 
      0.0          1410894          7      201556.3      125341.0        3870      471105     189778.5  cudaMalloc                        
      0.0          1158601          6      193100.2        3770.0        2220     1140661     464208.9  cudaStreamSynchronize             
      0.0           438514         12       36542.8        8350.0        4370      302033      84092.3  cudaLaunchKernel                  
      0.0           375253        814         461.0         410.0         120        1540        249.0  cuGetProcAddress_v2               
      0.0           302052         96        3146.4        2725.0         560       30241       3099.5  cudaEventRecord                   
      0.0           213934         40        5348.4        4235.0        3540       34611       4913.8  cuLaunchKernel                    
      0.0            88261        108         817.2         460.0         340       28130       2788.5  cudaEventDestroy                  
      0.0            67421         88         766.1         600.0         470        4810        653.0  cudaEventCreate                   
      0.0            58340         20        2917.0         525.0         420       38120       8492.6  cudaEventCreateWithFlags          
      0.0            38630          4        9657.5        3340.0        1340       30610      14015.3  cudaDeviceSynchronize             
      0.0            36660          2       18330.0       18330.0        1930       34730      23193.1  cudaStreamCreateWithFlags         
      0.0            24220          2       12110.0       12110.0        5980       18240       8669.1  cudaStreamDestroy                 
      0.0            20020         20        1001.0         425.0         290        3690       1241.9  cudaStreamGetCaptureInfo_v2_v11030
      0.0            15820         16         988.8         655.0         570        4420        948.2  cuLibraryGetKernel                
      0.0            11570          4        2892.5        2800.0        2050        3920        904.7  cudaStreamWaitEvent               
      0.0             6120          3        2040.0        2270.0         520        3330       1419.0  cuInit                            
      0.0             5830          1        5830.0        5830.0        5830        5830          0.0  cudaEventQuery                    
      0.0             3970          3        1323.3         370.0         160        3440       1836.1  cuModuleGetLoadingMode            
      0.0             1790          1        1790.0        1790.0        1790        1790          0.0  cuCtxSynchronize                  
      0.0              940          2         470.0         470.0         310         630        226.3  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8       4330412175         40  108260304.4  108337579.5  105847759  110074328     900843.6  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          4582785          4    1145696.3    1144440.0    1139945    1153960       6378.2  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          2686451          8     335806.4     333794.5      16480     659812     341144.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     95.4       1607976472      9  178664052.4  54159856.0      1600  417532310  200444899.9  [CUDA memcpy Host-to-Device]
      4.6         77098263      5   15419652.6      1952.0      1952   77088823   34474114.3  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  32800.042      9  3644.449   800.000     0.010  8000.000     4139.775  [CUDA memcpy Host-to-Device]
    800.000      5   160.000     0.000     0.000   800.000      357.771  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 10 (num_steps = 40), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  30.03 GB
Used GPU Memory:  9.46 GB
------------------------

Process RSS:  32.80 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 1.585007 ms
t_alloc_cpu = 8596.307039 ms
t_init      = 2262.645006 ms
t_h2d       = 1605.153311 ms
t_d2h       = 155.355930 ms
t_gemm      = 4690.471947 ms
t_end_2_end = 20245.884895 ms
Generating '/tmp/nsys-report-660e.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [==19%                       ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [========42%                 ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [=========43%                ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [=========44%                ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [=========45%                ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [=========46%                ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [==========47%               ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [==========48%               ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [==========49%               ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [=======================95%  ] nsys_report_fo_10000_10_40.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_40.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [1%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [2%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [3%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [4%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [5%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [6%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [7%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [8%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [9%                          ] nsys_report_fo_10000_10_40.sqlite[2/7] [10%                         ] nsys_report_fo_10000_10_40.sqlite[2/7] [11%                         ] nsys_report_fo_10000_10_40.sqlite[2/7] [12%                         ] nsys_report_fo_10000_10_40.sqlite[2/7] [13%                         ] nsys_report_fo_10000_10_40.sqlite[2/7] [14%                         ] nsys_report_fo_10000_10_40.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_10_40.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_10_40.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_10_40.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_10_40.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_10_40.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_10_40.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_10_40.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_10_40.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_10_40.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_10_40.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_10_40.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_10_40.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_10_40.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_10_40.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_10_40.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_10_40.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_10_40.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_10_40.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_10_40.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_10_40.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_10_40.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_10_40.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_10_40.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_10_40.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_10_40.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_10_40.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_10_40.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_10_40.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_10_40.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_10_40.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_10_40.sqlite[2/7] [============54%             ] nsys_report_fo_10000_10_40.sqlite[2/7] [============55%             ] nsys_report_fo_10000_10_40.sqlite[2/7] [============56%             ] nsys_report_fo_10000_10_40.sqlite[2/7] [============57%             ] nsys_report_fo_10000_10_40.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_10_40.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_10_40.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_10_40.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_10_40.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_10_40.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_10_40.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_10_40.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_10_40.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_10_40.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_10_40.sqlite[2/7] [================68%         ] nsys_report_fo_10000_10_40.sqlite[2/7] [================69%         ] nsys_report_fo_10000_10_40.sqlite[2/7] [================70%         ] nsys_report_fo_10000_10_40.sqlite[2/7] [================71%         ] nsys_report_fo_10000_10_40.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_10_40.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_10_40.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_10_40.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_10_40.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_10_40.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_10_40.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_10_40.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_10_40.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_10_40.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_10_40.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_10_40.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_10_40.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_10_40.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_10_40.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_10_40.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_10_40.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_10_40.sqlite[2/7] [========================97% ] nsys_report_fo_10000_10_40.sqlite[2/7] [========================98% ] nsys_report_fo_10000_10_40.sqlite[2/7] [========================99% ] nsys_report_fo_10000_10_40.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_40.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        304928952          1  304928952.0  304928952.0  304928952  304928952          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     48.7       8596302578          1  8596302578.0  8596302578.0  8596302578  8596302578          0.0  cudaHostAlloc                     
     24.3       4292797691        120    35773314.1        8000.0        3490   111111501   51751151.3  cudaMemcpyAsync                   
     22.2       3925483642          1  3925483642.0  3925483642.0  3925483642  3925483642          0.0  cudaFreeHost                      
      2.2        383303980         40     9582599.5         500.0         400   383281940   60602106.5  cuKernelGetFunction               
      1.1        188323967         16    11770247.9      459760.0       54330   180517757   45001304.4  cudaFree                          
      0.7        130854191          2    65427095.5    65427095.5    53299442    77554749   17151092.1  cudaMemcpy                        
      0.7        125838321          1   125838321.0   125838321.0   125838321   125838321          0.0  cudaDeviceReset                   
      0.0          4052642         15      270176.1      283373.0      122931      439065     103867.2  cuLibraryLoadData                 
      0.0          1761867         15      117457.8      121821.0        3900      155852      36891.8  cudaMalloc                        
      0.0          1245473         42       29654.1        2375.0        1960     1144632     176241.5  cudaStreamSynchronize             
      0.0           885735        120        7381.1        4630.0        4060      248862      22316.5  cudaLaunchKernel                  
      0.0           579728        280        2070.5        2400.0         520       22700       1788.2  cudaEventRecord                   
      0.0           264272        814         324.7         290.0         120        1220        157.1  cuGetProcAddress_v2               
      0.0           225001         40        5625.0        4830.0        4200       32670       4425.9  cuLaunchKernel                    
      0.0           124791        160         779.9         600.0         480       11530        994.9  cudaEventCreate                   
      0.0            83801          1       83801.0       83801.0       83801       83801          0.0  cudaMemGetInfo                    
      0.0            83301        200         416.5         330.0         280        6910        489.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0            66021         70         943.2         860.0         590        4080        488.1  cudaStreamWaitEvent               
      0.0            48920         38        1287.4         520.0         400       11960       2457.1  cudaEventCreateWithFlags          
      0.0            39881          4        9970.3        3080.0        1330       32391      14987.9  cudaDeviceSynchronize             
      0.0            38290          2       19145.0       19145.0        2190       36100      23978.0  cudaStreamCreateWithFlags         
      0.0            28850         38         759.2         555.0         340        4770        812.9  cudaEventDestroy                  
      0.0            19440          2        9720.0        9720.0        5420       14020       6081.1  cudaStreamDestroy                 
      0.0            11280         16         705.0         620.0         500        1230        251.4  cuLibraryGetKernel                
      0.0             6860          3        2286.7        2690.0         860        3310       1273.8  cuInit                            
      0.0             5230          1        5230.0        5230.0        5230        5230          0.0  cudaEventQuery                    
      0.0             2990          3         996.7         270.0         140        2580       1372.7  cuModuleGetLoadingMode            
      0.0             1220          1        1220.0        1220.0        1220        1220          0.0  cuCtxSynchronize                  
      0.0              950          2         475.0         475.0         330         620        205.1  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       4328889076         40  108222226.9  108312144.0  106413588  109336503     724241.8  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         45955293         40    1148882.3    1151208.0    1139048    1155016       5294.0  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         25896140         80     323701.8     320210.0      12544     641060     312877.6  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     95.4       1604729077     81  19811470.1  32234811.0      1568  54081495   20522798.2  [CUDA memcpy Host-to-Device]
      4.6         77455736     41   1889164.3      1952.0      1920  77375449   12083701.5  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  32800.415     81   404.943   800.000     0.010   800.000      402.456  [CUDA memcpy Host-to-Device]
    800.000     41    19.512     0.000     0.000   800.000      124.939  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 10 (num_steps = 60)
number of batches= 6
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 6484.661781 ms
t_h2d = 2335.229282 ms
t_gpu_alloc = 1.215935 ms
t_cpu_alloc = 12750.854015 ms
t_init = 3192.504168 ms
t_d2h = 156.270981 ms
t_end_2_end = 30968.147993 ms
Generating '/tmp/nsys-report-9fb9.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [=======37%                  ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [============57%             ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [==================78%       ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [===================79%      ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [===================80%      ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [===================81%      ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_10_60.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_60.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [1%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [2%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [3%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [4%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [5%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [6%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [7%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [8%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [9%                          ] nsys_report_ia_10000_10_60.sqlite[2/7] [10%                         ] nsys_report_ia_10000_10_60.sqlite[2/7] [11%                         ] nsys_report_ia_10000_10_60.sqlite[2/7] [12%                         ] nsys_report_ia_10000_10_60.sqlite[2/7] [13%                         ] nsys_report_ia_10000_10_60.sqlite[2/7] [14%                         ] nsys_report_ia_10000_10_60.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_10_60.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_10_60.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_10_60.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_10_60.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_10_60.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_10_60.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_10_60.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_10_60.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_10_60.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_10_60.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_10_60.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_10_60.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_10_60.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_10_60.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_10_60.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_10_60.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_10_60.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_10_60.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_10_60.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_10_60.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_10_60.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_10_60.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_10_60.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_10_60.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_10_60.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_10_60.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_10_60.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_10_60.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_10_60.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_10_60.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_10_60.sqlite[2/7] [============54%             ] nsys_report_ia_10000_10_60.sqlite[2/7] [============55%             ] nsys_report_ia_10000_10_60.sqlite[2/7] [============56%             ] nsys_report_ia_10000_10_60.sqlite[2/7] [============57%             ] nsys_report_ia_10000_10_60.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_10_60.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_10_60.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_10_60.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_10_60.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_10_60.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_10_60.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_10_60.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_10_60.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_10_60.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_10_60.sqlite[2/7] [================68%         ] nsys_report_ia_10000_10_60.sqlite[2/7] [================69%         ] nsys_report_ia_10000_10_60.sqlite[2/7] [================70%         ] nsys_report_ia_10000_10_60.sqlite[2/7] [================71%         ] nsys_report_ia_10000_10_60.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_10_60.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_10_60.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_10_60.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_10_60.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_10_60.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_10_60.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_10_60.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_10_60.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_10_60.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_10_60.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_10_60.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_10_60.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_10_60.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_10_60.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_10_60.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_10_60.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_10_60.sqlite[2/7] [========================97% ] nsys_report_ia_10000_10_60.sqlite[2/7] [========================98% ] nsys_report_ia_10000_10_60.sqlite[2/7] [========================99% ] nsys_report_ia_10000_10_60.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_60.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        286596641          1  286596641.0  286596641.0  286596641  286596641          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     48.2      12750848680          1  12750848680.0  12750848680.0  12750848680  12750848680          0.0  cudaHostAlloc                     
     27.5       7274282692         18    404126816.2        16585.0         6240   1487997137  670549456.1  cudaMemcpyAsync                   
     21.2       5612315966          1   5612315966.0   5612315966.0   5612315966   5612315966          0.0  cudaFreeHost                      
      1.5        398406864         60      6640114.4          300.0          290    398376134   51430070.5  cuKernelGetFunction               
      0.7        180275765          8     22534470.6      2334424.0        30421    165543783   57823900.1  cudaFree                          
      0.5        131938630          2     65969315.0     65969315.0     54273675     77664955   16540132.7  cudaMemcpy                        
      0.5        121493973          1    121493973.0    121493973.0    121493973    121493973          0.0  cudaDeviceReset                   
      0.0          4006650         15       267110.0       279783.0       119281       433874     103724.4  cuLibraryLoadData                 
      0.0          1392306          7       198900.9       122411.0         3610       466555     188204.2  cudaMalloc                        
      0.0          1163792          8       145474.0         3280.0         2710      1140541     402068.2  cudaStreamSynchronize             
      0.0           469295         18        26071.9         8430.5         4330       259822      58955.0  cudaLaunchKernel                  
      0.0           426695        144         2963.2         2720.0          620        21400       1867.7  cudaEventRecord                   
      0.0           314012         60         5233.5         4250.0         3540        34390       4120.3  cuLaunchKernel                    
      0.0           261833        814          321.7          300.0          130         1070        155.6  cuGetProcAddress_v2               
      0.0            96170        132          728.6          590.0          470         4330        529.7  cudaEventCreate                   
      0.0            86901        152          571.7          360.0          340        15411       1333.8  cudaEventDestroy                  
      0.0            52151         20         2607.6          525.0          400        18990       5209.2  cudaEventCreateWithFlags          
      0.0            35180          2        17590.0        17590.0         1870        33310      22231.4  cudaStreamCreateWithFlags         
      0.0            34820          4         8705.0         3095.0         1510        27120      12312.8  cudaDeviceSynchronize             
      0.0            26620         30          887.3          410.0          290         3010       1031.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0            17760          2         8880.0         8880.0         5150        12610       5275.0  cudaStreamDestroy                 
      0.0            14870         16          929.4          545.0          490         5700       1292.8  cuLibraryGetKernel                
      0.0            11120          6         1853.3         1640.0          990         3790       1018.2  cudaStreamWaitEvent               
      0.0             5640          1         5640.0         5640.0         5640         5640          0.0  cudaEventQuery                    
      0.0             4420          3         1473.3         1850.0          630         1940        731.7  cuInit                            
      0.0             3270          3         1090.0          270.0          160         2840       1516.5  cuModuleGetLoadingMode            
      0.0             1150          2          575.0          575.0          300          850        388.9  cudaGetDriverEntryPoint_v11030    
      0.0             1090          1         1090.0         1090.0         1090         1090          0.0  cuCtxSynchronize                  

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8       6484061083         60  108067684.7  108228673.0  105290094  110680779    1158475.5  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          6894032          6    1149005.3    1149976.0    1140616    1153352       4825.4  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          4018908         12     334909.0     333842.0      16160     658373     332487.4  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     96.8       2334806092     13  179600468.6  53976652.0      1600  416799581  194790605.0  [CUDA memcpy Host-to-Device]
      3.2         77481249      7   11068749.9      1952.0      1920   77467905   29279275.3  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  48800.062     13  3753.851   800.000     0.010  8000.000     4097.274  [CUDA memcpy Host-to-Device]
    800.000      7   114.286     0.000     0.000   800.000      302.372  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 10 (num_steps = 60)
number of batches= 6
t_gemm = 6909.952881 ms
t_h2d = 2287.065805 ms
t_d2h = 156.642914 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.936985 ms
t_cpu_alloc = 12659.194946 ms
t_init = 3224.277973 ms
t_end_2_end = 29426.923037 ms
Generating '/tmp/nsys-report-c7ff.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_10_60.nsys-rep[1/7] [=======37%                  ] nsys_report_db_10000_10_60.nsys-rep[1/7] [============57%             ] nsys_report_db_10000_10_60.nsys-rep[1/7] [==================77%       ] nsys_report_db_10000_10_60.nsys-rep[1/7] [==================78%       ] nsys_report_db_10000_10_60.nsys-rep[1/7] [===================79%      ] nsys_report_db_10000_10_60.nsys-rep[1/7] [===================80%      ] nsys_report_db_10000_10_60.nsys-rep[1/7] [===================81%      ] nsys_report_db_10000_10_60.nsys-rep[1/7] [===================82%      ] nsys_report_db_10000_10_60.nsys-rep[1/7] [====================83%     ] nsys_report_db_10000_10_60.nsys-rep[1/7] [====================84%     ] nsys_report_db_10000_10_60.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_10_60.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_10_60.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_10_60.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_10_60.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_10_60.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_10_60.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_10_60.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_10_60.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_10_60.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_10_60.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_10_60.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_10_60.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_10_60.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_60.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [1%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [2%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [3%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [4%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [5%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [6%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [7%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [8%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [9%                          ] nsys_report_db_10000_10_60.sqlite[2/7] [10%                         ] nsys_report_db_10000_10_60.sqlite[2/7] [11%                         ] nsys_report_db_10000_10_60.sqlite[2/7] [12%                         ] nsys_report_db_10000_10_60.sqlite[2/7] [13%                         ] nsys_report_db_10000_10_60.sqlite[2/7] [14%                         ] nsys_report_db_10000_10_60.sqlite[2/7] [=15%                        ] nsys_report_db_10000_10_60.sqlite[2/7] [=16%                        ] nsys_report_db_10000_10_60.sqlite[2/7] [=17%                        ] nsys_report_db_10000_10_60.sqlite[2/7] [==18%                       ] nsys_report_db_10000_10_60.sqlite[2/7] [==19%                       ] nsys_report_db_10000_10_60.sqlite[2/7] [==20%                       ] nsys_report_db_10000_10_60.sqlite[2/7] [==21%                       ] nsys_report_db_10000_10_60.sqlite[2/7] [===22%                      ] nsys_report_db_10000_10_60.sqlite[2/7] [===23%                      ] nsys_report_db_10000_10_60.sqlite[2/7] [===24%                      ] nsys_report_db_10000_10_60.sqlite[2/7] [====25%                     ] nsys_report_db_10000_10_60.sqlite[2/7] [====26%                     ] nsys_report_db_10000_10_60.sqlite[2/7] [====27%                     ] nsys_report_db_10000_10_60.sqlite[2/7] [====28%                     ] nsys_report_db_10000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_10_60.sqlite[2/7] [======33%                   ] nsys_report_db_10000_10_60.sqlite[2/7] [======34%                   ] nsys_report_db_10000_10_60.sqlite[2/7] [======35%                   ] nsys_report_db_10000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_10_60.sqlite[2/7] [========40%                 ] nsys_report_db_10000_10_60.sqlite[2/7] [========41%                 ] nsys_report_db_10000_10_60.sqlite[2/7] [========42%                 ] nsys_report_db_10000_10_60.sqlite[2/7] [=========43%                ] nsys_report_db_10000_10_60.sqlite[2/7] [=========44%                ] nsys_report_db_10000_10_60.sqlite[2/7] [=========45%                ] nsys_report_db_10000_10_60.sqlite[2/7] [=========46%                ] nsys_report_db_10000_10_60.sqlite[2/7] [==========47%               ] nsys_report_db_10000_10_60.sqlite[2/7] [==========48%               ] nsys_report_db_10000_10_60.sqlite[2/7] [==========49%               ] nsys_report_db_10000_10_60.sqlite[2/7] [===========50%              ] nsys_report_db_10000_10_60.sqlite[2/7] [===========51%              ] nsys_report_db_10000_10_60.sqlite[2/7] [===========52%              ] nsys_report_db_10000_10_60.sqlite[2/7] [===========53%              ] nsys_report_db_10000_10_60.sqlite[2/7] [============54%             ] nsys_report_db_10000_10_60.sqlite[2/7] [============55%             ] nsys_report_db_10000_10_60.sqlite[2/7] [============56%             ] nsys_report_db_10000_10_60.sqlite[2/7] [============57%             ] nsys_report_db_10000_10_60.sqlite[2/7] [=============58%            ] nsys_report_db_10000_10_60.sqlite[2/7] [=============59%            ] nsys_report_db_10000_10_60.sqlite[2/7] [=============60%            ] nsys_report_db_10000_10_60.sqlite[2/7] [==============61%           ] nsys_report_db_10000_10_60.sqlite[2/7] [==============62%           ] nsys_report_db_10000_10_60.sqlite[2/7] [==============63%           ] nsys_report_db_10000_10_60.sqlite[2/7] [==============64%           ] nsys_report_db_10000_10_60.sqlite[2/7] [===============65%          ] nsys_report_db_10000_10_60.sqlite[2/7] [===============66%          ] nsys_report_db_10000_10_60.sqlite[2/7] [===============67%          ] nsys_report_db_10000_10_60.sqlite[2/7] [================68%         ] nsys_report_db_10000_10_60.sqlite[2/7] [================69%         ] nsys_report_db_10000_10_60.sqlite[2/7] [================70%         ] nsys_report_db_10000_10_60.sqlite[2/7] [================71%         ] nsys_report_db_10000_10_60.sqlite[2/7] [=================72%        ] nsys_report_db_10000_10_60.sqlite[2/7] [=================73%        ] nsys_report_db_10000_10_60.sqlite[2/7] [=================74%        ] nsys_report_db_10000_10_60.sqlite[2/7] [==================75%       ] nsys_report_db_10000_10_60.sqlite[2/7] [==================76%       ] nsys_report_db_10000_10_60.sqlite[2/7] [==================77%       ] nsys_report_db_10000_10_60.sqlite[2/7] [==================78%       ] nsys_report_db_10000_10_60.sqlite[2/7] [===================79%      ] nsys_report_db_10000_10_60.sqlite[2/7] [===================80%      ] nsys_report_db_10000_10_60.sqlite[2/7] [===================81%      ] nsys_report_db_10000_10_60.sqlite[2/7] [===================82%      ] nsys_report_db_10000_10_60.sqlite[2/7] [====================83%     ] nsys_report_db_10000_10_60.sqlite[2/7] [====================84%     ] nsys_report_db_10000_10_60.sqlite[2/7] [====================85%     ] nsys_report_db_10000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_10_60.sqlite[2/7] [======================90%   ] nsys_report_db_10000_10_60.sqlite[2/7] [======================91%   ] nsys_report_db_10000_10_60.sqlite[2/7] [======================92%   ] nsys_report_db_10000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_10_60.sqlite[2/7] [========================97% ] nsys_report_db_10000_10_60.sqlite[2/7] [========================98% ] nsys_report_db_10000_10_60.sqlite[2/7] [========================99% ] nsys_report_db_10000_10_60.sqlite[2/7] [========================100%] nsys_report_db_10000_10_60.sqlite[2/7] [========================100%] nsys_report_db_10000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        284502395          1  284502395.0  284502395.0  284502395  284502395          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     50.8      12659190113          1  12659190113.0  12659190113.0  12659190113  12659190113          0.0  cudaHostAlloc                     
     22.4       5573042877          1   5573042877.0   5573042877.0   5573042877   5573042877          0.0  cudaFreeHost                      
     21.8       5438479571         18    302137753.9        16270.0         6530   1090411412  501199896.4  cudaMemcpyAsync                   
      3.2        799014796         60     13316913.3          290.0          270    798985796  103148559.3  cuKernelGetFunction               
      0.7        177268003          8     22158500.4      2330619.0        52181    162538201   56761919.7  cudaFree                          
      0.5        132104798          2     66052399.0     66052399.0     53995085     78109713   17051617.0  cudaMemcpy                        
      0.5        120464848          1    120464848.0    120464848.0    120464848    120464848          0.0  cudaDeviceReset                   
      0.0          4010491         15       267366.1       282973.0       119542       440504     104228.7  cuLibraryLoadData                 
      0.0          1423644          7       203377.7       125181.0         4620       476475     187255.0  cudaMalloc                        
      0.0          1161421          8       145177.6         2965.0         2660      1139591     401804.0  cudaStreamSynchronize             
      0.0           459076         18        25504.2         9005.0         4391       256743      58248.5  cudaLaunchKernel                  
      0.0           417293        144         2897.9         2670.0          500        20680       1795.3  cudaEventRecord                   
      0.0           308611         60         5143.5         4175.0         3540        32710       3906.6  cuLaunchKernel                    
      0.0           264480        814          324.9          290.0          120         1240        154.0  cuGetProcAddress_v2               
      0.0            98661        152          649.1          425.0          320        21460       1844.7  cudaEventDestroy                  
      0.0            93811        132          710.7          510.0          470         3810        528.0  cudaEventCreate                   
      0.0            43090         20         2154.5          620.0          440        14450       3779.1  cudaEventCreateWithFlags          
      0.0            39611          2        19805.5        19805.5         1860        37751      25378.8  cudaStreamCreateWithFlags         
      0.0            35520          4         8880.0         3180.0         1380        27780      12647.1  cudaDeviceSynchronize             
      0.0            30571         30         1019.0          340.0          290         7990       1600.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0            18080          2         9040.0         9040.0         5110        12970       5557.9  cudaStreamDestroy                 
      0.0            15540          6         2590.0         2475.0         1930         3380        657.8  cudaStreamWaitEvent               
      0.0            11220         16          701.3          605.0          510         1860        337.7  cuLibraryGetKernel                
      0.0             5750          1         5750.0         5750.0         5750         5750          0.0  cudaEventQuery                    
      0.0             3980          3         1326.7          270.0          250         3460       1847.5  cuModuleGetLoadingMode            
      0.0             3740          3         1246.7         1370.0          550         1820        643.9  cuInit                            
      0.0             1060          1         1060.0         1060.0         1060         1060          0.0  cuCtxSynchronize                  
      0.0              790          2          395.0          395.0          310          480        120.2  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8       6502183710         60  108369728.5  108407934.5  105810097  109842443     815395.3  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          6880209          6    1146701.5    1148104.5    1139496    1153352       5365.1  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          4037054         12     336421.2     333843.0      16608     663365     333907.8  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     96.7       2286801557     13  175907812.1  53839887.0      1600  410266506  190686126.9  [CUDA memcpy Host-to-Device]
      3.3         77922920      7   11131845.7      1952.0      1952   77909384   29446126.6  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  48800.062     13  3753.851   800.000     0.010  8000.000     4097.274  [CUDA memcpy Host-to-Device]
    800.000      7   114.286     0.000     0.000   800.000      302.372  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 10 (num_steps = 60), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  30.01 GB
Used GPU Memory:  9.49 GB
------------------------

Process RSS:  47.71 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 1.601934 ms
t_alloc_cpu = 12710.988998 ms
t_init      = 3274.058104 ms
t_h2d       = 2399.827826 ms
t_d2h       = 155.204058 ms
t_gemm      = 6870.992706 ms
t_end_2_end = 29300.194025 ms
Generating '/tmp/nsys-report-fac5.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=15%                        ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [========42%                 ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=========43%                ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=========44%                ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=========45%                ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=========46%                ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [==========47%               ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_10000_10_60.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_60.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [1%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [2%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [3%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [4%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [5%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [6%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [7%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [8%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [9%                          ] nsys_report_fo_10000_10_60.sqlite[2/7] [10%                         ] nsys_report_fo_10000_10_60.sqlite[2/7] [11%                         ] nsys_report_fo_10000_10_60.sqlite[2/7] [12%                         ] nsys_report_fo_10000_10_60.sqlite[2/7] [13%                         ] nsys_report_fo_10000_10_60.sqlite[2/7] [14%                         ] nsys_report_fo_10000_10_60.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_10_60.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_10_60.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_10_60.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_10_60.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_10_60.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_10_60.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_10_60.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_10_60.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_10_60.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_10_60.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_10_60.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_10_60.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_10_60.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_10_60.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_10_60.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_10_60.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_10_60.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_10_60.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_10_60.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_10_60.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_10_60.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_10_60.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_10_60.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_10_60.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_10_60.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_10_60.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_10_60.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_10_60.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_10_60.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_10_60.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_10_60.sqlite[2/7] [============54%             ] nsys_report_fo_10000_10_60.sqlite[2/7] [============55%             ] nsys_report_fo_10000_10_60.sqlite[2/7] [============56%             ] nsys_report_fo_10000_10_60.sqlite[2/7] [============57%             ] nsys_report_fo_10000_10_60.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_10_60.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_10_60.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_10_60.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_10_60.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_10_60.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_10_60.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_10_60.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_10_60.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_10_60.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_10_60.sqlite[2/7] [================68%         ] nsys_report_fo_10000_10_60.sqlite[2/7] [================69%         ] nsys_report_fo_10000_10_60.sqlite[2/7] [================70%         ] nsys_report_fo_10000_10_60.sqlite[2/7] [================71%         ] nsys_report_fo_10000_10_60.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_10_60.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_10_60.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_10_60.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_10_60.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_10_60.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_10_60.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_10_60.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_10_60.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_10_60.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_10_60.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_10_60.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_10_60.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_10_60.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_10_60.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_10_60.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_10_60.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_10_60.sqlite[2/7] [========================97% ] nsys_report_fo_10000_10_60.sqlite[2/7] [========================98% ] nsys_report_fo_10000_10_60.sqlite[2/7] [========================99% ] nsys_report_fo_10000_10_60.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_60.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        306948042          1  306948042.0  306948042.0  306948042  306948042          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.5      12710982305          1  12710982305.0  12710982305.0  12710982305  12710982305          0.0  cudaHostAlloc                     
     25.3       6501791885        180     36121066.0         9685.0         3550    111716695   51855080.1  cudaMemcpyAsync                   
     21.9       5639723091          1   5639723091.0   5639723091.0   5639723091   5639723091          0.0  cudaFreeHost                      
      1.5        390874659         60      6514577.7          585.0          430    390827169   50455466.6  cuKernelGetFunction               
      0.7        188822622         16     11801413.9       458800.0        52541    181789308   45330829.3  cudaFree                          
      0.5        130758862          2     65379431.0     65379431.0     53527344     77231518   16761382.2  cudaMemcpy                        
      0.5        122411345          1    122411345.0    122411345.0    122411345    122411345          0.0  cudaDeviceReset                   
      0.0          4006434         15       267095.6       279203.0       119891       430524     103002.8  cuLibraryLoadData                 
      0.0          1777848         15       118523.2       132302.0         4050       149601      36737.3  cudaMalloc                        
      0.0          1322567        180         7347.6         4700.0         4150       241692      17806.0  cudaLaunchKernel                  
      0.0          1299123         62        20953.6         2495.0         2040      1143662     144921.9  cudaStreamSynchronize             
      0.0           916908        420         2183.1         2480.0          490        23040       1689.0  cudaEventRecord                   
      0.0           348852         60         5814.2         5010.0         4320        32130       3569.0  cuLaunchKernel                    
      0.0           268173        814          329.5          300.0          120         1240        164.5  cuGetProcAddress_v2               
      0.0           179782        240          749.1          580.0          470         9140        791.8  cudaEventCreate                   
      0.0           135252        300          450.8          380.0          270         2810        364.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0           108970        110          990.6          905.0          580         3450        442.9  cudaStreamWaitEvent               
      0.0            75850          1        75850.0        75850.0        75850        75850          0.0  cudaMemGetInfo                    
      0.0            61291         38         1612.9          520.0          380        20261       3797.1  cudaEventCreateWithFlags          
      0.0            37601          2        18800.5        18800.5         1890        35711      23915.1  cudaStreamCreateWithFlags         
      0.0            37330          4         9332.5         3320.0         1340        29350      13388.8  cudaDeviceSynchronize             
      0.0            27450         38          722.4          540.0          330         4270        724.5  cudaEventDestroy                  
      0.0            20200          2        10100.0        10100.0         5570        14630       6406.4  cudaStreamDestroy                 
      0.0            15370         16          960.6          610.0          490         5650       1273.9  cuLibraryGetKernel                
      0.0             4940          1         4940.0         4940.0         4940         4940          0.0  cudaEventQuery                    
      0.0             4650          3         1550.0         1940.0          570         2140        854.6  cuInit                            
      0.0             3010          3         1003.3          270.0          160         2580       1366.5  cuModuleGetLoadingMode            
      0.0             1220          1         1220.0         1220.0         1220         1220          0.0  cuCtxSynchronize                  
      0.0              910          2          455.0          455.0          330          580        176.8  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       6500563389         60  108342723.2  108438557.0  105059858  109927155     702857.1  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         68972930         60    1149548.8    1152008.5    1139560    1154695       4611.9  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         38922103        120     324350.9     321954.0      12545     642661     312841.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     96.9       2399199524    121  19828095.2  31956574.0      1568  54228536   20629630.7  [CUDA memcpy Host-to-Device]
      3.1         77166313     61   1265021.5      1952.0      1920  77047334    9864646.4  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  48800.623    121   403.311   800.000     0.010   800.000      401.644  [CUDA memcpy Host-to-Device]
    800.000     61    13.115     0.000     0.000   800.000      102.430  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 10 (num_steps = 80)
number of batches= 8
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 8645.223022 ms
t_h2d = 3084.206888 ms
t_gpu_alloc = 1.224041 ms
t_cpu_alloc = 16847.041130 ms
t_init = 4260.964870 ms
t_d2h = 157.076836 ms
t_end_2_end = 40726.294041 ms
Generating '/tmp/nsys-report-5f4f.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [==18%                       ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [======35%                   ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=======36%                  ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [================71%         ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=================72%        ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=================73%        ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=================74%        ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [==================75%       ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [==================76%       ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [==================77%       ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [==================78%       ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [===================79%      ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [===================80%      ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [===================81%      ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_10_80.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_80.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [1%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [2%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [3%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [4%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [5%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [6%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [7%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [8%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [9%                          ] nsys_report_ia_10000_10_80.sqlite[2/7] [10%                         ] nsys_report_ia_10000_10_80.sqlite[2/7] [11%                         ] nsys_report_ia_10000_10_80.sqlite[2/7] [12%                         ] nsys_report_ia_10000_10_80.sqlite[2/7] [13%                         ] nsys_report_ia_10000_10_80.sqlite[2/7] [14%                         ] nsys_report_ia_10000_10_80.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_10_80.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_10_80.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_10_80.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_10_80.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_10_80.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_10_80.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_10_80.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_10_80.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_10_80.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_10_80.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_10_80.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_10_80.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_10_80.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_10_80.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_10_80.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_10_80.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_10_80.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_10_80.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_10_80.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_10_80.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_10_80.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_10_80.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_10_80.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_10_80.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_10_80.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_10_80.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_10_80.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_10_80.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_10_80.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_10_80.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_10_80.sqlite[2/7] [============54%             ] nsys_report_ia_10000_10_80.sqlite[2/7] [============55%             ] nsys_report_ia_10000_10_80.sqlite[2/7] [============56%             ] nsys_report_ia_10000_10_80.sqlite[2/7] [============57%             ] nsys_report_ia_10000_10_80.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_10_80.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_10_80.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_10_80.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_10_80.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_10_80.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_10_80.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_10_80.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_10_80.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_10_80.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_10_80.sqlite[2/7] [================68%         ] nsys_report_ia_10000_10_80.sqlite[2/7] [================69%         ] nsys_report_ia_10000_10_80.sqlite[2/7] [================70%         ] nsys_report_ia_10000_10_80.sqlite[2/7] [================71%         ] nsys_report_ia_10000_10_80.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_10_80.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_10_80.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_10_80.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_10_80.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_10_80.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_10_80.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_10_80.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_10_80.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_10_80.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_10_80.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_10_80.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_10_80.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_10_80.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_10_80.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_10_80.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_10_80.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_10_80.sqlite[2/7] [========================97% ] nsys_report_ia_10000_10_80.sqlite[2/7] [========================98% ] nsys_report_ia_10000_10_80.sqlite[2/7] [========================99% ] nsys_report_ia_10000_10_80.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_80.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        303975898          1  303975898.0  303975898.0  303975898  303975898          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     47.9      16847035403          1  16847035403.0  16847035403.0  16847035403  16847035403          0.0  cudaHostAlloc                     
     28.9      10157529208         24    423230383.7        15540.0         6310   1517956132  673911217.5  cudaMemcpyAsync                   
     20.7       7278262572          1   7278262572.0   7278262572.0   7278262572   7278262572          0.0  cudaFreeHost                      
      1.2        430539613         80      5381745.2          305.0          290    430497113   48130980.3  cuKernelGetFunction               
      0.6        195399540          8     24424942.5      2334799.0        54471    180713417   63185457.1  cudaFree                          
      0.4        132442947          2     66221473.5     66221473.5     54677899     77765048   16325079.6  cudaMemcpy                        
      0.3        118691393          1    118691393.0    118691393.0    118691393    118691393          0.0  cudaDeviceReset                   
      0.0          4043191         15       269546.1       288483.0       118581       443735     106143.4  cuLibraryLoadData                 
      0.0          1398165          7       199737.9       123041.0         3890       470915     189274.6  cudaMalloc                        
      0.0          1171753         10       117175.3         3560.0         2940      1140242     359469.2  cudaStreamSynchronize             
      0.0           581459        192         3028.4         2800.0          550        21951       1724.5  cudaEventRecord                   
      0.0           537536         24        22397.3         8050.0         4480       257022      50694.8  cudaLaunchKernel                  
      0.0           417365         80         5217.1         4300.0         3660        30540       3560.3  cuLaunchKernel                    
      0.0           248042        814          304.7          280.0          120         1160        144.6  cuGetProcAddress_v2               
      0.0           126971        176          721.4          600.0          470         4420        522.2  cudaEventCreate                   
      0.0           112791        196          575.5          475.0          350        15920       1234.1  cudaEventDestroy                  
      0.0            44650          2        22325.0        22325.0         1870        42780      28927.7  cudaStreamCreateWithFlags         
      0.0            41690         20         2084.5          495.0          380        13660       3800.8  cudaEventCreateWithFlags          
      0.0            41280         40         1032.0          350.0          300         7360       1467.3  cudaStreamGetCaptureInfo_v2_v11030
      0.0            35780          4         8945.0         2975.0         1390        28440      13026.3  cudaDeviceSynchronize             
      0.0            18041          2         9020.5         9020.5         5310        12731       5247.4  cudaStreamDestroy                 
      0.0            14390          8         1798.8         1530.0         1030         3460        814.4  cudaStreamWaitEvent               
      0.0            10640         16          665.0          565.0          490         1330        225.3  cuLibraryGetKernel                
      0.0             4900          1         4900.0         4900.0         4900         4900          0.0  cudaEventQuery                    
      0.0             4740          3         1580.0         1660.0          530         2550       1012.4  cuInit                            
      0.0             3380          3         1126.7          290.0          180         2910       1545.4  cuModuleGetLoadingMode            
      0.0             1170          1         1170.0         1170.0         1170         1170          0.0  cuCtxSynchronize                  
      0.0             1010          2          505.0          505.0          410          600        134.4  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8       8644532518         80  108056656.5  108328731.0  105105426  110543686    1159825.7  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          9186336          8    1148292.0    1148648.0    1140008    1152232       3712.8  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          5374050         16     335878.1     333314.0      16448     659973     329659.6  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     97.5       3083725163     17  181395597.8  54344534.0      1600  448894581  194202638.4  [CUDA memcpy Host-to-Device]
      2.5         77595092      9    8621676.9      1952.0      1920   77577972   25858610.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  64800.083     17  3811.770   800.000     0.010  8000.000     4074.594  [CUDA memcpy Host-to-Device]
    800.000      9    88.889     0.000     0.000   800.000      266.667  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 10 (num_steps = 80)
number of batches= 8
t_gemm = 9119.737968 ms
t_h2d = 3106.509935 ms
t_d2h = 157.517910 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.957966 ms
t_cpu_alloc = 16805.155039 ms
t_init = 4128.535986 ms
t_end_2_end = 38378.973961 ms
Generating '/tmp/nsys-report-d3ae.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_10_80.nsys-rep[1/7] [======35%                   ] nsys_report_db_10000_10_80.nsys-rep[1/7] [===========53%              ] nsys_report_db_10000_10_80.nsys-rep[1/7] [================70%         ] nsys_report_db_10000_10_80.nsys-rep[1/7] [================71%         ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=================72%        ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=================73%        ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=================74%        ] nsys_report_db_10000_10_80.nsys-rep[1/7] [==================75%       ] nsys_report_db_10000_10_80.nsys-rep[1/7] [==================76%       ] nsys_report_db_10000_10_80.nsys-rep[1/7] [==================77%       ] nsys_report_db_10000_10_80.nsys-rep[1/7] [==================78%       ] nsys_report_db_10000_10_80.nsys-rep[1/7] [===================79%      ] nsys_report_db_10000_10_80.nsys-rep[1/7] [===================80%      ] nsys_report_db_10000_10_80.nsys-rep[1/7] [===================81%      ] nsys_report_db_10000_10_80.nsys-rep[1/7] [===================82%      ] nsys_report_db_10000_10_80.nsys-rep[1/7] [====================83%     ] nsys_report_db_10000_10_80.nsys-rep[1/7] [====================84%     ] nsys_report_db_10000_10_80.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_10_80.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_10_80.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_10_80.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_10_80.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_10_80.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_10_80.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_80.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [1%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [2%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [3%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [4%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [5%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [6%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [7%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [8%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [9%                          ] nsys_report_db_10000_10_80.sqlite[2/7] [10%                         ] nsys_report_db_10000_10_80.sqlite[2/7] [11%                         ] nsys_report_db_10000_10_80.sqlite[2/7] [12%                         ] nsys_report_db_10000_10_80.sqlite[2/7] [13%                         ] nsys_report_db_10000_10_80.sqlite[2/7] [14%                         ] nsys_report_db_10000_10_80.sqlite[2/7] [=15%                        ] nsys_report_db_10000_10_80.sqlite[2/7] [=16%                        ] nsys_report_db_10000_10_80.sqlite[2/7] [=17%                        ] nsys_report_db_10000_10_80.sqlite[2/7] [==18%                       ] nsys_report_db_10000_10_80.sqlite[2/7] [==19%                       ] nsys_report_db_10000_10_80.sqlite[2/7] [==20%                       ] nsys_report_db_10000_10_80.sqlite[2/7] [==21%                       ] nsys_report_db_10000_10_80.sqlite[2/7] [===22%                      ] nsys_report_db_10000_10_80.sqlite[2/7] [===23%                      ] nsys_report_db_10000_10_80.sqlite[2/7] [===24%                      ] nsys_report_db_10000_10_80.sqlite[2/7] [====25%                     ] nsys_report_db_10000_10_80.sqlite[2/7] [====26%                     ] nsys_report_db_10000_10_80.sqlite[2/7] [====27%                     ] nsys_report_db_10000_10_80.sqlite[2/7] [====28%                     ] nsys_report_db_10000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_10_80.sqlite[2/7] [======33%                   ] nsys_report_db_10000_10_80.sqlite[2/7] [======34%                   ] nsys_report_db_10000_10_80.sqlite[2/7] [======35%                   ] nsys_report_db_10000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_10_80.sqlite[2/7] [========40%                 ] nsys_report_db_10000_10_80.sqlite[2/7] [========41%                 ] nsys_report_db_10000_10_80.sqlite[2/7] [========42%                 ] nsys_report_db_10000_10_80.sqlite[2/7] [=========43%                ] nsys_report_db_10000_10_80.sqlite[2/7] [=========44%                ] nsys_report_db_10000_10_80.sqlite[2/7] [=========45%                ] nsys_report_db_10000_10_80.sqlite[2/7] [=========46%                ] nsys_report_db_10000_10_80.sqlite[2/7] [==========47%               ] nsys_report_db_10000_10_80.sqlite[2/7] [==========48%               ] nsys_report_db_10000_10_80.sqlite[2/7] [==========49%               ] nsys_report_db_10000_10_80.sqlite[2/7] [===========50%              ] nsys_report_db_10000_10_80.sqlite[2/7] [===========51%              ] nsys_report_db_10000_10_80.sqlite[2/7] [===========52%              ] nsys_report_db_10000_10_80.sqlite[2/7] [===========53%              ] nsys_report_db_10000_10_80.sqlite[2/7] [============54%             ] nsys_report_db_10000_10_80.sqlite[2/7] [============55%             ] nsys_report_db_10000_10_80.sqlite[2/7] [============56%             ] nsys_report_db_10000_10_80.sqlite[2/7] [============57%             ] nsys_report_db_10000_10_80.sqlite[2/7] [=============58%            ] nsys_report_db_10000_10_80.sqlite[2/7] [=============59%            ] nsys_report_db_10000_10_80.sqlite[2/7] [=============60%            ] nsys_report_db_10000_10_80.sqlite[2/7] [==============61%           ] nsys_report_db_10000_10_80.sqlite[2/7] [==============62%           ] nsys_report_db_10000_10_80.sqlite[2/7] [==============63%           ] nsys_report_db_10000_10_80.sqlite[2/7] [==============64%           ] nsys_report_db_10000_10_80.sqlite[2/7] [===============65%          ] nsys_report_db_10000_10_80.sqlite[2/7] [===============66%          ] nsys_report_db_10000_10_80.sqlite[2/7] [===============67%          ] nsys_report_db_10000_10_80.sqlite[2/7] [================68%         ] nsys_report_db_10000_10_80.sqlite[2/7] [================69%         ] nsys_report_db_10000_10_80.sqlite[2/7] [================70%         ] nsys_report_db_10000_10_80.sqlite[2/7] [================71%         ] nsys_report_db_10000_10_80.sqlite[2/7] [=================72%        ] nsys_report_db_10000_10_80.sqlite[2/7] [=================73%        ] nsys_report_db_10000_10_80.sqlite[2/7] [=================74%        ] nsys_report_db_10000_10_80.sqlite[2/7] [==================75%       ] nsys_report_db_10000_10_80.sqlite[2/7] [==================76%       ] nsys_report_db_10000_10_80.sqlite[2/7] [==================77%       ] nsys_report_db_10000_10_80.sqlite[2/7] [==================78%       ] nsys_report_db_10000_10_80.sqlite[2/7] [===================79%      ] nsys_report_db_10000_10_80.sqlite[2/7] [===================80%      ] nsys_report_db_10000_10_80.sqlite[2/7] [===================81%      ] nsys_report_db_10000_10_80.sqlite[2/7] [===================82%      ] nsys_report_db_10000_10_80.sqlite[2/7] [====================83%     ] nsys_report_db_10000_10_80.sqlite[2/7] [====================84%     ] nsys_report_db_10000_10_80.sqlite[2/7] [====================85%     ] nsys_report_db_10000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_10_80.sqlite[2/7] [======================90%   ] nsys_report_db_10000_10_80.sqlite[2/7] [======================91%   ] nsys_report_db_10000_10_80.sqlite[2/7] [======================92%   ] nsys_report_db_10000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_10_80.sqlite[2/7] [========================97% ] nsys_report_db_10000_10_80.sqlite[2/7] [========================98% ] nsys_report_db_10000_10_80.sqlite[2/7] [========================99% ] nsys_report_db_10000_10_80.sqlite[2/7] [========================100%] nsys_report_db_10000_10_80.sqlite[2/7] [========================100%] nsys_report_db_10000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        306406331          1  306406331.0  306406331.0  306406331  306406331          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     51.0      16805148785          1  16805148785.0  16805148785.0  16805148785  16805148785          0.0  cudaHostAlloc                     
     23.1       7623541762         24    317647573.4        15375.0         6440   1093443034  505583925.6  cudaMemcpyAsync                   
     22.0       7241217088          1   7241217088.0   7241217088.0   7241217088   7241217088          0.0  cudaFreeHost                      
      2.5        823385374         80     10292317.2          300.0          280    823342952   92052480.4  cuKernelGetFunction               
      0.6        195957547          8     24494693.4      2332834.5        30260    181326054   63404685.9  cudaFree                          
      0.4        132172321          2     66086160.5     66086160.5     53543410     78628911   17738127.9  cudaMemcpy                        
      0.4        121269567          1    121269567.0    121269567.0    121269567    121269567          0.0  cudaDeviceReset                   
      0.0          4060989         15       270732.6       282023.0       119561       443064     107001.7  cuLibraryLoadData                 
      0.0          1436315          7       205187.9       131872.0         3850       478925     193574.7  cudaMalloc                        
      0.0          1171512         10       117151.2         3450.0         2580      1140062     359414.7  cudaStreamSynchronize             
      0.0           572092        192         2979.6         2810.0          520        18510       1509.6  cudaEventRecord                   
      0.0           538419         24        22434.1         8030.0         4380       261273      51519.1  cudaLaunchKernel                  
      0.0           404518         80         5056.5         4305.0         3570        32850       3436.6  cuLaunchKernel                    
      0.0           254031        814          312.1          280.0          120         1200        152.3  cuGetProcAddress_v2               
      0.0           140402        176          797.7          595.0          490         8760        896.4  cudaEventCreate                   
      0.0           135913        196          693.4          480.0          340        19030       1433.9  cudaEventDestroy                  
      0.0            39431          2        19715.5        19715.5         2390        37041      24502.0  cudaStreamCreateWithFlags         
      0.0            38860         20         1943.0          540.0          420        14810       4040.1  cudaEventCreateWithFlags          
      0.0            37250          4         9312.5         5105.0         1490        25550      11172.3  cudaDeviceSynchronize             
      0.0            36430         40          910.8          420.0          300         3150       1057.5  cudaStreamGetCaptureInfo_v2_v11030
      0.0            19680          8         2460.0         2400.0         1960         3030        435.7  cudaStreamWaitEvent               
      0.0            17410          2         8705.0         8705.0         4490        12920       5960.9  cudaStreamDestroy                 
      0.0            15410         16          963.1          570.0          530         5730       1292.6  cuLibraryGetKernel                
      0.0             5010          1         5010.0         5010.0         5010         5010          0.0  cudaEventQuery                    
      0.0             4050          3         1350.0         1410.0          610         2030        711.9  cuInit                            
      0.0             3320          3         1106.7          260.0          160         2900       1553.9  cuModuleGetLoadingMode            
      0.0             1050          2          525.0          525.0          290          760        332.3  cudaGetDriverEntryPoint_v11030    
      0.0             1050          1         1050.0         1050.0         1050         1050          0.0  cuCtxSynchronize                  

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8       8683953829         80  108549422.9  108584188.0  105083003  109792668     782826.7  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          9197955          8    1149744.4    1152712.0    1140105    1153288       5732.2  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          5366950         16     335434.4     333954.0      16416     657285     329191.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     97.5       3106205131     17  182717948.9  53373715.0      1600  434929259  196717481.7  [CUDA memcpy Host-to-Device]
      2.5         78439391      9    8715487.9      1952.0      1951   78422049   26139960.4  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  64800.083     17  3811.770   800.000     0.010  8000.000     4074.594  [CUDA memcpy Host-to-Device]
    800.000      9    88.889     0.000     0.000   800.000      266.667  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 10 (num_steps = 80), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  29.98 GB
Used GPU Memory:  9.52 GB
------------------------

Process RSS:  62.61 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 1.569986 ms
t_alloc_cpu = 16865.091801 ms
t_init      = 4209.835052 ms
t_h2d       = 3165.782612 ms
t_d2h       = 155.401945 ms
t_gemm      = 9033.085892 ms
t_end_2_end = 38178.782940 ms
Generating '/tmp/nsys-report-fdad.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [13%                         ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [====26%                     ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_10000_10_80.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_80.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [1%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [2%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [3%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [4%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [5%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [6%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [7%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [8%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [9%                          ] nsys_report_fo_10000_10_80.sqlite[2/7] [10%                         ] nsys_report_fo_10000_10_80.sqlite[2/7] [11%                         ] nsys_report_fo_10000_10_80.sqlite[2/7] [12%                         ] nsys_report_fo_10000_10_80.sqlite[2/7] [13%                         ] nsys_report_fo_10000_10_80.sqlite[2/7] [14%                         ] nsys_report_fo_10000_10_80.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_10_80.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_10_80.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_10_80.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_10_80.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_10_80.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_10_80.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_10_80.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_10_80.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_10_80.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_10_80.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_10_80.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_10_80.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_10_80.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_10_80.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_10_80.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_10_80.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_10_80.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_10_80.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_10_80.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_10_80.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_10_80.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_10_80.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_10_80.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_10_80.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_10_80.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_10_80.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_10_80.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_10_80.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_10_80.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_10_80.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_10_80.sqlite[2/7] [============54%             ] nsys_report_fo_10000_10_80.sqlite[2/7] [============55%             ] nsys_report_fo_10000_10_80.sqlite[2/7] [============56%             ] nsys_report_fo_10000_10_80.sqlite[2/7] [============57%             ] nsys_report_fo_10000_10_80.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_10_80.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_10_80.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_10_80.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_10_80.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_10_80.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_10_80.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_10_80.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_10_80.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_10_80.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_10_80.sqlite[2/7] [================68%         ] nsys_report_fo_10000_10_80.sqlite[2/7] [================69%         ] nsys_report_fo_10000_10_80.sqlite[2/7] [================70%         ] nsys_report_fo_10000_10_80.sqlite[2/7] [================71%         ] nsys_report_fo_10000_10_80.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_10_80.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_10_80.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_10_80.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_10_80.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_10_80.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_10_80.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_10_80.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_10_80.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_10_80.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_10_80.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_10_80.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_10_80.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_10_80.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_10_80.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_10_80.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_10_80.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_10_80.sqlite[2/7] [========================97% ] nsys_report_fo_10000_10_80.sqlite[2/7] [========================98% ] nsys_report_fo_10000_10_80.sqlite[2/7] [========================99% ] nsys_report_fo_10000_10_80.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_80.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        298551395          1  298551395.0  298551395.0  298551395  298551395          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     50.1      16865087124          1  16865087124.0  16865087124.0  16865087124  16865087124          0.0  cudaHostAlloc                     
     25.9       8702760547        240     36261502.3         9645.0         3470    111583721   51859131.8  cudaMemcpyAsync                   
     21.5       7238864478          1   7238864478.0   7238864478.0   7238864478   7238864478          0.0  cudaFreeHost                      
      1.1        386586469         80      4832330.9          555.0          410    386519179   43214062.7  cuKernelGetFunction               
      0.5        181940710         16     11371294.4       458680.0        53200    175385701   43737496.7  cudaFree                          
      0.4        130984285          2     65492142.5     65492142.5     53294790     77689495   17249661.3  cudaMemcpy                        
      0.4        120198332          1    120198332.0    120198332.0    120198332    120198332          0.0  cudaDeviceReset                   
      0.0          3996362         15       266424.1       280383.0       119651       435724     103361.2  cuLibraryLoadData                 
      0.0          1741348         15       116089.9       127741.0         4000       144861      35925.6  cudaMalloc                        
      0.0          1736434        240         7235.1         4680.0         4100       246253      15906.0  cudaLaunchKernel                  
      0.0          1345604         82        16409.8         2460.0         1910      1143262     125976.7  cudaStreamSynchronize             
      0.0          1225490        560         2188.4         2630.0          520        14280       1418.5  cudaEventRecord                   
      0.0           469503         80         5868.8         4960.5         4280        33820       3363.8  cuLaunchKernel                    
      0.0           249234        814          306.2          290.0          130         1050        136.9  cuGetProcAddress_v2               
      0.0           242083        320          756.5          610.0          490         9110        713.9  cudaEventCreate                   
      0.0           189373        400          473.4          380.0          280         5610        432.3  cudaStreamGetCaptureInfo_v2_v11030
      0.0           146890        150          979.3          870.0          620         3890        470.6  cudaStreamWaitEvent               
      0.0            77671          1        77671.0        77671.0        77671        77671          0.0  cudaMemGetInfo                    
      0.0            50360         38         1325.3          555.0          410        13220       2611.2  cudaEventCreateWithFlags          
      0.0            47271          2        23635.5        23635.5         2040        45231      30540.6  cudaStreamCreateWithFlags         
      0.0            37401          4         9350.3         3355.0         1360        29331      13363.4  cudaDeviceSynchronize             
      0.0            29510         38          776.6          555.0          340         4350        765.4  cudaEventDestroy                  
      0.0            20670          2        10335.0        10335.0         5350        15320       7049.9  cudaStreamDestroy                 
      0.0            10390         16          649.4          590.0          510         1300        205.0  cuLibraryGetKernel                
      0.0             4950          1         4950.0         4950.0         4950         4950          0.0  cudaEventQuery                    
      0.0             4020          3         1340.0         1360.0          590         2070        740.2  cuInit                            
      0.0             3370          3         1123.3          260.0          150         2960       1591.6  cuModuleGetLoadingMode            
      0.0             1340          1         1340.0         1340.0         1340         1340          0.0  cuCtxSynchronize                  
      0.0              910          2          455.0          455.0          320          590        190.9  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       8667097027         80  108338712.8  108333066.5  105979942  109804283     686870.8  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         92018611         80    1150232.6    1152457.0    1139400    1154505       4308.4  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         51877076        160     324231.7     321186.5      12544     641829     312390.5  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     97.6       3164975302    161  19658231.7  31885799.0      1568  54363551   20542080.8  [CUDA memcpy Host-to-Device]
      2.4         77668477     81    958870.1      1952.0      1920  77509504    8611946.3  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  64800.830    161   402.490   800.000     0.010   800.000      401.235  [CUDA memcpy Host-to-Device]
    800.001     81     9.877     0.000     0.000   800.000       88.889  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 10 (num_steps = 100)
number of batches= 10
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 10808.447395 ms
t_h2d = 3810.328787 ms
t_gpu_alloc = 1.264095 ms
t_cpu_alloc = 20836.822987 ms
t_init = 5243.400097 ms
t_d2h = 156.096935 ms
t_end_2_end = 50245.831966 ms
Generating '/tmp/nsys-report-19f1.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [======35%                   ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [===========51%              ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [===============66%          ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [===============67%          ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [================68%         ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [================69%         ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [================70%         ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [================71%         ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=================72%        ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=================73%        ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=================74%        ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [==================75%       ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [==================76%       ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [==================77%       ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [==================78%       ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [===================79%      ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [===================80%      ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [===================81%      ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_10_100.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_100.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [1%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [2%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [3%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [4%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [5%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [6%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [7%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [8%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [9%                          ] nsys_report_ia_10000_10_100.sqlite[2/7] [10%                         ] nsys_report_ia_10000_10_100.sqlite[2/7] [11%                         ] nsys_report_ia_10000_10_100.sqlite[2/7] [12%                         ] nsys_report_ia_10000_10_100.sqlite[2/7] [13%                         ] nsys_report_ia_10000_10_100.sqlite[2/7] [14%                         ] nsys_report_ia_10000_10_100.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_10_100.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_10_100.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_10_100.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_10_100.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_10_100.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_10_100.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_10_100.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_10_100.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_10_100.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_10_100.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_10_100.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_10_100.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_10_100.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_10_100.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_10_100.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_10_100.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_10_100.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_10_100.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_10_100.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_10_100.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_10_100.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_10_100.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_10_100.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_10_100.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_10_100.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_10_100.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_10_100.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_10_100.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_10_100.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_10_100.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_10_100.sqlite[2/7] [============54%             ] nsys_report_ia_10000_10_100.sqlite[2/7] [============55%             ] nsys_report_ia_10000_10_100.sqlite[2/7] [============56%             ] nsys_report_ia_10000_10_100.sqlite[2/7] [============57%             ] nsys_report_ia_10000_10_100.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_10_100.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_10_100.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_10_100.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_10_100.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_10_100.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_10_100.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_10_100.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_10_100.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_10_100.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_10_100.sqlite[2/7] [================68%         ] nsys_report_ia_10000_10_100.sqlite[2/7] [================69%         ] nsys_report_ia_10000_10_100.sqlite[2/7] [================70%         ] nsys_report_ia_10000_10_100.sqlite[2/7] [================71%         ] nsys_report_ia_10000_10_100.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_10_100.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_10_100.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_10_100.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_10_100.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_10_100.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_10_100.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_10_100.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_10_100.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_10_100.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_10_100.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_10_100.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_10_100.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_10_100.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_10_100.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_10_100.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_10_100.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_10_100.sqlite[2/7] [========================97% ] nsys_report_ia_10000_10_100.sqlite[2/7] [========================98% ] nsys_report_ia_10000_10_100.sqlite[2/7] [========================99% ] nsys_report_ia_10000_10_100.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_100.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        307433985          1  307433985.0  307433985.0  307433985  307433985          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     47.7      20836817538          1  20836817538.0  20836817538.0  20836817538  20836817538          0.0  cudaHostAlloc                     
     29.9      13082972918         30    436099097.3        16005.5         6400   1522772933  677953132.2  cudaMemcpyAsync                   
     20.4       8932073907          1   8932073907.0   8932073907.0   8932073907   8932073907          0.0  cudaFreeHost                      
      0.9        398568426        100      3985684.3          310.0          280    398517776   39851726.4  cuKernelGetFunction               
      0.4        194645814          8     24330726.8      1728578.0        30031    182614887   63978602.7  cudaFree                          
      0.3        132034883          2     66017441.5     66017441.5     54378714     77656169   16459646.3  cudaMemcpy                        
      0.3        121441572          1    121441572.0    121441572.0    121441572    121441572          0.0  cudaDeviceReset                   
      0.0          3977912         15       265194.1       279153.0       118071       427634     103458.0  cuLibraryLoadData                 
      0.0          1439406          7       205629.4       124362.0         3780       494965     194090.7  cudaMalloc                        
      0.0          1177912         12        98159.3         3550.0         2900      1139562     327957.1  cudaStreamSynchronize             
      0.0           890080        240         3708.7         2750.0          510       181152      11599.5  cudaEventRecord                   
      0.0           613538         30        20451.3         8590.0         4340       259773      45916.9  cudaLaunchKernel                  
      0.0           514395        100         5144.0         4380.0         3670        29791       2930.9  cuLaunchKernel                    
      0.0           268233        814          329.5          290.0          120         1250        163.8  cuGetProcAddress_v2               
      0.0           158851        220          722.1          590.0          480         9911        765.5  cudaEventCreate                   
      0.0           124392        240          518.3          370.0          330        17021       1156.0  cudaEventDestroy                  
      0.0            50941         50         1018.8          395.0          280         7680       1408.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0            44700          2        22350.0        22350.0         1890        42810      28934.8  cudaStreamCreateWithFlags         
      0.0            42321         20         2116.1          495.0          380        13370       3812.3  cudaEventCreateWithFlags          
      0.0            33800          4         8450.0         2845.0         1330        26780      12244.5  cudaDeviceSynchronize             
      0.0            18430          2         9215.0         9215.0         4620        13810       6498.3  cudaStreamDestroy                 
      0.0            17251         10         1725.1         1325.0         1050         4161        958.4  cudaStreamWaitEvent               
      0.0            11740         16          733.8          615.0          490         2070        399.6  cuLibraryGetKernel                
      0.0             5550          1         5550.0         5550.0         5550         5550          0.0  cudaEventQuery                    
      0.0             4600          3         1533.3         1570.0          720         2310        795.6  cuInit                            
      0.0             3760          3         1253.3          270.0          270         3220       1703.2  cuModuleGetLoadingMode            
      0.0             1120          1         1120.0         1120.0         1120         1120          0.0  cuCtxSynchronize                  
      0.0              820          2          410.0          410.0          300          520        155.6  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8      10807711828        100  108077118.3  108313728.5  104778014  110099950    1173056.3  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1         11508981         10    1150898.1    1152552.5    1139784    1153993       4244.4  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          6716209         20     335810.5     333298.5      16415     659077     327455.3  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     98.0       3809866221     21  181422201.0  54084826.0      1568  438870014  192764945.2  [CUDA memcpy Host-to-Device]
      2.0         77482536     11    7043866.9      1952.0      1920   77461192   23354784.6  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  80800.104     21  3847.624   800.000     0.010  8000.000     4060.490  [CUDA memcpy Host-to-Device]
    800.000     11    72.727     0.000     0.000   800.000      241.209  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 10 (num_steps = 100)
number of batches= 10
t_gemm = 11201.222588 ms
t_h2d = 3775.337328 ms
t_d2h = 157.140017 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.935793 ms
t_cpu_alloc = 20835.031986 ms
t_init = 5287.021875 ms
t_end_2_end = 47289.134026 ms
Generating '/tmp/nsys-report-7f6f.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_10_100.nsys-rep[1/7] [==18%                       ] nsys_report_db_10000_10_100.nsys-rep[1/7] [======35%                   ] nsys_report_db_10000_10_100.nsys-rep[1/7] [==================75%       ] nsys_report_db_10000_10_100.nsys-rep[1/7] [==================76%       ] nsys_report_db_10000_10_100.nsys-rep[1/7] [==================77%       ] nsys_report_db_10000_10_100.nsys-rep[1/7] [==================78%       ] nsys_report_db_10000_10_100.nsys-rep[1/7] [===================79%      ] nsys_report_db_10000_10_100.nsys-rep[1/7] [===================80%      ] nsys_report_db_10000_10_100.nsys-rep[1/7] [===================81%      ] nsys_report_db_10000_10_100.nsys-rep[1/7] [===================82%      ] nsys_report_db_10000_10_100.nsys-rep[1/7] [====================83%     ] nsys_report_db_10000_10_100.nsys-rep[1/7] [====================84%     ] nsys_report_db_10000_10_100.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_10_100.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_10_100.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_10_100.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_10_100.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_10_100.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_10_100.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_10_100.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_10_100.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_10_100.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_10_100.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_10_100.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_10_100.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_10_100.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_100.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [1%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [2%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [3%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [4%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [5%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [6%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [7%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [8%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [9%                          ] nsys_report_db_10000_10_100.sqlite[2/7] [10%                         ] nsys_report_db_10000_10_100.sqlite[2/7] [11%                         ] nsys_report_db_10000_10_100.sqlite[2/7] [12%                         ] nsys_report_db_10000_10_100.sqlite[2/7] [13%                         ] nsys_report_db_10000_10_100.sqlite[2/7] [14%                         ] nsys_report_db_10000_10_100.sqlite[2/7] [=15%                        ] nsys_report_db_10000_10_100.sqlite[2/7] [=16%                        ] nsys_report_db_10000_10_100.sqlite[2/7] [=17%                        ] nsys_report_db_10000_10_100.sqlite[2/7] [==18%                       ] nsys_report_db_10000_10_100.sqlite[2/7] [==19%                       ] nsys_report_db_10000_10_100.sqlite[2/7] [==20%                       ] nsys_report_db_10000_10_100.sqlite[2/7] [==21%                       ] nsys_report_db_10000_10_100.sqlite[2/7] [===22%                      ] nsys_report_db_10000_10_100.sqlite[2/7] [===23%                      ] nsys_report_db_10000_10_100.sqlite[2/7] [===24%                      ] nsys_report_db_10000_10_100.sqlite[2/7] [====25%                     ] nsys_report_db_10000_10_100.sqlite[2/7] [====26%                     ] nsys_report_db_10000_10_100.sqlite[2/7] [====27%                     ] nsys_report_db_10000_10_100.sqlite[2/7] [====28%                     ] nsys_report_db_10000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_10_100.sqlite[2/7] [======33%                   ] nsys_report_db_10000_10_100.sqlite[2/7] [======34%                   ] nsys_report_db_10000_10_100.sqlite[2/7] [======35%                   ] nsys_report_db_10000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_10_100.sqlite[2/7] [========40%                 ] nsys_report_db_10000_10_100.sqlite[2/7] [========41%                 ] nsys_report_db_10000_10_100.sqlite[2/7] [========42%                 ] nsys_report_db_10000_10_100.sqlite[2/7] [=========43%                ] nsys_report_db_10000_10_100.sqlite[2/7] [=========44%                ] nsys_report_db_10000_10_100.sqlite[2/7] [=========45%                ] nsys_report_db_10000_10_100.sqlite[2/7] [=========46%                ] nsys_report_db_10000_10_100.sqlite[2/7] [==========47%               ] nsys_report_db_10000_10_100.sqlite[2/7] [==========48%               ] nsys_report_db_10000_10_100.sqlite[2/7] [==========49%               ] nsys_report_db_10000_10_100.sqlite[2/7] [===========50%              ] nsys_report_db_10000_10_100.sqlite[2/7] [===========51%              ] nsys_report_db_10000_10_100.sqlite[2/7] [===========52%              ] nsys_report_db_10000_10_100.sqlite[2/7] [===========53%              ] nsys_report_db_10000_10_100.sqlite[2/7] [============54%             ] nsys_report_db_10000_10_100.sqlite[2/7] [============55%             ] nsys_report_db_10000_10_100.sqlite[2/7] [============56%             ] nsys_report_db_10000_10_100.sqlite[2/7] [============57%             ] nsys_report_db_10000_10_100.sqlite[2/7] [=============58%            ] nsys_report_db_10000_10_100.sqlite[2/7] [=============59%            ] nsys_report_db_10000_10_100.sqlite[2/7] [=============60%            ] nsys_report_db_10000_10_100.sqlite[2/7] [==============61%           ] nsys_report_db_10000_10_100.sqlite[2/7] [==============62%           ] nsys_report_db_10000_10_100.sqlite[2/7] [==============63%           ] nsys_report_db_10000_10_100.sqlite[2/7] [==============64%           ] nsys_report_db_10000_10_100.sqlite[2/7] [===============65%          ] nsys_report_db_10000_10_100.sqlite[2/7] [===============66%          ] nsys_report_db_10000_10_100.sqlite[2/7] [===============67%          ] nsys_report_db_10000_10_100.sqlite[2/7] [================68%         ] nsys_report_db_10000_10_100.sqlite[2/7] [================69%         ] nsys_report_db_10000_10_100.sqlite[2/7] [================70%         ] nsys_report_db_10000_10_100.sqlite[2/7] [================71%         ] nsys_report_db_10000_10_100.sqlite[2/7] [=================72%        ] nsys_report_db_10000_10_100.sqlite[2/7] [=================73%        ] nsys_report_db_10000_10_100.sqlite[2/7] [=================74%        ] nsys_report_db_10000_10_100.sqlite[2/7] [==================75%       ] nsys_report_db_10000_10_100.sqlite[2/7] [==================76%       ] nsys_report_db_10000_10_100.sqlite[2/7] [==================77%       ] nsys_report_db_10000_10_100.sqlite[2/7] [==================78%       ] nsys_report_db_10000_10_100.sqlite[2/7] [===================79%      ] nsys_report_db_10000_10_100.sqlite[2/7] [===================80%      ] nsys_report_db_10000_10_100.sqlite[2/7] [===================81%      ] nsys_report_db_10000_10_100.sqlite[2/7] [===================82%      ] nsys_report_db_10000_10_100.sqlite[2/7] [====================83%     ] nsys_report_db_10000_10_100.sqlite[2/7] [====================84%     ] nsys_report_db_10000_10_100.sqlite[2/7] [====================85%     ] nsys_report_db_10000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_10_100.sqlite[2/7] [======================90%   ] nsys_report_db_10000_10_100.sqlite[2/7] [======================91%   ] nsys_report_db_10000_10_100.sqlite[2/7] [======================92%   ] nsys_report_db_10000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_10_100.sqlite[2/7] [========================97% ] nsys_report_db_10000_10_100.sqlite[2/7] [========================98% ] nsys_report_db_10000_10_100.sqlite[2/7] [========================99% ] nsys_report_db_10000_10_100.sqlite[2/7] [========================100%] nsys_report_db_10000_10_100.sqlite[2/7] [========================100%] nsys_report_db_10000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        278501455          1  278501455.0  278501455.0  278501455  278501455          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     51.2      20835026226          1  20835026226.0  20835026226.0  20835026226  20835026226          0.0  cudaHostAlloc                     
     24.1       9807121775         30    326904059.2        14365.0         6300   1093747154  507824676.6  cudaMemcpyAsync                   
     21.9       8905670733          1   8905670733.0   8905670733.0   8905670733   8905670733          0.0  cudaFreeHost                      
      1.8        726734079        100      7267340.8          310.0          280    726683539   72668302.9  cuKernelGetFunction               
      0.4        168308875          8     21038609.4      1773078.5        54461    156157596   54622441.8  cudaFree                          
      0.3        132203382          2     66101691.0     66101691.0     53850161     78353221   17326279.9  cudaMemcpy                        
      0.3        120819112          1    120819112.0    120819112.0    120819112    120819112          0.0  cudaDeviceReset                   
      0.0          3998232         15       266548.8       281583.0       119262       434644     103196.8  cuLibraryLoadData                 
      0.0          1403675          7       200525.0       121861.0         3380       474095     188908.1  cudaMalloc                        
      0.0          1176532         12        98044.3         3195.0         2110      1140402     328258.1  cudaStreamSynchronize             
      0.0           702715        240         2928.0         2740.0          520        22150       1549.9  cudaEventRecord                   
      0.0           613639         30        20454.6         9785.5         4340       257683      45478.4  cudaLaunchKernel                  
      0.0           523186        100         5231.9         4430.0         3760        32220       3133.4  cuLaunchKernel                    
      0.0           260250        814          319.7          290.0          120         1320        158.3  cuGetProcAddress_v2               
      0.0           166242        220          755.6          560.0          470        10810        963.9  cudaEventCreate                   
      0.0           137632        240          573.5          440.0          340        20411       1425.6  cudaEventDestroy                  
      0.0            47681         50          953.6          330.0          280         7420       1349.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0            43640          2        21820.0        21820.0         1870        41770      28213.6  cudaStreamCreateWithFlags         
      0.0            42340         20         2117.0          500.0          380        21280       4981.5  cudaEventCreateWithFlags          
      0.0            36390          4         9097.5         3160.0         1450        28620      13058.8  cudaDeviceSynchronize             
      0.0            23850         10         2385.0         2270.0         1760         3490        536.7  cudaStreamWaitEvent               
      0.0            18330          2         9165.0         9165.0         5000        13330       5890.2  cudaStreamDestroy                 
      0.0            10870         16          679.4          625.0          520         1450        238.3  cuLibraryGetKernel                
      0.0             5210          1         5210.0         5210.0         5210         5210          0.0  cudaEventQuery                    
      0.0             4190          3         1396.7         1590.0          630         1970        690.6  cuInit                            
      0.0             3050          3         1016.7          260.0          170         2620       1389.3  cuModuleGetLoadingMode            
      0.0             1090          1         1090.0         1090.0         1090         1090          0.0  cuCtxSynchronize                  
      0.0              890          2          445.0          445.0          320          570        176.8  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8      10864750929        100  108647509.3  108686364.5  105467371  110116193     861340.2  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1         11501013         10    1150101.3    1152792.0    1140265    1154089       5302.2  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1          6704207         20     335210.4     333730.5      16256     657349     326885.9  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     98.0       3774887211     21  179756533.9  53549979.0      1600  436950025  191149869.9  [CUDA memcpy Host-to-Device]
      2.0         78176177     11    7106925.2      1952.0      1951   78154898   23563946.8  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  80800.104     21  3847.624   800.000     0.010  8000.000     4060.490  [CUDA memcpy Host-to-Device]
    800.000     11    72.727     0.000     0.000   800.000      241.209  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 10 (num_steps = 100), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  29.95 GB
Used GPU Memory:  9.55 GB
------------------------

Process RSS:  77.51 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 1.574039 ms
t_alloc_cpu = 20906.831980 ms
t_init      = 5271.107912 ms
t_h2d       = 3874.307331 ms
t_d2h       = 156.266928 ms
t_gemm      = 11217.122841 ms
t_end_2_end = 47141.554832 ms
Generating '/tmp/nsys-report-0445.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [11%                         ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [===22%                      ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [===23%                      ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [===24%                      ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [====25%                     ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [====26%                     ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [=======================93%  ] nsys_report_fo_10000_10_100.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_100.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [1%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [2%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [3%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [4%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [5%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [6%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [7%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [8%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [9%                          ] nsys_report_fo_10000_10_100.sqlite[2/7] [10%                         ] nsys_report_fo_10000_10_100.sqlite[2/7] [11%                         ] nsys_report_fo_10000_10_100.sqlite[2/7] [12%                         ] nsys_report_fo_10000_10_100.sqlite[2/7] [13%                         ] nsys_report_fo_10000_10_100.sqlite[2/7] [14%                         ] nsys_report_fo_10000_10_100.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_10_100.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_10_100.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_10_100.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_10_100.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_10_100.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_10_100.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_10_100.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_10_100.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_10_100.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_10_100.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_10_100.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_10_100.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_10_100.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_10_100.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_10_100.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_10_100.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_10_100.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_10_100.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_10_100.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_10_100.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_10_100.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_10_100.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_10_100.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_10_100.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_10_100.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_10_100.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_10_100.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_10_100.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_10_100.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_10_100.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_10_100.sqlite[2/7] [============54%             ] nsys_report_fo_10000_10_100.sqlite[2/7] [============55%             ] nsys_report_fo_10000_10_100.sqlite[2/7] [============56%             ] nsys_report_fo_10000_10_100.sqlite[2/7] [============57%             ] nsys_report_fo_10000_10_100.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_10_100.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_10_100.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_10_100.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_10_100.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_10_100.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_10_100.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_10_100.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_10_100.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_10_100.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_10_100.sqlite[2/7] [================68%         ] nsys_report_fo_10000_10_100.sqlite[2/7] [================69%         ] nsys_report_fo_10000_10_100.sqlite[2/7] [================70%         ] nsys_report_fo_10000_10_100.sqlite[2/7] [================71%         ] nsys_report_fo_10000_10_100.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_10_100.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_10_100.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_10_100.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_10_100.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_10_100.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_10_100.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_10_100.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_10_100.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_10_100.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_10_100.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_10_100.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_10_100.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_10_100.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_10_100.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_10_100.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_10_100.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_10_100.sqlite[2/7] [========================97% ] nsys_report_fo_10000_10_100.sqlite[2/7] [========================98% ] nsys_report_fo_10000_10_100.sqlite[2/7] [========================99% ] nsys_report_fo_10000_10_100.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_100.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        298342440          1  298342440.0  298342440.0  298342440  298342440          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     50.3      20906827312          1  20906827312.0  20906827312.0  20906827312  20906827312          0.0  cudaHostAlloc                     
     26.3      10921786264        300     36405954.2         9580.0         3400    111904492   51947260.8  cudaMemcpyAsync                   
     21.4       8875908409          1   8875908409.0   8875908409.0   8875908409   8875908409          0.0  cudaFreeHost                      
      0.9        388295548        100      3882955.5          630.0          440    388192887   38819185.0  cuKernelGetFunction               
      0.4        173446709         16     10840419.3       458750.0        30320    167456465   41764569.3  cudaFree                          
      0.3        131194339          2     65597169.5     65597169.5     52969365     78224974   17858412.4  cudaMemcpy                        
      0.3        120600895          1    120600895.0    120600895.0    120600895    120600895          0.0  cudaDeviceReset                   
      0.0          3958094         15       263872.9       274553.0       117691       435505     102517.2  cuLibraryLoadData                 
      0.0          2179099        300         7263.7         4715.0         4160       241533      14101.1  cudaLaunchKernel                  
      0.0          1743289         15       116219.3       126441.0         3630       145752      36138.6  cudaMalloc                        
      0.0          1560743        700         2229.6         2595.0          510        19130       1497.3  cudaEventRecord                   
      0.0          1398507        102        13710.9         2410.0         2050      1144312     113055.1  cudaStreamSynchronize             
      0.0           605764        100         6057.6         5270.5         4430        30070       2777.2  cuLaunchKernel                    
      0.0           288264        400          720.7          585.0          490         8850        616.7  cudaEventCreate                   
      0.0           263964        814          324.3          290.0          130         1450        157.7  cuGetProcAddress_v2               
      0.0           241433        500          482.9          330.0          280         2720        423.9  cudaStreamGetCaptureInfo_v2_v11030
      0.0           185492        190          976.3          830.0          580         4420        483.3  cudaStreamWaitEvent               
      0.0            79901          1        79901.0        79901.0        79901        79901          0.0  cudaMemGetInfo                    
      0.0            59041         38         1553.7          525.0          410        19241       3624.7  cudaEventCreateWithFlags          
      0.0            39560          2        19780.0        19780.0         2020        37540      25116.4  cudaStreamCreateWithFlags         
      0.0            29010         38          763.4          545.0          340         4450        768.0  cudaEventDestroy                  
      0.0            28480          4         7120.0         3225.0         1370        20660       9077.6  cudaDeviceSynchronize             
      0.0            19620          2         9810.0         9810.0         5960        13660       5444.7  cudaStreamDestroy                 
      0.0            17100         16         1068.8          620.0          490         6100       1401.7  cuLibraryGetKernel                
      0.0             5480          1         5480.0         5480.0         5480         5480          0.0  cudaEventQuery                    
      0.0             3990          3         1330.0         1150.0          630         2210        805.2  cuInit                            
      0.0             3440          3         1146.7          270.0          260         2910       1527.1  cuModuleGetLoadingMode            
      0.0             1250          1         1250.0         1250.0         1250         1250          0.0  cuCtxSynchronize                  
      0.0             1000          2          500.0          500.0          430          570         99.0  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4      10850191225        100  108501912.3  108594970.0  106077527  110135145     797279.4  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0        115069749        100    1150697.5    1152312.0    1139561    1155689       3933.4  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         64822296        200     324111.5     321250.5      12512     641892     312067.4  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     98.0       3873352470    201  19270410.3  31858089.0      1567  54308581   20035560.0  [CUDA memcpy Host-to-Device]
      2.0         78214840    101    774404.4      1952.0      1920  78016532    7762737.8  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  80801.038    201   401.995   800.000     0.010   800.000      400.989  [CUDA memcpy Host-to-Device]
    800.001    101     7.921     0.000     0.000   800.000       79.603  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 10 (num_steps = 150)
number of batches= 15
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 16245.280762 ms
t_h2d = 5816.040661 ms
t_gpu_alloc = 1.218081 ms
t_cpu_alloc = 31002.654076 ms
t_init = 9104.974031 ms
t_d2h = 156.104088 ms
t_end_2_end = 77805.446148 ms
Generating '/tmp/nsys-report-1cff.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [13%                         ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [====25%                     ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [====26%                     ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [====27%                     ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [====28%                     ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=====29%                    ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=====31%                    ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=====32%                    ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [======33%                   ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [======34%                   ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [======35%                   ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=======36%                  ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=======37%                  ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=======38%                  ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=======39%                  ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [========40%                 ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [========41%                 ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [========42%                 ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=========43%                ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=========44%                ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=========45%                ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=========46%                ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [==========47%               ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [==========48%               ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [==========49%               ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [===========50%              ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [===========51%              ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [===========52%              ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [===========53%              ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [============54%             ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [============55%             ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [============56%             ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [============57%             ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=============58%            ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=============59%            ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [=============60%            ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [==============61%           ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_10_150.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_150.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [1%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [2%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [3%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [4%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [5%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [6%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [7%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [8%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [9%                          ] nsys_report_ia_10000_10_150.sqlite[2/7] [10%                         ] nsys_report_ia_10000_10_150.sqlite[2/7] [11%                         ] nsys_report_ia_10000_10_150.sqlite[2/7] [12%                         ] nsys_report_ia_10000_10_150.sqlite[2/7] [13%                         ] nsys_report_ia_10000_10_150.sqlite[2/7] [14%                         ] nsys_report_ia_10000_10_150.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_10_150.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_10_150.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_10_150.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_10_150.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_10_150.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_10_150.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_10_150.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_10_150.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_10_150.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_10_150.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_10_150.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_10_150.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_10_150.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_10_150.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_10_150.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_10_150.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_10_150.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_10_150.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_10_150.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_10_150.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_10_150.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_10_150.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_10_150.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_10_150.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_10_150.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_10_150.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_10_150.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_10_150.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_10_150.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_10_150.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_10_150.sqlite[2/7] [============54%             ] nsys_report_ia_10000_10_150.sqlite[2/7] [============55%             ] nsys_report_ia_10000_10_150.sqlite[2/7] [============56%             ] nsys_report_ia_10000_10_150.sqlite[2/7] [============57%             ] nsys_report_ia_10000_10_150.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_10_150.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_10_150.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_10_150.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_10_150.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_10_150.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_10_150.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_10_150.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_10_150.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_10_150.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_10_150.sqlite[2/7] [================68%         ] nsys_report_ia_10000_10_150.sqlite[2/7] [================69%         ] nsys_report_ia_10000_10_150.sqlite[2/7] [================70%         ] nsys_report_ia_10000_10_150.sqlite[2/7] [================71%         ] nsys_report_ia_10000_10_150.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_10_150.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_10_150.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_10_150.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_10_150.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_10_150.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_10_150.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_10_150.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_10_150.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_10_150.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_10_150.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_10_150.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_10_150.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_10_150.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_10_150.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_10_150.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_10_150.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_10_150.sqlite[2/7] [========================97% ] nsys_report_ia_10000_10_150.sqlite[2/7] [========================98% ] nsys_report_ia_10000_10_150.sqlite[2/7] [========================99% ] nsys_report_ia_10000_10_150.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_150.sqlite[2/7] [========================100%] nsys_report_ia_10000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        280027740          1  280027740.0  280027740.0  280027740  280027740          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     46.0      31002648007          1  31002648007.0  31002648007.0  31002648007  31002648007          0.0  cudaHostAlloc                     
     30.5      20549108700         45    456646860.0        17600.0         7220   1529636177  687603073.0  cudaMemcpyAsync                   
     22.3      15046887625          1  15046887625.0  15046887625.0  15046887625  15046887625          0.0  cudaFreeHost                      
      0.6        377241362        150      2514942.4          300.0          280    377157231   30794712.9  cuKernelGetFunction               
      0.3        170819920          8     21352490.0      1766199.5        27070    158699300   55522072.4  cudaFree                          
      0.2        132026575          2     66013287.5     66013287.5     54162600     77863975   16759403.0  cudaMemcpy                        
      0.2        118310637          1    118310637.0    118310637.0    118310637    118310637          0.0  cudaDeviceReset                   
      0.0          3952011         15       263467.4       280813.0       116321       450075     104710.5  cuLibraryLoadData                 
      0.0          1400255          7       200036.4       122641.0         3930       475845     187638.3  cudaMalloc                        
      0.0          1201322         17        70666.0         4150.0         2740      1140612     275720.0  cudaStreamSynchronize             
      0.0          1085065        360         3014.1         2740.0          500        14480       1353.3  cudaEventRecord                   
      0.0           909706         45        20215.7         8230.0         4280       274143      40721.9  cudaLaunchKernel                  
      0.0           773886        150         5159.2         4305.5         3750        31220       3134.6  cuLaunchKernel                    
      0.0           267842        814          329.0          300.0          120         1340        156.7  cuGetProcAddress_v2               
      0.0           247882        330          751.2          580.0          470        10880        756.2  cudaEventCreate                   
      0.0           179891        350          514.0          460.0          320        17120        962.4  cudaEventDestroy                  
      0.0            88680         75         1182.4          420.0          280         8450       1771.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0            46970          4        11742.5         3265.0         1520        38920      18145.4  cudaDeviceSynchronize             
      0.0            44980         20         2249.0          510.0          390        21280       5227.8  cudaEventCreateWithFlags          
      0.0            34901          2        17450.5        17450.5         2060        32841      21765.5  cudaStreamCreateWithFlags         
      0.0            27371         15         1824.7         1760.0          930         3220        684.9  cudaStreamWaitEvent               
      0.0            16370          2         8185.0         8185.0         3490        12880       6639.7  cudaStreamDestroy                 
      0.0            10400         16          650.0          560.0          500         1310        220.6  cuLibraryGetKernel                
      0.0             5290          1         5290.0         5290.0         5290         5290          0.0  cudaEventQuery                    
      0.0             4290          3         1430.0         1610.0          700         1980        658.7  cuInit                            
      0.0             3650          3         1216.7          390.0          300         2960       1510.4  cuModuleGetLoadingMode            
      0.0             1130          1         1130.0         1130.0         1130         1130          0.0  cuCtxSynchronize                  
      0.0              910          2          455.0          455.0          300          610        219.2  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8      16244359437        150  108295729.6  108492520.0  105335199  110876600    1190272.0  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1         17252734         15    1150182.3    1151048.0    1140681    1153512       3390.0  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         10075368         30     335845.6     333522.5      16416     660068     324623.4  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     98.7       5815473265     31  187595911.8  53854745.0      1600  438832441  196067658.6  [CUDA memcpy Host-to-Device]
      1.3         77694403     16    4855900.2      1952.0      1951   77663363   19415323.4  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 120800.156     31  3896.779   800.000     0.010  8000.000     4041.074  [CUDA memcpy Host-to-Device]
    800.000     16    50.000     0.000     0.000   800.000      200.000  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_10_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 10 (num_steps = 150)
number of batches= 15
t_gemm = 16735.034386 ms
t_h2d = 5830.295582 ms
t_d2h = 156.810045 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 0.947952 ms
t_cpu_alloc = 31046.916008 ms
t_init = 7790.049076 ms
t_end_2_end = 71741.116047 ms
Generating '/tmp/nsys-report-ecf9.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_10_150.nsys-rep[1/7] [11%                         ] nsys_report_db_10000_10_150.nsys-rep[1/7] [===22%                      ] nsys_report_db_10000_10_150.nsys-rep[1/7] [===23%                      ] nsys_report_db_10000_10_150.nsys-rep[1/7] [===24%                      ] nsys_report_db_10000_10_150.nsys-rep[1/7] [====25%                     ] nsys_report_db_10000_10_150.nsys-rep[1/7] [====26%                     ] nsys_report_db_10000_10_150.nsys-rep[1/7] [====27%                     ] nsys_report_db_10000_10_150.nsys-rep[1/7] [====28%                     ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=====29%                    ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=====31%                    ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=====32%                    ] nsys_report_db_10000_10_150.nsys-rep[1/7] [======33%                   ] nsys_report_db_10000_10_150.nsys-rep[1/7] [======34%                   ] nsys_report_db_10000_10_150.nsys-rep[1/7] [======35%                   ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=======36%                  ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=======37%                  ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=======38%                  ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=======39%                  ] nsys_report_db_10000_10_150.nsys-rep[1/7] [========40%                 ] nsys_report_db_10000_10_150.nsys-rep[1/7] [========41%                 ] nsys_report_db_10000_10_150.nsys-rep[1/7] [========42%                 ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=========43%                ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=========44%                ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=========45%                ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=========46%                ] nsys_report_db_10000_10_150.nsys-rep[1/7] [==========47%               ] nsys_report_db_10000_10_150.nsys-rep[1/7] [==========48%               ] nsys_report_db_10000_10_150.nsys-rep[1/7] [==========49%               ] nsys_report_db_10000_10_150.nsys-rep[1/7] [===========50%              ] nsys_report_db_10000_10_150.nsys-rep[1/7] [===========51%              ] nsys_report_db_10000_10_150.nsys-rep[1/7] [===========52%              ] nsys_report_db_10000_10_150.nsys-rep[1/7] [===========53%              ] nsys_report_db_10000_10_150.nsys-rep[1/7] [============54%             ] nsys_report_db_10000_10_150.nsys-rep[1/7] [============55%             ] nsys_report_db_10000_10_150.nsys-rep[1/7] [============56%             ] nsys_report_db_10000_10_150.nsys-rep[1/7] [============57%             ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=============58%            ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=============59%            ] nsys_report_db_10000_10_150.nsys-rep[1/7] [=============60%            ] nsys_report_db_10000_10_150.nsys-rep[1/7] [==============61%           ] nsys_report_db_10000_10_150.nsys-rep[1/7] [==============62%           ] nsys_report_db_10000_10_150.nsys-rep[1/7] [==============63%           ] nsys_report_db_10000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_10000_10_150.nsys-rep[1/7] [===============65%          ] nsys_report_db_10000_10_150.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_10_150.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_150.nsys-rep[1/7] [========================100%] nsys_report_db_10000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [1%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [2%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [3%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [4%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [5%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [6%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [7%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [8%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [9%                          ] nsys_report_db_10000_10_150.sqlite[2/7] [10%                         ] nsys_report_db_10000_10_150.sqlite[2/7] [11%                         ] nsys_report_db_10000_10_150.sqlite[2/7] [12%                         ] nsys_report_db_10000_10_150.sqlite[2/7] [13%                         ] nsys_report_db_10000_10_150.sqlite[2/7] [14%                         ] nsys_report_db_10000_10_150.sqlite[2/7] [=15%                        ] nsys_report_db_10000_10_150.sqlite[2/7] [=16%                        ] nsys_report_db_10000_10_150.sqlite[2/7] [=17%                        ] nsys_report_db_10000_10_150.sqlite[2/7] [==18%                       ] nsys_report_db_10000_10_150.sqlite[2/7] [==19%                       ] nsys_report_db_10000_10_150.sqlite[2/7] [==20%                       ] nsys_report_db_10000_10_150.sqlite[2/7] [==21%                       ] nsys_report_db_10000_10_150.sqlite[2/7] [===22%                      ] nsys_report_db_10000_10_150.sqlite[2/7] [===23%                      ] nsys_report_db_10000_10_150.sqlite[2/7] [===24%                      ] nsys_report_db_10000_10_150.sqlite[2/7] [====25%                     ] nsys_report_db_10000_10_150.sqlite[2/7] [====26%                     ] nsys_report_db_10000_10_150.sqlite[2/7] [====27%                     ] nsys_report_db_10000_10_150.sqlite[2/7] [====28%                     ] nsys_report_db_10000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_10_150.sqlite[2/7] [======33%                   ] nsys_report_db_10000_10_150.sqlite[2/7] [======34%                   ] nsys_report_db_10000_10_150.sqlite[2/7] [======35%                   ] nsys_report_db_10000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_10_150.sqlite[2/7] [========40%                 ] nsys_report_db_10000_10_150.sqlite[2/7] [========41%                 ] nsys_report_db_10000_10_150.sqlite[2/7] [========42%                 ] nsys_report_db_10000_10_150.sqlite[2/7] [=========43%                ] nsys_report_db_10000_10_150.sqlite[2/7] [=========44%                ] nsys_report_db_10000_10_150.sqlite[2/7] [=========45%                ] nsys_report_db_10000_10_150.sqlite[2/7] [=========46%                ] nsys_report_db_10000_10_150.sqlite[2/7] [==========47%               ] nsys_report_db_10000_10_150.sqlite[2/7] [==========48%               ] nsys_report_db_10000_10_150.sqlite[2/7] [==========49%               ] nsys_report_db_10000_10_150.sqlite[2/7] [===========50%              ] nsys_report_db_10000_10_150.sqlite[2/7] [===========51%              ] nsys_report_db_10000_10_150.sqlite[2/7] [===========52%              ] nsys_report_db_10000_10_150.sqlite[2/7] [===========53%              ] nsys_report_db_10000_10_150.sqlite[2/7] [============54%             ] nsys_report_db_10000_10_150.sqlite[2/7] [============55%             ] nsys_report_db_10000_10_150.sqlite[2/7] [============56%             ] nsys_report_db_10000_10_150.sqlite[2/7] [============57%             ] nsys_report_db_10000_10_150.sqlite[2/7] [=============58%            ] nsys_report_db_10000_10_150.sqlite[2/7] [=============59%            ] nsys_report_db_10000_10_150.sqlite[2/7] [=============60%            ] nsys_report_db_10000_10_150.sqlite[2/7] [==============61%           ] nsys_report_db_10000_10_150.sqlite[2/7] [==============62%           ] nsys_report_db_10000_10_150.sqlite[2/7] [==============63%           ] nsys_report_db_10000_10_150.sqlite[2/7] [==============64%           ] nsys_report_db_10000_10_150.sqlite[2/7] [===============65%          ] nsys_report_db_10000_10_150.sqlite[2/7] [===============66%          ] nsys_report_db_10000_10_150.sqlite[2/7] [===============67%          ] nsys_report_db_10000_10_150.sqlite[2/7] [================68%         ] nsys_report_db_10000_10_150.sqlite[2/7] [================69%         ] nsys_report_db_10000_10_150.sqlite[2/7] [================70%         ] nsys_report_db_10000_10_150.sqlite[2/7] [================71%         ] nsys_report_db_10000_10_150.sqlite[2/7] [=================72%        ] nsys_report_db_10000_10_150.sqlite[2/7] [=================73%        ] nsys_report_db_10000_10_150.sqlite[2/7] [=================74%        ] nsys_report_db_10000_10_150.sqlite[2/7] [==================75%       ] nsys_report_db_10000_10_150.sqlite[2/7] [==================76%       ] nsys_report_db_10000_10_150.sqlite[2/7] [==================77%       ] nsys_report_db_10000_10_150.sqlite[2/7] [==================78%       ] nsys_report_db_10000_10_150.sqlite[2/7] [===================79%      ] nsys_report_db_10000_10_150.sqlite[2/7] [===================80%      ] nsys_report_db_10000_10_150.sqlite[2/7] [===================81%      ] nsys_report_db_10000_10_150.sqlite[2/7] [===================82%      ] nsys_report_db_10000_10_150.sqlite[2/7] [====================83%     ] nsys_report_db_10000_10_150.sqlite[2/7] [====================84%     ] nsys_report_db_10000_10_150.sqlite[2/7] [====================85%     ] nsys_report_db_10000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_10_150.sqlite[2/7] [======================90%   ] nsys_report_db_10000_10_150.sqlite[2/7] [======================91%   ] nsys_report_db_10000_10_150.sqlite[2/7] [======================92%   ] nsys_report_db_10000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_10_150.sqlite[2/7] [========================97% ] nsys_report_db_10000_10_150.sqlite[2/7] [========================98% ] nsys_report_db_10000_10_150.sqlite[2/7] [========================99% ] nsys_report_db_10000_10_150.sqlite[2/7] [========================100%] nsys_report_db_10000_10_150.sqlite[2/7] [========================100%] nsys_report_db_10000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        298034600          1  298034600.0  298034600.0  298034600  298034600          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.6      31046909944          1  31046909944.0  31046909944.0  31046909944  31046909944          0.0  cudaHostAlloc                     
     24.4      15278265217         45    339517004.8        14860.0         6330   1096396489  510879835.9  cudaMemcpyAsync                   
     24.1      15071253677          1  15071253677.0  15071253677.0  15071253677  15071253677          0.0  cudaFreeHost                      
      1.3        806375356        150      5375835.7          290.0          270    806299865   65834066.9  cuKernelGetFunction               
      0.3        187141325          8     23392665.6      1726898.5        29360    175108436   61325627.4  cudaFree                          
      0.2        132582668          2     66291334.0     66291334.0     54025822     78556846   17346053.4  cudaMemcpy                        
      0.2        120743910          1    120743910.0    120743910.0    120743910    120743910          0.0  cudaDeviceReset                   
      0.0          3912672         15       260844.8       275033.0       116751       426884     101727.9  cuLibraryLoadData                 
      0.0          1408385          7       201197.9       138722.0         3690       473895     192010.8  cudaMalloc                        
      0.0          1192232         17        70131.3         3210.0         2090      1141012     275960.0  cudaStreamSynchronize             
      0.0          1031796        360         2866.1         2690.0          500        13440       1074.5  cudaEventRecord                   
      0.0           766787         45        17039.7         8360.0         4400       253433      36839.5  cudaLaunchKernel                  
      0.0           750904        150         5006.0         4270.0         3610        30490       2629.5  cuLaunchKernel                    
      0.0           235242        330          712.9          580.0          470        10460        721.7  cudaEventCreate                   
      0.0           234661        814          288.3          270.0          120          980        132.4  cuGetProcAddress_v2               
      0.0           197280        350          563.7          435.0          320        18650       1045.2  cudaEventDestroy                  
      0.0            64632         75          861.8          330.0          280         3560       1010.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0            50061          2        25030.5        25030.5         1850        48211      32782.2  cudaStreamCreateWithFlags         
      0.0            44180         20         2209.0          520.0          380        13970       4162.7  cudaEventCreateWithFlags          
      0.0            31940         15         2129.3         1920.0         1640         3260        490.0  cudaStreamWaitEvent               
      0.0            30151          4         7537.8         3020.0         1280        22831      10245.8  cudaDeviceSynchronize             
      0.0            17250          2         8625.0         8625.0         4700        12550       5550.8  cudaStreamDestroy                 
      0.0            10561         16          660.1          525.0          480         1770        334.4  cuLibraryGetKernel                
      0.0             5490          3         1830.0         2000.0          720         2770       1035.5  cuInit                            
      0.0             4830          1         4830.0         4830.0         4830         4830          0.0  cudaEventQuery                    
      0.0             3250          3         1083.3          270.0          250         2730       1426.1  cuModuleGetLoadingMode            
      0.0             1570          1         1570.0         1570.0         1570         1570          0.0  cuCtxSynchronize                  
      0.0              820          2          410.0          410.0          330          490        113.1  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8      16326912227        150  108846081.5  108940719.5  105536496  110865441     877741.1  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1         17236803         15    1149120.2    1148745.0    1140425    1153833       4110.5  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         10072779         30     335759.3     334226.5      16416     658917     324543.4  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     98.7       5829929506     31  188062242.1  53871647.0      1600  458036723  195985761.8  [CUDA memcpy Host-to-Device]
      1.3         78374544     16    4898409.0      1952.0      1951   78343665   19585401.6  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 120800.156     31  3896.779   800.000     0.010  8000.000     4041.074  [CUDA memcpy Host-to-Device]
    800.000     16    50.000     0.000     0.000   800.000      200.000  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_10_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 10 (num_steps = 150), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  29.87 GB
Used GPU Memory:  9.62 GB
------------------------

Process RSS:  114.76 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 1.568079 ms
t_alloc_cpu = 30979.892969 ms
t_init      = 7838.425875 ms
t_h2d       = 5781.557476 ms
t_d2h       = 155.172110 ms
t_gemm      = 16653.108971 ms
t_end_2_end = 70594.854116 ms
Generating '/tmp/nsys-report-815b.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [8%                          ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [=17%                        ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [==18%                       ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [==19%                       ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [==20%                       ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [==21%                       ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [===22%                      ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [===23%                      ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [===24%                      ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [====25%                     ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [====26%                     ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [=======================93%  ] nsys_report_fo_10000_10_150.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_150.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [1%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [2%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [3%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [4%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [5%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [6%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [7%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [8%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [9%                          ] nsys_report_fo_10000_10_150.sqlite[2/7] [10%                         ] nsys_report_fo_10000_10_150.sqlite[2/7] [11%                         ] nsys_report_fo_10000_10_150.sqlite[2/7] [12%                         ] nsys_report_fo_10000_10_150.sqlite[2/7] [13%                         ] nsys_report_fo_10000_10_150.sqlite[2/7] [14%                         ] nsys_report_fo_10000_10_150.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_10_150.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_10_150.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_10_150.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_10_150.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_10_150.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_10_150.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_10_150.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_10_150.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_10_150.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_10_150.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_10_150.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_10_150.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_10_150.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_10_150.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_10_150.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_10_150.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_10_150.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_10_150.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_10_150.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_10_150.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_10_150.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_10_150.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_10_150.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_10_150.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_10_150.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_10_150.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_10_150.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_10_150.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_10_150.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_10_150.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_10_150.sqlite[2/7] [============54%             ] nsys_report_fo_10000_10_150.sqlite[2/7] [============55%             ] nsys_report_fo_10000_10_150.sqlite[2/7] [============56%             ] nsys_report_fo_10000_10_150.sqlite[2/7] [============57%             ] nsys_report_fo_10000_10_150.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_10_150.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_10_150.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_10_150.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_10_150.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_10_150.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_10_150.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_10_150.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_10_150.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_10_150.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_10_150.sqlite[2/7] [================68%         ] nsys_report_fo_10000_10_150.sqlite[2/7] [================69%         ] nsys_report_fo_10000_10_150.sqlite[2/7] [================70%         ] nsys_report_fo_10000_10_150.sqlite[2/7] [================71%         ] nsys_report_fo_10000_10_150.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_10_150.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_10_150.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_10_150.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_10_150.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_10_150.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_10_150.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_10_150.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_10_150.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_10_150.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_10_150.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_10_150.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_10_150.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_10_150.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_10_150.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_10_150.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_10_150.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_10_150.sqlite[2/7] [========================97% ] nsys_report_fo_10000_10_150.sqlite[2/7] [========================98% ] nsys_report_fo_10000_10_150.sqlite[2/7] [========================99% ] nsys_report_fo_10000_10_150.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_150.sqlite[2/7] [========================100%] nsys_report_fo_10000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        294705669          1  294705669.0  294705669.0  294705669  294705669          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.6      30979887043          1  30979887043.0  30979887043.0  30979887043  30979887043          0.0  cudaHostAlloc                     
     26.3      16439922543        450     36533161.2        10155.0         3350    112316745   51969973.2  cudaMemcpyAsync                   
     22.7      14162625353          1  14162625353.0  14162625353.0  14162625353  14162625353          0.0  cudaFreeHost                      
      0.6        394477489        150      2629849.9          645.0          410    394289485   32193498.6  cuKernelGetFunction               
      0.3        179008867         16     11188054.2       460725.0        29501    172876560   43117250.8  cudaFree                          
      0.2        130637413          2     65318706.5     65318706.5     53565809     77071604   16621107.0  cudaMemcpy                        
      0.2        119518763          1    119518763.0    119518763.0    119518763    119518763          0.0  cudaDeviceReset                   
      0.0          3910230         15       260682.0       273973.0       117631       422844     100463.5  cuLibraryLoadData                 
      0.0          3491546        450         7759.0         4870.0         4100       241053      11837.9  cudaLaunchKernel                  
      0.0          2404162       1050         2289.7         2585.0          510        28350       1602.3  cudaEventRecord                   
      0.0          1739288         15       115952.5       132872.0         3760       147322      35700.6  cudaMalloc                        
      0.0          1534559        152        10095.8         2495.0         1950      1145472      92701.5  cudaStreamSynchronize             
      0.0          1070396        150         7136.0         5905.0         4611        30141       2690.4  cuLaunchKernel                    
      0.0           407234        600          678.7          490.0          460        10960        619.8  cudaEventCreate                   
      0.0           401404        750          535.2          320.0          270         2680        498.4  cudaStreamGetCaptureInfo_v2_v11030
      0.0           299045        290         1031.2          885.0          580         3040        454.9  cudaStreamWaitEvent               
      0.0           248294        814          305.0          280.0          120         1200        144.3  cuGetProcAddress_v2               
      0.0            76171          1        76171.0        76171.0        76171        76171          0.0  cudaMemGetInfo                    
      0.0            49732         38         1308.7          510.0          380        11331       2619.9  cudaEventCreateWithFlags          
      0.0            35000          4         8750.0         2920.0         1370        27790      12718.5  cudaDeviceSynchronize             
      0.0            33560          2        16780.0        16780.0         1790        31770      21199.1  cudaStreamCreateWithFlags         
      0.0            28550         38          751.3          545.0          340         4170        768.3  cudaEventDestroy                  
      0.0            19830          2         9915.0         9915.0         5130        14700       6767.0  cudaStreamDestroy                 
      0.0            13020         16          813.8          570.0          470         3270        694.6  cuLibraryGetKernel                
      0.0             6340          3         2113.3         2540.0          680         3120       1274.7  cuInit                            
      0.0             4890          1         4890.0         4890.0         4890         4890          0.0  cudaEventQuery                    
      0.0             3670          3         1223.3          420.0          260         2990       1532.1  cuModuleGetLoadingMode            
      0.0             1140          1         1140.0         1140.0         1140         1140          0.0  cuCtxSynchronize                  
      0.0             1100          2          550.0          550.0          290          810        367.7  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4      16279880937        150  108532539.6  108548573.0  106250520  110529254     770400.6  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0        172639413        150    1150929.4    1152249.0    1139561    1154729       3406.7  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         97295355        300     324317.9     320642.5      12544     647366     312009.9  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     98.7       5780034796    301  19202773.4  31915273.0      1567  54280920   19972793.1  [CUDA memcpy Host-to-Device]
      1.3         77187821    151    511177.6      1952.0      1888  76892197    6257237.9  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 120801.556    301   401.334   800.000     0.010   800.000      400.659  [CUDA memcpy Host-to-Device]
    800.001    151     5.298     0.000     0.000   800.000       65.103  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_10_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 20 (num_steps = 20)
number of batches= 1
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 2168.768448 ms
t_h2d = 875.727322 ms
t_gpu_alloc = 1.894951 ms
t_cpu_alloc = 4405.337095 ms
t_init = 1155.395031 ms
t_d2h = 156.260967 ms
t_end_2_end = 11322.829962 ms
Generating '/tmp/nsys-report-84e9.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [======34%                   ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [==============63%           ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_20_20.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_20.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [1%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [2%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [3%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [4%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [5%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [6%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [7%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [8%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [9%                          ] nsys_report_ia_10000_20_20.sqlite[2/7] [10%                         ] nsys_report_ia_10000_20_20.sqlite[2/7] [11%                         ] nsys_report_ia_10000_20_20.sqlite[2/7] [12%                         ] nsys_report_ia_10000_20_20.sqlite[2/7] [13%                         ] nsys_report_ia_10000_20_20.sqlite[2/7] [14%                         ] nsys_report_ia_10000_20_20.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_20_20.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_20_20.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_20_20.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_20_20.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_20_20.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_20_20.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_20_20.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_20_20.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_20_20.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_20_20.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_20_20.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_20_20.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_20_20.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_20_20.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_20_20.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_20_20.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_20_20.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_20_20.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_20_20.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_20_20.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_20_20.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_20_20.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_20_20.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_20_20.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_20_20.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_20_20.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_20_20.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_20_20.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_20_20.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_20_20.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_20_20.sqlite[2/7] [============54%             ] nsys_report_ia_10000_20_20.sqlite[2/7] [============55%             ] nsys_report_ia_10000_20_20.sqlite[2/7] [============56%             ] nsys_report_ia_10000_20_20.sqlite[2/7] [============57%             ] nsys_report_ia_10000_20_20.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_20_20.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_20_20.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_20_20.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_20_20.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_20_20.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_20_20.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_20_20.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_20_20.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_20_20.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_20_20.sqlite[2/7] [================68%         ] nsys_report_ia_10000_20_20.sqlite[2/7] [================69%         ] nsys_report_ia_10000_20_20.sqlite[2/7] [================70%         ] nsys_report_ia_10000_20_20.sqlite[2/7] [================71%         ] nsys_report_ia_10000_20_20.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_20_20.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_20_20.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_20_20.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_20_20.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_20_20.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_20_20.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_20_20.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_20_20.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_20_20.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_20_20.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_20_20.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_20_20.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_20_20.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_20_20.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_20_20.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_20_20.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_20_20.sqlite[2/7] [========================97% ] nsys_report_ia_10000_20_20.sqlite[2/7] [========================98% ] nsys_report_ia_10000_20_20.sqlite[2/7] [========================99% ] nsys_report_ia_10000_20_20.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_20.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        293937567          1  293937567.0  293937567.0  293937567  293937567          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     56.7       4405330816          1  4405330816.0  4405330816.0  4405330816  4405330816          0.0  cudaHostAlloc                     
     27.6       2149733849          1  2149733849.0  2149733849.0  2149733849  2149733849          0.0  cudaFreeHost                      
     10.3        802829475         20    40141473.8         310.0         290   802823145  179516638.1  cuKernelGetFunction               
      2.5        195684632          8    24460579.0     4282381.5       58491   168112303   58200822.6  cudaFree                          
      1.7        132202583          2    66101291.5    66101291.5    54418310    77784273   16522230.9  cudaMemcpy                        
      1.0         80454692          1    80454692.0    80454692.0    80454692    80454692          0.0  cudaDeviceReset                   
      0.1          4123576         15      274905.1      293643.0      124562      449325     107295.6  cuLibraryLoadData                 
      0.0          2070433          7      295776.1      146102.0        3740      806419     343848.5  cudaMalloc                        
      0.0          1149033          3      383011.0        4450.0        2460     1142123     657411.0  cudaStreamSynchronize             
      0.0           716577          3      238859.0       19640.0       18970      677967     380278.8  cudaMemcpyAsync                   
      0.0           314354          3      104784.7       31701.0        5540      277113     149812.9  cudaLaunchKernel                  
      0.0           245224        814         301.3         280.0         120        1390        143.9  cuGetProcAddress_v2               
      0.0           131402         44        2986.4        2150.0         590       25470       3707.6  cudaEventRecord                   
      0.0           107901         20        5395.1        3775.0        3610       32070       6297.0  cuLaunchKernel                    
      0.0            45390         62         732.1         385.0         330        8790       1482.8  cudaEventDestroy                  
      0.0            40180         20        2009.0         505.0         390       19970       4652.5  cudaEventCreateWithFlags          
      0.0            35421          2       17710.5       17710.5        1920       33501      22331.1  cudaStreamCreateWithFlags         
      0.0            35030          4        8757.5        3095.0        1350       27490      12529.4  cudaDeviceSynchronize             
      0.0            32331         42         769.8         600.0         480        3580        608.3  cudaEventCreate                   
      0.0            18901          2        9450.5        9450.5        5140       13761       6096.0  cudaStreamDestroy                 
      0.0            14130         16         883.1         555.0         480        4780       1071.6  cuLibraryGetKernel                
      0.0             6020          5        1204.0         420.0         310        4410       1793.4  cudaStreamGetCaptureInfo_v2_v11030
      0.0             5930          1        5930.0        5930.0        5930        5930          0.0  cudaEventQuery                    
      0.0             4150          3        1383.3        1480.0         540        2130        799.4  cuInit                            
      0.0             3420          3        1140.0         260.0         180        2980       1594.0  cuModuleGetLoadingMode            
      0.0             3220          1        3220.0        3220.0        3220        3220          0.0  cudaStreamWaitEvent               
      0.0             1140          1        1140.0        1140.0        1140        1140          0.0  cuCtxSynchronize                  
      0.0             1030          2         515.0         515.0         320         710        275.8  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9       2168164835         20  108408241.8  108409071.5  106314810  109832027     967417.4  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          1140297          1    1140297.0    1140297.0    1140297    1140297          0.0  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0           672069          2     336034.5     336034.5      16736     655333     451556.3  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     91.9        875517274      3  291839091.3  54267239.0      1632  821248403  459284066.2  [CUDA memcpy Host-to-Device]
      8.1         77603486      2   38801743.0  38801743.0      3520   77599966   54868973.2  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  16800.010      3  5600.003   800.000     0.010  16000.000     9015.539  [CUDA memcpy Host-to-Device]
    800.000      2   400.000   400.000     0.000    800.000      565.685  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 20 (num_steps = 20)
number of batches= 1
t_gemm = 2164.882767 ms
t_h2d = 800.770430 ms
t_d2h = 155.673981 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 1.608133 ms
t_cpu_alloc = 4409.794092 ms
t_init = 1161.063910 ms
t_end_2_end = 11230.898857 ms
Generating '/tmp/nsys-report-c654.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=====32%                    ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=============59%            ] nsys_report_db_10000_20_20.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_20_20.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_20_20.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_20_20.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_20_20.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_20_20.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_db_10000_20_20.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_20.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [1%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [2%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [3%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [4%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [5%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [6%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [7%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [8%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [9%                          ] nsys_report_db_10000_20_20.sqlite[2/7] [10%                         ] nsys_report_db_10000_20_20.sqlite[2/7] [11%                         ] nsys_report_db_10000_20_20.sqlite[2/7] [12%                         ] nsys_report_db_10000_20_20.sqlite[2/7] [13%                         ] nsys_report_db_10000_20_20.sqlite[2/7] [14%                         ] nsys_report_db_10000_20_20.sqlite[2/7] [=15%                        ] nsys_report_db_10000_20_20.sqlite[2/7] [=16%                        ] nsys_report_db_10000_20_20.sqlite[2/7] [=17%                        ] nsys_report_db_10000_20_20.sqlite[2/7] [==18%                       ] nsys_report_db_10000_20_20.sqlite[2/7] [==19%                       ] nsys_report_db_10000_20_20.sqlite[2/7] [==20%                       ] nsys_report_db_10000_20_20.sqlite[2/7] [==21%                       ] nsys_report_db_10000_20_20.sqlite[2/7] [===22%                      ] nsys_report_db_10000_20_20.sqlite[2/7] [===23%                      ] nsys_report_db_10000_20_20.sqlite[2/7] [===24%                      ] nsys_report_db_10000_20_20.sqlite[2/7] [====25%                     ] nsys_report_db_10000_20_20.sqlite[2/7] [====26%                     ] nsys_report_db_10000_20_20.sqlite[2/7] [====27%                     ] nsys_report_db_10000_20_20.sqlite[2/7] [====28%                     ] nsys_report_db_10000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_20_20.sqlite[2/7] [======33%                   ] nsys_report_db_10000_20_20.sqlite[2/7] [======34%                   ] nsys_report_db_10000_20_20.sqlite[2/7] [======35%                   ] nsys_report_db_10000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_20_20.sqlite[2/7] [========40%                 ] nsys_report_db_10000_20_20.sqlite[2/7] [========41%                 ] nsys_report_db_10000_20_20.sqlite[2/7] [========42%                 ] nsys_report_db_10000_20_20.sqlite[2/7] [=========43%                ] nsys_report_db_10000_20_20.sqlite[2/7] [=========44%                ] nsys_report_db_10000_20_20.sqlite[2/7] [=========45%                ] nsys_report_db_10000_20_20.sqlite[2/7] [=========46%                ] nsys_report_db_10000_20_20.sqlite[2/7] [==========47%               ] nsys_report_db_10000_20_20.sqlite[2/7] [==========48%               ] nsys_report_db_10000_20_20.sqlite[2/7] [==========49%               ] nsys_report_db_10000_20_20.sqlite[2/7] [===========50%              ] nsys_report_db_10000_20_20.sqlite[2/7] [===========51%              ] nsys_report_db_10000_20_20.sqlite[2/7] [===========52%              ] nsys_report_db_10000_20_20.sqlite[2/7] [===========53%              ] nsys_report_db_10000_20_20.sqlite[2/7] [============54%             ] nsys_report_db_10000_20_20.sqlite[2/7] [============55%             ] nsys_report_db_10000_20_20.sqlite[2/7] [============56%             ] nsys_report_db_10000_20_20.sqlite[2/7] [============57%             ] nsys_report_db_10000_20_20.sqlite[2/7] [=============58%            ] nsys_report_db_10000_20_20.sqlite[2/7] [=============59%            ] nsys_report_db_10000_20_20.sqlite[2/7] [=============60%            ] nsys_report_db_10000_20_20.sqlite[2/7] [==============61%           ] nsys_report_db_10000_20_20.sqlite[2/7] [==============62%           ] nsys_report_db_10000_20_20.sqlite[2/7] [==============63%           ] nsys_report_db_10000_20_20.sqlite[2/7] [==============64%           ] nsys_report_db_10000_20_20.sqlite[2/7] [===============65%          ] nsys_report_db_10000_20_20.sqlite[2/7] [===============66%          ] nsys_report_db_10000_20_20.sqlite[2/7] [===============67%          ] nsys_report_db_10000_20_20.sqlite[2/7] [================68%         ] nsys_report_db_10000_20_20.sqlite[2/7] [================69%         ] nsys_report_db_10000_20_20.sqlite[2/7] [================70%         ] nsys_report_db_10000_20_20.sqlite[2/7] [================71%         ] nsys_report_db_10000_20_20.sqlite[2/7] [=================72%        ] nsys_report_db_10000_20_20.sqlite[2/7] [=================73%        ] nsys_report_db_10000_20_20.sqlite[2/7] [=================74%        ] nsys_report_db_10000_20_20.sqlite[2/7] [==================75%       ] nsys_report_db_10000_20_20.sqlite[2/7] [==================76%       ] nsys_report_db_10000_20_20.sqlite[2/7] [==================77%       ] nsys_report_db_10000_20_20.sqlite[2/7] [==================78%       ] nsys_report_db_10000_20_20.sqlite[2/7] [===================79%      ] nsys_report_db_10000_20_20.sqlite[2/7] [===================80%      ] nsys_report_db_10000_20_20.sqlite[2/7] [===================81%      ] nsys_report_db_10000_20_20.sqlite[2/7] [===================82%      ] nsys_report_db_10000_20_20.sqlite[2/7] [====================83%     ] nsys_report_db_10000_20_20.sqlite[2/7] [====================84%     ] nsys_report_db_10000_20_20.sqlite[2/7] [====================85%     ] nsys_report_db_10000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_20_20.sqlite[2/7] [======================90%   ] nsys_report_db_10000_20_20.sqlite[2/7] [======================91%   ] nsys_report_db_10000_20_20.sqlite[2/7] [======================92%   ] nsys_report_db_10000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_20_20.sqlite[2/7] [========================97% ] nsys_report_db_10000_20_20.sqlite[2/7] [========================98% ] nsys_report_db_10000_20_20.sqlite[2/7] [========================99% ] nsys_report_db_10000_20_20.sqlite[2/7] [========================100%] nsys_report_db_10000_20_20.sqlite[2/7] [========================100%] nsys_report_db_10000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        295964021          1  295964021.0  295964021.0  295964021  295964021          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     57.4       4409788365          1  4409788365.0  4409788365.0  4409788365  4409788365          0.0  cudaHostAlloc                     
     27.7       2125160078          1  2125160078.0  2125160078.0  2125160078  2125160078          0.0  cudaFreeHost                      
      9.5        728599605         20    36429980.3         310.0         290   728593525  162918393.4  cuKernelGetFunction               
      2.6        200889320          8    25111165.0     4292441.5       55021   173292200   60026460.0  cudaFree                          
      1.7        130939290          2    65469645.0    65469645.0    53636142    77303148   16735100.4  cudaMemcpy                        
      1.0         80132239          1    80132239.0    80132239.0    80132239    80132239          0.0  cudaDeviceReset                   
      0.1          4092335         15      272822.3      287994.0      123021      444395     105921.2  cuLibraryLoadData                 
      0.0          2071574          7      295939.1      120711.0        3830      807129     350355.7  cudaMalloc                        
      0.0          1148002          3      382667.3        4230.0        2490     1141282     656980.1  cudaStreamSynchronize             
      0.0           716858          3      238952.7       18580.0       17170      681108     382918.4  cudaMemcpyAsync                   
      0.0           286283          3       95427.7       20890.0        5330      260063     142790.5  cudaLaunchKernel                  
      0.0           250491        814         307.7         280.0         120        1380        146.7  cuGetProcAddress_v2               
      0.0           135282         44        3074.6        2275.0         620       26141       3808.7  cudaEventRecord                   
      0.0           106680         20        5334.0        3720.0        3560       32450       6395.8  cuLaunchKernel                    
      0.0            49071         62         791.5         460.0         340       10721       1658.9  cudaEventDestroy                  
      0.0            40700         20        2035.0         530.0         410       12900       3607.3  cudaEventCreateWithFlags          
      0.0            37300          4        9325.0        3525.0        1640       28610      12889.4  cudaDeviceSynchronize             
      0.0            36280          2       18140.0       18140.0        1990       34290      22839.5  cudaStreamCreateWithFlags         
      0.0            33320         42         793.3         615.0         490        4220        673.3  cudaEventCreate                   
      0.0            18030          2        9015.0        9015.0        4820       13210       5932.6  cudaStreamDestroy                 
      0.0            13550         16         846.9         560.0         520        3620        798.7  cuLibraryGetKernel                
      0.0             5290          1        5290.0        5290.0        5290        5290          0.0  cudaEventQuery                    
      0.0             4930          5         986.0         480.0         320        3120       1197.3  cudaStreamGetCaptureInfo_v2_v11030
      0.0             4600          3        1533.3        1810.0         550        2240        878.3  cuInit                            
      0.0             3510          1        3510.0        3510.0        3510        3510          0.0  cudaStreamWaitEvent               
      0.0             3390          3        1130.0         260.0         250        2880       1515.6  cuModuleGetLoadingMode            
      0.0             1390          1        1390.0        1390.0        1390        1390          0.0  cuCtxSynchronize                  
      0.0              970          2         485.0         485.0         330         640        219.2  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9       2164299444         20  108214972.2  108530808.5  105295213  109945909    1068810.1  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          1139720          1    1139720.0    1139720.0    1139720    1139720          0.0  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0           675045          2     337522.5     337522.5      16672     658373     453751.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     91.2        800418221      3  266806073.7  53346366.0      1600  747070255  416775333.9  [CUDA memcpy Host-to-Device]
      8.8         77126070      2   38563035.0  38563035.0      3551   77122519   54531345.2  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  16800.010      3  5600.003   800.000     0.010  16000.000     9015.539  [CUDA memcpy Host-to-Device]
    800.000      2   400.000   400.000     0.000    800.000      565.685  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 20 (num_steps = 20), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  22.60 GB
Used GPU Memory:  16.90 GB
------------------------

Process RSS:  17.91 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 2.843857 ms
t_alloc_cpu = 4414.954185 ms
t_init      = 1269.867897 ms
t_h2d       = 796.034143 ms
t_d2h       = 155.652046 ms
t_gemm      = 2865.354362 ms
t_end_2_end = 11361.258984 ms
Generating '/tmp/nsys-report-a514.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [=========43%                ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [===============66%          ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [======================90%   ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [======================91%   ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [======================92%   ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [=======================93%  ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [=======================95%  ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [=======================96%  ] nsys_report_fo_10000_20_20.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_20.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [1%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [2%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [3%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [4%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [5%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [6%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [7%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [8%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [9%                          ] nsys_report_fo_10000_20_20.sqlite[2/7] [10%                         ] nsys_report_fo_10000_20_20.sqlite[2/7] [11%                         ] nsys_report_fo_10000_20_20.sqlite[2/7] [12%                         ] nsys_report_fo_10000_20_20.sqlite[2/7] [13%                         ] nsys_report_fo_10000_20_20.sqlite[2/7] [14%                         ] nsys_report_fo_10000_20_20.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_20_20.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_20_20.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_20_20.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_20_20.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_20_20.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_20_20.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_20_20.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_20_20.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_20_20.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_20_20.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_20_20.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_20_20.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_20_20.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_20_20.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_20_20.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_20_20.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_20_20.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_20_20.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_20_20.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_20_20.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_20_20.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_20_20.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_20_20.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_20_20.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_20_20.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_20_20.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_20_20.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_20_20.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_20_20.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_20_20.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_20_20.sqlite[2/7] [============54%             ] nsys_report_fo_10000_20_20.sqlite[2/7] [============55%             ] nsys_report_fo_10000_20_20.sqlite[2/7] [============56%             ] nsys_report_fo_10000_20_20.sqlite[2/7] [============57%             ] nsys_report_fo_10000_20_20.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_20_20.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_20_20.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_20_20.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_20_20.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_20_20.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_20_20.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_20_20.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_20_20.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_20_20.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_20_20.sqlite[2/7] [================68%         ] nsys_report_fo_10000_20_20.sqlite[2/7] [================69%         ] nsys_report_fo_10000_20_20.sqlite[2/7] [================70%         ] nsys_report_fo_10000_20_20.sqlite[2/7] [================71%         ] nsys_report_fo_10000_20_20.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_20_20.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_20_20.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_20_20.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_20_20.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_20_20.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_20_20.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_20_20.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_20_20.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_20_20.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_20_20.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_20_20.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_20_20.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_20_20.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_20_20.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_20_20.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_20_20.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_20_20.sqlite[2/7] [========================97% ] nsys_report_fo_10000_20_20.sqlite[2/7] [========================98% ] nsys_report_fo_10000_20_20.sqlite[2/7] [========================99% ] nsys_report_fo_10000_20_20.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_20.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        298667563          1  298667563.0  298667563.0  298667563  298667563          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     45.2       4414946795          1  4414946795.0  4414946795.0  4414946795  4414946795          0.0  cudaHostAlloc                     
     21.7       2118497922          1  2118497922.0  2118497922.0  2118497922  2118497922          0.0  cudaFreeHost                      
     21.4       2093791397         60    34896523.3       10490.5        3260   110986855   51661509.6  cudaMemcpyAsync                   
      7.4        723596827         20    36179841.4         435.0         370   723585697  161798549.6  cuKernelGetFunction               
      2.0        190711922         26     7335073.9      458190.0       57501   175240562   34258637.7  cudaFree                          
      1.3        131094124          2    65547062.0    65547062.0    53606532    77487592   16886459.5  cudaMemcpy                        
      0.8         80838888          1    80838888.0    80838888.0    80838888    80838888          0.0  cudaDeviceReset                   
      0.0          4162583         15      277505.5      293223.0      124851      451684     108915.1  cuLibraryLoadData                 
      0.0          3013914         25      120556.6      127911.0        3610      146711      28465.6  cudaMalloc                        
      0.0          1198005         22       54454.8        2395.0        2140     1144623     243492.9  cudaStreamSynchronize             
      0.0           567665         60        9461.1        4615.5        4050      247203      31300.5  cudaLaunchKernel                  
      0.0           275711        140        1969.4        1875.0         530       22630       2158.7  cudaEventRecord                   
      0.0           258964        814         318.1         290.0         120        1280        151.7  cuGetProcAddress_v2               
      0.0           128181         20        6409.1        4630.0        4450       30970       5889.9  cuLaunchKernel                    
      0.0            78260          1       78260.0       78260.0       78260       78260          0.0  cudaMemGetInfo                    
      0.0            73451         80         918.1         580.0         470       10690       1377.5  cudaEventCreate                   
      0.0            65780         58        1134.1         535.0         400       12340       2272.4  cudaEventCreateWithFlags          
      0.0            42800        100         428.0         335.0         300        2040        250.7  cudaStreamGetCaptureInfo_v2_v11030
      0.0            40170         58         692.6         560.0         350        5190        679.8  cudaEventDestroy                  
      0.0            37361          2       18680.5       18680.5        1940       35421      23674.6  cudaStreamCreateWithFlags         
      0.0            36950          4        9237.5        3085.0        1320       29460      13519.9  cudaDeviceSynchronize             
      0.0            26110         20        1305.5         950.0         790        3310        729.6  cudaStreamWaitEvent               
      0.0            20771          2       10385.5       10385.5        6181       14590       5946.1  cudaStreamDestroy                 
      0.0            15300         16         956.3         590.0         530        5450       1216.3  cuLibraryGetKernel                
      0.0             5351          1        5351.0        5351.0        5351        5351          0.0  cudaEventQuery                    
      0.0             4510          3        1503.3        1900.0         590        2020        793.2  cuInit                            
      0.0             3380          3        1126.7         270.0         190        2920       1553.6  cuModuleGetLoadingMode            
      0.0             1410          1        1410.0        1410.0        1410        1410          0.0  cuCtxSynchronize                  
      0.0              890          2         445.0         445.0         310         580        190.9  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       2164493777         20  108224688.9  108435958.0  105289836  109213353     976795.2  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         22806383         20    1140319.2    1140297.0    1139337    1141513        609.8  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         12969345         40     324233.6     321810.5      12576     639909     315384.6  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     91.1        795760787     41  19408799.7  32124696.0      1568  53494716   19958736.8  [CUDA memcpy Host-to-Device]
      8.9         77352790     21   3683466.2      1952.0      1920  77312119   16870443.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  16800.208     41   409.761   800.000     0.010   800.000      404.843  [CUDA memcpy Host-to-Device]
    800.000     21    38.095     0.000     0.000   800.000      174.574  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 20 (num_steps = 40)
number of batches= 2
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 4327.987312 ms
t_h2d = 1667.591120 ms
t_gpu_alloc = 1.840115 ms
t_cpu_alloc = 8587.635994 ms
t_init = 2158.890009 ms
t_d2h = 156.846046 ms
t_end_2_end = 21238.631964 ms
Generating '/tmp/nsys-report-c326.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [======34%                   ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [============57%             ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [===================80%      ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [===================81%      ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_20_40.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_40.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [1%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [2%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [3%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [4%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [5%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [6%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [7%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [8%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [9%                          ] nsys_report_ia_10000_20_40.sqlite[2/7] [10%                         ] nsys_report_ia_10000_20_40.sqlite[2/7] [11%                         ] nsys_report_ia_10000_20_40.sqlite[2/7] [12%                         ] nsys_report_ia_10000_20_40.sqlite[2/7] [13%                         ] nsys_report_ia_10000_20_40.sqlite[2/7] [14%                         ] nsys_report_ia_10000_20_40.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_20_40.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_20_40.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_20_40.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_20_40.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_20_40.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_20_40.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_20_40.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_20_40.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_20_40.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_20_40.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_20_40.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_20_40.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_20_40.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_20_40.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_20_40.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_20_40.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_20_40.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_20_40.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_20_40.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_20_40.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_20_40.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_20_40.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_20_40.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_20_40.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_20_40.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_20_40.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_20_40.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_20_40.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_20_40.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_20_40.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_20_40.sqlite[2/7] [============54%             ] nsys_report_ia_10000_20_40.sqlite[2/7] [============55%             ] nsys_report_ia_10000_20_40.sqlite[2/7] [============56%             ] nsys_report_ia_10000_20_40.sqlite[2/7] [============57%             ] nsys_report_ia_10000_20_40.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_20_40.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_20_40.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_20_40.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_20_40.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_20_40.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_20_40.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_20_40.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_20_40.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_20_40.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_20_40.sqlite[2/7] [================68%         ] nsys_report_ia_10000_20_40.sqlite[2/7] [================69%         ] nsys_report_ia_10000_20_40.sqlite[2/7] [================70%         ] nsys_report_ia_10000_20_40.sqlite[2/7] [================71%         ] nsys_report_ia_10000_20_40.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_20_40.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_20_40.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_20_40.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_20_40.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_20_40.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_20_40.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_20_40.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_20_40.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_20_40.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_20_40.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_20_40.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_20_40.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_20_40.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_20_40.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_20_40.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_20_40.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_20_40.sqlite[2/7] [========================97% ] nsys_report_ia_10000_20_40.sqlite[2/7] [========================98% ] nsys_report_ia_10000_20_40.sqlite[2/7] [========================99% ] nsys_report_ia_10000_20_40.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_40.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        267159543          1  267159543.0  267159543.0  267159543  267159543          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                  Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  ------------  ----------------------------------
     51.4       8587628587          1  8587628587.0  8587628587.0  8587628587  8587628587           0.0  cudaHostAlloc                     
     23.4       3913457390          1  3913457390.0  3913457390.0  3913457390  3913457390           0.0  cudaFreeHost                      
     17.5       2932367769          6   488727961.5       17976.0        6540  2931639560  1196777409.7  cudaMemcpyAsync                   
      5.0        833624179         40    20840604.5         290.0         280   833609369   131805154.2  cuKernelGetFunction               
      1.1        180579893          8    22572486.6     4305812.5       53830   152924202    52843139.2  cudaFree                          
      0.8        131916274          2    65958137.0    65958137.0    53442541    78473733    17699725.6  cudaMemcpy                        
      0.7        120888864          1   120888864.0   120888864.0   120888864   120888864           0.0  cudaDeviceReset                   
      0.0          4112705         15      274180.3      289423.0      118231      443585      108029.1  cuLibraryLoadData                 
      0.0          2017452          7      288207.4      134832.0        3550      781859      337339.4  cudaMalloc                        
      0.0          1149122          4      287280.5        4170.0        2960     1137822      567028.0  cudaStreamSynchronize             
      0.0           328653          6       54775.5       12725.0        4630      265892      103860.8  cudaLaunchKernel                  
      0.0           254422        814         312.6         280.0         120        5950         238.4  cuGetProcAddress_v2               
      0.0           247393         88        2811.3        2535.0         930       14600        1745.8  cudaEventRecord                   
      0.0           204521         40        5113.0        4215.0        3630       34891        4908.4  cuLaunchKernel                    
      0.0            73551        104         707.2         460.0         330       17300        1818.1  cudaEventDestroy                  
      0.0            71011         84         845.4         520.0         480        7520        1060.0  cudaEventCreate                   
      0.0            39240         20        1962.0         510.0         400       15920        4289.7  cudaEventCreateWithFlags          
      0.0            37200          4        9300.0        3195.0        1290       29520       13520.5  cudaDeviceSynchronize             
      0.0            35611          2       17805.5       17805.5        1790       33821       22649.3  cudaStreamCreateWithFlags         
      0.0            18360          2        9180.0        9180.0        5440       12920        5289.2  cudaStreamDestroy                 
      0.0            12800         10        1280.0         405.0         300        6420        2016.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0             9960         16         622.5         530.0         490        1340         232.0  cuLibraryGetKernel                
      0.0             5770          2        2885.0        2885.0        2360        3410         742.5  cudaStreamWaitEvent               
      0.0             4970          1        4970.0        4970.0        4970        4970           0.0  cudaEventQuery                    
      0.0             4130          3        1376.7        1150.0         580        2400         930.9  cuInit                            
      0.0             3920          3        1306.7         370.0         260        3290        1718.5  cuModuleGetLoadingMode            
      0.0             1120          1        1120.0        1120.0        1120        1120           0.0  cuCtxSynchronize                  
      0.0              840          2         420.0         420.0         290         550         183.8  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9       4327339654         40  108183491.4  108360138.5  104739579  110350005    1023115.2  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          2292753          2    1146376.5    1146376.5    1139208    1153545      10137.8  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          1339018          4     334754.5     334466.5      16800     653285     367124.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     95.5       1667348870      5  333469774.0  53272180.0      1600  852026588  434019646.2  [CUDA memcpy Host-to-Device]
      4.5         78278845      3   26092948.3      3520.0      1952   78273373   45189573.3  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  32800.021      5  6560.004   800.000     0.010  16000.000     8623.684  [CUDA memcpy Host-to-Device]
    800.000      3   266.667     0.000     0.000    800.000      461.880  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 20 (num_steps = 40)
number of batches= 2
t_gemm = 5092.154579 ms
t_h2d = 1662.357281 ms
t_d2h = 158.960104 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 1.580000 ms
t_cpu_alloc = 8617.759943 ms
t_init = 2147.125959 ms
t_end_2_end = 21294.692039 ms
Generating '/tmp/nsys-report-64e1.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_20_40.nsys-rep[1/7] [=======38%                  ] nsys_report_db_10000_20_40.nsys-rep[1/7] [==============62%           ] nsys_report_db_10000_20_40.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_20_40.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_20_40.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_20_40.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_20_40.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_20_40.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_20_40.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_20_40.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_20_40.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_20_40.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_20_40.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_20_40.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_20_40.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_40.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [1%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [2%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [3%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [4%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [5%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [6%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [7%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [8%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [9%                          ] nsys_report_db_10000_20_40.sqlite[2/7] [10%                         ] nsys_report_db_10000_20_40.sqlite[2/7] [11%                         ] nsys_report_db_10000_20_40.sqlite[2/7] [12%                         ] nsys_report_db_10000_20_40.sqlite[2/7] [13%                         ] nsys_report_db_10000_20_40.sqlite[2/7] [14%                         ] nsys_report_db_10000_20_40.sqlite[2/7] [=15%                        ] nsys_report_db_10000_20_40.sqlite[2/7] [=16%                        ] nsys_report_db_10000_20_40.sqlite[2/7] [=17%                        ] nsys_report_db_10000_20_40.sqlite[2/7] [==18%                       ] nsys_report_db_10000_20_40.sqlite[2/7] [==19%                       ] nsys_report_db_10000_20_40.sqlite[2/7] [==20%                       ] nsys_report_db_10000_20_40.sqlite[2/7] [==21%                       ] nsys_report_db_10000_20_40.sqlite[2/7] [===22%                      ] nsys_report_db_10000_20_40.sqlite[2/7] [===23%                      ] nsys_report_db_10000_20_40.sqlite[2/7] [===24%                      ] nsys_report_db_10000_20_40.sqlite[2/7] [====25%                     ] nsys_report_db_10000_20_40.sqlite[2/7] [====26%                     ] nsys_report_db_10000_20_40.sqlite[2/7] [====27%                     ] nsys_report_db_10000_20_40.sqlite[2/7] [====28%                     ] nsys_report_db_10000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_20_40.sqlite[2/7] [======33%                   ] nsys_report_db_10000_20_40.sqlite[2/7] [======34%                   ] nsys_report_db_10000_20_40.sqlite[2/7] [======35%                   ] nsys_report_db_10000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_20_40.sqlite[2/7] [========40%                 ] nsys_report_db_10000_20_40.sqlite[2/7] [========41%                 ] nsys_report_db_10000_20_40.sqlite[2/7] [========42%                 ] nsys_report_db_10000_20_40.sqlite[2/7] [=========43%                ] nsys_report_db_10000_20_40.sqlite[2/7] [=========44%                ] nsys_report_db_10000_20_40.sqlite[2/7] [=========45%                ] nsys_report_db_10000_20_40.sqlite[2/7] [=========46%                ] nsys_report_db_10000_20_40.sqlite[2/7] [==========47%               ] nsys_report_db_10000_20_40.sqlite[2/7] [==========48%               ] nsys_report_db_10000_20_40.sqlite[2/7] [==========49%               ] nsys_report_db_10000_20_40.sqlite[2/7] [===========50%              ] nsys_report_db_10000_20_40.sqlite[2/7] [===========51%              ] nsys_report_db_10000_20_40.sqlite[2/7] [===========52%              ] nsys_report_db_10000_20_40.sqlite[2/7] [===========53%              ] nsys_report_db_10000_20_40.sqlite[2/7] [============54%             ] nsys_report_db_10000_20_40.sqlite[2/7] [============55%             ] nsys_report_db_10000_20_40.sqlite[2/7] [============56%             ] nsys_report_db_10000_20_40.sqlite[2/7] [============57%             ] nsys_report_db_10000_20_40.sqlite[2/7] [=============58%            ] nsys_report_db_10000_20_40.sqlite[2/7] [=============59%            ] nsys_report_db_10000_20_40.sqlite[2/7] [=============60%            ] nsys_report_db_10000_20_40.sqlite[2/7] [==============61%           ] nsys_report_db_10000_20_40.sqlite[2/7] [==============62%           ] nsys_report_db_10000_20_40.sqlite[2/7] [==============63%           ] nsys_report_db_10000_20_40.sqlite[2/7] [==============64%           ] nsys_report_db_10000_20_40.sqlite[2/7] [===============65%          ] nsys_report_db_10000_20_40.sqlite[2/7] [===============66%          ] nsys_report_db_10000_20_40.sqlite[2/7] [===============67%          ] nsys_report_db_10000_20_40.sqlite[2/7] [================68%         ] nsys_report_db_10000_20_40.sqlite[2/7] [================69%         ] nsys_report_db_10000_20_40.sqlite[2/7] [================70%         ] nsys_report_db_10000_20_40.sqlite[2/7] [================71%         ] nsys_report_db_10000_20_40.sqlite[2/7] [=================72%        ] nsys_report_db_10000_20_40.sqlite[2/7] [=================73%        ] nsys_report_db_10000_20_40.sqlite[2/7] [=================74%        ] nsys_report_db_10000_20_40.sqlite[2/7] [==================75%       ] nsys_report_db_10000_20_40.sqlite[2/7] [==================76%       ] nsys_report_db_10000_20_40.sqlite[2/7] [==================77%       ] nsys_report_db_10000_20_40.sqlite[2/7] [==================78%       ] nsys_report_db_10000_20_40.sqlite[2/7] [===================79%      ] nsys_report_db_10000_20_40.sqlite[2/7] [===================80%      ] nsys_report_db_10000_20_40.sqlite[2/7] [===================81%      ] nsys_report_db_10000_20_40.sqlite[2/7] [===================82%      ] nsys_report_db_10000_20_40.sqlite[2/7] [====================83%     ] nsys_report_db_10000_20_40.sqlite[2/7] [====================84%     ] nsys_report_db_10000_20_40.sqlite[2/7] [====================85%     ] nsys_report_db_10000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_20_40.sqlite[2/7] [======================90%   ] nsys_report_db_10000_20_40.sqlite[2/7] [======================91%   ] nsys_report_db_10000_20_40.sqlite[2/7] [======================92%   ] nsys_report_db_10000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_20_40.sqlite[2/7] [========================97% ] nsys_report_db_10000_20_40.sqlite[2/7] [========================98% ] nsys_report_db_10000_20_40.sqlite[2/7] [========================99% ] nsys_report_db_10000_20_40.sqlite[2/7] [========================100%] nsys_report_db_10000_20_40.sqlite[2/7] [========================100%] nsys_report_db_10000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        293110469          1  293110469.0  293110469.0  293110469  293110469          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     51.4       8617753875          1  8617753875.0  8617753875.0  8617753875  8617753875          0.0  cudaHostAlloc                     
     23.4       3924803949          1  3924803949.0  3924803949.0  3924803949  3924803949          0.0  cudaFreeHost                      
     13.0       2174754731          6   362459121.8       19595.5       10471  2174019732  887479865.2  cudaMemcpyAsync                   
      9.5       1589377992         40    39734449.8         310.0         280  1589362232  251300170.1  cuKernelGetFunction               
      1.2        207638389          8    25954798.6     4299157.0       28450   180047619   62409622.0  cudaFree                          
      0.8        133825466          2    66912733.0    66912733.0    54451213    79374253   17623250.6  cudaMemcpy                        
      0.7        121084537          1   121084537.0   121084537.0   121084537   121084537          0.0  cudaDeviceReset                   
      0.0          4064352         15      270956.8      284533.0      118491      449035     106983.5  cuLibraryLoadData                 
      0.0          2046882          7      292411.7      125451.0        3780      792908     343340.1  cudaMalloc                        
      0.0          1148653          4      287163.3        4160.0        2350     1137983     567213.8  cudaStreamSynchronize             
      0.0           323973          6       53995.5       12865.0        4340      263753     103146.8  cudaLaunchKernel                  
      0.0           263372        814         323.6         280.0         120       17060        604.5  cuGetProcAddress_v2               
      0.0           248294         88        2821.5        2525.0         590       19700       2123.9  cudaEventRecord                   
      0.0           208011         40        5200.3        4430.5        3530       31710       4437.2  cuLaunchKernel                    
      0.0            85282        104         820.0         490.0         330       20470       2038.6  cudaEventDestroy                  
      0.0            64661         84         769.8         585.0         480        3880        601.1  cudaEventCreate                   
      0.0            46160         20        2308.0         515.0         390       14820       4385.4  cudaEventCreateWithFlags          
      0.0            36780          2       18390.0       18390.0        2050       34730      23108.2  cudaStreamCreateWithFlags         
      0.0            33780          4        8445.0        3190.0        1480       25920      11694.8  cudaDeviceSynchronize             
      0.0            18430          2        9215.0        9215.0        5350       13080       5465.9  cudaStreamDestroy                 
      0.0            16350         16        1021.9         590.0         500        6400       1456.4  cuLibraryGetKernel                
      0.0             8730         10         873.0         380.0         300        3020       1055.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0             6630          2        3315.0        3315.0        3080        3550        332.3  cudaStreamWaitEvent               
      0.0             4990          1        4990.0        4990.0        4990        4990          0.0  cudaEventQuery                    
      0.0             4320          3        1440.0        1750.0         580        1990        754.4  cuInit                            
      0.0             3530          3        1176.7         280.0         170        3080       1649.3  cuModuleGetLoadingMode            
      0.0             1050          1        1050.0        1050.0        1050        1050          0.0  cuCtxSynchronize                  
      0.0              750          2         375.0         375.0         320         430         77.8  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9       4329202618         40  108230065.5  108239844.0  105504926  109893039     933956.4  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          2281328          2    1140664.0    1140664.0    1139400    1141928       1787.6  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          1335626          4     333906.5     332418.5      16576     654213     366393.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     95.5       1661988964      5  332397792.8  54150520.0      1600  845539723  432007725.6  [CUDA memcpy Host-to-Device]
      4.5         79174787      3   26391595.7      3457.0      1952   79169378   45706900.3  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  32800.021      5  6560.004   800.000     0.010  16000.000     8623.684  [CUDA memcpy Host-to-Device]
    800.000      3   266.667     0.000     0.000    800.000      461.880  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 20 (num_steps = 40), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  22.57 GB
Used GPU Memory:  16.92 GB
------------------------

Process RSS:  32.80 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 2.836943 ms
t_alloc_cpu = 8595.479012 ms
t_init      = 2296.336889 ms
t_h2d       = 1589.299839 ms
t_d2h       = 155.210972 ms
t_gemm      = 5032.043671 ms
t_end_2_end = 20626.332045 ms
Generating '/tmp/nsys-report-29aa.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [==19%                       ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [========42%                 ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [=========43%                ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [=========44%                ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [=========45%                ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [=========46%                ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [=======================95%  ] nsys_report_fo_10000_20_40.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_40.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [1%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [2%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [3%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [4%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [5%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [6%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [7%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [8%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [9%                          ] nsys_report_fo_10000_20_40.sqlite[2/7] [10%                         ] nsys_report_fo_10000_20_40.sqlite[2/7] [11%                         ] nsys_report_fo_10000_20_40.sqlite[2/7] [12%                         ] nsys_report_fo_10000_20_40.sqlite[2/7] [13%                         ] nsys_report_fo_10000_20_40.sqlite[2/7] [14%                         ] nsys_report_fo_10000_20_40.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_20_40.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_20_40.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_20_40.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_20_40.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_20_40.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_20_40.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_20_40.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_20_40.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_20_40.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_20_40.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_20_40.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_20_40.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_20_40.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_20_40.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_20_40.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_20_40.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_20_40.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_20_40.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_20_40.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_20_40.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_20_40.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_20_40.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_20_40.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_20_40.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_20_40.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_20_40.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_20_40.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_20_40.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_20_40.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_20_40.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_20_40.sqlite[2/7] [============54%             ] nsys_report_fo_10000_20_40.sqlite[2/7] [============55%             ] nsys_report_fo_10000_20_40.sqlite[2/7] [============56%             ] nsys_report_fo_10000_20_40.sqlite[2/7] [============57%             ] nsys_report_fo_10000_20_40.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_20_40.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_20_40.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_20_40.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_20_40.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_20_40.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_20_40.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_20_40.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_20_40.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_20_40.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_20_40.sqlite[2/7] [================68%         ] nsys_report_fo_10000_20_40.sqlite[2/7] [================69%         ] nsys_report_fo_10000_20_40.sqlite[2/7] [================70%         ] nsys_report_fo_10000_20_40.sqlite[2/7] [================71%         ] nsys_report_fo_10000_20_40.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_20_40.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_20_40.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_20_40.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_20_40.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_20_40.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_20_40.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_20_40.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_20_40.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_20_40.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_20_40.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_20_40.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_20_40.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_20_40.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_20_40.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_20_40.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_20_40.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_20_40.sqlite[2/7] [========================97% ] nsys_report_fo_10000_20_40.sqlite[2/7] [========================98% ] nsys_report_fo_10000_20_40.sqlite[2/7] [========================99% ] nsys_report_fo_10000_20_40.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_40.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        292642327          1  292642327.0  292642327.0  292642327  292642327          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                 Name               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------
     47.8       8595473490          1  8595473490.0  8595473490.0  8595473490  8595473490          0.0  cudaHostAlloc                     
     23.9       4294019653        120    35783497.1        8710.0        3420   111209691   51764768.5  cudaMemcpyAsync                   
     21.9       3941222592          1  3941222592.0  3941222592.0  3941222592  3941222592          0.0  cudaFreeHost                      
      4.0        724818133         40    18120453.3         510.0         400   724794343  114599951.5  cuKernelGetFunction               
      1.0        184707703         26     7104142.4      458640.0       47861   169631368   33160011.0  cudaFree                          
      0.7        130156727          2    65078363.5    65078363.5    52866135    77290592   17270699.2  cudaMemcpy                        
      0.7        119691324          1   119691324.0   119691324.0   119691324   119691324          0.0  cudaDeviceReset                   
      0.0          4045302         15      269686.8      287803.0      118201      435925     105158.0  cuLibraryLoadData                 
      0.0          2999814         25      119992.6      126452.0        3860      149622      28438.4  cudaMalloc                        
      0.0          1245403         42       29652.5        2350.0        2090     1144173     176169.3  cudaStreamSynchronize             
      0.0           900300        120        7502.5        4715.0        4050      246943      22149.2  cudaLaunchKernel                  
      0.0           564618        280        2016.5        1920.0         520       15420       1511.8  cudaEventRecord                   
      0.0           243222        814         298.8         270.0         120        1300        145.0  cuGetProcAddress_v2               
      0.0           233153         40        5828.8        4910.0        4230       37061       5129.1  cuLaunchKernel                    
      0.0           126271        160         789.2         590.0         480       10090       1009.0  cudaEventCreate                   
      0.0            82304        200         411.5         315.0         280        5360        409.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0            78951          1       78951.0       78951.0       78951       78951          0.0  cudaMemGetInfo                    
      0.0            67631         58        1166.1         530.0         400       13220       2445.7  cudaEventCreateWithFlags          
      0.0            60441         60        1007.4         875.0         600        3500        500.1  cudaStreamWaitEvent               
      0.0            53441          4       13360.3        3430.0        1500       45081      21173.4  cudaDeviceSynchronize             
      0.0            40690         58         701.6         550.0         340        4590        674.6  cudaEventDestroy                  
      0.0            36700          2       18350.0       18350.0        1750       34950      23475.9  cudaStreamCreateWithFlags         
      0.0            16680          2        8340.0        8340.0        3620       13060       6675.1  cudaStreamDestroy                 
      0.0            11511         16         719.4         625.0         520        1960        359.6  cuLibraryGetKernel                
      0.0             5680          3        1893.3        2080.0         610        2990       1200.9  cuInit                            
      0.0             5300          1        5300.0        5300.0        5300        5300          0.0  cudaEventQuery                    
      0.0             3360          3        1120.0         280.0         150        2930       1568.9  cuModuleGetLoadingMode            
      0.0             1170          1        1170.0        1170.0        1170        1170          0.0  cuCtxSynchronize                  
      0.0              820          2         410.0         410.0         320         500        127.3  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       4329932365         40  108248309.1  108248833.5  106287906  109437818     546104.4  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         45833531         40    1145838.3    1144457.0    1139688    1153832       5645.7  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         25939431         80     324242.9     321746.5      12576     642596     313427.6  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     95.4       1588896053     81  19616000.7  32169715.0      1568  54242266   20315197.1  [CUDA memcpy Host-to-Device]
      4.6         77201618     41   1882966.3      1952.0      1920  77121617   12044060.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  32800.415     81   404.943   800.000     0.010   800.000      402.456  [CUDA memcpy Host-to-Device]
    800.000     41    19.512     0.000     0.000   800.000      124.939  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 20 (num_steps = 60)
number of batches= 3
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 6499.771408 ms
t_h2d = 2321.948225 ms
t_gpu_alloc = 1.880169 ms
t_cpu_alloc = 12718.621969 ms
t_init = 3196.177959 ms
t_d2h = 156.133175 ms
t_end_2_end = 30954.817057 ms
Generating '/tmp/nsys-report-710e.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [==========47%               ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [===============65%          ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [===============66%          ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [===============67%          ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [================68%         ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [================69%         ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [================70%         ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [================71%         ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=================72%        ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=================73%        ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=================74%        ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [==================75%       ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [==================76%       ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [==================77%       ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [==================78%       ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [===================79%      ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [===================80%      ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [===================81%      ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_10000_20_60.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_60.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [1%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [2%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [3%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [4%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [5%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [6%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [7%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [8%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [9%                          ] nsys_report_ia_10000_20_60.sqlite[2/7] [10%                         ] nsys_report_ia_10000_20_60.sqlite[2/7] [11%                         ] nsys_report_ia_10000_20_60.sqlite[2/7] [12%                         ] nsys_report_ia_10000_20_60.sqlite[2/7] [13%                         ] nsys_report_ia_10000_20_60.sqlite[2/7] [14%                         ] nsys_report_ia_10000_20_60.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_20_60.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_20_60.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_20_60.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_20_60.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_20_60.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_20_60.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_20_60.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_20_60.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_20_60.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_20_60.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_20_60.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_20_60.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_20_60.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_20_60.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_20_60.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_20_60.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_20_60.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_20_60.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_20_60.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_20_60.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_20_60.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_20_60.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_20_60.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_20_60.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_20_60.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_20_60.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_20_60.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_20_60.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_20_60.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_20_60.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_20_60.sqlite[2/7] [============54%             ] nsys_report_ia_10000_20_60.sqlite[2/7] [============55%             ] nsys_report_ia_10000_20_60.sqlite[2/7] [============56%             ] nsys_report_ia_10000_20_60.sqlite[2/7] [============57%             ] nsys_report_ia_10000_20_60.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_20_60.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_20_60.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_20_60.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_20_60.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_20_60.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_20_60.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_20_60.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_20_60.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_20_60.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_20_60.sqlite[2/7] [================68%         ] nsys_report_ia_10000_20_60.sqlite[2/7] [================69%         ] nsys_report_ia_10000_20_60.sqlite[2/7] [================70%         ] nsys_report_ia_10000_20_60.sqlite[2/7] [================71%         ] nsys_report_ia_10000_20_60.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_20_60.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_20_60.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_20_60.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_20_60.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_20_60.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_20_60.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_20_60.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_20_60.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_20_60.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_20_60.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_20_60.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_20_60.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_20_60.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_20_60.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_20_60.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_20_60.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_20_60.sqlite[2/7] [========================97% ] nsys_report_ia_10000_20_60.sqlite[2/7] [========================98% ] nsys_report_ia_10000_20_60.sqlite[2/7] [========================99% ] nsys_report_ia_10000_20_60.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_60.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        285278980          1  285278980.0  285278980.0  285278980  285278980          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                  Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------------------
     50.1      12718616598          1  12718616598.0  12718616598.0  12718616598  12718616598           0.0  cudaHostAlloc                     
     22.9       5808567360          9    645396373.3        19200.0         6880   2930689463  1280523487.3  cudaMemcpyAsync                   
     22.1       5616699478          1   5616699478.0   5616699478.0   5616699478   5616699478           0.0  cudaFreeHost                      
      3.1        785827487         60     13097124.8          290.0          280    785805747   101447038.1  cuKernelGetFunction               
      0.8        192109655          8     24013706.9      4303932.0        32200    164358142    56870182.6  cudaFree                          
      0.5        131049698          2     65524849.0     65524849.0     53208200     77841498    17418372.1  cudaMemcpy                        
      0.5        120560025          1    120560025.0    120560025.0    120560025    120560025           0.0  cudaDeviceReset                   
      0.0          4068544         15       271236.3       290913.0       119321       438415      106295.1  cuLibraryLoadData                 
      0.0          2054963          7       293566.1       125341.0         3810       805969      346528.1  cudaMalloc                        
      0.0          1154412          5       230882.4         3860.0         2660      1140682      508593.7  cudaStreamSynchronize             
      0.0           386212        132         2925.8         2640.0          570        27240        2363.9  cudaEventRecord                   
      0.0           366966          9        40774.0         8220.0         4410       265563       84837.0  cudaLaunchKernel                  
      0.0           293695         60         4894.9         4195.0         3540        32770        3833.4  cuLaunchKernel                    
      0.0           247963        814          304.6          280.0          120         1240         152.5  cuGetProcAddress_v2               
      0.0            93511        146          640.5          480.0          330        18121        1569.5  cudaEventDestroy                  
      0.0            89831        126          712.9          590.0          470         3870         526.7  cudaEventCreate                   
      0.0            43050          2        21525.0        21525.0         2010        41040       27598.4  cudaStreamCreateWithFlags         
      0.0            41070         20         2053.5          525.0          390        13090        3638.3  cudaEventCreateWithFlags          
      0.0            33750          4         8437.5         2575.0         1340        27260       12564.6  cudaDeviceSynchronize             
      0.0            17750          2         8875.0         8875.0         4890        12860        5635.6  cudaStreamDestroy                 
      0.0            15310         15         1020.7          370.0          300         4010        1317.5  cudaStreamGetCaptureInfo_v2_v11030
      0.0            14110         16          881.9          630.0          500         3770         810.3  cuLibraryGetKernel                
      0.0             6570          3         2190.0         1970.0         1280         3320        1037.6  cudaStreamWaitEvent               
      0.0             5510          1         5510.0         5510.0         5510         5510           0.0  cudaEventQuery                    
      0.0             5030          3         1676.7         1990.0          690         2350         873.2  cuInit                            
      0.0             3280          3         1093.3          270.0          180         2830        1504.7  cuModuleGetLoadingMode            
      0.0             1640          1         1640.0         1640.0         1640         1640           0.0  cuCtxSynchronize                  
      0.0              860          2          430.0          430.0          340          520         127.3  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9       6499052813         60  108317546.9  108588127.5  105273106  110087347     952087.2  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          3441593          3    1147197.7    1149960.0    1140648    1150985       5695.3  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          2007662          6     334610.3     334082.0      16512     654373     348297.2  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     96.8       2321712372      7  331673196.0  53053084.0      1600  804095886  398634606.6  [CUDA memcpy Host-to-Device]
      3.2         77658519      4   19414629.8      2751.5      1952   77651064   38824289.5  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  48800.031      7  6971.433   800.000     0.010  16000.000     8450.186  [CUDA memcpy Host-to-Device]
    800.000      4   200.000     0.000     0.000    800.000      400.000  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 20 (num_steps = 60)
number of batches= 3
t_gemm = 7271.245018 ms
t_h2d = 2314.266590 ms
t_d2h = 155.925035 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 1.561165 ms
t_cpu_alloc = 12673.262835 ms
t_init = 3142.117023 ms
t_end_2_end = 30170.833111 ms
Generating '/tmp/nsys-report-cae3.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_20_60.nsys-rep[1/7] [======34%                   ] nsys_report_db_10000_20_60.nsys-rep[1/7] [============54%             ] nsys_report_db_10000_20_60.nsys-rep[1/7] [=================74%        ] nsys_report_db_10000_20_60.nsys-rep[1/7] [==================75%       ] nsys_report_db_10000_20_60.nsys-rep[1/7] [==================76%       ] nsys_report_db_10000_20_60.nsys-rep[1/7] [==================77%       ] nsys_report_db_10000_20_60.nsys-rep[1/7] [==================78%       ] nsys_report_db_10000_20_60.nsys-rep[1/7] [===================79%      ] nsys_report_db_10000_20_60.nsys-rep[1/7] [===================80%      ] nsys_report_db_10000_20_60.nsys-rep[1/7] [===================81%      ] nsys_report_db_10000_20_60.nsys-rep[1/7] [===================82%      ] nsys_report_db_10000_20_60.nsys-rep[1/7] [====================83%     ] nsys_report_db_10000_20_60.nsys-rep[1/7] [====================84%     ] nsys_report_db_10000_20_60.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_20_60.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_20_60.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_20_60.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_20_60.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_20_60.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_20_60.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_20_60.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_20_60.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_20_60.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_20_60.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_20_60.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_20_60.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_20_60.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_60.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [1%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [2%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [3%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [4%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [5%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [6%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [7%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [8%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [9%                          ] nsys_report_db_10000_20_60.sqlite[2/7] [10%                         ] nsys_report_db_10000_20_60.sqlite[2/7] [11%                         ] nsys_report_db_10000_20_60.sqlite[2/7] [12%                         ] nsys_report_db_10000_20_60.sqlite[2/7] [13%                         ] nsys_report_db_10000_20_60.sqlite[2/7] [14%                         ] nsys_report_db_10000_20_60.sqlite[2/7] [=15%                        ] nsys_report_db_10000_20_60.sqlite[2/7] [=16%                        ] nsys_report_db_10000_20_60.sqlite[2/7] [=17%                        ] nsys_report_db_10000_20_60.sqlite[2/7] [==18%                       ] nsys_report_db_10000_20_60.sqlite[2/7] [==19%                       ] nsys_report_db_10000_20_60.sqlite[2/7] [==20%                       ] nsys_report_db_10000_20_60.sqlite[2/7] [==21%                       ] nsys_report_db_10000_20_60.sqlite[2/7] [===22%                      ] nsys_report_db_10000_20_60.sqlite[2/7] [===23%                      ] nsys_report_db_10000_20_60.sqlite[2/7] [===24%                      ] nsys_report_db_10000_20_60.sqlite[2/7] [====25%                     ] nsys_report_db_10000_20_60.sqlite[2/7] [====26%                     ] nsys_report_db_10000_20_60.sqlite[2/7] [====27%                     ] nsys_report_db_10000_20_60.sqlite[2/7] [====28%                     ] nsys_report_db_10000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_20_60.sqlite[2/7] [======33%                   ] nsys_report_db_10000_20_60.sqlite[2/7] [======34%                   ] nsys_report_db_10000_20_60.sqlite[2/7] [======35%                   ] nsys_report_db_10000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_20_60.sqlite[2/7] [========40%                 ] nsys_report_db_10000_20_60.sqlite[2/7] [========41%                 ] nsys_report_db_10000_20_60.sqlite[2/7] [========42%                 ] nsys_report_db_10000_20_60.sqlite[2/7] [=========43%                ] nsys_report_db_10000_20_60.sqlite[2/7] [=========44%                ] nsys_report_db_10000_20_60.sqlite[2/7] [=========45%                ] nsys_report_db_10000_20_60.sqlite[2/7] [=========46%                ] nsys_report_db_10000_20_60.sqlite[2/7] [==========47%               ] nsys_report_db_10000_20_60.sqlite[2/7] [==========48%               ] nsys_report_db_10000_20_60.sqlite[2/7] [==========49%               ] nsys_report_db_10000_20_60.sqlite[2/7] [===========50%              ] nsys_report_db_10000_20_60.sqlite[2/7] [===========51%              ] nsys_report_db_10000_20_60.sqlite[2/7] [===========52%              ] nsys_report_db_10000_20_60.sqlite[2/7] [===========53%              ] nsys_report_db_10000_20_60.sqlite[2/7] [============54%             ] nsys_report_db_10000_20_60.sqlite[2/7] [============55%             ] nsys_report_db_10000_20_60.sqlite[2/7] [============56%             ] nsys_report_db_10000_20_60.sqlite[2/7] [============57%             ] nsys_report_db_10000_20_60.sqlite[2/7] [=============58%            ] nsys_report_db_10000_20_60.sqlite[2/7] [=============59%            ] nsys_report_db_10000_20_60.sqlite[2/7] [=============60%            ] nsys_report_db_10000_20_60.sqlite[2/7] [==============61%           ] nsys_report_db_10000_20_60.sqlite[2/7] [==============62%           ] nsys_report_db_10000_20_60.sqlite[2/7] [==============63%           ] nsys_report_db_10000_20_60.sqlite[2/7] [==============64%           ] nsys_report_db_10000_20_60.sqlite[2/7] [===============65%          ] nsys_report_db_10000_20_60.sqlite[2/7] [===============66%          ] nsys_report_db_10000_20_60.sqlite[2/7] [===============67%          ] nsys_report_db_10000_20_60.sqlite[2/7] [================68%         ] nsys_report_db_10000_20_60.sqlite[2/7] [================69%         ] nsys_report_db_10000_20_60.sqlite[2/7] [================70%         ] nsys_report_db_10000_20_60.sqlite[2/7] [================71%         ] nsys_report_db_10000_20_60.sqlite[2/7] [=================72%        ] nsys_report_db_10000_20_60.sqlite[2/7] [=================73%        ] nsys_report_db_10000_20_60.sqlite[2/7] [=================74%        ] nsys_report_db_10000_20_60.sqlite[2/7] [==================75%       ] nsys_report_db_10000_20_60.sqlite[2/7] [==================76%       ] nsys_report_db_10000_20_60.sqlite[2/7] [==================77%       ] nsys_report_db_10000_20_60.sqlite[2/7] [==================78%       ] nsys_report_db_10000_20_60.sqlite[2/7] [===================79%      ] nsys_report_db_10000_20_60.sqlite[2/7] [===================80%      ] nsys_report_db_10000_20_60.sqlite[2/7] [===================81%      ] nsys_report_db_10000_20_60.sqlite[2/7] [===================82%      ] nsys_report_db_10000_20_60.sqlite[2/7] [====================83%     ] nsys_report_db_10000_20_60.sqlite[2/7] [====================84%     ] nsys_report_db_10000_20_60.sqlite[2/7] [====================85%     ] nsys_report_db_10000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_20_60.sqlite[2/7] [======================90%   ] nsys_report_db_10000_20_60.sqlite[2/7] [======================91%   ] nsys_report_db_10000_20_60.sqlite[2/7] [======================92%   ] nsys_report_db_10000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_20_60.sqlite[2/7] [========================97% ] nsys_report_db_10000_20_60.sqlite[2/7] [========================98% ] nsys_report_db_10000_20_60.sqlite[2/7] [========================99% ] nsys_report_db_10000_20_60.sqlite[2/7] [========================100%] nsys_report_db_10000_20_60.sqlite[2/7] [========================100%] nsys_report_db_10000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        281595434          1  281595434.0  281595434.0  281595434  281595434          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     51.4      12673256530          1  12673256530.0  12673256530.0  12673256530  12673256530          0.0  cudaHostAlloc                     
     22.6       5580416809          1   5580416809.0   5580416809.0   5580416809   5580416809          0.0  cudaFreeHost                      
     17.6       4343157773          9    482573085.9        17990.0         6360   2176061035  957364079.8  cudaMemcpyAsync                   
      6.5       1595970592         60     26599509.9          300.0          290   1595947412  206035874.2  cuKernelGetFunction               
      0.8        189696201          8     23712025.1      4299032.0        53531    162125510   56089325.1  cudaFree                          
      0.5        130755957          2     65377978.5     65377978.5     53298521     77457436   17082932.6  cudaMemcpy                        
      0.5        125729223          1    125729223.0    125729223.0    125729223    125729223          0.0  cudaDeviceReset                   
      0.0          3993811         15       266254.1       290073.0       119331       435165     103526.7  cuLibraryLoadData                 
      0.0          2022171          7       288881.6       141272.0         3990       796289     338885.9  cudaMalloc                        
      0.0          1154052          5       230810.4         3700.0         2090      1140712     508651.1  cudaStreamSynchronize             
      0.0           381985          9        42442.8         9071.0         4550       275153      87849.5  cudaLaunchKernel                  
      0.0           368793        132         2793.9         2625.0          500        14230       1385.8  cudaEventRecord                   
      0.0           291033         60         4850.6         4090.0         3430        35221       4176.0  cuLaunchKernel                    
      0.0           261563        814          321.3          290.0          120         1100        147.7  cuGetProcAddress_v2               
      0.0            92401        146          632.9          370.0          340        19590       1706.8  cudaEventDestroy                  
      0.0            88131        126          699.5          545.0          470         4010        513.3  cudaEventCreate                   
      0.0            46561         20         2328.1          520.0          390        14921       4362.5  cudaEventCreateWithFlags          
      0.0            37311          2        18655.5        18655.5         1920        35391      23667.6  cudaStreamCreateWithFlags         
      0.0            32690          4         8172.5         2505.0         1420        26260      12069.8  cudaDeviceSynchronize             
      0.0            18791         15         1252.7          390.0          290         7351       1978.8  cudaStreamGetCaptureInfo_v2_v11030
      0.0            17840          2         8920.0         8920.0         4810        13030       5812.4  cudaStreamDestroy                 
      0.0            10800         16          675.0          570.0          500         1490        267.3  cuLibraryGetKernel                
      0.0             8910          3         2970.0         3190.0         2080         3640        802.9  cudaStreamWaitEvent               
      0.0             5030          1         5030.0         5030.0         5030         5030          0.0  cudaEventQuery                    
      0.0             4940          3         1646.7         1580.0          560         2800       1121.5  cuInit                            
      0.0             3760          3         1253.3          280.0          180         3300       1773.2  cuModuleGetLoadingMode            
      0.0             1310          1         1310.0         1310.0         1310         1310          0.0  cuCtxSynchronize                  
      0.0              800          2          400.0          400.0          280          520        169.7  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9       6501568930         60  108359482.2  108557958.5  105768564  109699880     801534.7  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          3434139          3    1144713.0    1140905.0    1140617    1152617       6846.6  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          2012303          6     335383.8     334946.5      16576     655749     349132.5  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     96.8       2314042233      7  330577461.9  53145452.0      1600  845357594  400382020.9  [CUDA memcpy Host-to-Device]
      3.2         77274134      4   19318533.5      2784.0      1952   77266614   38632053.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  48800.031      7  6971.433   800.000     0.010  16000.000     8450.186  [CUDA memcpy Host-to-Device]
    800.000      4   200.000     0.000     0.000    800.000      400.000  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 20 (num_steps = 60), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  22.54 GB
Used GPU Memory:  16.95 GB
------------------------

Process RSS:  47.71 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 2.803087 ms
t_alloc_cpu = 12694.983959 ms
t_init      = 3288.760900 ms
t_h2d       = 2297.455503 ms
t_d2h       = 156.202078 ms
t_gemm      = 7301.828430 ms
t_end_2_end = 29689.693928 ms
Generating '/tmp/nsys-report-2062.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=15%                        ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [========42%                 ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=========43%                ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_10000_20_60.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_60.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [1%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [2%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [3%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [4%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [5%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [6%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [7%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [8%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [9%                          ] nsys_report_fo_10000_20_60.sqlite[2/7] [10%                         ] nsys_report_fo_10000_20_60.sqlite[2/7] [11%                         ] nsys_report_fo_10000_20_60.sqlite[2/7] [12%                         ] nsys_report_fo_10000_20_60.sqlite[2/7] [13%                         ] nsys_report_fo_10000_20_60.sqlite[2/7] [14%                         ] nsys_report_fo_10000_20_60.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_20_60.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_20_60.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_20_60.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_20_60.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_20_60.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_20_60.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_20_60.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_20_60.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_20_60.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_20_60.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_20_60.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_20_60.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_20_60.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_20_60.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_20_60.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_20_60.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_20_60.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_20_60.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_20_60.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_20_60.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_20_60.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_20_60.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_20_60.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_20_60.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_20_60.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_20_60.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_20_60.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_20_60.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_20_60.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_20_60.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_20_60.sqlite[2/7] [============54%             ] nsys_report_fo_10000_20_60.sqlite[2/7] [============55%             ] nsys_report_fo_10000_20_60.sqlite[2/7] [============56%             ] nsys_report_fo_10000_20_60.sqlite[2/7] [============57%             ] nsys_report_fo_10000_20_60.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_20_60.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_20_60.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_20_60.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_20_60.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_20_60.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_20_60.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_20_60.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_20_60.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_20_60.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_20_60.sqlite[2/7] [================68%         ] nsys_report_fo_10000_20_60.sqlite[2/7] [================69%         ] nsys_report_fo_10000_20_60.sqlite[2/7] [================70%         ] nsys_report_fo_10000_20_60.sqlite[2/7] [================71%         ] nsys_report_fo_10000_20_60.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_20_60.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_20_60.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_20_60.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_20_60.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_20_60.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_20_60.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_20_60.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_20_60.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_20_60.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_20_60.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_20_60.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_20_60.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_20_60.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_20_60.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_20_60.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_20_60.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_20_60.sqlite[2/7] [========================97% ] nsys_report_fo_10000_20_60.sqlite[2/7] [========================98% ] nsys_report_fo_10000_20_60.sqlite[2/7] [========================99% ] nsys_report_fo_10000_20_60.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_60.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        284249946          1  284249946.0  284249946.0  284249946  284249946          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     48.7      12694977738          1  12694977738.0  12694977738.0  12694977738  12694977738          0.0  cudaHostAlloc                     
     24.9       6502037230        180     36122429.1         9780.0         3340    111671400   51857449.1  cudaMemcpyAsync                   
     21.5       5612673463          1   5612673463.0   5612673463.0   5612673463   5612673463          0.0  cudaFreeHost                      
      3.2        821633570         60     13693892.8          540.0          430    821584769  106066030.8  cuKernelGetFunction               
      0.7        176756042         26      6798309.3       460550.0        58080    162514016   31767220.2  cudaFree                          
      0.5        130943211          2     65471605.5     65471605.5     53049820     77893391   17567057.5  cudaMemcpy                        
      0.5        121490538          1    121490538.0    121490538.0    121490538    121490538          0.0  cudaDeviceReset                   
      0.0          4088722         15       272581.5       285513.0       121671       435945     105333.5  cuLibraryLoadData                 
      0.0          2969573         25       118782.9       124961.0         3840       158872      28161.1  cudaMalloc                        
      0.0          1294836         62        20884.5         2395.0         2170      1144383     145023.9  cudaStreamSynchronize             
      0.0          1270485        180         7058.3         4630.0         4100       244403      18022.1  cudaLaunchKernel                  
      0.0           875659        420         2084.9         1985.0          500        26570       1772.0  cudaEventRecord                   
      0.0           362734         60         6045.6         4935.0         4340        34140       3915.8  cuLaunchKernel                    
      0.0           252711        814          310.5          280.0          120         1170        151.8  cuGetProcAddress_v2               
      0.0           180062        240          750.3          590.0          470        10340        785.1  cudaEventCreate                   
      0.0           175442        300          584.8          325.0          280        45250       2608.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0           102941        100         1029.4          885.0          590         3750        499.8  cudaStreamWaitEvent               
      0.0            75101          1        75101.0        75101.0        75101        75101          0.0  cudaMemGetInfo                    
      0.0            62561         58         1078.6          530.0          390        13710       2221.5  cudaEventCreateWithFlags          
      0.0            41950         58          723.3          535.0          340         4970        716.2  cudaEventDestroy                  
      0.0            38061          4         9515.3         3215.0         1470        30161      13797.2  cudaDeviceSynchronize             
      0.0            35750          2        17875.0        17875.0         1810        33940      22719.3  cudaStreamCreateWithFlags         
      0.0            19410          2         9705.0         9705.0         5200        14210       6371.0  cudaStreamDestroy                 
      0.0            13230         16          826.9          675.0          510         3140        633.0  cuLibraryGetKernel                
      0.0             5110          1         5110.0         5110.0         5110         5110          0.0  cudaEventQuery                    
      0.0             4160          3         1386.7         1290.0          560         2310        879.0  cuInit                            
      0.0             3510          3         1170.0          280.0          270         2960       1550.2  cuModuleGetLoadingMode            
      0.0             1020          2          510.0          510.0          430          590        113.1  cudaGetDriverEntryPoint_v11030    
      0.0             1020          1         1020.0         1020.0         1020         1020          0.0  cuCtxSynchronize                  

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       6501488114         60  108358135.2  108462533.0  105455380  109895537     770276.3  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         68880328         60    1148005.5    1150168.5    1138792    1154569       5534.4  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         38887593        120     324063.3     321155.0      12576     643205     312550.3  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     96.7       2296866419    121  18982367.1  32009488.0      1568  53082541   19613752.8  [CUDA memcpy Host-to-Device]
      3.3         77839225     61   1276052.9      1952.0      1888  77719448    9950700.0  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  48800.623    121   403.311   800.000     0.010   800.000      401.644  [CUDA memcpy Host-to-Device]
    800.000     61    13.115     0.000     0.000   800.000      102.430  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 20 (num_steps = 80)
number of batches= 4
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 8665.085648 ms
t_h2d = 3119.055141 ms
t_gpu_alloc = 1.924992 ms
t_cpu_alloc = 16813.771009 ms
t_init = 4209.519863 ms
t_d2h = 156.092882 ms
t_end_2_end = 40683.775187 ms
Generating '/tmp/nsys-report-59d8.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [==18%                       ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=======36%                  ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=======37%                  ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=======38%                  ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=======39%                  ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [========40%                 ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [========41%                 ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [========42%                 ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=========43%                ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [==================76%       ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [==================77%       ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [==================78%       ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [===================79%      ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [===================80%      ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [===================81%      ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_20_80.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_80.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [1%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [2%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [3%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [4%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [5%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [6%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [7%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [8%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [9%                          ] nsys_report_ia_10000_20_80.sqlite[2/7] [10%                         ] nsys_report_ia_10000_20_80.sqlite[2/7] [11%                         ] nsys_report_ia_10000_20_80.sqlite[2/7] [12%                         ] nsys_report_ia_10000_20_80.sqlite[2/7] [13%                         ] nsys_report_ia_10000_20_80.sqlite[2/7] [14%                         ] nsys_report_ia_10000_20_80.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_20_80.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_20_80.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_20_80.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_20_80.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_20_80.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_20_80.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_20_80.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_20_80.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_20_80.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_20_80.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_20_80.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_20_80.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_20_80.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_20_80.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_20_80.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_20_80.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_20_80.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_20_80.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_20_80.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_20_80.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_20_80.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_20_80.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_20_80.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_20_80.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_20_80.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_20_80.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_20_80.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_20_80.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_20_80.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_20_80.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_20_80.sqlite[2/7] [============54%             ] nsys_report_ia_10000_20_80.sqlite[2/7] [============55%             ] nsys_report_ia_10000_20_80.sqlite[2/7] [============56%             ] nsys_report_ia_10000_20_80.sqlite[2/7] [============57%             ] nsys_report_ia_10000_20_80.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_20_80.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_20_80.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_20_80.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_20_80.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_20_80.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_20_80.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_20_80.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_20_80.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_20_80.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_20_80.sqlite[2/7] [================68%         ] nsys_report_ia_10000_20_80.sqlite[2/7] [================69%         ] nsys_report_ia_10000_20_80.sqlite[2/7] [================70%         ] nsys_report_ia_10000_20_80.sqlite[2/7] [================71%         ] nsys_report_ia_10000_20_80.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_20_80.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_20_80.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_20_80.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_20_80.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_20_80.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_20_80.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_20_80.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_20_80.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_20_80.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_20_80.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_20_80.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_20_80.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_20_80.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_20_80.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_20_80.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_20_80.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_20_80.sqlite[2/7] [========================97% ] nsys_report_ia_10000_20_80.sqlite[2/7] [========================98% ] nsys_report_ia_10000_20_80.sqlite[2/7] [========================99% ] nsys_report_ia_10000_20_80.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_80.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        311683541          1  311683541.0  311683541.0  311683541  311683541          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                  Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------------------
     49.3      16813765420          1  16813765420.0  16813765420.0  16813765420  16813765420           0.0  cudaHostAlloc                     
     25.6       8719219838         12    726601653.2        17945.0         6341   2927078772  1314382189.7  cudaMemcpyAsync                   
     21.3       7246608962          1   7246608962.0   7246608962.0   7246608962   7246608962           0.0  cudaFreeHost                      
      2.5        837322822         80     10466535.3          300.0          280    837291002    93611934.8  cuKernelGetFunction               
      0.6        214051341          8     26756417.6      4293302.0        26550    186442580    64664803.2  cudaFree                          
      0.4        131296697          2     65648348.5     65648348.5     53878520     77418177    16645051.1  cudaMemcpy                        
      0.4        120653981          1    120653981.0    120653981.0    120653981    120653981           0.0  cudaDeviceReset                   
      0.0          3989012         15       265934.1       276743.0       115321       432895      104874.1  cuLibraryLoadData                 
      0.0          2109653          7       301379.0       148372.0         3890       817169      352480.5  cudaMalloc                        
      0.0          1158763          6       193127.2         3620.0         3030      1141083      464401.9  cudaStreamSynchronize             
      0.0           521505        176         2963.1         2710.0          730        26470        2026.9  cudaEventRecord                   
      0.0           421386         12        35115.5        12920.0         4400       264433       72858.2  cudaLaunchKernel                  
      0.0           398892         80         4986.2         4295.0         3590        31400        3329.4  cuLaunchKernel                    
      0.0           247891        814          304.5          275.0          120         1610         150.7  cuGetProcAddress_v2               
      0.0           130621        168          777.5          590.0          470         4260         600.0  cudaEventCreate                   
      0.0           102281        188          544.0          410.0          320        16330        1244.8  cudaEventDestroy                  
      0.0            41890         20         2094.5          480.0          380        15330        3977.6  cudaEventCreateWithFlags          
      0.0            35611          2        17805.5        17805.5         1930        33681       22451.3  cudaStreamCreateWithFlags         
      0.0            32761          4         8190.3         3065.5         1510        25120       11328.9  cudaDeviceSynchronize             
      0.0            22630         20         1131.5          425.0          280         4720        1491.5  cudaStreamGetCaptureInfo_v2_v11030
      0.0            18180          2         9090.0         9090.0         4580        13600        6378.1  cudaStreamDestroy                 
      0.0            12500         16          781.3          555.0          490         3540         755.8  cuLibraryGetKernel                
      0.0             9200          4         2300.0         2115.0         1350         3620         957.4  cudaStreamWaitEvent               
      0.0             5700          1         5700.0         5700.0         5700         5700           0.0  cudaEventQuery                    
      0.0             4630          3         1543.3         1740.0          620         2270         842.4  cuInit                            
      0.0             3630          3         1210.0          260.0          170         3200        1724.0  cuModuleGetLoadingMode            
      0.0             1190          1         1190.0         1190.0         1190         1190           0.0  cuCtxSynchronize                  
      0.0              940          2          470.0          470.0          310          630         226.3  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9       8664294841         80  108303685.5  108459602.5  105329986  110032861     916427.1  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          4600035          4    1150008.8    1152681.0    1141512    1153161       5669.1  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          2689270          8     336158.8     335267.0      16800     657094     341384.7  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     97.6       3118659436      9  346517715.1  53572589.0      1631  855520201  400516995.5  [CUDA memcpy Host-to-Device]
      2.4         77225372      5   15445074.4      2144.0      1952   77215644   34530798.2  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  64800.042      9  7200.005   800.000     0.010  16000.000     8352.241  [CUDA memcpy Host-to-Device]
    800.000      5   160.000     0.000     0.000    800.000      357.771  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 20 (num_steps = 80)
number of batches= 4
t_gemm = 9415.892334 ms
t_h2d = 3019.553625 ms
t_d2h = 157.757998 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 1.614094 ms
t_cpu_alloc = 16803.808928 ms
t_init = 4267.262936 ms
t_end_2_end = 39214.487076 ms
Generating '/tmp/nsys-report-eee6.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_20_80.nsys-rep[1/7] [========41%                 ] nsys_report_db_10000_20_80.nsys-rep[1/7] [==============62%           ] nsys_report_db_10000_20_80.nsys-rep[1/7] [====================83%     ] nsys_report_db_10000_20_80.nsys-rep[1/7] [====================84%     ] nsys_report_db_10000_20_80.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_20_80.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_20_80.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_20_80.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_20_80.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_20_80.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_20_80.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_20_80.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_20_80.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_20_80.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_20_80.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_20_80.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_20_80.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_20_80.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_80.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [1%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [2%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [3%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [4%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [5%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [6%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [7%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [8%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [9%                          ] nsys_report_db_10000_20_80.sqlite[2/7] [10%                         ] nsys_report_db_10000_20_80.sqlite[2/7] [11%                         ] nsys_report_db_10000_20_80.sqlite[2/7] [12%                         ] nsys_report_db_10000_20_80.sqlite[2/7] [13%                         ] nsys_report_db_10000_20_80.sqlite[2/7] [14%                         ] nsys_report_db_10000_20_80.sqlite[2/7] [=15%                        ] nsys_report_db_10000_20_80.sqlite[2/7] [=16%                        ] nsys_report_db_10000_20_80.sqlite[2/7] [=17%                        ] nsys_report_db_10000_20_80.sqlite[2/7] [==18%                       ] nsys_report_db_10000_20_80.sqlite[2/7] [==19%                       ] nsys_report_db_10000_20_80.sqlite[2/7] [==20%                       ] nsys_report_db_10000_20_80.sqlite[2/7] [==21%                       ] nsys_report_db_10000_20_80.sqlite[2/7] [===22%                      ] nsys_report_db_10000_20_80.sqlite[2/7] [===23%                      ] nsys_report_db_10000_20_80.sqlite[2/7] [===24%                      ] nsys_report_db_10000_20_80.sqlite[2/7] [====25%                     ] nsys_report_db_10000_20_80.sqlite[2/7] [====26%                     ] nsys_report_db_10000_20_80.sqlite[2/7] [====27%                     ] nsys_report_db_10000_20_80.sqlite[2/7] [====28%                     ] nsys_report_db_10000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_20_80.sqlite[2/7] [======33%                   ] nsys_report_db_10000_20_80.sqlite[2/7] [======34%                   ] nsys_report_db_10000_20_80.sqlite[2/7] [======35%                   ] nsys_report_db_10000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_20_80.sqlite[2/7] [========40%                 ] nsys_report_db_10000_20_80.sqlite[2/7] [========41%                 ] nsys_report_db_10000_20_80.sqlite[2/7] [========42%                 ] nsys_report_db_10000_20_80.sqlite[2/7] [=========43%                ] nsys_report_db_10000_20_80.sqlite[2/7] [=========44%                ] nsys_report_db_10000_20_80.sqlite[2/7] [=========45%                ] nsys_report_db_10000_20_80.sqlite[2/7] [=========46%                ] nsys_report_db_10000_20_80.sqlite[2/7] [==========47%               ] nsys_report_db_10000_20_80.sqlite[2/7] [==========48%               ] nsys_report_db_10000_20_80.sqlite[2/7] [==========49%               ] nsys_report_db_10000_20_80.sqlite[2/7] [===========50%              ] nsys_report_db_10000_20_80.sqlite[2/7] [===========51%              ] nsys_report_db_10000_20_80.sqlite[2/7] [===========52%              ] nsys_report_db_10000_20_80.sqlite[2/7] [===========53%              ] nsys_report_db_10000_20_80.sqlite[2/7] [============54%             ] nsys_report_db_10000_20_80.sqlite[2/7] [============55%             ] nsys_report_db_10000_20_80.sqlite[2/7] [============56%             ] nsys_report_db_10000_20_80.sqlite[2/7] [============57%             ] nsys_report_db_10000_20_80.sqlite[2/7] [=============58%            ] nsys_report_db_10000_20_80.sqlite[2/7] [=============59%            ] nsys_report_db_10000_20_80.sqlite[2/7] [=============60%            ] nsys_report_db_10000_20_80.sqlite[2/7] [==============61%           ] nsys_report_db_10000_20_80.sqlite[2/7] [==============62%           ] nsys_report_db_10000_20_80.sqlite[2/7] [==============63%           ] nsys_report_db_10000_20_80.sqlite[2/7] [==============64%           ] nsys_report_db_10000_20_80.sqlite[2/7] [===============65%          ] nsys_report_db_10000_20_80.sqlite[2/7] [===============66%          ] nsys_report_db_10000_20_80.sqlite[2/7] [===============67%          ] nsys_report_db_10000_20_80.sqlite[2/7] [================68%         ] nsys_report_db_10000_20_80.sqlite[2/7] [================69%         ] nsys_report_db_10000_20_80.sqlite[2/7] [================70%         ] nsys_report_db_10000_20_80.sqlite[2/7] [================71%         ] nsys_report_db_10000_20_80.sqlite[2/7] [=================72%        ] nsys_report_db_10000_20_80.sqlite[2/7] [=================73%        ] nsys_report_db_10000_20_80.sqlite[2/7] [=================74%        ] nsys_report_db_10000_20_80.sqlite[2/7] [==================75%       ] nsys_report_db_10000_20_80.sqlite[2/7] [==================76%       ] nsys_report_db_10000_20_80.sqlite[2/7] [==================77%       ] nsys_report_db_10000_20_80.sqlite[2/7] [==================78%       ] nsys_report_db_10000_20_80.sqlite[2/7] [===================79%      ] nsys_report_db_10000_20_80.sqlite[2/7] [===================80%      ] nsys_report_db_10000_20_80.sqlite[2/7] [===================81%      ] nsys_report_db_10000_20_80.sqlite[2/7] [===================82%      ] nsys_report_db_10000_20_80.sqlite[2/7] [====================83%     ] nsys_report_db_10000_20_80.sqlite[2/7] [====================84%     ] nsys_report_db_10000_20_80.sqlite[2/7] [====================85%     ] nsys_report_db_10000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_20_80.sqlite[2/7] [======================90%   ] nsys_report_db_10000_20_80.sqlite[2/7] [======================91%   ] nsys_report_db_10000_20_80.sqlite[2/7] [======================92%   ] nsys_report_db_10000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_20_80.sqlite[2/7] [========================97% ] nsys_report_db_10000_20_80.sqlite[2/7] [========================98% ] nsys_report_db_10000_20_80.sqlite[2/7] [========================99% ] nsys_report_db_10000_20_80.sqlite[2/7] [========================100%] nsys_report_db_10000_20_80.sqlite[2/7] [========================100%] nsys_report_db_10000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        300193189          1  300193189.0  300193189.0  300193189  300193189          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     51.6      16803802763          1  16803802763.0  16803802763.0  16803802763  16803802763          0.0  cudaHostAlloc                     
     22.3       7253628314          1   7253628314.0   7253628314.0   7253628314   7253628314          0.0  cudaFreeHost                      
     20.1       6544258281         12    545354856.8        16885.5         6320   2184895741  986427182.1  cudaMemcpyAsync                   
      4.6       1495095782         80     18688697.3          290.0          280   1495065142  167153321.1  cuKernelGetFunction               
      0.6        204551492          8     25568936.5      4290912.0        28201    176944989   61314794.2  cudaFree                          
      0.4        133156269          2     66578134.5     66578134.5     53946121     79210148   17864364.8  cudaMemcpy                        
      0.4        121680354          1    121680354.0    121680354.0    121680354    121680354          0.0  cudaDeviceReset                   
      0.0          4040701         15       269380.1       287783.0       122121       437414     104658.2  cuLibraryLoadData                 
      0.0          2076243          7       296606.1       139441.0         3890       811549     351596.8  cudaMalloc                        
      0.0          1158793          6       193132.2         3620.0         2341      1140742     464233.0  cudaStreamSynchronize             
      0.0           490541        176         2787.2         2555.0          500        20690       1668.1  cudaEventRecord                   
      0.0           399106         12        33258.8         8500.0         4240       265903      73788.0  cudaLaunchKernel                  
      0.0           381355         80         4766.9         4130.0         3560        30121       3161.5  cuLaunchKernel                    
      0.0           248512        814          305.3          280.0          120         1160        144.0  cuGetProcAddress_v2               
      0.0           130632        168          777.6          580.0          460        10530        948.7  cudaEventCreate                   
      0.0           127451        188          677.9          480.0          340        18360       1397.0  cudaEventDestroy                  
      0.0            50520         20         2526.0          515.0          400        19460       5101.9  cudaEventCreateWithFlags          
      0.0            35360          4         8840.0         3650.0         1260        26800      12028.7  cudaDeviceSynchronize             
      0.0            34710          2        17355.0        17355.0         1940        32770      21800.1  cudaStreamCreateWithFlags         
      0.0            19621         20          981.1          400.0          290         3461       1209.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0            18110          2         9055.0         9055.0         4780        13330       6045.8  cudaStreamDestroy                 
      0.0            16620         16         1038.8          615.0          500         6490       1466.4  cuLibraryGetKernel                
      0.0            11140          4         2785.0         2785.0         2190         3380        642.5  cudaStreamWaitEvent               
      0.0             5630          1         5630.0         5630.0         5630         5630          0.0  cudaEventQuery                    
      0.0             4580          3         1526.7         1500.0          680         2400        860.3  cuInit                            
      0.0             3550          3         1183.3          260.0          250         3040       1607.9  cuModuleGetLoadingMode            
      0.0             1050          1         1050.0         1050.0         1050         1050          0.0  cuCtxSynchronize                  
      0.0              840          2          420.0          420.0          280          560        198.0  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9       8697879475         80  108723493.4  108617601.0  106415833  109835711     799320.9  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          4577186          4    1144296.5    1144424.0    1139881    1148457       4499.1  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          2688246          8     336030.8     333203.5      16608     659077     341260.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     97.4       3019321103      9  335480122.6  53792531.0      1600  796227110  386285171.1  [CUDA memcpy Host-to-Device]
      2.6         79018189      5   15803637.8      2016.0      1952   79008749   35332731.3  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  64800.042      9  7200.005   800.000     0.010  16000.000     8352.241  [CUDA memcpy Host-to-Device]
    800.000      5   160.000     0.000     0.000    800.000      357.771  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 20 (num_steps = 80), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  22.52 GB
Used GPU Memory:  16.98 GB
------------------------

Process RSS:  62.61 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 2.795219 ms
t_alloc_cpu = 16773.652792 ms
t_init      = 4334.585190 ms
t_h2d       = 3165.079653 ms
t_d2h       = 156.882048 ms
t_gemm      = 9455.077538 ms
t_end_2_end = 38628.654957 ms
Generating '/tmp/nsys-report-d27f.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [13%                         ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [====25%                     ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [====26%                     ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [========40%                 ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [========41%                 ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [========42%                 ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_10000_20_80.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_80.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [1%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [2%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [3%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [4%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [5%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [6%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [7%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [8%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [9%                          ] nsys_report_fo_10000_20_80.sqlite[2/7] [10%                         ] nsys_report_fo_10000_20_80.sqlite[2/7] [11%                         ] nsys_report_fo_10000_20_80.sqlite[2/7] [12%                         ] nsys_report_fo_10000_20_80.sqlite[2/7] [13%                         ] nsys_report_fo_10000_20_80.sqlite[2/7] [14%                         ] nsys_report_fo_10000_20_80.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_20_80.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_20_80.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_20_80.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_20_80.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_20_80.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_20_80.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_20_80.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_20_80.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_20_80.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_20_80.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_20_80.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_20_80.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_20_80.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_20_80.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_20_80.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_20_80.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_20_80.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_20_80.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_20_80.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_20_80.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_20_80.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_20_80.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_20_80.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_20_80.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_20_80.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_20_80.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_20_80.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_20_80.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_20_80.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_20_80.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_20_80.sqlite[2/7] [============54%             ] nsys_report_fo_10000_20_80.sqlite[2/7] [============55%             ] nsys_report_fo_10000_20_80.sqlite[2/7] [============56%             ] nsys_report_fo_10000_20_80.sqlite[2/7] [============57%             ] nsys_report_fo_10000_20_80.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_20_80.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_20_80.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_20_80.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_20_80.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_20_80.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_20_80.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_20_80.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_20_80.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_20_80.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_20_80.sqlite[2/7] [================68%         ] nsys_report_fo_10000_20_80.sqlite[2/7] [================69%         ] nsys_report_fo_10000_20_80.sqlite[2/7] [================70%         ] nsys_report_fo_10000_20_80.sqlite[2/7] [================71%         ] nsys_report_fo_10000_20_80.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_20_80.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_20_80.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_20_80.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_20_80.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_20_80.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_20_80.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_20_80.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_20_80.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_20_80.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_20_80.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_20_80.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_20_80.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_20_80.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_20_80.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_20_80.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_20_80.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_20_80.sqlite[2/7] [========================97% ] nsys_report_fo_10000_20_80.sqlite[2/7] [========================98% ] nsys_report_fo_10000_20_80.sqlite[2/7] [========================99% ] nsys_report_fo_10000_20_80.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_80.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        301429107          1  301429107.0  301429107.0  301429107  301429107          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.4      16773647398          1  16773647398.0  16773647398.0  16773647398  16773647398          0.0  cudaHostAlloc                     
     25.6       8709707841        240     36290449.3         9635.0         3210    112107929   51900988.3  cudaMemcpyAsync                   
     21.3       7218104187          1   7218104187.0   7218104187.0   7218104187   7218104187          0.0  cudaFreeHost                      
      2.4        805900652         80     10073758.2          520.0          350    805834381   90094928.9  cuKernelGetFunction               
      0.6        192132947         26      7389728.7       459440.0        52030    178408127   34885955.9  cudaFree                          
      0.4        131478742          2     65739371.0     65739371.0     52925111     78553631   18122100.3  cudaMemcpy                        
      0.4        120556942          1    120556942.0    120556942.0    120556942    120556942          0.0  cudaDeviceReset                   
      0.0          4001574         15       266771.6       278073.0       120811       434445     103770.3  cuLibraryLoadData                 
      0.0          2954542         25       118181.7       121402.0         4260       158321      28021.2  cudaMalloc                        
      0.0          1734222        240         7225.9         4640.0         4100       242223      15640.0  cudaLaunchKernel                  
      0.0          1342294         82        16369.4         2360.0         2000      1144753     126147.8  cudaStreamSynchronize             
      0.0          1173269        560         2095.1         2400.0          500        20800       1516.0  cudaEventRecord                   
      0.0           477996         80         5975.0         5050.0         4320        31220       3126.7  cuLaunchKernel                    
      0.0           267244        814          328.3          280.0          120        15540        554.1  cuGetProcAddress_v2               
      0.0           229792        320          718.1          570.0          460         8980        650.2  cudaEventCreate                   
      0.0           179311        400          448.3          300.0          270         2630        405.3  cudaStreamGetCaptureInfo_v2_v11030
      0.0           138142        140          986.7          870.0          560         3420        440.9  cudaStreamWaitEvent               
      0.0            78481          1        78481.0        78481.0        78481        78481          0.0  cudaMemGetInfo                    
      0.0            67980         58         1172.1          540.0          390        14520       2591.5  cudaEventCreateWithFlags          
      0.0            40241         58          693.8          525.0          340         4780        666.6  cudaEventDestroy                  
      0.0            38461          4         9615.3         2915.0         1780        30851      14178.0  cudaDeviceSynchronize             
      0.0            36381          2        18190.5        18190.5         2230        34151      22571.6  cudaStreamCreateWithFlags         
      0.0            18560          2         9280.0         9280.0         4510        14050       6745.8  cudaStreamDestroy                 
      0.0            16230         16         1014.4          595.0          510         6440       1457.1  cuLibraryGetKernel                
      0.0             5280          1         5280.0         5280.0         5280         5280          0.0  cudaEventQuery                    
      0.0             4500          3         1500.0         1410.0          690         2400        858.5  cuInit                            
      0.0             3220          3         1073.3          240.0          150         2830       1522.0  cuModuleGetLoadingMode            
      0.0             1060          1         1060.0         1060.0         1060         1060          0.0  cuCtxSynchronize                  
      0.0              900          2          450.0          450.0          310          590        198.0  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4       8672948615         80  108411857.7  108375701.0  105028373  110358461     874381.8  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0         91897857         80    1148723.2    1151320.5    1139657    1154569       5111.6  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         51856362        160     324102.3     321650.5      12544     641861     312276.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     97.6       3164327687    161  19654209.2  31904274.0      1568  54132998   20457893.6  [CUDA memcpy Host-to-Device]
      2.4         78686701     81    971440.8      1952.0      1920  78364267    8706711.8  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  64800.830    161   402.490   800.000     0.010   800.000      401.235  [CUDA memcpy Host-to-Device]
    800.001     81     9.877     0.000     0.000   800.000       88.889  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 20 (num_steps = 100)
number of batches= 5
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 10846.724869 ms
t_h2d = 3986.382750 ms
t_gpu_alloc = 1.847029 ms
t_cpu_alloc = 20903.663874 ms
t_init = 5220.155954 ms
t_d2h = 156.040192 ms
t_end_2_end = 50440.562010 ms
Generating '/tmp/nsys-report-1222.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=16%                        ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=====32%                    ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [======33%                   ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [======34%                   ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [================69%         ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [================70%         ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [================71%         ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=================72%        ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=================73%        ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=================74%        ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [==================75%       ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [==================76%       ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [==================77%       ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [==================78%       ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [===================79%      ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [===================80%      ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [===================81%      ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_20_100.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_100.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [1%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [2%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [3%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [4%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [5%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [6%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [7%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [8%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [9%                          ] nsys_report_ia_10000_20_100.sqlite[2/7] [10%                         ] nsys_report_ia_10000_20_100.sqlite[2/7] [11%                         ] nsys_report_ia_10000_20_100.sqlite[2/7] [12%                         ] nsys_report_ia_10000_20_100.sqlite[2/7] [13%                         ] nsys_report_ia_10000_20_100.sqlite[2/7] [14%                         ] nsys_report_ia_10000_20_100.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_20_100.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_20_100.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_20_100.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_20_100.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_20_100.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_20_100.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_20_100.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_20_100.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_20_100.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_20_100.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_20_100.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_20_100.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_20_100.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_20_100.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_20_100.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_20_100.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_20_100.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_20_100.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_20_100.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_20_100.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_20_100.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_20_100.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_20_100.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_20_100.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_20_100.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_20_100.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_20_100.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_20_100.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_20_100.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_20_100.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_20_100.sqlite[2/7] [============54%             ] nsys_report_ia_10000_20_100.sqlite[2/7] [============55%             ] nsys_report_ia_10000_20_100.sqlite[2/7] [============56%             ] nsys_report_ia_10000_20_100.sqlite[2/7] [============57%             ] nsys_report_ia_10000_20_100.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_20_100.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_20_100.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_20_100.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_20_100.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_20_100.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_20_100.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_20_100.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_20_100.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_20_100.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_20_100.sqlite[2/7] [================68%         ] nsys_report_ia_10000_20_100.sqlite[2/7] [================69%         ] nsys_report_ia_10000_20_100.sqlite[2/7] [================70%         ] nsys_report_ia_10000_20_100.sqlite[2/7] [================71%         ] nsys_report_ia_10000_20_100.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_20_100.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_20_100.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_20_100.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_20_100.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_20_100.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_20_100.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_20_100.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_20_100.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_20_100.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_20_100.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_20_100.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_20_100.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_20_100.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_20_100.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_20_100.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_20_100.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_20_100.sqlite[2/7] [========================97% ] nsys_report_ia_10000_20_100.sqlite[2/7] [========================98% ] nsys_report_ia_10000_20_100.sqlite[2/7] [========================99% ] nsys_report_ia_10000_20_100.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_100.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        280307199          1  280307199.0  280307199.0  280307199  280307199          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                  Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------------------
     48.8      20903658751          1  20903658751.0  20903658751.0  20903658751  20903658751           0.0  cudaHostAlloc                     
     27.4      11742276490         15    782818432.7        16210.0         6010   3026401253  1343969207.7  cudaMemcpyAsync                   
     20.7       8887674914          1   8887674914.0   8887674914.0   8887674914   8887674914           0.0  cudaFreeHost                      
      2.0        863968420        100      8639684.2          295.0          280    863927200    86392678.4  cuKernelGetFunction               
      0.4        186338548          8     23292318.5      4298307.0        28370    158715634    54886321.4  cudaFree                          
      0.3        130812726          2     65406363.0     65406363.0     53391976     77420750    16990909.0  cudaMemcpy                        
      0.3        118226859          1    118226859.0    118226859.0    118226859    118226859           0.0  cudaDeviceReset                   
      0.0          3941691         15       262779.4       274743.0       117971       427675      102122.8  cuLibraryLoadData                 
      0.0          2031983          7       290283.3       137642.0         3720       789498      337652.1  cudaMalloc                        
      0.0          1162092          7       166013.1         3630.0         2970      1140502      429709.3  cudaStreamSynchronize             
      0.0           622138        220         2827.9         2640.0          550        14321        1160.6  cudaEventRecord                   
      0.0           480016        100         4800.2         4240.0         3630        33580        3140.2  cuLaunchKernel                    
      0.0           439235         15        29282.3         8240.0         4380       259813       64490.6  cudaLaunchKernel                  
      0.0           240314        814          295.2          270.0          120         1080         137.1  cuGetProcAddress_v2               
      0.0           161821        210          770.6          580.0          470        10140        1002.0  cudaEventCreate                   
      0.0           124841        230          542.8          460.0          330        15370        1073.1  cudaEventDestroy                  
      0.0            44351          2        22175.5        22175.5         1900        42451       28673.9  cudaStreamCreateWithFlags         
      0.0            36260         20         1813.0          500.0          390        12900        3657.3  cudaEventCreateWithFlags          
      0.0            32790          4         8197.5         3085.0         1220        25400       11512.2  cudaDeviceSynchronize             
      0.0            27170         25         1086.8          430.0          290         6260        1536.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0            18760          2         9380.0         9380.0         6170        12590        4539.6  cudaStreamDestroy                 
      0.0             9640         16          602.5          510.0          480         1180         199.6  cuLibraryGetKernel                
      0.0             9530          5         1906.0         1500.0         1230         3400         909.5  cudaStreamWaitEvent               
      0.0             5470          1         5470.0         5470.0         5470         5470           0.0  cudaEventQuery                    
      0.0             4830          3         1610.0         1730.0          600         2500         955.7  cuInit                            
      0.0             3420          3         1140.0          340.0          240         2840        1473.1  cuModuleGetLoadingMode            
      0.0             1220          1         1220.0         1220.0         1220         1220           0.0  cuCtxSynchronize                  
      0.0              900          2          450.0          450.0          330          570         169.7  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9      10845867894        100  108458678.9  108466624.5  104927344  110472350    1012339.1  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          5739596          5    1147919.2    1148648.0    1141610    1152553       3954.5  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          3350233         10     335023.3     333730.5      16608     656325     335413.7  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     98.1       3985980967     11  362361906.1  53084204.0      1600  882082006  409522609.2  [CUDA memcpy Host-to-Device]
      1.9         77218089      6   12869681.5      1952.0      1952   77206665   31518556.2  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  80800.052     11  7345.459   800.000     0.010  16000.000     8289.309  [CUDA memcpy Host-to-Device]
    800.000      6   133.333     0.000     0.000    800.000      326.599  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 20 (num_steps = 100)
number of batches= 5
t_gemm = 11624.102135 ms
t_h2d = 3862.078392 ms
t_d2h = 156.532049 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 1.597166 ms
t_cpu_alloc = 20852.749825 ms
t_init = 7597.034216 ms
t_end_2_end = 50501.585007 ms
Generating '/tmp/nsys-report-1cc1.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=17%                        ] nsys_report_db_10000_20_100.nsys-rep[1/7] [======33%                   ] nsys_report_db_10000_20_100.nsys-rep[1/7] [======34%                   ] nsys_report_db_10000_20_100.nsys-rep[1/7] [======35%                   ] nsys_report_db_10000_20_100.nsys-rep[1/7] [================70%         ] nsys_report_db_10000_20_100.nsys-rep[1/7] [================71%         ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=================72%        ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=================73%        ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=================74%        ] nsys_report_db_10000_20_100.nsys-rep[1/7] [==================75%       ] nsys_report_db_10000_20_100.nsys-rep[1/7] [==================76%       ] nsys_report_db_10000_20_100.nsys-rep[1/7] [==================77%       ] nsys_report_db_10000_20_100.nsys-rep[1/7] [==================78%       ] nsys_report_db_10000_20_100.nsys-rep[1/7] [===================79%      ] nsys_report_db_10000_20_100.nsys-rep[1/7] [===================80%      ] nsys_report_db_10000_20_100.nsys-rep[1/7] [===================81%      ] nsys_report_db_10000_20_100.nsys-rep[1/7] [===================82%      ] nsys_report_db_10000_20_100.nsys-rep[1/7] [====================83%     ] nsys_report_db_10000_20_100.nsys-rep[1/7] [====================84%     ] nsys_report_db_10000_20_100.nsys-rep[1/7] [====================85%     ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=====================86%    ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=====================87%    ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=====================88%    ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=====================89%    ] nsys_report_db_10000_20_100.nsys-rep[1/7] [======================90%   ] nsys_report_db_10000_20_100.nsys-rep[1/7] [======================91%   ] nsys_report_db_10000_20_100.nsys-rep[1/7] [======================92%   ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=======================93%  ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=======================94%  ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=======================95%  ] nsys_report_db_10000_20_100.nsys-rep[1/7] [=======================96%  ] nsys_report_db_10000_20_100.nsys-rep[1/7] [========================97% ] nsys_report_db_10000_20_100.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_100.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [1%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [2%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [3%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [4%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [5%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [6%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [7%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [8%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [9%                          ] nsys_report_db_10000_20_100.sqlite[2/7] [10%                         ] nsys_report_db_10000_20_100.sqlite[2/7] [11%                         ] nsys_report_db_10000_20_100.sqlite[2/7] [12%                         ] nsys_report_db_10000_20_100.sqlite[2/7] [13%                         ] nsys_report_db_10000_20_100.sqlite[2/7] [14%                         ] nsys_report_db_10000_20_100.sqlite[2/7] [=15%                        ] nsys_report_db_10000_20_100.sqlite[2/7] [=16%                        ] nsys_report_db_10000_20_100.sqlite[2/7] [=17%                        ] nsys_report_db_10000_20_100.sqlite[2/7] [==18%                       ] nsys_report_db_10000_20_100.sqlite[2/7] [==19%                       ] nsys_report_db_10000_20_100.sqlite[2/7] [==20%                       ] nsys_report_db_10000_20_100.sqlite[2/7] [==21%                       ] nsys_report_db_10000_20_100.sqlite[2/7] [===22%                      ] nsys_report_db_10000_20_100.sqlite[2/7] [===23%                      ] nsys_report_db_10000_20_100.sqlite[2/7] [===24%                      ] nsys_report_db_10000_20_100.sqlite[2/7] [====25%                     ] nsys_report_db_10000_20_100.sqlite[2/7] [====26%                     ] nsys_report_db_10000_20_100.sqlite[2/7] [====27%                     ] nsys_report_db_10000_20_100.sqlite[2/7] [====28%                     ] nsys_report_db_10000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_20_100.sqlite[2/7] [======33%                   ] nsys_report_db_10000_20_100.sqlite[2/7] [======34%                   ] nsys_report_db_10000_20_100.sqlite[2/7] [======35%                   ] nsys_report_db_10000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_20_100.sqlite[2/7] [========40%                 ] nsys_report_db_10000_20_100.sqlite[2/7] [========41%                 ] nsys_report_db_10000_20_100.sqlite[2/7] [========42%                 ] nsys_report_db_10000_20_100.sqlite[2/7] [=========43%                ] nsys_report_db_10000_20_100.sqlite[2/7] [=========44%                ] nsys_report_db_10000_20_100.sqlite[2/7] [=========45%                ] nsys_report_db_10000_20_100.sqlite[2/7] [=========46%                ] nsys_report_db_10000_20_100.sqlite[2/7] [==========47%               ] nsys_report_db_10000_20_100.sqlite[2/7] [==========48%               ] nsys_report_db_10000_20_100.sqlite[2/7] [==========49%               ] nsys_report_db_10000_20_100.sqlite[2/7] [===========50%              ] nsys_report_db_10000_20_100.sqlite[2/7] [===========51%              ] nsys_report_db_10000_20_100.sqlite[2/7] [===========52%              ] nsys_report_db_10000_20_100.sqlite[2/7] [===========53%              ] nsys_report_db_10000_20_100.sqlite[2/7] [============54%             ] nsys_report_db_10000_20_100.sqlite[2/7] [============55%             ] nsys_report_db_10000_20_100.sqlite[2/7] [============56%             ] nsys_report_db_10000_20_100.sqlite[2/7] [============57%             ] nsys_report_db_10000_20_100.sqlite[2/7] [=============58%            ] nsys_report_db_10000_20_100.sqlite[2/7] [=============59%            ] nsys_report_db_10000_20_100.sqlite[2/7] [=============60%            ] nsys_report_db_10000_20_100.sqlite[2/7] [==============61%           ] nsys_report_db_10000_20_100.sqlite[2/7] [==============62%           ] nsys_report_db_10000_20_100.sqlite[2/7] [==============63%           ] nsys_report_db_10000_20_100.sqlite[2/7] [==============64%           ] nsys_report_db_10000_20_100.sqlite[2/7] [===============65%          ] nsys_report_db_10000_20_100.sqlite[2/7] [===============66%          ] nsys_report_db_10000_20_100.sqlite[2/7] [===============67%          ] nsys_report_db_10000_20_100.sqlite[2/7] [================68%         ] nsys_report_db_10000_20_100.sqlite[2/7] [================69%         ] nsys_report_db_10000_20_100.sqlite[2/7] [================70%         ] nsys_report_db_10000_20_100.sqlite[2/7] [================71%         ] nsys_report_db_10000_20_100.sqlite[2/7] [=================72%        ] nsys_report_db_10000_20_100.sqlite[2/7] [=================73%        ] nsys_report_db_10000_20_100.sqlite[2/7] [=================74%        ] nsys_report_db_10000_20_100.sqlite[2/7] [==================75%       ] nsys_report_db_10000_20_100.sqlite[2/7] [==================76%       ] nsys_report_db_10000_20_100.sqlite[2/7] [==================77%       ] nsys_report_db_10000_20_100.sqlite[2/7] [==================78%       ] nsys_report_db_10000_20_100.sqlite[2/7] [===================79%      ] nsys_report_db_10000_20_100.sqlite[2/7] [===================80%      ] nsys_report_db_10000_20_100.sqlite[2/7] [===================81%      ] nsys_report_db_10000_20_100.sqlite[2/7] [===================82%      ] nsys_report_db_10000_20_100.sqlite[2/7] [====================83%     ] nsys_report_db_10000_20_100.sqlite[2/7] [====================84%     ] nsys_report_db_10000_20_100.sqlite[2/7] [====================85%     ] nsys_report_db_10000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_20_100.sqlite[2/7] [======================90%   ] nsys_report_db_10000_20_100.sqlite[2/7] [======================91%   ] nsys_report_db_10000_20_100.sqlite[2/7] [======================92%   ] nsys_report_db_10000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_20_100.sqlite[2/7] [========================97% ] nsys_report_db_10000_20_100.sqlite[2/7] [========================98% ] nsys_report_db_10000_20_100.sqlite[2/7] [========================99% ] nsys_report_db_10000_20_100.sqlite[2/7] [========================100%] nsys_report_db_10000_20_100.sqlite[2/7] [========================100%] nsys_report_db_10000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        298836737          1  298836737.0  298836737.0  298836737  298836737          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     51.5      20852743428          1  20852743428.0  20852743428.0  20852743428  20852743428          0.0  cudaHostAlloc                     
     22.0       8905247830          1   8905247830.0   8905247830.0   8905247830   8905247830          0.0  cudaFreeHost                      
     21.5       8706512433         15    580434162.2        16861.0         6570   2185452306  996206338.6  cudaMemcpyAsync                   
      3.9       1599176358        100     15991763.6          290.0          280   1599135828  159913541.9  cuKernelGetFunction               
      0.5        202185703          8     25273212.9      4298127.5        51271    174083914   60287774.7  cudaFree                          
      0.3        132715450          2     66357725.0     66357725.0     54470729     78244721   16810751.0  cudaMemcpy                        
      0.3        118457523          1    118457523.0    118457523.0    118457523    118457523          0.0  cudaDeviceReset                   
      0.0          3959354         15       263956.9       288834.0       116001       429755     104346.2  cuLibraryLoadData                 
      0.0          2069793          7       295684.7       143241.0         3771       813759     346499.3  cudaMalloc                        
      0.0          1162572          7       166081.7         3270.0         2580      1141822     430261.6  cudaStreamSynchronize             
      0.0           621575        220         2825.3         2660.0          550        15090       1221.2  cudaEventRecord                   
      0.0           472456        100         4724.6         4165.0         3560        33530       3151.8  cuLaunchKernel                    
      0.0           438346         15        29223.1         8471.0         4300       262333      65109.3  cudaLaunchKernel                  
      0.0           260123        814          319.6          290.0          110         1200        160.0  cuGetProcAddress_v2               
      0.0           160963        210          766.5          590.0          460        10000        932.4  cudaEventCreate                   
      0.0           133171        230          579.0          460.0          320        17710       1269.7  cudaEventDestroy                  
      0.0            42921          2        21460.5        21460.5         1970        40951      27563.7  cudaStreamCreateWithFlags         
      0.0            39100         20         1955.0          500.0          380        16910       4338.1  cudaEventCreateWithFlags          
      0.0            37420          4         9355.0         3285.0         1400        29450      13437.4  cudaDeviceSynchronize             
      0.0            27710         25         1108.4          450.0          310         6270       1501.1  cudaStreamGetCaptureInfo_v2_v11030
      0.0            19940          2         9970.0         9970.0         6450        13490       4978.0  cudaStreamDestroy                 
      0.0            14290          5         2858.0         2690.0         2180         3860        653.6  cudaStreamWaitEvent               
      0.0            10500         16          656.3          555.0          480         1440        265.0  cuLibraryGetKernel                
      0.0             4650          1         4650.0         4650.0         4650         4650          0.0  cudaEventQuery                    
      0.0             4530          3         1510.0         1890.0          570         2070        819.0  cuInit                            
      0.0             3390          3         1130.0          240.0          170         2980       1602.5  cuModuleGetLoadingMode            
      0.0             1180          1         1180.0         1180.0         1180         1180          0.0  cuCtxSynchronize                  
      0.0              890          2          445.0          445.0          310          580        190.9  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9      10852754158        100  108527541.6  108618632.5  105120108  110009869     940370.6  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          5738317          5    1147663.4    1148489.0    1141737    1153161       5596.7  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          3353049         10     335304.9     334562.5      16416     655781     335809.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     98.0       3861571467     11  351051951.5  54066609.0      1600  846920879  394837316.3  [CUDA memcpy Host-to-Device]
      2.0         78051852      6   13008642.0      1952.0      1951   78040430   31858939.5  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  80800.052     11  7345.459   800.000     0.010  16000.000     8289.309  [CUDA memcpy Host-to-Device]
    800.000      6   133.333     0.000     0.000    800.000      326.599  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 20 (num_steps = 100), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  22.49 GB
Used GPU Memory:  17.01 GB
------------------------

Process RSS:  77.51 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 2.827883 ms
t_alloc_cpu = 20952.547073 ms
t_init      = 5206.994057 ms
t_h2d       = 3915.188658 ms
t_d2h       = 155.900002 ms
t_gemm      = 11651.436096 ms
t_end_2_end = 47572.353125 ms
Generating '/tmp/nsys-report-846b.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [11%                         ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [===23%                      ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [===24%                      ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [====25%                     ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [====26%                     ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [=======================93%  ] nsys_report_fo_10000_20_100.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_100.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [1%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [2%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [3%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [4%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [5%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [6%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [7%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [8%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [9%                          ] nsys_report_fo_10000_20_100.sqlite[2/7] [10%                         ] nsys_report_fo_10000_20_100.sqlite[2/7] [11%                         ] nsys_report_fo_10000_20_100.sqlite[2/7] [12%                         ] nsys_report_fo_10000_20_100.sqlite[2/7] [13%                         ] nsys_report_fo_10000_20_100.sqlite[2/7] [14%                         ] nsys_report_fo_10000_20_100.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_20_100.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_20_100.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_20_100.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_20_100.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_20_100.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_20_100.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_20_100.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_20_100.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_20_100.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_20_100.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_20_100.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_20_100.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_20_100.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_20_100.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_20_100.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_20_100.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_20_100.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_20_100.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_20_100.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_20_100.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_20_100.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_20_100.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_20_100.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_20_100.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_20_100.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_20_100.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_20_100.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_20_100.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_20_100.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_20_100.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_20_100.sqlite[2/7] [============54%             ] nsys_report_fo_10000_20_100.sqlite[2/7] [============55%             ] nsys_report_fo_10000_20_100.sqlite[2/7] [============56%             ] nsys_report_fo_10000_20_100.sqlite[2/7] [============57%             ] nsys_report_fo_10000_20_100.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_20_100.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_20_100.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_20_100.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_20_100.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_20_100.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_20_100.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_20_100.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_20_100.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_20_100.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_20_100.sqlite[2/7] [================68%         ] nsys_report_fo_10000_20_100.sqlite[2/7] [================69%         ] nsys_report_fo_10000_20_100.sqlite[2/7] [================70%         ] nsys_report_fo_10000_20_100.sqlite[2/7] [================71%         ] nsys_report_fo_10000_20_100.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_20_100.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_20_100.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_20_100.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_20_100.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_20_100.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_20_100.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_20_100.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_20_100.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_20_100.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_20_100.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_20_100.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_20_100.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_20_100.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_20_100.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_20_100.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_20_100.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_20_100.sqlite[2/7] [========================97% ] nsys_report_fo_10000_20_100.sqlite[2/7] [========================98% ] nsys_report_fo_10000_20_100.sqlite[2/7] [========================99% ] nsys_report_fo_10000_20_100.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_100.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        293960867          1  293960867.0  293960867.0  293960867  293960867          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     49.8      20952541866          1  20952541866.0  20952541866.0  20952541866  20952541866          0.0  cudaHostAlloc                     
     26.0      10921482473        300     36404941.6         9520.0         3250    112102864   51946150.7  cudaMemcpyAsync                   
     21.1       8886754102          1   8886754102.0   8886754102.0   8886754102   8886754102          0.0  cudaFreeHost                      
      2.0        823717050        100      8237170.5          555.0          410    823613878   82361283.6  cuKernelGetFunction               
      0.4        184776743         26      7106797.8       458815.5        55650    171786301   33591123.4  cudaFree                          
      0.3        130438197          2     65219098.5     65219098.5     52754151     77684046   17628097.8  cudaMemcpy                        
      0.3        121166024          1    121166024.0    121166024.0    121166024    121166024          0.0  cudaDeviceReset                   
      0.0          3966853         15       264456.9       280743.0       116561       434905     103885.0  cuLibraryLoadData                 
      0.0          2990923         25       119636.9       119431.0         3740       147612      28716.0  cudaMalloc                        
      0.0          2208010        300         7360.0         4695.0         4050       244483      14247.8  cudaLaunchKernel                  
      0.0          1487794        700         2125.4         2440.0          490        13900       1399.6  cudaEventRecord                   
      0.0          1389536        102        13622.9         2405.5         1870      1140603     112693.0  cudaStreamSynchronize             
      0.0           614942        100         6149.4         5490.0         4230        32340       2964.8  cuLaunchKernel                    
      0.0           277272        400          693.2          570.0          460         9100        602.4  cudaEventCreate                   
      0.0           246382        814          302.7          280.0          120         1310        144.5  cuGetProcAddress_v2               
      0.0           238882        500          477.8          310.0          270         3010        488.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0           183742        180         1020.8          870.0          580         3530        463.4  cudaStreamWaitEvent               
      0.0            74001          1        74001.0        74001.0        74001        74001          0.0  cudaMemGetInfo                    
      0.0            68252         58         1176.8          510.0          380        14030       2405.2  cudaEventCreateWithFlags          
      0.0            45011          2        22505.5        22505.5         2020        42991      28970.9  cudaStreamCreateWithFlags         
      0.0            42271         58          728.8          545.0          330         4380        659.2  cudaEventDestroy                  
      0.0            39041          4         9760.3         3085.0         1340        31531      14545.8  cudaDeviceSynchronize             
      0.0            20330          2        10165.0        10165.0         4900        15430       7445.8  cudaStreamDestroy                 
      0.0            10810         16          675.6          590.0          500         1410        292.9  cuLibraryGetKernel                
      0.0             4861          1         4861.0         4861.0         4861         4861          0.0  cudaEventQuery                    
      0.0             4430          3         1476.7         1530.0          710         2190        741.4  cuInit                            
      0.0             3770          3         1256.7          260.0          160         3350       1813.6  cuModuleGetLoadingMode            
      0.0             1090          1         1090.0         1090.0         1090         1090          0.0  cuCtxSynchronize                  
      0.0              890          2          445.0          445.0          310          580        190.9  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4      10849087254        100  108490872.5  108529369.5  105048751  110326795     884763.3  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0        114950226        100    1149502.3    1151992.5    1139496    1154664       4819.6  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         64900871        200     324504.4     321762.5      12576     643461     312470.2  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     98.1       3914250948    201  19473885.3  31912051.0      1567  54170583   20263807.6  [CUDA memcpy Host-to-Device]
      1.9         77693234    101    769239.9      1952.0      1920  77494957    7710839.1  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  80801.038    201   401.995   800.000     0.010   800.000      400.989  [CUDA memcpy Host-to-Device]
    800.001    101     7.921     0.000     0.000   800.000       79.603  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 10000, batch_size = 20 (num_steps = 150)
number of batches= 8
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gemm = 16296.016190 ms
t_h2d = 5666.712635 ms
t_gpu_alloc = 1.895905 ms
t_cpu_alloc = 31133.970976 ms
t_init = 7781.139135 ms
t_d2h = 156.188965 ms
t_end_2_end = 76826.568127 ms
Generating '/tmp/nsys-report-d8e8.qdstrm'
[1/7] [0%                          ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=====31%                    ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [========42%                 ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [============54%             ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [============55%             ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [============56%             ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [============57%             ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=============58%            ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=============59%            ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=============60%            ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [==============61%           ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [==============62%           ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [==============63%           ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [===============65%          ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [===============66%          ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [===============67%          ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [================68%         ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [================69%         ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [================70%         ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [================71%         ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=================72%        ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=================73%        ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=================74%        ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [==================75%       ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [==================76%       ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [==================77%       ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [==================78%       ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [===================79%      ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [===================80%      ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [===================81%      ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [===================82%      ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [====================83%     ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [====================84%     ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [====================85%     ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [======================90%   ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [======================91%   ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [======================92%   ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [========================97% ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_10000_20_150.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_150.nsys-rep[1/7] [========================100%] nsys_report_ia_10000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [1%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [2%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [3%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [4%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [5%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [6%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [7%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [8%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [9%                          ] nsys_report_ia_10000_20_150.sqlite[2/7] [10%                         ] nsys_report_ia_10000_20_150.sqlite[2/7] [11%                         ] nsys_report_ia_10000_20_150.sqlite[2/7] [12%                         ] nsys_report_ia_10000_20_150.sqlite[2/7] [13%                         ] nsys_report_ia_10000_20_150.sqlite[2/7] [14%                         ] nsys_report_ia_10000_20_150.sqlite[2/7] [=15%                        ] nsys_report_ia_10000_20_150.sqlite[2/7] [=16%                        ] nsys_report_ia_10000_20_150.sqlite[2/7] [=17%                        ] nsys_report_ia_10000_20_150.sqlite[2/7] [==18%                       ] nsys_report_ia_10000_20_150.sqlite[2/7] [==19%                       ] nsys_report_ia_10000_20_150.sqlite[2/7] [==20%                       ] nsys_report_ia_10000_20_150.sqlite[2/7] [==21%                       ] nsys_report_ia_10000_20_150.sqlite[2/7] [===22%                      ] nsys_report_ia_10000_20_150.sqlite[2/7] [===23%                      ] nsys_report_ia_10000_20_150.sqlite[2/7] [===24%                      ] nsys_report_ia_10000_20_150.sqlite[2/7] [====25%                     ] nsys_report_ia_10000_20_150.sqlite[2/7] [====26%                     ] nsys_report_ia_10000_20_150.sqlite[2/7] [====27%                     ] nsys_report_ia_10000_20_150.sqlite[2/7] [====28%                     ] nsys_report_ia_10000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_10000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_10000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_10000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_10000_20_150.sqlite[2/7] [======33%                   ] nsys_report_ia_10000_20_150.sqlite[2/7] [======34%                   ] nsys_report_ia_10000_20_150.sqlite[2/7] [======35%                   ] nsys_report_ia_10000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_10000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_10000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_10000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_10000_20_150.sqlite[2/7] [========40%                 ] nsys_report_ia_10000_20_150.sqlite[2/7] [========41%                 ] nsys_report_ia_10000_20_150.sqlite[2/7] [========42%                 ] nsys_report_ia_10000_20_150.sqlite[2/7] [=========43%                ] nsys_report_ia_10000_20_150.sqlite[2/7] [=========44%                ] nsys_report_ia_10000_20_150.sqlite[2/7] [=========45%                ] nsys_report_ia_10000_20_150.sqlite[2/7] [=========46%                ] nsys_report_ia_10000_20_150.sqlite[2/7] [==========47%               ] nsys_report_ia_10000_20_150.sqlite[2/7] [==========48%               ] nsys_report_ia_10000_20_150.sqlite[2/7] [==========49%               ] nsys_report_ia_10000_20_150.sqlite[2/7] [===========50%              ] nsys_report_ia_10000_20_150.sqlite[2/7] [===========51%              ] nsys_report_ia_10000_20_150.sqlite[2/7] [===========52%              ] nsys_report_ia_10000_20_150.sqlite[2/7] [===========53%              ] nsys_report_ia_10000_20_150.sqlite[2/7] [============54%             ] nsys_report_ia_10000_20_150.sqlite[2/7] [============55%             ] nsys_report_ia_10000_20_150.sqlite[2/7] [============56%             ] nsys_report_ia_10000_20_150.sqlite[2/7] [============57%             ] nsys_report_ia_10000_20_150.sqlite[2/7] [=============58%            ] nsys_report_ia_10000_20_150.sqlite[2/7] [=============59%            ] nsys_report_ia_10000_20_150.sqlite[2/7] [=============60%            ] nsys_report_ia_10000_20_150.sqlite[2/7] [==============61%           ] nsys_report_ia_10000_20_150.sqlite[2/7] [==============62%           ] nsys_report_ia_10000_20_150.sqlite[2/7] [==============63%           ] nsys_report_ia_10000_20_150.sqlite[2/7] [==============64%           ] nsys_report_ia_10000_20_150.sqlite[2/7] [===============65%          ] nsys_report_ia_10000_20_150.sqlite[2/7] [===============66%          ] nsys_report_ia_10000_20_150.sqlite[2/7] [===============67%          ] nsys_report_ia_10000_20_150.sqlite[2/7] [================68%         ] nsys_report_ia_10000_20_150.sqlite[2/7] [================69%         ] nsys_report_ia_10000_20_150.sqlite[2/7] [================70%         ] nsys_report_ia_10000_20_150.sqlite[2/7] [================71%         ] nsys_report_ia_10000_20_150.sqlite[2/7] [=================72%        ] nsys_report_ia_10000_20_150.sqlite[2/7] [=================73%        ] nsys_report_ia_10000_20_150.sqlite[2/7] [=================74%        ] nsys_report_ia_10000_20_150.sqlite[2/7] [==================75%       ] nsys_report_ia_10000_20_150.sqlite[2/7] [==================76%       ] nsys_report_ia_10000_20_150.sqlite[2/7] [==================77%       ] nsys_report_ia_10000_20_150.sqlite[2/7] [==================78%       ] nsys_report_ia_10000_20_150.sqlite[2/7] [===================79%      ] nsys_report_ia_10000_20_150.sqlite[2/7] [===================80%      ] nsys_report_ia_10000_20_150.sqlite[2/7] [===================81%      ] nsys_report_ia_10000_20_150.sqlite[2/7] [===================82%      ] nsys_report_ia_10000_20_150.sqlite[2/7] [====================83%     ] nsys_report_ia_10000_20_150.sqlite[2/7] [====================84%     ] nsys_report_ia_10000_20_150.sqlite[2/7] [====================85%     ] nsys_report_ia_10000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_10000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_10000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_10000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_10000_20_150.sqlite[2/7] [======================90%   ] nsys_report_ia_10000_20_150.sqlite[2/7] [======================91%   ] nsys_report_ia_10000_20_150.sqlite[2/7] [======================92%   ] nsys_report_ia_10000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_10000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_10000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_10000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_10000_20_150.sqlite[2/7] [========================97% ] nsys_report_ia_10000_20_150.sqlite[2/7] [========================98% ] nsys_report_ia_10000_20_150.sqlite[2/7] [========================99% ] nsys_report_ia_10000_20_150.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_150.sqlite[2/7] [========================100%] nsys_report_ia_10000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        305131154          1  305131154.0  305131154.0  305131154  305131154          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                  Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------------------
     46.7      31133964700          1  31133964700.0  31133964700.0  31133964700  31133964700           0.0  cudaHostAlloc                     
     28.5      19006937095         24    791955712.3        14685.0         7520   2957395041  1294444608.1  cudaMemcpyAsync                   
     23.0      15321096774          1  15321096774.0  15321096774.0  15321096774  15321096774           0.0  cudaFreeHost                      
      1.1        734305475        150      4895369.8          300.0          280    734242444    59950610.0  cuKernelGetFunction               
      0.3        207646848          8     25955856.0      4296867.5        28120    180176706    62459275.6  cudaFree                          
      0.2        131427939          2     65713969.5     65713969.5     53511360     77916579    17257095.9  cudaMemcpy                        
      0.2        121019494          1    121019494.0    121019494.0    121019494    121019494           0.0  cudaDeviceReset                   
      0.0          3917182         15       261145.5       274613.0       117741       424144      101520.4  cuLibraryLoadData                 
      0.0          2072972          7       296138.9       140731.0         3930       810109      349393.2  cudaMalloc                        
      0.0          1172553         10       117255.3         3545.0         2290      1139943      359336.5  cudaStreamSynchronize             
      0.0           960320        332         2892.5         2740.0          550        13930        1067.4  cudaEventRecord                   
      0.0           721156        150         4807.7         4300.0         3540        31660        2651.2  cuLaunchKernel                    
      0.0           571698         24        23820.8         8375.0         4500       264253       52182.8  cudaLaunchKernel                  
      0.0           254581        814          312.8          280.0          130         1480         144.0  cuGetProcAddress_v2               
      0.0           243232        316          769.7          590.0          480         9810         732.3  cudaEventCreate                   
      0.0           165641        336          493.0          430.0          330        16280         929.8  cudaEventDestroy                  
      0.0            45301         40         1132.5          365.0          300         6111        1560.8  cudaStreamGetCaptureInfo_v2_v11030
      0.0            42032         20         2101.6          500.0          390        12990        3908.7  cudaEventCreateWithFlags          
      0.0            36781          2        18390.5        18390.5         2030        34751       23137.2  cudaStreamCreateWithFlags         
      0.0            34942          4         8735.5         3670.5         1420        26181       11686.3  cudaDeviceSynchronize             
      0.0            16780          2         8390.0         8390.0         4020        12760        6180.1  cudaStreamDestroy                 
      0.0            14750          8         1843.8         1600.0         1040         3340         861.5  cudaStreamWaitEvent               
      0.0            11120         16          695.0          600.0          500         1520         263.9  cuLibraryGetKernel                
      0.0             5130          1         5130.0         5130.0         5130         5130           0.0  cudaEventQuery                    
      0.0             4810          3         1603.3         1530.0          850         2430         792.5  cuInit                            
      0.0             3520          3         1173.3          280.0          170         3070        1643.5  cuModuleGetLoadingMode            
      0.0              990          1          990.0          990.0          990          990           0.0  cuCtxSynchronize                  
      0.0              970          2          485.0          485.0          440          530          63.6  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9      16294975666        150  108633171.1  108659231.0  105264493  111249474    1164863.5  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          9208390          8    1151048.8    1152569.0    1139657    1153897       4642.6  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          5372938         16     335808.6     334306.5      16289     658276     329540.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     98.6       5666438863     17  333319933.1  53362630.0      1600  772937761  372826802.8  [CUDA memcpy Host-to-Device]
      1.4         77731928      9    8636880.9      1952.0      1920   77714778   25904211.4  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
 120800.083     17  7105.887   800.000     0.010  16000.000     7898.767  [CUDA memcpy Host-to-Device]
    800.000      9    88.889     0.000     0.000    800.000      266.667  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_10000_20_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 10000, batch_size = 20 (num_steps = 150)
number of batches= 8
t_gemm = 17040.185509 ms
t_h2d = 5673.224098 ms
t_d2h = 155.479908 ms
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_gpu_alloc = 1.592159 ms
t_cpu_alloc = 31071.657896 ms
t_init = 7840.923071 ms
t_end_2_end = 72044.523001 ms
Generating '/tmp/nsys-report-d5fb.qdstrm'
[1/7] [0%                          ] nsys_report_db_10000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_db_10000_20_150.nsys-rep[1/7] [12%                         ] nsys_report_db_10000_20_150.nsys-rep[1/7] [===24%                      ] nsys_report_db_10000_20_150.nsys-rep[1/7] [====25%                     ] nsys_report_db_10000_20_150.nsys-rep[1/7] [====26%                     ] nsys_report_db_10000_20_150.nsys-rep[1/7] [====27%                     ] nsys_report_db_10000_20_150.nsys-rep[1/7] [====28%                     ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=====29%                    ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=====31%                    ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=====32%                    ] nsys_report_db_10000_20_150.nsys-rep[1/7] [======33%                   ] nsys_report_db_10000_20_150.nsys-rep[1/7] [======34%                   ] nsys_report_db_10000_20_150.nsys-rep[1/7] [======35%                   ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=======36%                  ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=======37%                  ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=======38%                  ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=======39%                  ] nsys_report_db_10000_20_150.nsys-rep[1/7] [========40%                 ] nsys_report_db_10000_20_150.nsys-rep[1/7] [========41%                 ] nsys_report_db_10000_20_150.nsys-rep[1/7] [========42%                 ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=========43%                ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=========44%                ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=========45%                ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=========46%                ] nsys_report_db_10000_20_150.nsys-rep[1/7] [==========47%               ] nsys_report_db_10000_20_150.nsys-rep[1/7] [==========48%               ] nsys_report_db_10000_20_150.nsys-rep[1/7] [==========49%               ] nsys_report_db_10000_20_150.nsys-rep[1/7] [===========50%              ] nsys_report_db_10000_20_150.nsys-rep[1/7] [===========51%              ] nsys_report_db_10000_20_150.nsys-rep[1/7] [===========52%              ] nsys_report_db_10000_20_150.nsys-rep[1/7] [===========53%              ] nsys_report_db_10000_20_150.nsys-rep[1/7] [============54%             ] nsys_report_db_10000_20_150.nsys-rep[1/7] [============55%             ] nsys_report_db_10000_20_150.nsys-rep[1/7] [============56%             ] nsys_report_db_10000_20_150.nsys-rep[1/7] [============57%             ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=============58%            ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=============59%            ] nsys_report_db_10000_20_150.nsys-rep[1/7] [=============60%            ] nsys_report_db_10000_20_150.nsys-rep[1/7] [==============61%           ] nsys_report_db_10000_20_150.nsys-rep[1/7] [==============62%           ] nsys_report_db_10000_20_150.nsys-rep[1/7] [==============63%           ] nsys_report_db_10000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_10000_20_150.nsys-rep[1/7] [===============65%          ] nsys_report_db_10000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_db_10000_20_150.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_150.nsys-rep[1/7] [========================100%] nsys_report_db_10000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [1%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [2%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [3%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [4%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [5%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [6%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [7%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [8%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [9%                          ] nsys_report_db_10000_20_150.sqlite[2/7] [10%                         ] nsys_report_db_10000_20_150.sqlite[2/7] [11%                         ] nsys_report_db_10000_20_150.sqlite[2/7] [12%                         ] nsys_report_db_10000_20_150.sqlite[2/7] [13%                         ] nsys_report_db_10000_20_150.sqlite[2/7] [14%                         ] nsys_report_db_10000_20_150.sqlite[2/7] [=15%                        ] nsys_report_db_10000_20_150.sqlite[2/7] [=16%                        ] nsys_report_db_10000_20_150.sqlite[2/7] [=17%                        ] nsys_report_db_10000_20_150.sqlite[2/7] [==18%                       ] nsys_report_db_10000_20_150.sqlite[2/7] [==19%                       ] nsys_report_db_10000_20_150.sqlite[2/7] [==20%                       ] nsys_report_db_10000_20_150.sqlite[2/7] [==21%                       ] nsys_report_db_10000_20_150.sqlite[2/7] [===22%                      ] nsys_report_db_10000_20_150.sqlite[2/7] [===23%                      ] nsys_report_db_10000_20_150.sqlite[2/7] [===24%                      ] nsys_report_db_10000_20_150.sqlite[2/7] [====25%                     ] nsys_report_db_10000_20_150.sqlite[2/7] [====26%                     ] nsys_report_db_10000_20_150.sqlite[2/7] [====27%                     ] nsys_report_db_10000_20_150.sqlite[2/7] [====28%                     ] nsys_report_db_10000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_db_10000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_db_10000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_db_10000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_db_10000_20_150.sqlite[2/7] [======33%                   ] nsys_report_db_10000_20_150.sqlite[2/7] [======34%                   ] nsys_report_db_10000_20_150.sqlite[2/7] [======35%                   ] nsys_report_db_10000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_db_10000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_db_10000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_db_10000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_db_10000_20_150.sqlite[2/7] [========40%                 ] nsys_report_db_10000_20_150.sqlite[2/7] [========41%                 ] nsys_report_db_10000_20_150.sqlite[2/7] [========42%                 ] nsys_report_db_10000_20_150.sqlite[2/7] [=========43%                ] nsys_report_db_10000_20_150.sqlite[2/7] [=========44%                ] nsys_report_db_10000_20_150.sqlite[2/7] [=========45%                ] nsys_report_db_10000_20_150.sqlite[2/7] [=========46%                ] nsys_report_db_10000_20_150.sqlite[2/7] [==========47%               ] nsys_report_db_10000_20_150.sqlite[2/7] [==========48%               ] nsys_report_db_10000_20_150.sqlite[2/7] [==========49%               ] nsys_report_db_10000_20_150.sqlite[2/7] [===========50%              ] nsys_report_db_10000_20_150.sqlite[2/7] [===========51%              ] nsys_report_db_10000_20_150.sqlite[2/7] [===========52%              ] nsys_report_db_10000_20_150.sqlite[2/7] [===========53%              ] nsys_report_db_10000_20_150.sqlite[2/7] [============54%             ] nsys_report_db_10000_20_150.sqlite[2/7] [============55%             ] nsys_report_db_10000_20_150.sqlite[2/7] [============56%             ] nsys_report_db_10000_20_150.sqlite[2/7] [============57%             ] nsys_report_db_10000_20_150.sqlite[2/7] [=============58%            ] nsys_report_db_10000_20_150.sqlite[2/7] [=============59%            ] nsys_report_db_10000_20_150.sqlite[2/7] [=============60%            ] nsys_report_db_10000_20_150.sqlite[2/7] [==============61%           ] nsys_report_db_10000_20_150.sqlite[2/7] [==============62%           ] nsys_report_db_10000_20_150.sqlite[2/7] [==============63%           ] nsys_report_db_10000_20_150.sqlite[2/7] [==============64%           ] nsys_report_db_10000_20_150.sqlite[2/7] [===============65%          ] nsys_report_db_10000_20_150.sqlite[2/7] [===============66%          ] nsys_report_db_10000_20_150.sqlite[2/7] [===============67%          ] nsys_report_db_10000_20_150.sqlite[2/7] [================68%         ] nsys_report_db_10000_20_150.sqlite[2/7] [================69%         ] nsys_report_db_10000_20_150.sqlite[2/7] [================70%         ] nsys_report_db_10000_20_150.sqlite[2/7] [================71%         ] nsys_report_db_10000_20_150.sqlite[2/7] [=================72%        ] nsys_report_db_10000_20_150.sqlite[2/7] [=================73%        ] nsys_report_db_10000_20_150.sqlite[2/7] [=================74%        ] nsys_report_db_10000_20_150.sqlite[2/7] [==================75%       ] nsys_report_db_10000_20_150.sqlite[2/7] [==================76%       ] nsys_report_db_10000_20_150.sqlite[2/7] [==================77%       ] nsys_report_db_10000_20_150.sqlite[2/7] [==================78%       ] nsys_report_db_10000_20_150.sqlite[2/7] [===================79%      ] nsys_report_db_10000_20_150.sqlite[2/7] [===================80%      ] nsys_report_db_10000_20_150.sqlite[2/7] [===================81%      ] nsys_report_db_10000_20_150.sqlite[2/7] [===================82%      ] nsys_report_db_10000_20_150.sqlite[2/7] [====================83%     ] nsys_report_db_10000_20_150.sqlite[2/7] [====================84%     ] nsys_report_db_10000_20_150.sqlite[2/7] [====================85%     ] nsys_report_db_10000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_db_10000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_db_10000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_db_10000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_db_10000_20_150.sqlite[2/7] [======================90%   ] nsys_report_db_10000_20_150.sqlite[2/7] [======================91%   ] nsys_report_db_10000_20_150.sqlite[2/7] [======================92%   ] nsys_report_db_10000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_db_10000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_db_10000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_db_10000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_db_10000_20_150.sqlite[2/7] [========================97% ] nsys_report_db_10000_20_150.sqlite[2/7] [========================98% ] nsys_report_db_10000_20_150.sqlite[2/7] [========================99% ] nsys_report_db_10000_20_150.sqlite[2/7] [========================100%] nsys_report_db_10000_20_150.sqlite[2/7] [========================100%] nsys_report_db_10000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        295049797          1  295049797.0  295049797.0  295049797  295049797          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     50.3      31071652539          1  31071652539.0  31071652539.0  31071652539  31071652539          0.0  cudaHostAlloc                     
     23.6      14600433155          1  14600433155.0  14600433155.0  14600433155  14600433155          0.0  cudaFreeHost                      
     23.0      14190005974         24    591250248.9        16010.5         6840   2189878192  964240407.3  cudaMemcpyAsync                   
      2.4       1501111688        150     10007411.3          290.0          280   1501050538  122560229.7  cuKernelGetFunction               
      0.3        203313445          8     25414180.6      4292862.5        28630    175690310   60871750.4  cudaFree                          
      0.2        131187658          2     65593829.0     65593829.0     53724033     77463625   16786426.5  cudaMemcpy                        
      0.2        120544080          1    120544080.0    120544080.0    120544080    120544080          0.0  cudaDeviceReset                   
      0.0          3926442         15       261762.8       273723.0       118281       419204     101931.9  cuLibraryLoadData                 
      0.0          2065273          7       295039.0       145051.0         3790       797519     345231.7  cudaMalloc                        
      0.0          1171362         10       117136.2         3290.0         2550      1141042     359764.3  cudaStreamSynchronize             
      0.0           950818        332         2863.9         2735.0          500        20920       1297.3  cudaEventRecord                   
      0.0           714550        150         4763.7         4245.0         3590        33680       2765.2  cuLaunchKernel                    
      0.0           534317         24        22263.2         7820.5         4310       255973      50516.8  cudaLaunchKernel                  
      0.0           255533        814          313.9          290.0          120         1240        150.2  cuGetProcAddress_v2               
      0.0           228642        316          723.6          590.0          470        10011        672.7  cudaEventCreate                   
      0.0           199912        336          595.0          470.0          330        18490       1055.6  cudaEventDestroy                  
      0.0            52132         20         2606.6          485.0          390        21041       6221.0  cudaEventCreateWithFlags          
      0.0            39631         40          990.8          370.0          290         3720       1221.3  cudaStreamGetCaptureInfo_v2_v11030
      0.0            36961          2        18480.5        18480.5         1970        34991      23349.4  cudaStreamCreateWithFlags         
      0.0            33121          4         8280.3         3155.0         1410        25401      11448.5  cudaDeviceSynchronize             
      0.0            19581          8         2447.6         2335.0         1811         3300        497.7  cudaStreamWaitEvent               
      0.0            18980          2         9490.0         9490.0         5170        13810       6109.4  cudaStreamDestroy                 
      0.0            16411         16         1025.7          555.0          510         6781       1561.4  cuLibraryGetKernel                
      0.0             5230          1         5230.0         5230.0         5230         5230          0.0  cudaEventQuery                    
      0.0             4370          3         1456.7         1760.0          580         2030        771.1  cuInit                            
      0.0             3581          3         1193.7          290.0          180         3111       1661.4  cuModuleGetLoadingMode            
      0.0             1140          1         1140.0         1140.0         1140         1140          0.0  cuCtxSynchronize                  
      0.0              840          2          420.0          420.0          320          520        141.4  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.9      16333378570        150  108889190.5  109021988.0  104837765  110837097     906441.5  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1          9187594          8    1148449.3    1150456.5    1139530    1153641       5747.7  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.0          5356523         16     334782.7     333299.0      16416     657125     328556.1  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)   Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  ----------  --------  ---------  -----------  ----------------------------
     98.7       5672812856     17  333694873.9  53433738.0      1600  813667086  367243834.6  [CUDA memcpy Host-to-Device]
      1.3         77269565      9    8585507.2      1952.0      1951   77252253   25750029.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
 120800.083     17  7105.887   800.000     0.010  16000.000     7898.767  [CUDA memcpy Host-to-Device]
    800.000      9    88.889     0.000     0.000    800.000      266.667  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_10000_20_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 10000, buff_size = 20 (num_steps = 150), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  22.41 GB
Used GPU Memory:  17.08 GB
------------------------

Process RSS:  114.76 GB
h_X_final[0] = 0.000100
h_X_final[1] = 0.000100
h_X_final[2] = 0.000100
h_X_final[3] = 0.000100
h_X_final[4] = 0.000100
t_alloc_gpu = 2.813101 ms
t_alloc_cpu = 30967.149973 ms
t_init      = 7927.242994 ms
t_h2d       = 5785.432911 ms
t_d2h       = 156.074047 ms
t_gemm      = 17035.255524 ms
t_end_2_end = 71686.792850 ms
Generating '/tmp/nsys-report-b71c.qdstrm'
[1/7] [0%                          ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [8%                          ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [=16%                        ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [=17%                        ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [==18%                       ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [==19%                       ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [==20%                       ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [==21%                       ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [===22%                      ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [===23%                      ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [===24%                      ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [====25%                     ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [====26%                     ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [====27%                     ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [====28%                     ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [======33%                   ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [======34%                   ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [======35%                   ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [=======================93%  ] nsys_report_fo_10000_20_150.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_150.nsys-rep[1/7] [========================100%] nsys_report_fo_10000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [1%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [2%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [3%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [4%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [5%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [6%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [7%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [8%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [9%                          ] nsys_report_fo_10000_20_150.sqlite[2/7] [10%                         ] nsys_report_fo_10000_20_150.sqlite[2/7] [11%                         ] nsys_report_fo_10000_20_150.sqlite[2/7] [12%                         ] nsys_report_fo_10000_20_150.sqlite[2/7] [13%                         ] nsys_report_fo_10000_20_150.sqlite[2/7] [14%                         ] nsys_report_fo_10000_20_150.sqlite[2/7] [=15%                        ] nsys_report_fo_10000_20_150.sqlite[2/7] [=16%                        ] nsys_report_fo_10000_20_150.sqlite[2/7] [=17%                        ] nsys_report_fo_10000_20_150.sqlite[2/7] [==18%                       ] nsys_report_fo_10000_20_150.sqlite[2/7] [==19%                       ] nsys_report_fo_10000_20_150.sqlite[2/7] [==20%                       ] nsys_report_fo_10000_20_150.sqlite[2/7] [==21%                       ] nsys_report_fo_10000_20_150.sqlite[2/7] [===22%                      ] nsys_report_fo_10000_20_150.sqlite[2/7] [===23%                      ] nsys_report_fo_10000_20_150.sqlite[2/7] [===24%                      ] nsys_report_fo_10000_20_150.sqlite[2/7] [====25%                     ] nsys_report_fo_10000_20_150.sqlite[2/7] [====26%                     ] nsys_report_fo_10000_20_150.sqlite[2/7] [====27%                     ] nsys_report_fo_10000_20_150.sqlite[2/7] [====28%                     ] nsys_report_fo_10000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_10000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_10000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_10000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_10000_20_150.sqlite[2/7] [======33%                   ] nsys_report_fo_10000_20_150.sqlite[2/7] [======34%                   ] nsys_report_fo_10000_20_150.sqlite[2/7] [======35%                   ] nsys_report_fo_10000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_10000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_10000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_10000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_10000_20_150.sqlite[2/7] [========40%                 ] nsys_report_fo_10000_20_150.sqlite[2/7] [========41%                 ] nsys_report_fo_10000_20_150.sqlite[2/7] [========42%                 ] nsys_report_fo_10000_20_150.sqlite[2/7] [=========43%                ] nsys_report_fo_10000_20_150.sqlite[2/7] [=========44%                ] nsys_report_fo_10000_20_150.sqlite[2/7] [=========45%                ] nsys_report_fo_10000_20_150.sqlite[2/7] [=========46%                ] nsys_report_fo_10000_20_150.sqlite[2/7] [==========47%               ] nsys_report_fo_10000_20_150.sqlite[2/7] [==========48%               ] nsys_report_fo_10000_20_150.sqlite[2/7] [==========49%               ] nsys_report_fo_10000_20_150.sqlite[2/7] [===========50%              ] nsys_report_fo_10000_20_150.sqlite[2/7] [===========51%              ] nsys_report_fo_10000_20_150.sqlite[2/7] [===========52%              ] nsys_report_fo_10000_20_150.sqlite[2/7] [===========53%              ] nsys_report_fo_10000_20_150.sqlite[2/7] [============54%             ] nsys_report_fo_10000_20_150.sqlite[2/7] [============55%             ] nsys_report_fo_10000_20_150.sqlite[2/7] [============56%             ] nsys_report_fo_10000_20_150.sqlite[2/7] [============57%             ] nsys_report_fo_10000_20_150.sqlite[2/7] [=============58%            ] nsys_report_fo_10000_20_150.sqlite[2/7] [=============59%            ] nsys_report_fo_10000_20_150.sqlite[2/7] [=============60%            ] nsys_report_fo_10000_20_150.sqlite[2/7] [==============61%           ] nsys_report_fo_10000_20_150.sqlite[2/7] [==============62%           ] nsys_report_fo_10000_20_150.sqlite[2/7] [==============63%           ] nsys_report_fo_10000_20_150.sqlite[2/7] [==============64%           ] nsys_report_fo_10000_20_150.sqlite[2/7] [===============65%          ] nsys_report_fo_10000_20_150.sqlite[2/7] [===============66%          ] nsys_report_fo_10000_20_150.sqlite[2/7] [===============67%          ] nsys_report_fo_10000_20_150.sqlite[2/7] [================68%         ] nsys_report_fo_10000_20_150.sqlite[2/7] [================69%         ] nsys_report_fo_10000_20_150.sqlite[2/7] [================70%         ] nsys_report_fo_10000_20_150.sqlite[2/7] [================71%         ] nsys_report_fo_10000_20_150.sqlite[2/7] [=================72%        ] nsys_report_fo_10000_20_150.sqlite[2/7] [=================73%        ] nsys_report_fo_10000_20_150.sqlite[2/7] [=================74%        ] nsys_report_fo_10000_20_150.sqlite[2/7] [==================75%       ] nsys_report_fo_10000_20_150.sqlite[2/7] [==================76%       ] nsys_report_fo_10000_20_150.sqlite[2/7] [==================77%       ] nsys_report_fo_10000_20_150.sqlite[2/7] [==================78%       ] nsys_report_fo_10000_20_150.sqlite[2/7] [===================79%      ] nsys_report_fo_10000_20_150.sqlite[2/7] [===================80%      ] nsys_report_fo_10000_20_150.sqlite[2/7] [===================81%      ] nsys_report_fo_10000_20_150.sqlite[2/7] [===================82%      ] nsys_report_fo_10000_20_150.sqlite[2/7] [====================83%     ] nsys_report_fo_10000_20_150.sqlite[2/7] [====================84%     ] nsys_report_fo_10000_20_150.sqlite[2/7] [====================85%     ] nsys_report_fo_10000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_10000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_10000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_10000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_10000_20_150.sqlite[2/7] [======================90%   ] nsys_report_fo_10000_20_150.sqlite[2/7] [======================91%   ] nsys_report_fo_10000_20_150.sqlite[2/7] [======================92%   ] nsys_report_fo_10000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_10000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_10000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_10000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_10000_20_150.sqlite[2/7] [========================97% ] nsys_report_fo_10000_20_150.sqlite[2/7] [========================98% ] nsys_report_fo_10000_20_150.sqlite[2/7] [========================99% ] nsys_report_fo_10000_20_150.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_150.sqlite[2/7] [========================100%] nsys_report_fo_10000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        298448837          1  298448837.0  298448837.0  298448837  298448837          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     48.8      30967144418          1  30967144418.0  30967144418.0  30967144418  30967144418          0.0  cudaHostAlloc                     
     25.9      16450314154        450     36556253.7        10070.0         3450    111847166   52002298.2  cudaMemcpyAsync                   
     23.3      14778220261          1  14778220261.0  14778220261.0  14778220261  14778220261          0.0  cudaFreeHost                      
      1.2        769303121        150      5128687.5          695.0          380    769107098   62797224.2  cuKernelGetFunction               
      0.3        191369795         26      7360376.7       460820.5        29291    180037530   35219705.1  cudaFree                          
      0.2        131618545          2     65809272.5     65809272.5     53795065     77823480   16990655.2  cudaMemcpy                        
      0.2        121305071          1    121305071.0    121305071.0    121305071    121305071          0.0  cudaDeviceReset                   
      0.0          3927383         15       261825.5       274613.0       116781       427465     103013.1  cuLibraryLoadData                 
      0.0          3610378        450         8023.1         4940.0         4180       236993      11732.5  cudaLaunchKernel                  
      0.0          2979232         25       119169.3       122122.0         3730       163571      28302.4  cudaMalloc                        
      0.0          2430655       1050         2314.9         2660.0          490        27031       1600.2  cudaEventRecord                   
      0.0          1544929        152        10164.0         2620.0         2140      1143603      92543.2  cudaStreamSynchronize             
      0.0           998499        150         6656.7         5995.5         4470        32401       2406.2  cuLaunchKernel                    
      0.0           414135        600          690.2          515.0          460        13590        737.7  cudaEventCreate                   
      0.0           389994        750          520.0          360.0          270         2610        429.5  cudaStreamGetCaptureInfo_v2_v11030
      0.0           306073        280         1093.1          945.0          580         3330        473.5  cudaStreamWaitEvent               
      0.0           255194        814          313.5          290.0          110         1010        142.5  cuGetProcAddress_v2               
      0.0            75241          1        75241.0        75241.0        75241        75241          0.0  cudaMemGetInfo                    
      0.0            60660         58         1045.9          510.0          380        11740       2073.2  cudaEventCreateWithFlags          
      0.0            43511         58          750.2          560.0          330         4330        644.2  cudaEventDestroy                  
      0.0            36990          2        18495.0        18495.0         1860        35130      23525.4  cudaStreamCreateWithFlags         
      0.0            35800          4         8950.0         3205.0         1420        27970      12720.6  cudaDeviceSynchronize             
      0.0            19190          2         9595.0         9595.0         5230        13960       6173.0  cudaStreamDestroy                 
      0.0            10130         16          633.1          535.0          470         1570        274.4  cuLibraryGetKernel                
      0.0             5010          1         5010.0         5010.0         5010         5010          0.0  cudaEventQuery                    
      0.0             4020          3         1340.0         1060.0          570         2390        941.8  cuInit                            
      0.0             3120          3         1040.0          260.0          250         2610       1359.7  cuModuleGetLoadingMode            
      0.0             1150          1         1150.0         1150.0         1150         1150          0.0  cuCtxSynchronize                  
      0.0              840          2          420.0          420.0          300          540        169.7  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     98.4      16289334775        150  108595565.2  108617909.0  105115759  110089599     758820.9  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      1.0        172537013        150    1150246.8    1152169.0    1139497    1155048       4259.3  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.6         97323193        300     324410.6     321506.5      12544     645829     312097.7  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  ----------  --------  --------  -----------  ----------------------------
     98.7       5783964129    301  19215827.7  31911473.0      1568  54304279   20049147.8  [CUDA memcpy Host-to-Device]
      1.3         77929389    151    516088.7      1952.0      1920  77633765    6317585.8  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 120801.556    301   401.334   800.000     0.010   800.000      400.659  [CUDA memcpy Host-to-Device]
    800.001    151     5.298     0.000     0.000   800.000       65.103  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_10000_20_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 5 (num_steps = 20)
number of batches= 4
h_X_final[0] = 0.000050
h_X_final[1] = 0.000050
h_X_final[2] = 0.000050
h_X_final[3] = 0.000050
h_X_final[4] = 0.000050
t_gemm = 17511.388062 ms
t_h2d = 3155.748762 ms
t_gpu_alloc = 2.093077 ms
t_cpu_alloc = 16842.738152 ms
t_init = 4591.742992 ms
t_d2h = 615.362167 ms
t_end_2_end = 50381.560087 ms
Generating '/tmp/nsys-report-0219.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [==19%                       ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=======38%                  ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=======39%                  ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [========40%                 ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [========41%                 ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [========42%                 ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [===============66%          ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [===============67%          ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [================68%         ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [================69%         ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [================70%         ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [================71%         ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=================72%        ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=================73%        ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=================74%        ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [==================75%       ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [==================76%       ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [==================77%       ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [==================78%       ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [===================79%      ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [===================80%      ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [===================81%      ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [===================82%      ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [====================83%     ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [====================84%     ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [====================85%     ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=====================86%    ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=====================87%    ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=====================88%    ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=====================89%    ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [======================90%   ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [======================91%   ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [======================92%   ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=======================93%  ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=======================94%  ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=======================95%  ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [========================97% ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_5_20.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_20.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [1%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [2%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [3%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [4%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [5%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [6%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [7%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [8%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [9%                          ] nsys_report_ia_20000_5_20.sqlite[2/7] [10%                         ] nsys_report_ia_20000_5_20.sqlite[2/7] [11%                         ] nsys_report_ia_20000_5_20.sqlite[2/7] [12%                         ] nsys_report_ia_20000_5_20.sqlite[2/7] [13%                         ] nsys_report_ia_20000_5_20.sqlite[2/7] [14%                         ] nsys_report_ia_20000_5_20.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_5_20.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_5_20.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_5_20.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_5_20.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_5_20.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_5_20.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_5_20.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_5_20.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_5_20.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_5_20.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_5_20.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_5_20.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_5_20.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_5_20.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_5_20.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_5_20.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_5_20.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_5_20.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_5_20.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_5_20.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_5_20.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_5_20.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_5_20.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_5_20.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_5_20.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_5_20.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_5_20.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_5_20.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_5_20.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_5_20.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_5_20.sqlite[2/7] [============54%             ] nsys_report_ia_20000_5_20.sqlite[2/7] [============55%             ] nsys_report_ia_20000_5_20.sqlite[2/7] [============56%             ] nsys_report_ia_20000_5_20.sqlite[2/7] [============57%             ] nsys_report_ia_20000_5_20.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_5_20.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_5_20.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_5_20.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_5_20.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_5_20.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_5_20.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_5_20.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_5_20.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_5_20.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_5_20.sqlite[2/7] [================68%         ] nsys_report_ia_20000_5_20.sqlite[2/7] [================69%         ] nsys_report_ia_20000_5_20.sqlite[2/7] [================70%         ] nsys_report_ia_20000_5_20.sqlite[2/7] [================71%         ] nsys_report_ia_20000_5_20.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_5_20.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_5_20.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_5_20.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_5_20.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_5_20.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_5_20.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_5_20.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_5_20.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_5_20.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_5_20.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_5_20.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_5_20.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_5_20.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_5_20.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_5_20.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_5_20.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_5_20.sqlite[2/7] [========================97% ] nsys_report_ia_20000_5_20.sqlite[2/7] [========================98% ] nsys_report_ia_20000_5_20.sqlite[2/7] [========================99% ] nsys_report_ia_20000_5_20.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_20.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        271200149          1  271200149.0  271200149.0  271200149  271200149          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                  Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------------------
     41.1      16842732587          1  16842732587.0  16842732587.0  16842732587  16842732587           0.0  cudaHostAlloc                     
     37.4      15342234366         12   1278519530.5        17135.5         6480   5130296891  2312409601.7  cudaMemcpyAsync                   
     17.6       7221414584          1   7221414584.0   7221414584.0   7221414584   7221414584           0.0  cudaFreeHost                      
      1.8        754917938         20     37745896.9          365.0          280    754902558   168801162.6  cuKernelGetFunction               
      1.3        516622372          2    258311186.0    258311186.0    211046973    305575399    66841691.0  cudaMemcpy                        
      0.4        180734858          8     22591857.3      4884519.0        28190    150773597    51950647.3  cudaFree                          
      0.3        118789323          1    118789323.0    118789323.0    118789323    118789323           0.0  cudaDeviceReset                   
      0.0          4626671          6       771111.8         4185.0         2910      4606871     1879130.6  cudaStreamSynchronize             
      0.0          4019346         15       267956.4       285733.0       118752       434685      103787.9  cuLibraryLoadData                 
      0.0          2274534          7       324933.4       246063.0         3640       790349      326076.6  cudaMalloc                        
      0.0           420897         12        35074.8         9385.5         4400       262643       72556.4  cudaLaunchKernel                  
      0.0           258295        814          317.3          280.0          120         1410         163.1  cuGetProcAddress_v2               
      0.0           194973         56         3481.7         2665.0          650        28540        3739.1  cudaEventRecord                   
      0.0           130251         20         6512.6         4530.0         3920        30750        6024.0  cuLaunchKernel                    
      0.0            55110         68          810.4          455.0          320        17050        2157.0  cudaEventDestroy                  
      0.0            41590          2        20795.0        20795.0         1920        39670       26693.3  cudaStreamCreateWithFlags         
      0.0            39582         20         1979.1          490.0          380        18551        4487.3  cudaEventCreateWithFlags          
      0.0            36620         48          762.9          590.0          480         4220         640.6  cudaEventCreate                   
      0.0            31411          4         7852.8         2585.0         1350        24891       11373.9  cudaDeviceSynchronize             
      0.0            21330         20         1066.5          340.0          290         4320        1453.5  cudaStreamGetCaptureInfo_v2_v11030
      0.0            18850          2         9425.0         9425.0         5590        13260        5423.5  cudaStreamDestroy                 
      0.0            12981         16          811.3          540.0          490         3570         780.3  cuLibraryGetKernel                
      0.0             9530          4         2382.5         2465.0         1300         3300         828.3  cudaStreamWaitEvent               
      0.0             5090          1         5090.0         5090.0         5090         5090           0.0  cudaEventQuery                    
      0.0             4600          3         1533.3         1950.0          610         2040         800.9  cuInit                            
      0.0             3300          3         1100.0          250.0          150         2900        1559.6  cuModuleGetLoadingMode            
      0.0             1250          1         1250.0         1250.0         1250         1250           0.0  cuCtxSynchronize                  
      0.0              910          2          455.0          455.0          310          600         205.1  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8      17511076968         20  875553848.4  876584456.5  861312194  886113454    6572624.7  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1         18606651          4    4651662.8    4664710.0    4607464    4669767      29733.6  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         10134580          8    1266822.5    1264730.0      14144    2522998    1338940.5  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  --------  ---------  -----------  ----------------------------
     91.2       3155483110      9  350609234.4  210871520.0      1632  773336994  372396588.5  [CUDA memcpy Host-to-Device]
      8.8        305388402      5   61077680.4       1984.0      1952  305378866  136568514.5  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  67200.042      9  7466.671  3200.000     0.010  16000.000     8158.426  [CUDA memcpy Host-to-Device]
   3200.000      5   640.000     0.000     0.000   3200.000     1431.084  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 5 (num_steps = 20)
number of batches= 4
t_gemm = 18354.145874 ms
t_h2d = 3156.899118 ms
t_d2h = 618.460894 ms
h_X_final[0] = 0.000050
h_X_final[1] = 0.000050
h_X_final[2] = 0.000050
h_X_final[3] = 0.000050
h_X_final[4] = 0.000050
t_gpu_alloc = 1.553059 ms
t_cpu_alloc = 16860.205889 ms
t_init = 4631.783962 ms
t_end_2_end = 49181.730986 ms
Generating '/tmp/nsys-report-a573.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_5_20.nsys-rep[1/7] [====25%                     ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=========44%                ] nsys_report_db_20000_5_20.nsys-rep[1/7] [==============63%           ] nsys_report_db_20000_5_20.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_5_20.nsys-rep[1/7] [===============65%          ] nsys_report_db_20000_5_20.nsys-rep[1/7] [===============66%          ] nsys_report_db_20000_5_20.nsys-rep[1/7] [===============67%          ] nsys_report_db_20000_5_20.nsys-rep[1/7] [================68%         ] nsys_report_db_20000_5_20.nsys-rep[1/7] [================69%         ] nsys_report_db_20000_5_20.nsys-rep[1/7] [================70%         ] nsys_report_db_20000_5_20.nsys-rep[1/7] [================71%         ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=================72%        ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=================73%        ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=================74%        ] nsys_report_db_20000_5_20.nsys-rep[1/7] [==================75%       ] nsys_report_db_20000_5_20.nsys-rep[1/7] [==================76%       ] nsys_report_db_20000_5_20.nsys-rep[1/7] [==================77%       ] nsys_report_db_20000_5_20.nsys-rep[1/7] [==================78%       ] nsys_report_db_20000_5_20.nsys-rep[1/7] [===================79%      ] nsys_report_db_20000_5_20.nsys-rep[1/7] [===================80%      ] nsys_report_db_20000_5_20.nsys-rep[1/7] [===================81%      ] nsys_report_db_20000_5_20.nsys-rep[1/7] [===================82%      ] nsys_report_db_20000_5_20.nsys-rep[1/7] [====================83%     ] nsys_report_db_20000_5_20.nsys-rep[1/7] [====================84%     ] nsys_report_db_20000_5_20.nsys-rep[1/7] [====================85%     ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=====================86%    ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=====================87%    ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=====================88%    ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=====================89%    ] nsys_report_db_20000_5_20.nsys-rep[1/7] [======================90%   ] nsys_report_db_20000_5_20.nsys-rep[1/7] [======================91%   ] nsys_report_db_20000_5_20.nsys-rep[1/7] [======================92%   ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=======================93%  ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=======================94%  ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=======================95%  ] nsys_report_db_20000_5_20.nsys-rep[1/7] [=======================96%  ] nsys_report_db_20000_5_20.nsys-rep[1/7] [========================97% ] nsys_report_db_20000_5_20.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_5_20.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_20.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [1%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [2%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [3%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [4%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [5%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [6%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [7%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [8%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [9%                          ] nsys_report_db_20000_5_20.sqlite[2/7] [10%                         ] nsys_report_db_20000_5_20.sqlite[2/7] [11%                         ] nsys_report_db_20000_5_20.sqlite[2/7] [12%                         ] nsys_report_db_20000_5_20.sqlite[2/7] [13%                         ] nsys_report_db_20000_5_20.sqlite[2/7] [14%                         ] nsys_report_db_20000_5_20.sqlite[2/7] [=15%                        ] nsys_report_db_20000_5_20.sqlite[2/7] [=16%                        ] nsys_report_db_20000_5_20.sqlite[2/7] [=17%                        ] nsys_report_db_20000_5_20.sqlite[2/7] [==18%                       ] nsys_report_db_20000_5_20.sqlite[2/7] [==19%                       ] nsys_report_db_20000_5_20.sqlite[2/7] [==20%                       ] nsys_report_db_20000_5_20.sqlite[2/7] [==21%                       ] nsys_report_db_20000_5_20.sqlite[2/7] [===22%                      ] nsys_report_db_20000_5_20.sqlite[2/7] [===23%                      ] nsys_report_db_20000_5_20.sqlite[2/7] [===24%                      ] nsys_report_db_20000_5_20.sqlite[2/7] [====25%                     ] nsys_report_db_20000_5_20.sqlite[2/7] [====26%                     ] nsys_report_db_20000_5_20.sqlite[2/7] [====27%                     ] nsys_report_db_20000_5_20.sqlite[2/7] [====28%                     ] nsys_report_db_20000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_5_20.sqlite[2/7] [======33%                   ] nsys_report_db_20000_5_20.sqlite[2/7] [======34%                   ] nsys_report_db_20000_5_20.sqlite[2/7] [======35%                   ] nsys_report_db_20000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_5_20.sqlite[2/7] [========40%                 ] nsys_report_db_20000_5_20.sqlite[2/7] [========41%                 ] nsys_report_db_20000_5_20.sqlite[2/7] [========42%                 ] nsys_report_db_20000_5_20.sqlite[2/7] [=========43%                ] nsys_report_db_20000_5_20.sqlite[2/7] [=========44%                ] nsys_report_db_20000_5_20.sqlite[2/7] [=========45%                ] nsys_report_db_20000_5_20.sqlite[2/7] [=========46%                ] nsys_report_db_20000_5_20.sqlite[2/7] [==========47%               ] nsys_report_db_20000_5_20.sqlite[2/7] [==========48%               ] nsys_report_db_20000_5_20.sqlite[2/7] [==========49%               ] nsys_report_db_20000_5_20.sqlite[2/7] [===========50%              ] nsys_report_db_20000_5_20.sqlite[2/7] [===========51%              ] nsys_report_db_20000_5_20.sqlite[2/7] [===========52%              ] nsys_report_db_20000_5_20.sqlite[2/7] [===========53%              ] nsys_report_db_20000_5_20.sqlite[2/7] [============54%             ] nsys_report_db_20000_5_20.sqlite[2/7] [============55%             ] nsys_report_db_20000_5_20.sqlite[2/7] [============56%             ] nsys_report_db_20000_5_20.sqlite[2/7] [============57%             ] nsys_report_db_20000_5_20.sqlite[2/7] [=============58%            ] nsys_report_db_20000_5_20.sqlite[2/7] [=============59%            ] nsys_report_db_20000_5_20.sqlite[2/7] [=============60%            ] nsys_report_db_20000_5_20.sqlite[2/7] [==============61%           ] nsys_report_db_20000_5_20.sqlite[2/7] [==============62%           ] nsys_report_db_20000_5_20.sqlite[2/7] [==============63%           ] nsys_report_db_20000_5_20.sqlite[2/7] [==============64%           ] nsys_report_db_20000_5_20.sqlite[2/7] [===============65%          ] nsys_report_db_20000_5_20.sqlite[2/7] [===============66%          ] nsys_report_db_20000_5_20.sqlite[2/7] [===============67%          ] nsys_report_db_20000_5_20.sqlite[2/7] [================68%         ] nsys_report_db_20000_5_20.sqlite[2/7] [================69%         ] nsys_report_db_20000_5_20.sqlite[2/7] [================70%         ] nsys_report_db_20000_5_20.sqlite[2/7] [================71%         ] nsys_report_db_20000_5_20.sqlite[2/7] [=================72%        ] nsys_report_db_20000_5_20.sqlite[2/7] [=================73%        ] nsys_report_db_20000_5_20.sqlite[2/7] [=================74%        ] nsys_report_db_20000_5_20.sqlite[2/7] [==================75%       ] nsys_report_db_20000_5_20.sqlite[2/7] [==================76%       ] nsys_report_db_20000_5_20.sqlite[2/7] [==================77%       ] nsys_report_db_20000_5_20.sqlite[2/7] [==================78%       ] nsys_report_db_20000_5_20.sqlite[2/7] [===================79%      ] nsys_report_db_20000_5_20.sqlite[2/7] [===================80%      ] nsys_report_db_20000_5_20.sqlite[2/7] [===================81%      ] nsys_report_db_20000_5_20.sqlite[2/7] [===================82%      ] nsys_report_db_20000_5_20.sqlite[2/7] [====================83%     ] nsys_report_db_20000_5_20.sqlite[2/7] [====================84%     ] nsys_report_db_20000_5_20.sqlite[2/7] [====================85%     ] nsys_report_db_20000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_5_20.sqlite[2/7] [======================90%   ] nsys_report_db_20000_5_20.sqlite[2/7] [======================91%   ] nsys_report_db_20000_5_20.sqlite[2/7] [======================92%   ] nsys_report_db_20000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_5_20.sqlite[2/7] [========================97% ] nsys_report_db_20000_5_20.sqlite[2/7] [========================98% ] nsys_report_db_20000_5_20.sqlite[2/7] [========================99% ] nsys_report_db_20000_5_20.sqlite[2/7] [========================100%] nsys_report_db_20000_5_20.sqlite[2/7] [========================100%] nsys_report_db_20000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        296348659          1  296348659.0  296348659.0  296348659  296348659          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                  Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------------------
     42.4      16860201998          1  16860201998.0  16860201998.0  16860201998  16860201998           0.0  cudaHostAlloc                     
     33.3      13241726972         12   1103477247.7        17435.0         6240   4430588542  1995748250.9  cudaMemcpyAsync                   
     18.3       7258357710          1   7258357710.0   7258357710.0   7258357710   7258357710           0.0  cudaFreeHost                      
      3.9       1533673939         20     76683697.0          340.0          300   1533658289   342936234.7  cuKernelGetFunction               
      1.3        520350377          2    260175188.5    260175188.5    211503140    308847237    68832671.1  cudaMemcpy                        
      0.5        213310810          8     26663851.3      4885544.5        28540    183346329    63437846.1  cudaFree                          
      0.3        121120450          1    121120450.0    121120450.0    121120450    121120450           0.0  cudaDeviceReset                   
      0.0          4627861          6       771310.2         4175.0         2640      4608601     1879881.0  cudaStreamSynchronize             
      0.0          4045532         15       269702.1       291073.0       119641       438434      104924.9  cuLibraryLoadData                 
      0.0          2265165          7       323595.0       243543.0         4090       787168      324469.5  cudaMalloc                        
      0.0           423395         12        35282.9         8900.0         4410       268343       74219.1  cudaLaunchKernel                  
      0.0           247273        814          303.8          280.0          120         1250         140.9  cuGetProcAddress_v2               
      0.0           176722         56         3155.8         2770.0          500        12990        1923.3  cudaEventRecord                   
      0.0           131121         20         6556.1         4475.0         4000        31590        6232.1  cuLaunchKernel                    
      0.0            63890         68          939.6          480.0          330        19230        2406.8  cudaEventDestroy                  
      0.0            47180         20         2359.0          520.0          400        22730        5654.6  cudaEventCreateWithFlags          
      0.0            42891          2        21445.5        21445.5         2240        40651       27160.7  cudaStreamCreateWithFlags         
      0.0            38680         48          805.8          615.0          500         4360         698.6  cudaEventCreate                   
      0.0            33000          4         8250.0         2865.0         1400        25870       11773.9  cudaDeviceSynchronize             
      0.0            25510         20         1275.5          410.0          280         6730        1893.0  cudaStreamGetCaptureInfo_v2_v11030
      0.0            19480          2         9740.0         9740.0         5760        13720        5628.6  cudaStreamDestroy                 
      0.0            12950          4         3237.5         3245.0         2630         3830         494.9  cudaStreamWaitEvent               
      0.0            11280         16          705.0          595.0          540         1410         270.4  cuLibraryGetKernel                
      0.0             6371          1         6371.0         6371.0         6371         6371           0.0  cudaEventQuery                    
      0.0             4560          3         1520.0         1830.0          600         2130         810.7  cuInit                            
      0.0             3570          3         1190.0          270.0          170         3130        1680.8  cuModuleGetLoadingMode            
      0.0             1090          1         1090.0         1090.0         1090         1090           0.0  cuCtxSynchronize                  
      0.0              910          2          455.0          455.0          310          600         205.1  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8      17564092536         20  878204626.8  880111190.0  861070009  887447468    6747633.3  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1         18530207          4    4632551.8    4628359.5    4607624    4665864      28901.4  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         10110936          8    1263867.0    1262682.5      14208    2514997    1335762.4  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  --------  ---------  -----------  ----------------------------
     91.1       3156630110      9  350736678.9  211316743.0      1632  789594222  373642405.1  [CUDA memcpy Host-to-Device]
      8.9        308635726      5   61727145.2       1984.0      1953  308626125  138020725.6  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
  67200.042      9  7466.671  3200.000     0.010  16000.000     8158.426  [CUDA memcpy Host-to-Device]
   3200.000      5   640.000     0.000     0.000   3200.000     1431.084  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 5 (num_steps = 20), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  18.07 GB
Used GPU Memory:  21.43 GB
------------------------

Process RSS:  69.31 GB
h_X_final[0] = 0.000050
h_X_final[1] = 0.000050
h_X_final[2] = 0.000050
h_X_final[3] = 0.000050
h_X_final[4] = 0.000050
t_alloc_gpu = 1.750946 ms
t_alloc_cpu = 16771.472216 ms
t_init      = 5054.172993 ms
t_h2d       = 3315.547358 ms
t_d2h       = 615.251064 ms
t_gemm      = 18303.503418 ms
t_end_2_end = 48925.066948 ms
Generating '/tmp/nsys-report-e5de.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [==18%                       ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [========40%                 ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [========41%                 ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [========42%                 ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=========43%                ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=========44%                ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=========45%                ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=========46%                ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [==========47%               ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [==========48%               ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [==========49%               ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [===========50%              ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [===========51%              ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [===========52%              ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [===========53%              ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [============54%             ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [============55%             ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [============56%             ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [============57%             ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=============58%            ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=============59%            ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [=============60%            ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [==============61%           ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [==============62%           ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [==============63%           ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [===============65%          ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [========================97% ] nsys_report_fo_20000_5_20.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_20.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [1%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [2%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [3%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [4%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [5%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [6%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [7%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [8%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [9%                          ] nsys_report_fo_20000_5_20.sqlite[2/7] [10%                         ] nsys_report_fo_20000_5_20.sqlite[2/7] [11%                         ] nsys_report_fo_20000_5_20.sqlite[2/7] [12%                         ] nsys_report_fo_20000_5_20.sqlite[2/7] [13%                         ] nsys_report_fo_20000_5_20.sqlite[2/7] [14%                         ] nsys_report_fo_20000_5_20.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_5_20.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_5_20.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_5_20.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_5_20.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_5_20.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_5_20.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_5_20.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_5_20.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_5_20.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_5_20.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_5_20.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_5_20.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_5_20.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_5_20.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_5_20.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_5_20.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_5_20.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_5_20.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_5_20.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_5_20.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_5_20.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_5_20.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_5_20.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_5_20.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_5_20.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_5_20.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_5_20.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_5_20.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_5_20.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_5_20.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_5_20.sqlite[2/7] [============54%             ] nsys_report_fo_20000_5_20.sqlite[2/7] [============55%             ] nsys_report_fo_20000_5_20.sqlite[2/7] [============56%             ] nsys_report_fo_20000_5_20.sqlite[2/7] [============57%             ] nsys_report_fo_20000_5_20.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_5_20.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_5_20.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_5_20.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_5_20.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_5_20.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_5_20.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_5_20.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_5_20.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_5_20.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_5_20.sqlite[2/7] [================68%         ] nsys_report_fo_20000_5_20.sqlite[2/7] [================69%         ] nsys_report_fo_20000_5_20.sqlite[2/7] [================70%         ] nsys_report_fo_20000_5_20.sqlite[2/7] [================71%         ] nsys_report_fo_20000_5_20.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_5_20.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_5_20.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_5_20.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_5_20.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_5_20.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_5_20.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_5_20.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_5_20.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_5_20.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_5_20.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_5_20.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_5_20.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_5_20.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_5_20.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_5_20.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_5_20.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_5_20.sqlite[2/7] [========================97% ] nsys_report_fo_20000_5_20.sqlite[2/7] [========================98% ] nsys_report_fo_20000_5_20.sqlite[2/7] [========================99% ] nsys_report_fo_20000_5_20.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_20.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        294130896          1  294130896.0  294130896.0  294130896  294130896          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     39.6      16848020507         60    280800341.8        12080.0         4180    893068317  415870154.7  cudaMemcpyAsync                   
     39.4      16771465960          1  16771465960.0  16771465960.0  16771465960  16771465960          0.0  cudaHostAlloc                     
     17.0       7254245735          1   7254245735.0   7254245735.0   7254245735   7254245735          0.0  cudaFreeHost                      
      2.0        841091001         20     42054550.1         2475.0          530    841049501  188063897.3  cuKernelGetFunction               
      1.2        519208528          2    259604264.0    259604264.0    213022499    306186029   65876563.8  cudaMemcpy                        
      0.4        187644927         11     17058629.7      1645258.0        56020    170508078   50911466.5  cudaFree                          
      0.3        119211260          1    119211260.0    119211260.0    119211260    119211260          0.0  cudaDeviceReset                   
      0.0          4673431         22       212428.7         2895.0         2370      4610721     982372.5  cudaStreamSynchronize             
      0.0          4066755         15       271117.0       284803.0       123481       445475     106419.8  cuLibraryLoadData                 
      0.0          1926951         10       192695.1       238742.5         4070       289993      94786.1  cudaMalloc                        
      0.0           844967         60        14082.8         8030.5         4210       248783      31583.0  cudaLaunchKernel                  
      0.0           373983        140         2671.3         2800.0          510        17640       2090.2  cudaEventRecord                   
      0.0           278530        814          342.2          300.0          120         1370        168.2  cuGetProcAddress_v2               
      0.0           184352         20         9217.6         8755.0         5000        32181       5632.5  cuLaunchKernel                    
      0.0            75422        100          754.2          410.0          290         3580        853.1  cudaStreamGetCaptureInfo_v2_v11030
      0.0            63451          1        63451.0        63451.0        63451        63451          0.0  cudaMemGetInfo                    
      0.0            61720         80          771.5          600.0          490         4970        636.0  cudaEventCreate                   
      0.0            54510         35         1557.4         1600.0          630         3320        743.6  cudaStreamWaitEvent               
      0.0            47391         28         1692.5          505.0          400        12700       3355.5  cudaEventCreateWithFlags          
      0.0            39230          2        19615.0        19615.0         2080        37150      24798.2  cudaStreamCreateWithFlags         
      0.0            38991          4         9747.8         2875.0         1290        31951      14826.5  cudaDeviceSynchronize             
      0.0            20700         28          739.3          465.0          330         3710        776.3  cudaEventDestroy                  
      0.0            19251          2         9625.5         9625.5         4620        14631       7078.8  cudaStreamDestroy                 
      0.0            14670         16          916.9          565.0          500         5470       1226.5  cuLibraryGetKernel                
      0.0             4930          1         4930.0         4930.0         4930         4930          0.0  cudaEventQuery                    
      0.0             4270          3         1423.3         1700.0          640         1930        688.1  cuInit                            
      0.0             3650          3         1216.7          250.0          170         3230       1744.1  cuModuleGetLoadingMode            
      0.0             1210          1         1210.0         1210.0         1210         1210          0.0  cuCtxSynchronize                  
      0.0              840          2          420.0          420.0          340          500        113.1  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.2      17573087805         20  878654390.3  880821414.5  863678411  885932721    5498792.5  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.5         92913202         20    4645660.1    4656376.5    4604201    4671721      23636.1  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.3         50563934         40    1264098.4    1257627.5      13984    2526486    1265699.7  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  -----------  --------  ---------  -----------  ----------------------------
     91.5       3315159507     41  80857549.0  124489344.0      1631  212882778   83192047.9  [CUDA memcpy Host-to-Device]
      8.5        306031878     21  14572946.6       1984.0      1951  305990405   66772128.1  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  67200.208     41  1639.029  3200.000     0.010  3200.000     1619.389  [CUDA memcpy Host-to-Device]
   3200.000     21   152.381     0.000     0.000  3200.000      698.297  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 5 (num_steps = 40)
number of batches= 8
h_X_final[0] = 0.000050
h_X_final[1] = 0.000050
h_X_final[2] = 0.000050
h_X_final[3] = 0.000050
h_X_final[4] = 0.000050
t_gemm = 35205.692993 ms
t_h2d = 6581.006952 ms
t_gpu_alloc = 2.094030 ms
t_cpu_alloc = 33507.514954 ms
t_init = 9916.018009 ms
t_d2h = 1502.588034 ms
t_end_2_end = 113209.342957 ms
Generating '/tmp/nsys-report-bb44.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [10%                         ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==21%                       ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===22%                      ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===23%                      ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===24%                      ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [====25%                     ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [====26%                     ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [====27%                     ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [====28%                     ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=====29%                    ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=====31%                    ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=====32%                    ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [======33%                   ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [======34%                   ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [======35%                   ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=======36%                  ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=======37%                  ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=======38%                  ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=======39%                  ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [========40%                 ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [========41%                 ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [========42%                 ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=========43%                ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=========44%                ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=========45%                ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=========46%                ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==========47%               ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==========48%               ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==========49%               ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===========50%              ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===========51%              ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===========52%              ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===========53%              ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [============54%             ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [============55%             ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [============56%             ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [============57%             ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=============58%            ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=============59%            ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=============60%            ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==============61%           ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==============62%           ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==============63%           ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===============65%          ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===============67%          ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [================70%         ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [================71%         ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=================72%        ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=================73%        ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=================74%        ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==================75%       ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==================76%       ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==================77%       ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [==================78%       ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [===================79%      ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [=======================96%  ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [========================97% ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_5_40.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_40.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [1%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [2%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [3%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [4%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [5%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [6%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [7%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [8%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [9%                          ] nsys_report_ia_20000_5_40.sqlite[2/7] [10%                         ] nsys_report_ia_20000_5_40.sqlite[2/7] [11%                         ] nsys_report_ia_20000_5_40.sqlite[2/7] [12%                         ] nsys_report_ia_20000_5_40.sqlite[2/7] [13%                         ] nsys_report_ia_20000_5_40.sqlite[2/7] [14%                         ] nsys_report_ia_20000_5_40.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_5_40.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_5_40.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_5_40.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_5_40.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_5_40.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_5_40.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_5_40.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_5_40.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_5_40.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_5_40.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_5_40.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_5_40.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_5_40.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_5_40.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_5_40.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_5_40.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_5_40.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_5_40.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_5_40.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_5_40.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_5_40.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_5_40.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_5_40.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_5_40.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_5_40.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_5_40.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_5_40.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_5_40.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_5_40.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_5_40.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_5_40.sqlite[2/7] [============54%             ] nsys_report_ia_20000_5_40.sqlite[2/7] [============55%             ] nsys_report_ia_20000_5_40.sqlite[2/7] [============56%             ] nsys_report_ia_20000_5_40.sqlite[2/7] [============57%             ] nsys_report_ia_20000_5_40.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_5_40.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_5_40.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_5_40.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_5_40.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_5_40.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_5_40.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_5_40.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_5_40.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_5_40.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_5_40.sqlite[2/7] [================68%         ] nsys_report_ia_20000_5_40.sqlite[2/7] [================69%         ] nsys_report_ia_20000_5_40.sqlite[2/7] [================70%         ] nsys_report_ia_20000_5_40.sqlite[2/7] [================71%         ] nsys_report_ia_20000_5_40.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_5_40.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_5_40.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_5_40.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_5_40.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_5_40.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_5_40.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_5_40.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_5_40.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_5_40.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_5_40.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_5_40.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_5_40.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_5_40.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_5_40.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_5_40.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_5_40.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_5_40.sqlite[2/7] [========================97% ] nsys_report_ia_20000_5_40.sqlite[2/7] [========================98% ] nsys_report_ia_20000_5_40.sqlite[2/7] [========================99% ] nsys_report_ia_20000_5_40.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_40.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        277285992          1  277285992.0  277285992.0  277285992  277285992          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                  Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------------------
     36.9      36196192187         24   1508174674.5        60495.5         8551   5270914884  2400819940.2  cudaMemcpyAsync                   
     34.2      33507500980          1  33507500980.0  33507500980.0  33507500980  33507500980           0.0  cudaHostAlloc                     
     26.5      26009365513          1  26009365513.0  26009365513.0  26009365513  26009365513           0.0  cudaFreeHost                      
      1.3       1260950579          2    630475289.5    630475289.5    440349798    820600781   268878048.6  cudaMemcpy                        
      0.8        788655188         40     19716379.7          405.0          290    788579537   124685066.0  cuKernelGetFunction               
      0.2        189423808          8     23677976.0      5296433.5        53390    158293863    54541403.4  cudaFree                          
      0.1        136676184          1    136676184.0    136676184.0    136676184    136676184           0.0  cudaDeviceReset                   
      0.0          5954906         15       396993.7       401005.0       172142       661597      169323.8  cuLibraryLoadData                 
      0.0          4655992         10       465599.2         6260.0         4260      4595891     1451237.5  cudaStreamSynchronize             
      0.0          2274165          7       324880.7       239863.0         4970       791318      327986.1  cudaMalloc                        
      0.0          1709361         40        42734.0         8431.0         4080      1316895      206779.7  cuLaunchKernel                    
      0.0          1569997        116        13534.5          500.0          350      1451056      134635.7  cudaEventDestroy                  
      0.0          1395567         24        58148.6        27115.5         4150       479916       98491.3  cudaLaunchKernel                  
      0.0           722335        112         6449.4         4250.0          570       115011       11221.8  cudaEventRecord                   
      0.0           568437          4       142109.3        37555.5         1730       491596      235232.3  cudaDeviceSynchronize             
      0.0           564577         16        35286.1          565.0          510       554047      138337.0  cuLibraryGetKernel                
      0.0           316545         40         7913.6          580.0          290       217783       34278.5  cudaStreamGetCaptureInfo_v2_v11030
      0.0           240822        814          295.9          270.0          120         1210         137.9  cuGetProcAddress_v2               
      0.0            89181         96          929.0          500.0          480        12370        1461.3  cudaEventCreate                   
      0.0            60231          2        30115.5        30115.5        13880        46351       22960.5  cudaStreamDestroy                 
      0.0            50021         20         2501.1          495.0          370        20991        6089.3  cudaEventCreateWithFlags          
      0.0            39261          2        19630.5        19630.5         1820        37441       25187.9  cudaStreamCreateWithFlags         
      0.0            29480          8         3685.0         3265.0         2760         6520        1222.6  cudaStreamWaitEvent               
      0.0            12900          1        12900.0        12900.0        12900        12900           0.0  cudaEventQuery                    
      0.0             4560          3         1520.0         1640.0          570         2350         896.0  cuInit                            
      0.0             3210          3         1070.0          300.0          170         2740        1447.7  cuModuleGetLoadingMode            
      0.0             3150          1         3150.0         3150.0         3150         3150           0.0  cuCtxSynchronize                  
      0.0             1130          2          565.0          565.0          390          740         247.5  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8      35203055620         40  880076390.5  881942888.5  861582644  891936825    8025629.5  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1         37210191          8    4651273.9    4658697.0    4610062    4666602      18817.2  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         20253524         16    1265845.3    1258074.5      14144    2531097    1292570.2  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  --------  ---------  -----------  ----------------------------
     88.9       6577489434     17  386911143.2  438220686.0      1632  829379233  385578694.9  [CUDA memcpy Host-to-Device]
     11.1        819931591      9   91103510.1       1984.0      1952  819913863  273303882.3  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
 131200.083     17  7717.652  3200.000     0.010  16000.000     8084.257  [CUDA memcpy Host-to-Device]
   3200.000      9   355.556     0.000     0.000   3200.000     1066.667  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 5 (num_steps = 40)
number of batches= 8
t_gemm = 35947.362610 ms
t_h2d = 6453.316286 ms
t_d2h = 1593.181133 ms
h_X_final[0] = 0.000050
h_X_final[1] = 0.000050
h_X_final[2] = 0.000050
h_X_final[3] = 0.000050
h_X_final[4] = 0.000050
t_gpu_alloc = 1.590014 ms
t_cpu_alloc = 32278.810978 ms
t_init = 14196.317911 ms
t_end_2_end = 99193.254948 ms
Generating '/tmp/nsys-report-4ba1.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===22%                      ] nsys_report_db_20000_5_40.nsys-rep[1/7] [======35%                   ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==========48%               ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==========49%               ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===========50%              ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===========51%              ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===========52%              ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===========53%              ] nsys_report_db_20000_5_40.nsys-rep[1/7] [============54%             ] nsys_report_db_20000_5_40.nsys-rep[1/7] [============55%             ] nsys_report_db_20000_5_40.nsys-rep[1/7] [============56%             ] nsys_report_db_20000_5_40.nsys-rep[1/7] [============57%             ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=============58%            ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=============59%            ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=============60%            ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==============61%           ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==============62%           ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==============63%           ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===============65%          ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===============66%          ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===============67%          ] nsys_report_db_20000_5_40.nsys-rep[1/7] [================68%         ] nsys_report_db_20000_5_40.nsys-rep[1/7] [================69%         ] nsys_report_db_20000_5_40.nsys-rep[1/7] [================70%         ] nsys_report_db_20000_5_40.nsys-rep[1/7] [================71%         ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=================72%        ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=================73%        ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=================74%        ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==================75%       ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==================76%       ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==================77%       ] nsys_report_db_20000_5_40.nsys-rep[1/7] [==================78%       ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===================79%      ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===================80%      ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===================81%      ] nsys_report_db_20000_5_40.nsys-rep[1/7] [===================82%      ] nsys_report_db_20000_5_40.nsys-rep[1/7] [====================83%     ] nsys_report_db_20000_5_40.nsys-rep[1/7] [====================84%     ] nsys_report_db_20000_5_40.nsys-rep[1/7] [====================85%     ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=====================86%    ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=====================87%    ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=====================88%    ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=====================89%    ] nsys_report_db_20000_5_40.nsys-rep[1/7] [======================90%   ] nsys_report_db_20000_5_40.nsys-rep[1/7] [======================91%   ] nsys_report_db_20000_5_40.nsys-rep[1/7] [======================92%   ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=======================93%  ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=======================94%  ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=======================95%  ] nsys_report_db_20000_5_40.nsys-rep[1/7] [=======================96%  ] nsys_report_db_20000_5_40.nsys-rep[1/7] [========================97% ] nsys_report_db_20000_5_40.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_5_40.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_40.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [1%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [2%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [3%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [4%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [5%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [6%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [7%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [8%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [9%                          ] nsys_report_db_20000_5_40.sqlite[2/7] [10%                         ] nsys_report_db_20000_5_40.sqlite[2/7] [11%                         ] nsys_report_db_20000_5_40.sqlite[2/7] [12%                         ] nsys_report_db_20000_5_40.sqlite[2/7] [13%                         ] nsys_report_db_20000_5_40.sqlite[2/7] [14%                         ] nsys_report_db_20000_5_40.sqlite[2/7] [=15%                        ] nsys_report_db_20000_5_40.sqlite[2/7] [=16%                        ] nsys_report_db_20000_5_40.sqlite[2/7] [=17%                        ] nsys_report_db_20000_5_40.sqlite[2/7] [==18%                       ] nsys_report_db_20000_5_40.sqlite[2/7] [==19%                       ] nsys_report_db_20000_5_40.sqlite[2/7] [==20%                       ] nsys_report_db_20000_5_40.sqlite[2/7] [==21%                       ] nsys_report_db_20000_5_40.sqlite[2/7] [===22%                      ] nsys_report_db_20000_5_40.sqlite[2/7] [===23%                      ] nsys_report_db_20000_5_40.sqlite[2/7] [===24%                      ] nsys_report_db_20000_5_40.sqlite[2/7] [====25%                     ] nsys_report_db_20000_5_40.sqlite[2/7] [====26%                     ] nsys_report_db_20000_5_40.sqlite[2/7] [====27%                     ] nsys_report_db_20000_5_40.sqlite[2/7] [====28%                     ] nsys_report_db_20000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_5_40.sqlite[2/7] [======33%                   ] nsys_report_db_20000_5_40.sqlite[2/7] [======34%                   ] nsys_report_db_20000_5_40.sqlite[2/7] [======35%                   ] nsys_report_db_20000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_5_40.sqlite[2/7] [========40%                 ] nsys_report_db_20000_5_40.sqlite[2/7] [========41%                 ] nsys_report_db_20000_5_40.sqlite[2/7] [========42%                 ] nsys_report_db_20000_5_40.sqlite[2/7] [=========43%                ] nsys_report_db_20000_5_40.sqlite[2/7] [=========44%                ] nsys_report_db_20000_5_40.sqlite[2/7] [=========45%                ] nsys_report_db_20000_5_40.sqlite[2/7] [=========46%                ] nsys_report_db_20000_5_40.sqlite[2/7] [==========47%               ] nsys_report_db_20000_5_40.sqlite[2/7] [==========48%               ] nsys_report_db_20000_5_40.sqlite[2/7] [==========49%               ] nsys_report_db_20000_5_40.sqlite[2/7] [===========50%              ] nsys_report_db_20000_5_40.sqlite[2/7] [===========51%              ] nsys_report_db_20000_5_40.sqlite[2/7] [===========52%              ] nsys_report_db_20000_5_40.sqlite[2/7] [===========53%              ] nsys_report_db_20000_5_40.sqlite[2/7] [============54%             ] nsys_report_db_20000_5_40.sqlite[2/7] [============55%             ] nsys_report_db_20000_5_40.sqlite[2/7] [============56%             ] nsys_report_db_20000_5_40.sqlite[2/7] [============57%             ] nsys_report_db_20000_5_40.sqlite[2/7] [=============58%            ] nsys_report_db_20000_5_40.sqlite[2/7] [=============59%            ] nsys_report_db_20000_5_40.sqlite[2/7] [=============60%            ] nsys_report_db_20000_5_40.sqlite[2/7] [==============61%           ] nsys_report_db_20000_5_40.sqlite[2/7] [==============62%           ] nsys_report_db_20000_5_40.sqlite[2/7] [==============63%           ] nsys_report_db_20000_5_40.sqlite[2/7] [==============64%           ] nsys_report_db_20000_5_40.sqlite[2/7] [===============65%          ] nsys_report_db_20000_5_40.sqlite[2/7] [===============66%          ] nsys_report_db_20000_5_40.sqlite[2/7] [===============67%          ] nsys_report_db_20000_5_40.sqlite[2/7] [================68%         ] nsys_report_db_20000_5_40.sqlite[2/7] [================69%         ] nsys_report_db_20000_5_40.sqlite[2/7] [================70%         ] nsys_report_db_20000_5_40.sqlite[2/7] [================71%         ] nsys_report_db_20000_5_40.sqlite[2/7] [=================72%        ] nsys_report_db_20000_5_40.sqlite[2/7] [=================73%        ] nsys_report_db_20000_5_40.sqlite[2/7] [=================74%        ] nsys_report_db_20000_5_40.sqlite[2/7] [==================75%       ] nsys_report_db_20000_5_40.sqlite[2/7] [==================76%       ] nsys_report_db_20000_5_40.sqlite[2/7] [==================77%       ] nsys_report_db_20000_5_40.sqlite[2/7] [==================78%       ] nsys_report_db_20000_5_40.sqlite[2/7] [===================79%      ] nsys_report_db_20000_5_40.sqlite[2/7] [===================80%      ] nsys_report_db_20000_5_40.sqlite[2/7] [===================81%      ] nsys_report_db_20000_5_40.sqlite[2/7] [===================82%      ] nsys_report_db_20000_5_40.sqlite[2/7] [====================83%     ] nsys_report_db_20000_5_40.sqlite[2/7] [====================84%     ] nsys_report_db_20000_5_40.sqlite[2/7] [====================85%     ] nsys_report_db_20000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_5_40.sqlite[2/7] [======================90%   ] nsys_report_db_20000_5_40.sqlite[2/7] [======================91%   ] nsys_report_db_20000_5_40.sqlite[2/7] [======================92%   ] nsys_report_db_20000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_5_40.sqlite[2/7] [========================97% ] nsys_report_db_20000_5_40.sqlite[2/7] [========================98% ] nsys_report_db_20000_5_40.sqlite[2/7] [========================99% ] nsys_report_db_20000_5_40.sqlite[2/7] [========================100%] nsys_report_db_20000_5_40.sqlite[2/7] [========================100%] nsys_report_db_20000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        318389180          1  318389180.0  318389180.0  318389180  318389180          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                  Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------------------
     40.6      32278806250          1  32278806250.0  32278806250.0  32278806250  32278806250           0.0  cudaHostAlloc                     
     39.0      30952989089         24   1289707878.7        30430.5         7270   4447403479  2052876552.7  cudaMemcpyAsync                   
     17.0      13468359416          1  13468359416.0  13468359416.0  13468359416  13468359416           0.0  cudaFreeHost                      
      1.9       1475782002         40     36894550.1          380.0          300   1475708702   233329735.9  cuKernelGetFunction               
      1.1        895652370          2    447826185.0    447826185.0    377857099    517795271    98951230.4  cudaMemcpy                        
      0.3        222101852          8     27762731.5      4912654.5        42901    191793716    66404091.4  cudaFree                          
      0.2        120921541          1    120921541.0    120921541.0    120921541    120921541           0.0  cudaDeviceReset                   
      0.0          5753462         15       383564.1       391655.0       169972       655207      154132.7  cuLibraryLoadData                 
      0.0          4659223         10       465922.3         6790.0         2620      4602301     1453376.2  cudaStreamSynchronize             
      0.0          2308195          7       329742.1       244032.0         3940       800459      332323.7  cudaMalloc                        
      0.0          1120150         24        46672.9        14525.0         4150       405694       82499.5  cudaLaunchKernel                  
      0.0           467836        112         4177.1         2905.0          590        31080        3793.0  cudaEventRecord                   
      0.0           346953         40         8673.8         4895.0         3910        50551        9290.1  cuLaunchKernel                    
      0.0           293634        814          360.7          330.0          120         1210         173.3  cuGetProcAddress_v2               
      0.0           113061        116          974.7          565.0          320        30810        2898.4  cudaEventDestroy                  
      0.0            88211         40         2205.3          540.0          300        13720        3631.3  cudaStreamGetCaptureInfo_v2_v11030
      0.0            80111         96          834.5          510.0          490         4500         769.6  cudaEventCreate                   
      0.0            56791         20         2839.6          520.0          400        34340        7778.8  cudaEventCreateWithFlags          
      0.0            51490          4        12872.5         3585.0         1830        42490       19772.7  cudaDeviceSynchronize             
      0.0            50052          8         6256.5         6460.0         4220         7310         933.8  cudaStreamWaitEvent               
      0.0            44450          2        22225.0        22225.0         2800        41650       27471.1  cudaStreamCreateWithFlags         
      0.0            21570          2        10785.0        10785.0         4600        16970        8746.9  cudaStreamDestroy                 
      0.0            15860         16          991.3          555.0          480         5890        1356.9  cuLibraryGetKernel                
      0.0             7741          1         7741.0         7741.0         7741         7741           0.0  cudaEventQuery                    
      0.0             6000          3         2000.0         2480.0          720         2800        1120.0  cuInit                            
      0.0             5290          3         1763.3          410.0          260         4620        2475.1  cuModuleGetLoadingMode            
      0.0             1550          1         1550.0         1550.0         1550         1550           0.0  cuCtxSynchronize                  
      0.0             1000          2          500.0          500.0          310          690         268.7  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.8      35240350582         40  881008764.6  884384356.0  856417316  890849419    8064824.0  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.1         37167079          8    4645884.9    4653767.5    4610475    4673291      24056.3  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.1         20256655         16    1266040.9    1259674.5      14176    2529591    1292651.5  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  --------  ---------  -----------  ----------------------------
     92.6       6452930936     17  379584172.7  377676989.0      1663  851737603  381003267.5  [CUDA memcpy Host-to-Device]
      7.4        517583321      9   57509257.9       1984.0      1951  517565785  172521197.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)   StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  ---------  -----------  ----------------------------
 131200.083     17  7717.652  3200.000     0.010  16000.000     8084.257  [CUDA memcpy Host-to-Device]
   3200.000      9   355.556     0.000     0.000   3200.000     1066.667  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 5 (num_steps = 40), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  17.95 GB
Used GPU Memory:  21.55 GB
------------------------

Process RSS:  128.92 GB
h_X_final[0] = 0.000050
h_X_final[1] = 0.000050
h_X_final[2] = 0.000050
h_X_final[3] = 0.000050
h_X_final[4] = 0.000050
t_alloc_gpu = 1.813889 ms
t_alloc_cpu = 32316.565037 ms
t_init      = 11572.297096 ms
t_h2d       = 6329.808207 ms
t_d2h       = 671.875954 ms
t_gemm      = 35884.325623 ms
t_end_2_end = 97492.727995 ms
Generating '/tmp/nsys-report-fd7e.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [10%                         ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [==21%                       ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===22%                      ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===23%                      ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===24%                      ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [====25%                     ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [====26%                     ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [====27%                     ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [====28%                     ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [======33%                   ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [======34%                   ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [======35%                   ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [========40%                 ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [========41%                 ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [========42%                 ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=========43%                ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=========44%                ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=========45%                ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=========46%                ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [==========47%               ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [==========48%               ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [==========49%               ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===========50%              ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===========51%              ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===========52%              ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===========53%              ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [============54%             ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [============55%             ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [============56%             ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [============57%             ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=============58%            ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=============59%            ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [=============60%            ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [==============61%           ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [==============62%           ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [==============63%           ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===============65%          ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===============66%          ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [===============67%          ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [================68%         ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [================69%         ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [================70%         ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [================71%         ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [========================97% ] nsys_report_fo_20000_5_40.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_40.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [1%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [2%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [3%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [4%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [5%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [6%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [7%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [8%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [9%                          ] nsys_report_fo_20000_5_40.sqlite[2/7] [10%                         ] nsys_report_fo_20000_5_40.sqlite[2/7] [11%                         ] nsys_report_fo_20000_5_40.sqlite[2/7] [12%                         ] nsys_report_fo_20000_5_40.sqlite[2/7] [13%                         ] nsys_report_fo_20000_5_40.sqlite[2/7] [14%                         ] nsys_report_fo_20000_5_40.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_5_40.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_5_40.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_5_40.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_5_40.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_5_40.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_5_40.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_5_40.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_5_40.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_5_40.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_5_40.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_5_40.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_5_40.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_5_40.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_5_40.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_5_40.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_5_40.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_5_40.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_5_40.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_5_40.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_5_40.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_5_40.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_5_40.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_5_40.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_5_40.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_5_40.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_5_40.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_5_40.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_5_40.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_5_40.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_5_40.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_5_40.sqlite[2/7] [============54%             ] nsys_report_fo_20000_5_40.sqlite[2/7] [============55%             ] nsys_report_fo_20000_5_40.sqlite[2/7] [============56%             ] nsys_report_fo_20000_5_40.sqlite[2/7] [============57%             ] nsys_report_fo_20000_5_40.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_5_40.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_5_40.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_5_40.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_5_40.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_5_40.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_5_40.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_5_40.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_5_40.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_5_40.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_5_40.sqlite[2/7] [================68%         ] nsys_report_fo_20000_5_40.sqlite[2/7] [================69%         ] nsys_report_fo_20000_5_40.sqlite[2/7] [================70%         ] nsys_report_fo_20000_5_40.sqlite[2/7] [================71%         ] nsys_report_fo_20000_5_40.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_5_40.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_5_40.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_5_40.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_5_40.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_5_40.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_5_40.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_5_40.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_5_40.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_5_40.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_5_40.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_5_40.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_5_40.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_5_40.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_5_40.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_5_40.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_5_40.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_5_40.sqlite[2/7] [========================97% ] nsys_report_fo_20000_5_40.sqlite[2/7] [========================98% ] nsys_report_fo_20000_5_40.sqlite[2/7] [========================99% ] nsys_report_fo_20000_5_40.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_40.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        311378895          1  311378895.0  311378895.0  311378895  311378895          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     41.0      34672857934        120    288940482.8        30750.0         3760    896927350  418086171.3  cudaMemcpyAsync                   
     38.2      32316559702          1  32316559702.0  32316559702.0  32316559702  32316559702          0.0  cudaHostAlloc                     
     18.8      15910355316          1  15910355316.0  15910355316.0  15910355316  15910355316          0.0  cudaFreeHost                      
      0.9        736055756         40     18401393.9         4285.0         1310    735898174  116355078.9  cuKernelGetFunction               
      0.7        599413250          2    299706625.0    299706625.0    239216374    360196876   85546133.4  cudaMemcpy                        
      0.2        200754066         11     18250369.6      1652948.0        58911    186237076   55719643.2  cudaFree                          
      0.2        140282647          1    140282647.0    140282647.0    140282647    140282647          0.0  cudaDeviceReset                   
      0.0          4838312         42       115197.9         5365.0         2660      4609431     710390.4  cudaStreamSynchronize             
      0.0          4546261         15       303084.1       327304.0       127822       482755     121807.5  cuLibraryLoadData                 
      0.0          2599764        120        21664.7         9425.5         4180       385305      37722.9  cudaLaunchKernel                  
      0.0          1996902         10       199690.2       251928.0         3760       294503      98718.9  cudaMalloc                        
      0.0           998021        280         3564.4         2920.0          500        43001       3553.9  cudaEventRecord                   
      0.0           513031         40        12825.8        11235.5         6510        65711       9063.5  cuLaunchKernel                    
      0.0           293375        814          360.4          320.0          120         1160        189.8  cuGetProcAddress_v2               
      0.0           252631        200         1263.2          405.0          290        16100       2105.8  cudaStreamGetCaptureInfo_v2_v11030
      0.0           182375         75         2431.7         2900.0          620         6850       1462.3  cudaStreamWaitEvent               
      0.0           132492          1       132492.0       132492.0       132492       132492          0.0  cudaMemGetInfo                    
      0.0           132132        160          825.8          490.0          470        14270       1471.5  cudaEventCreate                   
      0.0            81061          4        20265.3         3570.0         1980        71941      34459.2  cudaDeviceSynchronize             
      0.0            58061         28         2073.6          440.0          390        26710       5258.0  cudaEventCreateWithFlags          
      0.0            41481          2        20740.5        20740.5        12050        29431      12290.2  cudaStreamDestroy                 
      0.0            36071          2        18035.5        18035.5         1930        34141      22776.6  cudaStreamCreateWithFlags         
      0.0            26461         28          945.0          475.0          350         8490       1617.9  cudaEventDestroy                  
      0.0            10920         16          682.5          580.0          480         1860        352.0  cuLibraryGetKernel                
      0.0             6800          1         6800.0         6800.0         6800         6800          0.0  cudaEventQuery                    
      0.0             4110          3         1370.0         1260.0          550         2300        880.2  cuInit                            
      0.0             3350          3         1116.7          270.0          160         2920       1562.7  cuModuleGetLoadingMode            
      0.0             1760          1         1760.0         1760.0         1760         1760          0.0  cuCtxSynchronize                  
      0.0              920          2          460.0          460.0          310          610        212.1  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.2      35256196486         40  881404912.2  883689053.5  864299429  889860630    5723786.7  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.5        186042107         40    4651052.7    4658278.5    4608427    4671179      18775.6  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.3        101118755         80    1263984.4    1255755.0      14048    2530168    1257457.4  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  -----------  --------  ---------  -----------  ----------------------------
     94.6       6327977007     81  78123172.9  123832551.0      1600  238493601   80703445.3  [CUDA memcpy Host-to-Device]
      5.4        360030790     41   8781238.8       1984.0      1951  359949254   56214310.7  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 131200.415     81  1619.758  3200.000     0.010  3200.000     1609.841  [CUDA memcpy Host-to-Device]
   3200.000     41    78.049     0.000     0.000  3200.000      499.756  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 5 (num_steps = 60)
number of batches= 12
Generating '/tmp/nsys-report-17f4.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_5_60.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_5_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_5_60.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_60.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [1%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [2%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [3%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [4%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [5%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [6%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [7%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [8%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [9%                          ] nsys_report_ia_20000_5_60.sqlite[2/7] [10%                         ] nsys_report_ia_20000_5_60.sqlite[2/7] [11%                         ] nsys_report_ia_20000_5_60.sqlite[2/7] [12%                         ] nsys_report_ia_20000_5_60.sqlite[2/7] [13%                         ] nsys_report_ia_20000_5_60.sqlite[2/7] [14%                         ] nsys_report_ia_20000_5_60.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_5_60.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_5_60.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_5_60.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_5_60.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_5_60.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_5_60.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_5_60.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_5_60.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_5_60.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_5_60.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_5_60.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_5_60.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_5_60.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_5_60.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_5_60.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_5_60.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_5_60.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_5_60.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_5_60.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_5_60.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_5_60.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_5_60.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_5_60.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_5_60.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_5_60.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_5_60.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_5_60.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_5_60.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_5_60.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_5_60.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_5_60.sqlite[2/7] [============54%             ] nsys_report_ia_20000_5_60.sqlite[2/7] [============55%             ] nsys_report_ia_20000_5_60.sqlite[2/7] [============56%             ] nsys_report_ia_20000_5_60.sqlite[2/7] [============57%             ] nsys_report_ia_20000_5_60.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_5_60.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_5_60.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_5_60.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_5_60.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_5_60.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_5_60.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_5_60.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_5_60.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_5_60.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_5_60.sqlite[2/7] [================68%         ] nsys_report_ia_20000_5_60.sqlite[2/7] [================69%         ] nsys_report_ia_20000_5_60.sqlite[2/7] [================70%         ] nsys_report_ia_20000_5_60.sqlite[2/7] [================71%         ] nsys_report_ia_20000_5_60.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_5_60.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_5_60.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_5_60.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_5_60.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_5_60.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_5_60.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_5_60.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_5_60.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_5_60.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_5_60.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_5_60.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_5_60.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_5_60.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_5_60.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_5_60.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_5_60.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_5_60.sqlite[2/7] [========================97% ] nsys_report_ia_20000_5_60.sqlite[2/7] [========================98% ] nsys_report_ia_20000_5_60.sqlite[2/7] [========================99% ] nsys_report_ia_20000_5_60.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_60.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        290834643          1  290834643.0  290834643.0  290834643  290834643          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        167804999          1  167804999.0  167804999.0  167804999  167804999          0.0  cudaFree                      
      1.4          2305376          7     329339.4     244673.0       4250     789929     329206.1  cudaMalloc                    
      0.2           338113        814        415.4        390.0        130       1640        244.1  cuGetProcAddress_v2           
      0.0            41250          2      20625.0      20625.0       1930      39320      26438.7  cudaStreamCreateWithFlags     
      0.0            24591         18       1366.2        515.0        390      14151       3211.1  cudaEventCreateWithFlags      
      0.0            14010          1      14010.0      14010.0      14010      14010          0.0  cudaHostAlloc                 
      0.0             7370          3       2456.7       2350.0       1040       3980       1472.9  cuInit                        
      0.0             4900          3       1633.3        400.0        300       4200       2223.4  cuModuleGetLoadingMode        
      0.0             1070          2        535.0        535.0        310        760        318.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 5 (num_steps = 60)
number of batches= 12
Generating '/tmp/nsys-report-baff.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_5_60.nsys-rep[1/7] [=====31%                    ] nsys_report_db_20000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_5_60.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_5_60.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_60.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [1%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [2%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [3%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [4%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [5%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [6%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [7%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [8%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [9%                          ] nsys_report_db_20000_5_60.sqlite[2/7] [10%                         ] nsys_report_db_20000_5_60.sqlite[2/7] [11%                         ] nsys_report_db_20000_5_60.sqlite[2/7] [12%                         ] nsys_report_db_20000_5_60.sqlite[2/7] [13%                         ] nsys_report_db_20000_5_60.sqlite[2/7] [14%                         ] nsys_report_db_20000_5_60.sqlite[2/7] [=15%                        ] nsys_report_db_20000_5_60.sqlite[2/7] [=16%                        ] nsys_report_db_20000_5_60.sqlite[2/7] [=17%                        ] nsys_report_db_20000_5_60.sqlite[2/7] [==18%                       ] nsys_report_db_20000_5_60.sqlite[2/7] [==19%                       ] nsys_report_db_20000_5_60.sqlite[2/7] [==20%                       ] nsys_report_db_20000_5_60.sqlite[2/7] [==21%                       ] nsys_report_db_20000_5_60.sqlite[2/7] [===22%                      ] nsys_report_db_20000_5_60.sqlite[2/7] [===23%                      ] nsys_report_db_20000_5_60.sqlite[2/7] [===24%                      ] nsys_report_db_20000_5_60.sqlite[2/7] [====25%                     ] nsys_report_db_20000_5_60.sqlite[2/7] [====26%                     ] nsys_report_db_20000_5_60.sqlite[2/7] [====27%                     ] nsys_report_db_20000_5_60.sqlite[2/7] [====28%                     ] nsys_report_db_20000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_5_60.sqlite[2/7] [======33%                   ] nsys_report_db_20000_5_60.sqlite[2/7] [======34%                   ] nsys_report_db_20000_5_60.sqlite[2/7] [======35%                   ] nsys_report_db_20000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_5_60.sqlite[2/7] [========40%                 ] nsys_report_db_20000_5_60.sqlite[2/7] [========41%                 ] nsys_report_db_20000_5_60.sqlite[2/7] [========42%                 ] nsys_report_db_20000_5_60.sqlite[2/7] [=========43%                ] nsys_report_db_20000_5_60.sqlite[2/7] [=========44%                ] nsys_report_db_20000_5_60.sqlite[2/7] [=========45%                ] nsys_report_db_20000_5_60.sqlite[2/7] [=========46%                ] nsys_report_db_20000_5_60.sqlite[2/7] [==========47%               ] nsys_report_db_20000_5_60.sqlite[2/7] [==========48%               ] nsys_report_db_20000_5_60.sqlite[2/7] [==========49%               ] nsys_report_db_20000_5_60.sqlite[2/7] [===========50%              ] nsys_report_db_20000_5_60.sqlite[2/7] [===========51%              ] nsys_report_db_20000_5_60.sqlite[2/7] [===========52%              ] nsys_report_db_20000_5_60.sqlite[2/7] [===========53%              ] nsys_report_db_20000_5_60.sqlite[2/7] [============54%             ] nsys_report_db_20000_5_60.sqlite[2/7] [============55%             ] nsys_report_db_20000_5_60.sqlite[2/7] [============56%             ] nsys_report_db_20000_5_60.sqlite[2/7] [============57%             ] nsys_report_db_20000_5_60.sqlite[2/7] [=============58%            ] nsys_report_db_20000_5_60.sqlite[2/7] [=============59%            ] nsys_report_db_20000_5_60.sqlite[2/7] [=============60%            ] nsys_report_db_20000_5_60.sqlite[2/7] [==============61%           ] nsys_report_db_20000_5_60.sqlite[2/7] [==============62%           ] nsys_report_db_20000_5_60.sqlite[2/7] [==============63%           ] nsys_report_db_20000_5_60.sqlite[2/7] [==============64%           ] nsys_report_db_20000_5_60.sqlite[2/7] [===============65%          ] nsys_report_db_20000_5_60.sqlite[2/7] [===============66%          ] nsys_report_db_20000_5_60.sqlite[2/7] [===============67%          ] nsys_report_db_20000_5_60.sqlite[2/7] [================68%         ] nsys_report_db_20000_5_60.sqlite[2/7] [================69%         ] nsys_report_db_20000_5_60.sqlite[2/7] [================70%         ] nsys_report_db_20000_5_60.sqlite[2/7] [================71%         ] nsys_report_db_20000_5_60.sqlite[2/7] [=================72%        ] nsys_report_db_20000_5_60.sqlite[2/7] [=================73%        ] nsys_report_db_20000_5_60.sqlite[2/7] [=================74%        ] nsys_report_db_20000_5_60.sqlite[2/7] [==================75%       ] nsys_report_db_20000_5_60.sqlite[2/7] [==================76%       ] nsys_report_db_20000_5_60.sqlite[2/7] [==================77%       ] nsys_report_db_20000_5_60.sqlite[2/7] [==================78%       ] nsys_report_db_20000_5_60.sqlite[2/7] [===================79%      ] nsys_report_db_20000_5_60.sqlite[2/7] [===================80%      ] nsys_report_db_20000_5_60.sqlite[2/7] [===================81%      ] nsys_report_db_20000_5_60.sqlite[2/7] [===================82%      ] nsys_report_db_20000_5_60.sqlite[2/7] [====================83%     ] nsys_report_db_20000_5_60.sqlite[2/7] [====================84%     ] nsys_report_db_20000_5_60.sqlite[2/7] [====================85%     ] nsys_report_db_20000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_5_60.sqlite[2/7] [======================90%   ] nsys_report_db_20000_5_60.sqlite[2/7] [======================91%   ] nsys_report_db_20000_5_60.sqlite[2/7] [======================92%   ] nsys_report_db_20000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_5_60.sqlite[2/7] [========================97% ] nsys_report_db_20000_5_60.sqlite[2/7] [========================98% ] nsys_report_db_20000_5_60.sqlite[2/7] [========================99% ] nsys_report_db_20000_5_60.sqlite[2/7] [========================100%] nsys_report_db_20000_5_60.sqlite[2/7] [========================100%] nsys_report_db_20000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        241636578          1  241636578.0  241636578.0  241636578  241636578          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        136176730          1  136176730.0  136176730.0  136176730  136176730          0.0  cudaFree                      
      1.7          2357065          7     336723.6     239262.0       4300     877799     349054.0  cudaMalloc                    
      0.2           303202        814        372.5        325.0        120       1320        195.3  cuGetProcAddress_v2           
      0.0            41471          2      20735.5      20735.5       1900      39571      26637.4  cudaStreamCreateWithFlags     
      0.0            23560         18       1308.9        515.0        390      12900       2917.7  cudaEventCreateWithFlags      
      0.0            12210          1      12210.0      12210.0      12210      12210          0.0  cudaHostAlloc                 
      0.0             5160          3       1720.0       1990.0        690       2480        925.0  cuInit                        
      0.0             3740          3       1246.7        270.0        260       3210       1700.3  cuModuleGetLoadingMode        
      0.0             1340          2        670.0        670.0        440        900        325.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 5 (num_steps = 60), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  17.83 GB
Used GPU Memory:  21.67 GB
------------------------

Process RSS:  188.52 GB
h_X_final[0] = 0.000050
h_X_final[1] = 0.000050
h_X_final[2] = 0.000050
h_X_final[3] = 0.000050
h_X_final[4] = 0.000050
t_alloc_gpu = 1.670837 ms
t_alloc_cpu = 55530.545950 ms
t_init      = 16724.936008 ms
t_h2d       = 8611.108179 ms
t_d2h       = 1558.744192 ms
t_gemm      = 53471.930664 ms
t_end_2_end = 157872.442007 ms
Generating '/tmp/nsys-report-35ed.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=16%                        ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==21%                       ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [====25%                     ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [====26%                     ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [====27%                     ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [====28%                     ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [======33%                   ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [======34%                   ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [======35%                   ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [========40%                 ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [========41%                 ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [========42%                 ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=========43%                ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=========44%                ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=========45%                ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=========46%                ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==========47%               ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==========48%               ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==========49%               ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===========50%              ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===========51%              ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===========52%              ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===========53%              ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [============54%             ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [============55%             ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [============56%             ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [============57%             ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=============58%            ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=============59%            ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=============60%            ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==============61%           ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==============62%           ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==============63%           ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===============65%          ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===============66%          ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===============67%          ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [================68%         ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [================69%         ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [================70%         ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [================71%         ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=================72%        ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=================73%        ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=================74%        ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==================75%       ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==================76%       ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==================77%       ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [==================78%       ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===================79%      ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===================80%      ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===================81%      ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [===================82%      ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [====================83%     ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [====================84%     ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=====================86%    ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=====================88%    ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=====================89%    ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [======================90%   ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [======================91%   ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [======================92%   ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=======================93%  ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=======================95%  ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [=======================96%  ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [========================97% ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_5_60.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_60.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [1%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [2%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [3%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [4%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [5%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [6%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [7%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [8%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [9%                          ] nsys_report_fo_20000_5_60.sqlite[2/7] [10%                         ] nsys_report_fo_20000_5_60.sqlite[2/7] [11%                         ] nsys_report_fo_20000_5_60.sqlite[2/7] [12%                         ] nsys_report_fo_20000_5_60.sqlite[2/7] [13%                         ] nsys_report_fo_20000_5_60.sqlite[2/7] [14%                         ] nsys_report_fo_20000_5_60.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_5_60.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_5_60.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_5_60.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_5_60.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_5_60.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_5_60.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_5_60.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_5_60.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_5_60.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_5_60.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_5_60.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_5_60.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_5_60.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_5_60.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_5_60.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_5_60.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_5_60.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_5_60.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_5_60.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_5_60.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_5_60.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_5_60.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_5_60.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_5_60.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_5_60.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_5_60.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_5_60.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_5_60.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_5_60.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_5_60.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_5_60.sqlite[2/7] [============54%             ] nsys_report_fo_20000_5_60.sqlite[2/7] [============55%             ] nsys_report_fo_20000_5_60.sqlite[2/7] [============56%             ] nsys_report_fo_20000_5_60.sqlite[2/7] [============57%             ] nsys_report_fo_20000_5_60.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_5_60.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_5_60.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_5_60.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_5_60.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_5_60.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_5_60.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_5_60.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_5_60.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_5_60.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_5_60.sqlite[2/7] [================68%         ] nsys_report_fo_20000_5_60.sqlite[2/7] [================69%         ] nsys_report_fo_20000_5_60.sqlite[2/7] [================70%         ] nsys_report_fo_20000_5_60.sqlite[2/7] [================71%         ] nsys_report_fo_20000_5_60.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_5_60.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_5_60.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_5_60.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_5_60.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_5_60.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_5_60.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_5_60.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_5_60.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_5_60.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_5_60.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_5_60.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_5_60.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_5_60.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_5_60.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_5_60.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_5_60.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_5_60.sqlite[2/7] [========================97% ] nsys_report_fo_20000_5_60.sqlite[2/7] [========================98% ] nsys_report_fo_20000_5_60.sqlite[2/7] [========================99% ] nsys_report_fo_20000_5_60.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_60.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        255550645          1  255550645.0  255550645.0  255550645  255550645          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     39.8      55530606071          1  55530606071.0  55530606071.0  55530606071  55530606071          0.0  cudaHostAlloc                     
     37.6      52426295759        180    291257198.7        15096.0         4010    898295466  418234092.4  cudaMemcpyAsync                   
     21.1      29364599626          1  29364599626.0  29364599626.0  29364599626  29364599626          0.0  cudaFreeHost                      
      0.8       1082264572          2    541132286.0    541132286.0    213912042    868352530  462759306.9  cudaMemcpy                        
      0.5        712360762         60     11872679.4         2660.5          700    712146448   91937242.2  cuKernelGetFunction               
      0.1        149710669         11     13610060.8      1710745.0        37510    136814326   40869653.5  cudaFree                          
      0.1        138059024          1    138059024.0    138059024.0    138059024    138059024          0.0  cudaDeviceReset                   
      0.0          4821295         62        77762.8         3135.0         2610      4603055     584136.0  cudaStreamSynchronize             
      0.0          4470034         15       298002.3       290474.0       115372       535428     137482.0  cuLibraryLoadData                 
      0.0          4173582        180        23186.6         8965.0         4380      1343979     100238.9  cudaLaunchKernel                  
      0.0          1850957         10       185095.7       224018.0         3990       286324      91112.8  cudaMalloc                        
      0.0          1496263        420         3562.5         3125.0          510        40401       3330.4  cudaEventRecord                   
      0.0           834085         60        13901.4         9675.5         6400        83771      11424.7  cuLaunchKernel                    
      0.0           605816        300         2019.4          410.0          290       284844      16464.8  cudaStreamGetCaptureInfo_v2_v11030
      0.0           320581        814          393.8          350.0          120         1660        238.4  cuGetProcAddress_v2               
      0.0           220520        115         1917.6         1750.0          600         8630       1540.5  cudaStreamWaitEvent               
      0.0           179703          1       179703.0       179703.0       179703       179703          0.0  cudaMemGetInfo                    
      0.0           178684        240          744.5          490.5          480        14640       1132.8  cudaEventCreate                   
      0.0            68671          4        17167.8         3745.0         1640        59541      28272.1  cudaDeviceSynchronize             
      0.0            50280         28         1795.7          450.0          400        20850       4210.1  cudaEventCreateWithFlags          
      0.0            41651         28         1487.5          540.0          320         9390       2188.2  cudaEventDestroy                  
      0.0            38700          2        19350.0        19350.0         3180        35520      22867.8  cudaStreamCreateWithFlags         
      0.0            35121          2        17560.5        17560.5        10490        24631       9999.2  cudaStreamDestroy                 
      0.0            13690         16          855.6          705.0          520         1890        369.2  cuLibraryGetKernel                
      0.0             7760          1         7760.0         7760.0         7760         7760          0.0  cudaEventQuery                    
      0.0             7460          3         2486.7         3030.0          650         3780       1634.2  cuInit                            
      0.0             4650          3         1550.0          440.0          290         3920       2053.9  cuModuleGetLoadingMode            
      0.0             1210          1         1210.0         1210.0         1210         1210          0.0  cuCtxSynchronize                  
      0.0              860          2          430.0          430.0          330          530        141.4  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.2      52861357901         60  881022631.7  883235185.0  859151500  891125357    7524267.8  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.5        279785527         60    4663092.1    4669224.0    4608283    4680729      18311.4  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.3        151726601        120    1264388.3    1256637.5      13984    2528576    1255268.8  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  -----------  --------  ---------  -----------  ----------------------------
     90.8       8607186057    121  71133769.1  121954492.0      1600  213281711   72435206.4  [CUDA memcpy Host-to-Device]
      9.2        867738721     61  14225224.9       1984.0      1951  867617376  111086762.9  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 195200.623    121  1613.228  3200.000     0.010  3200.000     1606.593  [CUDA memcpy Host-to-Device]
   3200.000     61    52.459     0.000     0.000  3200.000      409.718  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 5 (num_steps = 80)
number of batches= 16
Generating '/tmp/nsys-report-9985.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_5_80.nsys-rep[1/7] [=====31%                    ] nsys_report_ia_20000_5_80.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_5_80.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_5_80.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_80.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [1%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [2%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [3%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [4%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [5%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [6%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [7%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [8%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [9%                          ] nsys_report_ia_20000_5_80.sqlite[2/7] [10%                         ] nsys_report_ia_20000_5_80.sqlite[2/7] [11%                         ] nsys_report_ia_20000_5_80.sqlite[2/7] [12%                         ] nsys_report_ia_20000_5_80.sqlite[2/7] [13%                         ] nsys_report_ia_20000_5_80.sqlite[2/7] [14%                         ] nsys_report_ia_20000_5_80.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_5_80.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_5_80.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_5_80.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_5_80.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_5_80.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_5_80.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_5_80.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_5_80.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_5_80.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_5_80.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_5_80.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_5_80.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_5_80.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_5_80.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_5_80.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_5_80.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_5_80.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_5_80.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_5_80.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_5_80.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_5_80.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_5_80.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_5_80.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_5_80.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_5_80.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_5_80.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_5_80.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_5_80.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_5_80.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_5_80.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_5_80.sqlite[2/7] [============54%             ] nsys_report_ia_20000_5_80.sqlite[2/7] [============55%             ] nsys_report_ia_20000_5_80.sqlite[2/7] [============56%             ] nsys_report_ia_20000_5_80.sqlite[2/7] [============57%             ] nsys_report_ia_20000_5_80.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_5_80.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_5_80.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_5_80.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_5_80.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_5_80.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_5_80.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_5_80.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_5_80.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_5_80.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_5_80.sqlite[2/7] [================68%         ] nsys_report_ia_20000_5_80.sqlite[2/7] [================69%         ] nsys_report_ia_20000_5_80.sqlite[2/7] [================70%         ] nsys_report_ia_20000_5_80.sqlite[2/7] [================71%         ] nsys_report_ia_20000_5_80.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_5_80.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_5_80.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_5_80.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_5_80.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_5_80.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_5_80.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_5_80.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_5_80.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_5_80.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_5_80.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_5_80.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_5_80.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_5_80.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_5_80.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_5_80.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_5_80.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_5_80.sqlite[2/7] [========================97% ] nsys_report_ia_20000_5_80.sqlite[2/7] [========================98% ] nsys_report_ia_20000_5_80.sqlite[2/7] [========================99% ] nsys_report_ia_20000_5_80.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_80.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        324918727          1  324918727.0  324918727.0  324918727  324918727          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        196265325          1  196265325.0  196265325.0  196265325  196265325          0.0  cudaFree                      
      1.2          2324584          7     332083.4     250604.0       4310     811052     332035.6  cudaMalloc                    
      0.2           344106        814        422.7        390.0        130       1710        244.3  cuGetProcAddress_v2           
      0.0            47811          2      23905.5      23905.5       1910      45901      31106.3  cudaStreamCreateWithFlags     
      0.0            19240         18       1068.9        505.0        380       8800       1967.9  cudaEventCreateWithFlags      
      0.0            13240          1      13240.0      13240.0      13240      13240          0.0  cudaHostAlloc                 
      0.0             6400          3       2133.3       2010.0        650       3740       1548.7  cuInit                        
      0.0             4720          3       1573.3        400.0        300       4020       2119.5  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        340        580        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 5 (num_steps = 80)
number of batches= 16
Generating '/tmp/nsys-report-c3d8.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_5_80.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_5_80.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_5_80.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_5_80.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_80.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [1%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [2%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [3%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [4%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [5%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [6%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [7%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [8%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [9%                          ] nsys_report_db_20000_5_80.sqlite[2/7] [10%                         ] nsys_report_db_20000_5_80.sqlite[2/7] [11%                         ] nsys_report_db_20000_5_80.sqlite[2/7] [12%                         ] nsys_report_db_20000_5_80.sqlite[2/7] [13%                         ] nsys_report_db_20000_5_80.sqlite[2/7] [14%                         ] nsys_report_db_20000_5_80.sqlite[2/7] [=15%                        ] nsys_report_db_20000_5_80.sqlite[2/7] [=16%                        ] nsys_report_db_20000_5_80.sqlite[2/7] [=17%                        ] nsys_report_db_20000_5_80.sqlite[2/7] [==18%                       ] nsys_report_db_20000_5_80.sqlite[2/7] [==19%                       ] nsys_report_db_20000_5_80.sqlite[2/7] [==20%                       ] nsys_report_db_20000_5_80.sqlite[2/7] [==21%                       ] nsys_report_db_20000_5_80.sqlite[2/7] [===22%                      ] nsys_report_db_20000_5_80.sqlite[2/7] [===23%                      ] nsys_report_db_20000_5_80.sqlite[2/7] [===24%                      ] nsys_report_db_20000_5_80.sqlite[2/7] [====25%                     ] nsys_report_db_20000_5_80.sqlite[2/7] [====26%                     ] nsys_report_db_20000_5_80.sqlite[2/7] [====27%                     ] nsys_report_db_20000_5_80.sqlite[2/7] [====28%                     ] nsys_report_db_20000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_5_80.sqlite[2/7] [======33%                   ] nsys_report_db_20000_5_80.sqlite[2/7] [======34%                   ] nsys_report_db_20000_5_80.sqlite[2/7] [======35%                   ] nsys_report_db_20000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_5_80.sqlite[2/7] [========40%                 ] nsys_report_db_20000_5_80.sqlite[2/7] [========41%                 ] nsys_report_db_20000_5_80.sqlite[2/7] [========42%                 ] nsys_report_db_20000_5_80.sqlite[2/7] [=========43%                ] nsys_report_db_20000_5_80.sqlite[2/7] [=========44%                ] nsys_report_db_20000_5_80.sqlite[2/7] [=========45%                ] nsys_report_db_20000_5_80.sqlite[2/7] [=========46%                ] nsys_report_db_20000_5_80.sqlite[2/7] [==========47%               ] nsys_report_db_20000_5_80.sqlite[2/7] [==========48%               ] nsys_report_db_20000_5_80.sqlite[2/7] [==========49%               ] nsys_report_db_20000_5_80.sqlite[2/7] [===========50%              ] nsys_report_db_20000_5_80.sqlite[2/7] [===========51%              ] nsys_report_db_20000_5_80.sqlite[2/7] [===========52%              ] nsys_report_db_20000_5_80.sqlite[2/7] [===========53%              ] nsys_report_db_20000_5_80.sqlite[2/7] [============54%             ] nsys_report_db_20000_5_80.sqlite[2/7] [============55%             ] nsys_report_db_20000_5_80.sqlite[2/7] [============56%             ] nsys_report_db_20000_5_80.sqlite[2/7] [============57%             ] nsys_report_db_20000_5_80.sqlite[2/7] [=============58%            ] nsys_report_db_20000_5_80.sqlite[2/7] [=============59%            ] nsys_report_db_20000_5_80.sqlite[2/7] [=============60%            ] nsys_report_db_20000_5_80.sqlite[2/7] [==============61%           ] nsys_report_db_20000_5_80.sqlite[2/7] [==============62%           ] nsys_report_db_20000_5_80.sqlite[2/7] [==============63%           ] nsys_report_db_20000_5_80.sqlite[2/7] [==============64%           ] nsys_report_db_20000_5_80.sqlite[2/7] [===============65%          ] nsys_report_db_20000_5_80.sqlite[2/7] [===============66%          ] nsys_report_db_20000_5_80.sqlite[2/7] [===============67%          ] nsys_report_db_20000_5_80.sqlite[2/7] [================68%         ] nsys_report_db_20000_5_80.sqlite[2/7] [================69%         ] nsys_report_db_20000_5_80.sqlite[2/7] [================70%         ] nsys_report_db_20000_5_80.sqlite[2/7] [================71%         ] nsys_report_db_20000_5_80.sqlite[2/7] [=================72%        ] nsys_report_db_20000_5_80.sqlite[2/7] [=================73%        ] nsys_report_db_20000_5_80.sqlite[2/7] [=================74%        ] nsys_report_db_20000_5_80.sqlite[2/7] [==================75%       ] nsys_report_db_20000_5_80.sqlite[2/7] [==================76%       ] nsys_report_db_20000_5_80.sqlite[2/7] [==================77%       ] nsys_report_db_20000_5_80.sqlite[2/7] [==================78%       ] nsys_report_db_20000_5_80.sqlite[2/7] [===================79%      ] nsys_report_db_20000_5_80.sqlite[2/7] [===================80%      ] nsys_report_db_20000_5_80.sqlite[2/7] [===================81%      ] nsys_report_db_20000_5_80.sqlite[2/7] [===================82%      ] nsys_report_db_20000_5_80.sqlite[2/7] [====================83%     ] nsys_report_db_20000_5_80.sqlite[2/7] [====================84%     ] nsys_report_db_20000_5_80.sqlite[2/7] [====================85%     ] nsys_report_db_20000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_5_80.sqlite[2/7] [======================90%   ] nsys_report_db_20000_5_80.sqlite[2/7] [======================91%   ] nsys_report_db_20000_5_80.sqlite[2/7] [======================92%   ] nsys_report_db_20000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_5_80.sqlite[2/7] [========================97% ] nsys_report_db_20000_5_80.sqlite[2/7] [========================98% ] nsys_report_db_20000_5_80.sqlite[2/7] [========================99% ] nsys_report_db_20000_5_80.sqlite[2/7] [========================100%] nsys_report_db_20000_5_80.sqlite[2/7] [========================100%] nsys_report_db_20000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        243881092          1  243881092.0  243881092.0  243881092  243881092          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        133663381          1  133663381.0  133663381.0  133663381  133663381          0.0  cudaFree                      
      1.7          2273414          7     324773.4     241354.0       4100     787731     324580.9  cudaMalloc                    
      0.2           297803        814        365.9        320.0        120       1290        196.4  cuGetProcAddress_v2           
      0.0            37901          2      18950.5      18950.5       1890      36011      24127.2  cudaStreamCreateWithFlags     
      0.0            24530         18       1362.8        480.0        400      14020       3178.9  cudaEventCreateWithFlags      
      0.0            11980          1      11980.0      11980.0      11980      11980          0.0  cudaHostAlloc                 
      0.0             4360          3       1453.3       1290.0        780       2290        768.1  cuInit                        
      0.0             3450          3       1150.0        250.0        170       3030       1628.6  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        300        620        226.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 5 (num_steps = 80), identity_test = 0
Generating '/tmp/nsys-report-3c82.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_5_80.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_20000_5_80.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_5_80.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_5_80.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_80.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [1%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [2%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [3%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [4%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [5%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [6%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [7%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [8%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [9%                          ] nsys_report_fo_20000_5_80.sqlite[2/7] [10%                         ] nsys_report_fo_20000_5_80.sqlite[2/7] [11%                         ] nsys_report_fo_20000_5_80.sqlite[2/7] [12%                         ] nsys_report_fo_20000_5_80.sqlite[2/7] [13%                         ] nsys_report_fo_20000_5_80.sqlite[2/7] [14%                         ] nsys_report_fo_20000_5_80.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_5_80.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_5_80.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_5_80.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_5_80.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_5_80.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_5_80.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_5_80.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_5_80.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_5_80.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_5_80.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_5_80.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_5_80.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_5_80.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_5_80.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_5_80.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_5_80.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_5_80.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_5_80.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_5_80.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_5_80.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_5_80.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_5_80.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_5_80.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_5_80.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_5_80.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_5_80.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_5_80.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_5_80.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_5_80.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_5_80.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_5_80.sqlite[2/7] [============54%             ] nsys_report_fo_20000_5_80.sqlite[2/7] [============55%             ] nsys_report_fo_20000_5_80.sqlite[2/7] [============56%             ] nsys_report_fo_20000_5_80.sqlite[2/7] [============57%             ] nsys_report_fo_20000_5_80.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_5_80.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_5_80.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_5_80.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_5_80.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_5_80.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_5_80.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_5_80.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_5_80.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_5_80.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_5_80.sqlite[2/7] [================68%         ] nsys_report_fo_20000_5_80.sqlite[2/7] [================69%         ] nsys_report_fo_20000_5_80.sqlite[2/7] [================70%         ] nsys_report_fo_20000_5_80.sqlite[2/7] [================71%         ] nsys_report_fo_20000_5_80.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_5_80.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_5_80.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_5_80.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_5_80.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_5_80.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_5_80.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_5_80.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_5_80.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_5_80.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_5_80.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_5_80.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_5_80.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_5_80.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_5_80.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_5_80.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_5_80.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_5_80.sqlite[2/7] [========================97% ] nsys_report_fo_20000_5_80.sqlite[2/7] [========================98% ] nsys_report_fo_20000_5_80.sqlite[2/7] [========================99% ] nsys_report_fo_20000_5_80.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_80.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        252465595          1  252465595.0  252465595.0  252465595  252465595          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        137142161          1  137142161.0  137142161.0  137142161  137142161          0.0  cudaFree                      
      1.3          1838506         10     183850.6     225068.5       4170     291074      91649.3  cudaMalloc                    
      0.2           340314        814        418.1        310.0        120      53451       1870.0  cuGetProcAddress_v2           
      0.0            49881          2      24940.5      24940.5       2070      47811      32343.8  cudaStreamCreateWithFlags     
      0.0            27091         18       1505.1        435.0        400      16391       3738.9  cudaEventCreateWithFlags      
      0.0            14010          1      14010.0      14010.0      14010      14010          0.0  cudaHostAlloc                 
      0.0             7020          3       2340.0       2340.0        850       3830       1490.0  cuInit                        
      0.0             4140          3       1380.0        520.0        510       3110       1498.2  cuModuleGetLoadingMode        
      0.0              910          2        455.0        455.0        300        610        219.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 5 (num_steps = 100)
number of batches= 20
Generating '/tmp/nsys-report-f90f.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_5_100.nsys-rep[1/7] [======35%                   ] nsys_report_ia_20000_5_100.nsys-rep[1/7] [================69%         ] nsys_report_ia_20000_5_100.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_5_100.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_100.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [1%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [2%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [3%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [4%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [5%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [6%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [7%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [8%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [9%                          ] nsys_report_ia_20000_5_100.sqlite[2/7] [10%                         ] nsys_report_ia_20000_5_100.sqlite[2/7] [11%                         ] nsys_report_ia_20000_5_100.sqlite[2/7] [12%                         ] nsys_report_ia_20000_5_100.sqlite[2/7] [13%                         ] nsys_report_ia_20000_5_100.sqlite[2/7] [14%                         ] nsys_report_ia_20000_5_100.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_5_100.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_5_100.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_5_100.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_5_100.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_5_100.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_5_100.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_5_100.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_5_100.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_5_100.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_5_100.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_5_100.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_5_100.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_5_100.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_5_100.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_5_100.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_5_100.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_5_100.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_5_100.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_5_100.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_5_100.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_5_100.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_5_100.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_5_100.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_5_100.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_5_100.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_5_100.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_5_100.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_5_100.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_5_100.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_5_100.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_5_100.sqlite[2/7] [============54%             ] nsys_report_ia_20000_5_100.sqlite[2/7] [============55%             ] nsys_report_ia_20000_5_100.sqlite[2/7] [============56%             ] nsys_report_ia_20000_5_100.sqlite[2/7] [============57%             ] nsys_report_ia_20000_5_100.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_5_100.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_5_100.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_5_100.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_5_100.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_5_100.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_5_100.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_5_100.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_5_100.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_5_100.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_5_100.sqlite[2/7] [================68%         ] nsys_report_ia_20000_5_100.sqlite[2/7] [================69%         ] nsys_report_ia_20000_5_100.sqlite[2/7] [================70%         ] nsys_report_ia_20000_5_100.sqlite[2/7] [================71%         ] nsys_report_ia_20000_5_100.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_5_100.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_5_100.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_5_100.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_5_100.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_5_100.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_5_100.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_5_100.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_5_100.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_5_100.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_5_100.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_5_100.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_5_100.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_5_100.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_5_100.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_5_100.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_5_100.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_5_100.sqlite[2/7] [========================97% ] nsys_report_ia_20000_5_100.sqlite[2/7] [========================98% ] nsys_report_ia_20000_5_100.sqlite[2/7] [========================99% ] nsys_report_ia_20000_5_100.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_100.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        288914436          1  288914436.0  288914436.0  288914436  288914436          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        169715589          1  169715589.0  169715589.0  169715589  169715589          0.0  cudaFree                      
      1.4          2341945          7     334563.6     258513.0       4030     802222     333203.0  cudaMalloc                    
      0.2           284865        814        350.0        310.0        110       1250        185.9  cuGetProcAddress_v2           
      0.0            38540          2      19270.0      19270.0       2130      36410      24239.6  cudaStreamCreateWithFlags     
      0.0            20560         18       1142.2        485.0        380      10240       2304.1  cudaEventCreateWithFlags      
      0.0            11970          1      11970.0      11970.0      11970      11970          0.0  cudaHostAlloc                 
      0.0             4281          3       1427.0       1030.0        740       2511        949.9  cuInit                        
      0.0             3100          3       1033.3        370.0        170       2560       1325.9  cuModuleGetLoadingMode        
      0.0             1070          2        535.0        535.0        310        760        318.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 5 (num_steps = 100)
number of batches= 20
Generating '/tmp/nsys-report-7f03.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_5_100.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_5_100.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_5_100.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_5_100.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_100.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [1%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [2%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [3%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [4%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [5%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [6%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [7%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [8%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [9%                          ] nsys_report_db_20000_5_100.sqlite[2/7] [10%                         ] nsys_report_db_20000_5_100.sqlite[2/7] [11%                         ] nsys_report_db_20000_5_100.sqlite[2/7] [12%                         ] nsys_report_db_20000_5_100.sqlite[2/7] [13%                         ] nsys_report_db_20000_5_100.sqlite[2/7] [14%                         ] nsys_report_db_20000_5_100.sqlite[2/7] [=15%                        ] nsys_report_db_20000_5_100.sqlite[2/7] [=16%                        ] nsys_report_db_20000_5_100.sqlite[2/7] [=17%                        ] nsys_report_db_20000_5_100.sqlite[2/7] [==18%                       ] nsys_report_db_20000_5_100.sqlite[2/7] [==19%                       ] nsys_report_db_20000_5_100.sqlite[2/7] [==20%                       ] nsys_report_db_20000_5_100.sqlite[2/7] [==21%                       ] nsys_report_db_20000_5_100.sqlite[2/7] [===22%                      ] nsys_report_db_20000_5_100.sqlite[2/7] [===23%                      ] nsys_report_db_20000_5_100.sqlite[2/7] [===24%                      ] nsys_report_db_20000_5_100.sqlite[2/7] [====25%                     ] nsys_report_db_20000_5_100.sqlite[2/7] [====26%                     ] nsys_report_db_20000_5_100.sqlite[2/7] [====27%                     ] nsys_report_db_20000_5_100.sqlite[2/7] [====28%                     ] nsys_report_db_20000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_5_100.sqlite[2/7] [======33%                   ] nsys_report_db_20000_5_100.sqlite[2/7] [======34%                   ] nsys_report_db_20000_5_100.sqlite[2/7] [======35%                   ] nsys_report_db_20000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_5_100.sqlite[2/7] [========40%                 ] nsys_report_db_20000_5_100.sqlite[2/7] [========41%                 ] nsys_report_db_20000_5_100.sqlite[2/7] [========42%                 ] nsys_report_db_20000_5_100.sqlite[2/7] [=========43%                ] nsys_report_db_20000_5_100.sqlite[2/7] [=========44%                ] nsys_report_db_20000_5_100.sqlite[2/7] [=========45%                ] nsys_report_db_20000_5_100.sqlite[2/7] [=========46%                ] nsys_report_db_20000_5_100.sqlite[2/7] [==========47%               ] nsys_report_db_20000_5_100.sqlite[2/7] [==========48%               ] nsys_report_db_20000_5_100.sqlite[2/7] [==========49%               ] nsys_report_db_20000_5_100.sqlite[2/7] [===========50%              ] nsys_report_db_20000_5_100.sqlite[2/7] [===========51%              ] nsys_report_db_20000_5_100.sqlite[2/7] [===========52%              ] nsys_report_db_20000_5_100.sqlite[2/7] [===========53%              ] nsys_report_db_20000_5_100.sqlite[2/7] [============54%             ] nsys_report_db_20000_5_100.sqlite[2/7] [============55%             ] nsys_report_db_20000_5_100.sqlite[2/7] [============56%             ] nsys_report_db_20000_5_100.sqlite[2/7] [============57%             ] nsys_report_db_20000_5_100.sqlite[2/7] [=============58%            ] nsys_report_db_20000_5_100.sqlite[2/7] [=============59%            ] nsys_report_db_20000_5_100.sqlite[2/7] [=============60%            ] nsys_report_db_20000_5_100.sqlite[2/7] [==============61%           ] nsys_report_db_20000_5_100.sqlite[2/7] [==============62%           ] nsys_report_db_20000_5_100.sqlite[2/7] [==============63%           ] nsys_report_db_20000_5_100.sqlite[2/7] [==============64%           ] nsys_report_db_20000_5_100.sqlite[2/7] [===============65%          ] nsys_report_db_20000_5_100.sqlite[2/7] [===============66%          ] nsys_report_db_20000_5_100.sqlite[2/7] [===============67%          ] nsys_report_db_20000_5_100.sqlite[2/7] [================68%         ] nsys_report_db_20000_5_100.sqlite[2/7] [================69%         ] nsys_report_db_20000_5_100.sqlite[2/7] [================70%         ] nsys_report_db_20000_5_100.sqlite[2/7] [================71%         ] nsys_report_db_20000_5_100.sqlite[2/7] [=================72%        ] nsys_report_db_20000_5_100.sqlite[2/7] [=================73%        ] nsys_report_db_20000_5_100.sqlite[2/7] [=================74%        ] nsys_report_db_20000_5_100.sqlite[2/7] [==================75%       ] nsys_report_db_20000_5_100.sqlite[2/7] [==================76%       ] nsys_report_db_20000_5_100.sqlite[2/7] [==================77%       ] nsys_report_db_20000_5_100.sqlite[2/7] [==================78%       ] nsys_report_db_20000_5_100.sqlite[2/7] [===================79%      ] nsys_report_db_20000_5_100.sqlite[2/7] [===================80%      ] nsys_report_db_20000_5_100.sqlite[2/7] [===================81%      ] nsys_report_db_20000_5_100.sqlite[2/7] [===================82%      ] nsys_report_db_20000_5_100.sqlite[2/7] [====================83%     ] nsys_report_db_20000_5_100.sqlite[2/7] [====================84%     ] nsys_report_db_20000_5_100.sqlite[2/7] [====================85%     ] nsys_report_db_20000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_5_100.sqlite[2/7] [======================90%   ] nsys_report_db_20000_5_100.sqlite[2/7] [======================91%   ] nsys_report_db_20000_5_100.sqlite[2/7] [======================92%   ] nsys_report_db_20000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_5_100.sqlite[2/7] [========================97% ] nsys_report_db_20000_5_100.sqlite[2/7] [========================98% ] nsys_report_db_20000_5_100.sqlite[2/7] [========================99% ] nsys_report_db_20000_5_100.sqlite[2/7] [========================100%] nsys_report_db_20000_5_100.sqlite[2/7] [========================100%] nsys_report_db_20000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        247291850          1  247291850.0  247291850.0  247291850  247291850          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        131145139          1  131145139.0  131145139.0  131145139  131145139          0.0  cudaFree                      
      1.7          2222963          7     317566.1     252244.0       3741     770911     317177.8  cudaMalloc                    
      0.2           284314        814        349.3        310.0        120       1310        188.2  cuGetProcAddress_v2           
      0.0            31600          2      15800.0      15800.0       1920      29680      19629.3  cudaStreamCreateWithFlags     
      0.0            27620         18       1534.4        510.0        390      16490       3759.5  cudaEventCreateWithFlags      
      0.0            11860          1      11860.0      11860.0      11860      11860          0.0  cudaHostAlloc                 
      0.0             4110          3       1370.0       1700.0        620       1790        651.1  cuInit                        
      0.0             3370          3       1123.3        250.0        150       2970       1600.0  cuModuleGetLoadingMode        
      0.0             1080          2        540.0        540.0        300        780        339.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 5 (num_steps = 100), identity_test = 0
Generating '/tmp/nsys-report-27ad.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_5_100.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_5_100.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_5_100.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_5_100.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_100.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [1%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [2%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [3%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [4%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [5%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [6%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [7%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [8%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [9%                          ] nsys_report_fo_20000_5_100.sqlite[2/7] [10%                         ] nsys_report_fo_20000_5_100.sqlite[2/7] [11%                         ] nsys_report_fo_20000_5_100.sqlite[2/7] [12%                         ] nsys_report_fo_20000_5_100.sqlite[2/7] [13%                         ] nsys_report_fo_20000_5_100.sqlite[2/7] [14%                         ] nsys_report_fo_20000_5_100.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_5_100.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_5_100.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_5_100.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_5_100.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_5_100.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_5_100.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_5_100.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_5_100.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_5_100.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_5_100.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_5_100.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_5_100.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_5_100.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_5_100.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_5_100.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_5_100.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_5_100.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_5_100.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_5_100.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_5_100.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_5_100.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_5_100.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_5_100.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_5_100.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_5_100.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_5_100.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_5_100.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_5_100.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_5_100.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_5_100.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_5_100.sqlite[2/7] [============54%             ] nsys_report_fo_20000_5_100.sqlite[2/7] [============55%             ] nsys_report_fo_20000_5_100.sqlite[2/7] [============56%             ] nsys_report_fo_20000_5_100.sqlite[2/7] [============57%             ] nsys_report_fo_20000_5_100.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_5_100.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_5_100.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_5_100.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_5_100.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_5_100.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_5_100.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_5_100.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_5_100.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_5_100.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_5_100.sqlite[2/7] [================68%         ] nsys_report_fo_20000_5_100.sqlite[2/7] [================69%         ] nsys_report_fo_20000_5_100.sqlite[2/7] [================70%         ] nsys_report_fo_20000_5_100.sqlite[2/7] [================71%         ] nsys_report_fo_20000_5_100.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_5_100.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_5_100.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_5_100.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_5_100.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_5_100.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_5_100.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_5_100.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_5_100.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_5_100.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_5_100.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_5_100.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_5_100.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_5_100.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_5_100.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_5_100.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_5_100.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_5_100.sqlite[2/7] [========================97% ] nsys_report_fo_20000_5_100.sqlite[2/7] [========================98% ] nsys_report_fo_20000_5_100.sqlite[2/7] [========================99% ] nsys_report_fo_20000_5_100.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_100.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        248779167          1  248779167.0  248779167.0  248779167  248779167          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.3        131060955          1  131060955.0  131060955.0  131060955  131060955          0.0  cudaFree                      
      1.4          1836336         10     183633.6     222403.5       3740     287544      90119.3  cudaMalloc                    
      0.3           335875        814        412.6        390.0        130       1590        240.3  cuGetProcAddress_v2           
      0.0            41540          2      20770.0      20770.0       1730      39810      26926.6  cudaStreamCreateWithFlags     
      0.0            19161         18       1064.5        505.0        410       8670       1927.7  cudaEventCreateWithFlags      
      0.0            12950          1      12950.0      12950.0      12950      12950          0.0  cudaHostAlloc                 
      0.0             6390          3       2130.0       2350.0        660       3380       1373.3  cuInit                        
      0.0             4420          3       1473.3        390.0        280       3750       1972.4  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        310        570        183.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 5 (num_steps = 150)
number of batches= 30
Generating '/tmp/nsys-report-0dd2.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_5_150.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_5_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_5_150.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_150.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [1%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [2%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [3%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [4%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [5%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [6%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [7%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [8%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [9%                          ] nsys_report_ia_20000_5_150.sqlite[2/7] [10%                         ] nsys_report_ia_20000_5_150.sqlite[2/7] [11%                         ] nsys_report_ia_20000_5_150.sqlite[2/7] [12%                         ] nsys_report_ia_20000_5_150.sqlite[2/7] [13%                         ] nsys_report_ia_20000_5_150.sqlite[2/7] [14%                         ] nsys_report_ia_20000_5_150.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_5_150.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_5_150.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_5_150.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_5_150.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_5_150.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_5_150.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_5_150.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_5_150.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_5_150.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_5_150.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_5_150.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_5_150.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_5_150.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_5_150.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_5_150.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_5_150.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_5_150.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_5_150.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_5_150.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_5_150.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_5_150.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_5_150.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_5_150.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_5_150.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_5_150.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_5_150.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_5_150.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_5_150.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_5_150.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_5_150.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_5_150.sqlite[2/7] [============54%             ] nsys_report_ia_20000_5_150.sqlite[2/7] [============55%             ] nsys_report_ia_20000_5_150.sqlite[2/7] [============56%             ] nsys_report_ia_20000_5_150.sqlite[2/7] [============57%             ] nsys_report_ia_20000_5_150.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_5_150.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_5_150.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_5_150.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_5_150.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_5_150.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_5_150.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_5_150.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_5_150.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_5_150.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_5_150.sqlite[2/7] [================68%         ] nsys_report_ia_20000_5_150.sqlite[2/7] [================69%         ] nsys_report_ia_20000_5_150.sqlite[2/7] [================70%         ] nsys_report_ia_20000_5_150.sqlite[2/7] [================71%         ] nsys_report_ia_20000_5_150.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_5_150.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_5_150.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_5_150.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_5_150.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_5_150.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_5_150.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_5_150.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_5_150.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_5_150.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_5_150.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_5_150.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_5_150.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_5_150.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_5_150.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_5_150.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_5_150.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_5_150.sqlite[2/7] [========================97% ] nsys_report_ia_20000_5_150.sqlite[2/7] [========================98% ] nsys_report_ia_20000_5_150.sqlite[2/7] [========================99% ] nsys_report_ia_20000_5_150.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_150.sqlite[2/7] [========================100%] nsys_report_ia_20000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        273469122          1  273469122.0  273469122.0  273469122  273469122          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.3        157671219          1  157671219.0  157671219.0  157671219  157671219          0.0  cudaFree                      
      1.4          2241993          7     320284.7     239084.0       4080     768091     314093.7  cudaMalloc                    
      0.2           367586        814        451.6        400.0        130       8611        381.3  cuGetProcAddress_v2           
      0.0            43281          2      21640.5      21640.5       2070      41211      27676.9  cudaStreamCreateWithFlags     
      0.0            23130         18       1285.0        490.0        390      12310       2786.7  cudaEventCreateWithFlags      
      0.0            13910          1      13910.0      13910.0      13910      13910          0.0  cudaHostAlloc                 
      0.0             7000          3       2333.3       2140.0        930       3930       1509.3  cuInit                        
      0.0             4770          3       1590.0        390.0        270       4110       2183.2  cuModuleGetLoadingMode        
      0.0             1050          2        525.0        525.0        430        620        134.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_5_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 5 (num_steps = 150)
number of batches= 30
Generating '/tmp/nsys-report-eae3.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_5_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_5_150.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_5_150.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_150.nsys-rep[1/7] [========================100%] nsys_report_db_20000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [1%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [2%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [3%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [4%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [5%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [6%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [7%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [8%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [9%                          ] nsys_report_db_20000_5_150.sqlite[2/7] [10%                         ] nsys_report_db_20000_5_150.sqlite[2/7] [11%                         ] nsys_report_db_20000_5_150.sqlite[2/7] [12%                         ] nsys_report_db_20000_5_150.sqlite[2/7] [13%                         ] nsys_report_db_20000_5_150.sqlite[2/7] [14%                         ] nsys_report_db_20000_5_150.sqlite[2/7] [=15%                        ] nsys_report_db_20000_5_150.sqlite[2/7] [=16%                        ] nsys_report_db_20000_5_150.sqlite[2/7] [=17%                        ] nsys_report_db_20000_5_150.sqlite[2/7] [==18%                       ] nsys_report_db_20000_5_150.sqlite[2/7] [==19%                       ] nsys_report_db_20000_5_150.sqlite[2/7] [==20%                       ] nsys_report_db_20000_5_150.sqlite[2/7] [==21%                       ] nsys_report_db_20000_5_150.sqlite[2/7] [===22%                      ] nsys_report_db_20000_5_150.sqlite[2/7] [===23%                      ] nsys_report_db_20000_5_150.sqlite[2/7] [===24%                      ] nsys_report_db_20000_5_150.sqlite[2/7] [====25%                     ] nsys_report_db_20000_5_150.sqlite[2/7] [====26%                     ] nsys_report_db_20000_5_150.sqlite[2/7] [====27%                     ] nsys_report_db_20000_5_150.sqlite[2/7] [====28%                     ] nsys_report_db_20000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_5_150.sqlite[2/7] [======33%                   ] nsys_report_db_20000_5_150.sqlite[2/7] [======34%                   ] nsys_report_db_20000_5_150.sqlite[2/7] [======35%                   ] nsys_report_db_20000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_5_150.sqlite[2/7] [========40%                 ] nsys_report_db_20000_5_150.sqlite[2/7] [========41%                 ] nsys_report_db_20000_5_150.sqlite[2/7] [========42%                 ] nsys_report_db_20000_5_150.sqlite[2/7] [=========43%                ] nsys_report_db_20000_5_150.sqlite[2/7] [=========44%                ] nsys_report_db_20000_5_150.sqlite[2/7] [=========45%                ] nsys_report_db_20000_5_150.sqlite[2/7] [=========46%                ] nsys_report_db_20000_5_150.sqlite[2/7] [==========47%               ] nsys_report_db_20000_5_150.sqlite[2/7] [==========48%               ] nsys_report_db_20000_5_150.sqlite[2/7] [==========49%               ] nsys_report_db_20000_5_150.sqlite[2/7] [===========50%              ] nsys_report_db_20000_5_150.sqlite[2/7] [===========51%              ] nsys_report_db_20000_5_150.sqlite[2/7] [===========52%              ] nsys_report_db_20000_5_150.sqlite[2/7] [===========53%              ] nsys_report_db_20000_5_150.sqlite[2/7] [============54%             ] nsys_report_db_20000_5_150.sqlite[2/7] [============55%             ] nsys_report_db_20000_5_150.sqlite[2/7] [============56%             ] nsys_report_db_20000_5_150.sqlite[2/7] [============57%             ] nsys_report_db_20000_5_150.sqlite[2/7] [=============58%            ] nsys_report_db_20000_5_150.sqlite[2/7] [=============59%            ] nsys_report_db_20000_5_150.sqlite[2/7] [=============60%            ] nsys_report_db_20000_5_150.sqlite[2/7] [==============61%           ] nsys_report_db_20000_5_150.sqlite[2/7] [==============62%           ] nsys_report_db_20000_5_150.sqlite[2/7] [==============63%           ] nsys_report_db_20000_5_150.sqlite[2/7] [==============64%           ] nsys_report_db_20000_5_150.sqlite[2/7] [===============65%          ] nsys_report_db_20000_5_150.sqlite[2/7] [===============66%          ] nsys_report_db_20000_5_150.sqlite[2/7] [===============67%          ] nsys_report_db_20000_5_150.sqlite[2/7] [================68%         ] nsys_report_db_20000_5_150.sqlite[2/7] [================69%         ] nsys_report_db_20000_5_150.sqlite[2/7] [================70%         ] nsys_report_db_20000_5_150.sqlite[2/7] [================71%         ] nsys_report_db_20000_5_150.sqlite[2/7] [=================72%        ] nsys_report_db_20000_5_150.sqlite[2/7] [=================73%        ] nsys_report_db_20000_5_150.sqlite[2/7] [=================74%        ] nsys_report_db_20000_5_150.sqlite[2/7] [==================75%       ] nsys_report_db_20000_5_150.sqlite[2/7] [==================76%       ] nsys_report_db_20000_5_150.sqlite[2/7] [==================77%       ] nsys_report_db_20000_5_150.sqlite[2/7] [==================78%       ] nsys_report_db_20000_5_150.sqlite[2/7] [===================79%      ] nsys_report_db_20000_5_150.sqlite[2/7] [===================80%      ] nsys_report_db_20000_5_150.sqlite[2/7] [===================81%      ] nsys_report_db_20000_5_150.sqlite[2/7] [===================82%      ] nsys_report_db_20000_5_150.sqlite[2/7] [====================83%     ] nsys_report_db_20000_5_150.sqlite[2/7] [====================84%     ] nsys_report_db_20000_5_150.sqlite[2/7] [====================85%     ] nsys_report_db_20000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_5_150.sqlite[2/7] [======================90%   ] nsys_report_db_20000_5_150.sqlite[2/7] [======================91%   ] nsys_report_db_20000_5_150.sqlite[2/7] [======================92%   ] nsys_report_db_20000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_5_150.sqlite[2/7] [========================97% ] nsys_report_db_20000_5_150.sqlite[2/7] [========================98% ] nsys_report_db_20000_5_150.sqlite[2/7] [========================99% ] nsys_report_db_20000_5_150.sqlite[2/7] [========================100%] nsys_report_db_20000_5_150.sqlite[2/7] [========================100%] nsys_report_db_20000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        250424332          1  250424332.0  250424332.0  250424332  250424332          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        133216251          1  133216251.0  133216251.0  133216251  133216251          0.0  cudaFree                      
      1.6          2229162          7     318451.7     243524.0       3890     763021     317521.1  cudaMalloc                    
      0.3           349133        814        428.9        400.0        120       1620        244.5  cuGetProcAddress_v2           
      0.0            54901          2      27450.5      27450.5       2020      52881      35964.2  cudaStreamCreateWithFlags     
      0.0            23711         18       1317.3        495.0        390      13421       3041.7  cudaEventCreateWithFlags      
      0.0            13500          1      13500.0      13500.0      13500      13500          0.0  cudaHostAlloc                 
      0.0             6690          3       2230.0       2390.0        620       3680       1536.3  cuInit                        
      0.0             5250          3       1750.0        510.0        290       4450       2340.9  cuModuleGetLoadingMode        
      0.0              910          2        455.0        455.0        320        590        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_5_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 5 (num_steps = 150), identity_test = 0
Generating '/tmp/nsys-report-d291.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_5_150.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_5_150.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_5_150.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_150.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [1%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [2%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [3%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [4%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [5%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [6%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [7%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [8%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [9%                          ] nsys_report_fo_20000_5_150.sqlite[2/7] [10%                         ] nsys_report_fo_20000_5_150.sqlite[2/7] [11%                         ] nsys_report_fo_20000_5_150.sqlite[2/7] [12%                         ] nsys_report_fo_20000_5_150.sqlite[2/7] [13%                         ] nsys_report_fo_20000_5_150.sqlite[2/7] [14%                         ] nsys_report_fo_20000_5_150.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_5_150.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_5_150.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_5_150.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_5_150.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_5_150.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_5_150.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_5_150.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_5_150.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_5_150.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_5_150.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_5_150.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_5_150.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_5_150.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_5_150.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_5_150.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_5_150.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_5_150.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_5_150.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_5_150.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_5_150.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_5_150.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_5_150.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_5_150.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_5_150.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_5_150.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_5_150.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_5_150.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_5_150.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_5_150.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_5_150.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_5_150.sqlite[2/7] [============54%             ] nsys_report_fo_20000_5_150.sqlite[2/7] [============55%             ] nsys_report_fo_20000_5_150.sqlite[2/7] [============56%             ] nsys_report_fo_20000_5_150.sqlite[2/7] [============57%             ] nsys_report_fo_20000_5_150.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_5_150.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_5_150.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_5_150.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_5_150.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_5_150.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_5_150.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_5_150.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_5_150.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_5_150.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_5_150.sqlite[2/7] [================68%         ] nsys_report_fo_20000_5_150.sqlite[2/7] [================69%         ] nsys_report_fo_20000_5_150.sqlite[2/7] [================70%         ] nsys_report_fo_20000_5_150.sqlite[2/7] [================71%         ] nsys_report_fo_20000_5_150.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_5_150.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_5_150.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_5_150.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_5_150.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_5_150.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_5_150.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_5_150.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_5_150.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_5_150.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_5_150.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_5_150.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_5_150.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_5_150.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_5_150.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_5_150.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_5_150.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_5_150.sqlite[2/7] [========================97% ] nsys_report_fo_20000_5_150.sqlite[2/7] [========================98% ] nsys_report_fo_20000_5_150.sqlite[2/7] [========================99% ] nsys_report_fo_20000_5_150.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_150.sqlite[2/7] [========================100%] nsys_report_fo_20000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        252400808          1  252400808.0  252400808.0  252400808  252400808          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.3        135807527          1  135807527.0  135807527.0  135807527  135807527          0.0  cudaFree                      
      1.3          1858097         10     185809.7     226458.0       3760     283535      89914.2  cudaMalloc                    
      0.3           349416        814        429.3        390.0        120       6490        319.7  cuGetProcAddress_v2           
      0.0            48700          2      24350.0      24350.0       1760      46940      31947.1  cudaStreamCreateWithFlags     
      0.0            20381         18       1132.3        485.0        380       9871       2221.2  cudaEventCreateWithFlags      
      0.0            13050          1      13050.0      13050.0      13050      13050          0.0  cudaHostAlloc                 
      0.0             6890          3       2296.7       2810.0        650       3430       1459.4  cuInit                        
      0.0             5630          3       1876.7        380.0        310       4940       2653.2  cuModuleGetLoadingMode        
      0.0              840          2        420.0        420.0        310        530        155.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_5_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 10 (num_steps = 20)
number of batches= 2
Generating '/tmp/nsys-report-dd69.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_10_20.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_10_20.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_10_20.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_10_20.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_20.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [1%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [2%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [3%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [4%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [5%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [6%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [7%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [8%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [9%                          ] nsys_report_ia_20000_10_20.sqlite[2/7] [10%                         ] nsys_report_ia_20000_10_20.sqlite[2/7] [11%                         ] nsys_report_ia_20000_10_20.sqlite[2/7] [12%                         ] nsys_report_ia_20000_10_20.sqlite[2/7] [13%                         ] nsys_report_ia_20000_10_20.sqlite[2/7] [14%                         ] nsys_report_ia_20000_10_20.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_10_20.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_10_20.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_10_20.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_10_20.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_10_20.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_10_20.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_10_20.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_10_20.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_10_20.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_10_20.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_10_20.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_10_20.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_10_20.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_10_20.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_10_20.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_10_20.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_10_20.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_10_20.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_10_20.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_10_20.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_10_20.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_10_20.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_10_20.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_10_20.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_10_20.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_10_20.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_10_20.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_10_20.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_10_20.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_10_20.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_10_20.sqlite[2/7] [============54%             ] nsys_report_ia_20000_10_20.sqlite[2/7] [============55%             ] nsys_report_ia_20000_10_20.sqlite[2/7] [============56%             ] nsys_report_ia_20000_10_20.sqlite[2/7] [============57%             ] nsys_report_ia_20000_10_20.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_10_20.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_10_20.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_10_20.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_10_20.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_10_20.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_10_20.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_10_20.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_10_20.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_10_20.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_10_20.sqlite[2/7] [================68%         ] nsys_report_ia_20000_10_20.sqlite[2/7] [================69%         ] nsys_report_ia_20000_10_20.sqlite[2/7] [================70%         ] nsys_report_ia_20000_10_20.sqlite[2/7] [================71%         ] nsys_report_ia_20000_10_20.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_10_20.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_10_20.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_10_20.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_10_20.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_10_20.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_10_20.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_10_20.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_10_20.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_10_20.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_10_20.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_10_20.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_10_20.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_10_20.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_10_20.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_10_20.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_10_20.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_10_20.sqlite[2/7] [========================97% ] nsys_report_ia_20000_10_20.sqlite[2/7] [========================98% ] nsys_report_ia_20000_10_20.sqlite[2/7] [========================99% ] nsys_report_ia_20000_10_20.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_20.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        276876025          1  276876025.0  276876025.0  276876025  276876025          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.3        156792716          1  156792716.0  156792716.0  156792716  156792716          0.0  cudaFree                      
      1.5          2345685          7     335097.9     203893.0       3690    1439381     497103.1  cudaMalloc                    
      0.2           269724        814        331.4        290.0        110       1300        180.5  cuGetProcAddress_v2           
      0.0            35700          2      17850.0      17850.0       3180      32520      20746.5  cudaStreamCreateWithFlags     
      0.0            20020         18       1112.2        425.0        390       9840       2218.9  cudaEventCreateWithFlags      
      0.0             3850          3       1283.3       1350.0        670       1830        582.9  cuInit                        
      0.0             3400          3       1133.3        290.0        190       2920       1548.1  cuModuleGetLoadingMode        
      0.0              900          2        450.0        450.0        310        590        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 10 (num_steps = 20)
number of batches= 2
Generating '/tmp/nsys-report-2861.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_10_20.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_10_20.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_10_20.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_10_20.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_20.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [1%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [2%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [3%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [4%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [5%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [6%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [7%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [8%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [9%                          ] nsys_report_db_20000_10_20.sqlite[2/7] [10%                         ] nsys_report_db_20000_10_20.sqlite[2/7] [11%                         ] nsys_report_db_20000_10_20.sqlite[2/7] [12%                         ] nsys_report_db_20000_10_20.sqlite[2/7] [13%                         ] nsys_report_db_20000_10_20.sqlite[2/7] [14%                         ] nsys_report_db_20000_10_20.sqlite[2/7] [=15%                        ] nsys_report_db_20000_10_20.sqlite[2/7] [=16%                        ] nsys_report_db_20000_10_20.sqlite[2/7] [=17%                        ] nsys_report_db_20000_10_20.sqlite[2/7] [==18%                       ] nsys_report_db_20000_10_20.sqlite[2/7] [==19%                       ] nsys_report_db_20000_10_20.sqlite[2/7] [==20%                       ] nsys_report_db_20000_10_20.sqlite[2/7] [==21%                       ] nsys_report_db_20000_10_20.sqlite[2/7] [===22%                      ] nsys_report_db_20000_10_20.sqlite[2/7] [===23%                      ] nsys_report_db_20000_10_20.sqlite[2/7] [===24%                      ] nsys_report_db_20000_10_20.sqlite[2/7] [====25%                     ] nsys_report_db_20000_10_20.sqlite[2/7] [====26%                     ] nsys_report_db_20000_10_20.sqlite[2/7] [====27%                     ] nsys_report_db_20000_10_20.sqlite[2/7] [====28%                     ] nsys_report_db_20000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_10_20.sqlite[2/7] [======33%                   ] nsys_report_db_20000_10_20.sqlite[2/7] [======34%                   ] nsys_report_db_20000_10_20.sqlite[2/7] [======35%                   ] nsys_report_db_20000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_10_20.sqlite[2/7] [========40%                 ] nsys_report_db_20000_10_20.sqlite[2/7] [========41%                 ] nsys_report_db_20000_10_20.sqlite[2/7] [========42%                 ] nsys_report_db_20000_10_20.sqlite[2/7] [=========43%                ] nsys_report_db_20000_10_20.sqlite[2/7] [=========44%                ] nsys_report_db_20000_10_20.sqlite[2/7] [=========45%                ] nsys_report_db_20000_10_20.sqlite[2/7] [=========46%                ] nsys_report_db_20000_10_20.sqlite[2/7] [==========47%               ] nsys_report_db_20000_10_20.sqlite[2/7] [==========48%               ] nsys_report_db_20000_10_20.sqlite[2/7] [==========49%               ] nsys_report_db_20000_10_20.sqlite[2/7] [===========50%              ] nsys_report_db_20000_10_20.sqlite[2/7] [===========51%              ] nsys_report_db_20000_10_20.sqlite[2/7] [===========52%              ] nsys_report_db_20000_10_20.sqlite[2/7] [===========53%              ] nsys_report_db_20000_10_20.sqlite[2/7] [============54%             ] nsys_report_db_20000_10_20.sqlite[2/7] [============55%             ] nsys_report_db_20000_10_20.sqlite[2/7] [============56%             ] nsys_report_db_20000_10_20.sqlite[2/7] [============57%             ] nsys_report_db_20000_10_20.sqlite[2/7] [=============58%            ] nsys_report_db_20000_10_20.sqlite[2/7] [=============59%            ] nsys_report_db_20000_10_20.sqlite[2/7] [=============60%            ] nsys_report_db_20000_10_20.sqlite[2/7] [==============61%           ] nsys_report_db_20000_10_20.sqlite[2/7] [==============62%           ] nsys_report_db_20000_10_20.sqlite[2/7] [==============63%           ] nsys_report_db_20000_10_20.sqlite[2/7] [==============64%           ] nsys_report_db_20000_10_20.sqlite[2/7] [===============65%          ] nsys_report_db_20000_10_20.sqlite[2/7] [===============66%          ] nsys_report_db_20000_10_20.sqlite[2/7] [===============67%          ] nsys_report_db_20000_10_20.sqlite[2/7] [================68%         ] nsys_report_db_20000_10_20.sqlite[2/7] [================69%         ] nsys_report_db_20000_10_20.sqlite[2/7] [================70%         ] nsys_report_db_20000_10_20.sqlite[2/7] [================71%         ] nsys_report_db_20000_10_20.sqlite[2/7] [=================72%        ] nsys_report_db_20000_10_20.sqlite[2/7] [=================73%        ] nsys_report_db_20000_10_20.sqlite[2/7] [=================74%        ] nsys_report_db_20000_10_20.sqlite[2/7] [==================75%       ] nsys_report_db_20000_10_20.sqlite[2/7] [==================76%       ] nsys_report_db_20000_10_20.sqlite[2/7] [==================77%       ] nsys_report_db_20000_10_20.sqlite[2/7] [==================78%       ] nsys_report_db_20000_10_20.sqlite[2/7] [===================79%      ] nsys_report_db_20000_10_20.sqlite[2/7] [===================80%      ] nsys_report_db_20000_10_20.sqlite[2/7] [===================81%      ] nsys_report_db_20000_10_20.sqlite[2/7] [===================82%      ] nsys_report_db_20000_10_20.sqlite[2/7] [====================83%     ] nsys_report_db_20000_10_20.sqlite[2/7] [====================84%     ] nsys_report_db_20000_10_20.sqlite[2/7] [====================85%     ] nsys_report_db_20000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_10_20.sqlite[2/7] [======================90%   ] nsys_report_db_20000_10_20.sqlite[2/7] [======================91%   ] nsys_report_db_20000_10_20.sqlite[2/7] [======================92%   ] nsys_report_db_20000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_10_20.sqlite[2/7] [========================97% ] nsys_report_db_20000_10_20.sqlite[2/7] [========================98% ] nsys_report_db_20000_10_20.sqlite[2/7] [========================99% ] nsys_report_db_20000_10_20.sqlite[2/7] [========================100%] nsys_report_db_20000_10_20.sqlite[2/7] [========================100%] nsys_report_db_20000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        240606211          1  240606211.0  240606211.0  240606211  240606211          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        129466732          1  129466732.0  129466732.0  129466732  129466732          0.0  cudaFree                      
      1.7          2277912          7     325416.0     205433.0       4050    1368390     470626.0  cudaMalloc                    
      0.3           332076        814        408.0        380.0        130       1670        235.6  cuGetProcAddress_v2           
      0.0            43781          2      21890.5      21890.5       1850      41931      28341.5  cudaStreamCreateWithFlags     
      0.0            24051         18       1336.2        515.0        400      13480       3051.2  cudaEventCreateWithFlags      
      0.0             8920          3       2973.3       3740.0        630       4550       2069.4  cuInit                        
      0.0             4670          3       1556.7        390.0        290       3990       2107.9  cuModuleGetLoadingMode        
      0.0              860          2        430.0        430.0        320        540        155.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 10 (num_steps = 20), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  3.16 GB
Used GPU Memory:  36.33 GB
------------------------

Process RSS:  69.31 GB
h_X_final[0] = 0.000050
h_X_final[1] = 0.000050
h_X_final[2] = 0.000050
h_X_final[3] = 0.000050
h_X_final[4] = 0.000050
t_alloc_gpu = 2.905130 ms
t_alloc_cpu = 16265.508890 ms
t_init      = 4986.024141 ms
t_h2d       = 3104.093985 ms
t_d2h       = 614.616871 ms
t_gemm      = 18945.648499 ms
t_end_2_end = 48103.106022 ms
Generating '/tmp/nsys-report-2f42.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=16%                        ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [======33%                   ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [======34%                   ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [======35%                   ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [========40%                 ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [========41%                 ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [========42%                 ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=========43%                ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=========44%                ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=========45%                ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=========46%                ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [==========47%               ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [==========48%               ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [==========49%               ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [===========50%              ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [===========51%              ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [===========52%              ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [===========53%              ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [============54%             ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [============55%             ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [============56%             ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [============57%             ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=============58%            ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=============59%            ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [=============60%            ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [==============61%           ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [==============62%           ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [==============63%           ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [===============65%          ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [===============66%          ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [===============67%          ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [================68%         ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [================69%         ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [================70%         ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [========================97% ] nsys_report_fo_20000_10_20.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_20.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [1%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [2%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [3%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [4%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [5%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [6%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [7%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [8%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [9%                          ] nsys_report_fo_20000_10_20.sqlite[2/7] [10%                         ] nsys_report_fo_20000_10_20.sqlite[2/7] [11%                         ] nsys_report_fo_20000_10_20.sqlite[2/7] [12%                         ] nsys_report_fo_20000_10_20.sqlite[2/7] [13%                         ] nsys_report_fo_20000_10_20.sqlite[2/7] [14%                         ] nsys_report_fo_20000_10_20.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_10_20.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_10_20.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_10_20.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_10_20.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_10_20.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_10_20.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_10_20.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_10_20.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_10_20.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_10_20.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_10_20.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_10_20.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_10_20.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_10_20.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_10_20.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_10_20.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_10_20.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_10_20.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_10_20.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_10_20.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_10_20.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_10_20.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_10_20.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_10_20.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_10_20.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_10_20.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_10_20.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_10_20.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_10_20.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_10_20.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_10_20.sqlite[2/7] [============54%             ] nsys_report_fo_20000_10_20.sqlite[2/7] [============55%             ] nsys_report_fo_20000_10_20.sqlite[2/7] [============56%             ] nsys_report_fo_20000_10_20.sqlite[2/7] [============57%             ] nsys_report_fo_20000_10_20.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_10_20.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_10_20.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_10_20.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_10_20.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_10_20.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_10_20.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_10_20.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_10_20.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_10_20.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_10_20.sqlite[2/7] [================68%         ] nsys_report_fo_20000_10_20.sqlite[2/7] [================69%         ] nsys_report_fo_20000_10_20.sqlite[2/7] [================70%         ] nsys_report_fo_20000_10_20.sqlite[2/7] [================71%         ] nsys_report_fo_20000_10_20.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_10_20.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_10_20.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_10_20.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_10_20.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_10_20.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_10_20.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_10_20.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_10_20.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_10_20.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_10_20.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_10_20.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_10_20.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_10_20.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_10_20.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_10_20.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_10_20.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_10_20.sqlite[2/7] [========================97% ] nsys_report_fo_20000_10_20.sqlite[2/7] [========================98% ] nsys_report_fo_20000_10_20.sqlite[2/7] [========================99% ] nsys_report_fo_20000_10_20.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_20.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        248435181          1  248435181.0  248435181.0  248435181  248435181          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     40.3      16831028852         60    280517147.5        14155.0         3580    890961573  415449695.7  cudaMemcpyAsync                   
     38.9      16265503350          1  16265503350.0  16265503350.0  16265503350  16265503350          0.0  cudaHostAlloc                     
     15.3       6385908501          1   6385908501.0   6385908501.0   6385908501   6385908501          0.0  cudaFreeHost                      
      3.6       1510060829         20     75503041.5         2710.0          710   1510016958  337649540.2  cuKernelGetFunction               
      1.2        514305253          2    257152626.5    257152626.5    210482431    303822822   66001623.4  cudaMemcpy                        
      0.4        163704475         16     10231529.7      1648318.5        56951    133123958   32850826.5  cudaFree                          
      0.3        121116127          1    121116127.0    121116127.0    121116127    121116127          0.0  cudaDeviceReset                   
      0.0          4673397         22       212427.1         2865.0         2350      4611346     982512.4  cudaStreamSynchronize             
      0.0          3907747         15       260516.5       271194.0       117532       421296     100708.7  cuLibraryLoadData                 
      0.0          3072825         15       204855.0       236604.0         3630       281784      79411.0  cudaMalloc                        
      0.0           840421         60        14007.0         7740.0         4280       256424      32495.5  cudaLaunchKernel                  
      0.0           378454        140         2703.2         2520.0          520        24201       2427.3  cudaEventRecord                   
      0.0           292896        814          359.8          320.0          120         1590        192.0  cuGetProcAddress_v2               
      0.0           193613         20         9680.7         9255.0         5340        32571       5624.9  cuLaunchKernel                    
      0.0            79070        100          790.7          410.0          280         3760        917.1  cudaStreamGetCaptureInfo_v2_v11030
      0.0            75401          1        75401.0        75401.0        75401        75401          0.0  cudaMemGetInfo                    
      0.0            59711         80          746.4          590.0          480         4200        553.6  cudaEventCreate                   
      0.0            54220         30         1807.3         1670.0          660         5040       1097.3  cudaStreamWaitEvent               
      0.0            51721         38         1361.1          520.0          390        13490       2726.4  cudaEventCreateWithFlags          
      0.0            43320          2        21660.0        21660.0         1890        41430      27959.0  cudaStreamCreateWithFlags         
      0.0            40060          4        10015.0         3630.0         1390        31410      14311.0  cudaDeviceSynchronize             
      0.0            30100         38          792.1          540.0          320         3950        838.9  cudaEventDestroy                  
      0.0            19800          2         9900.0         9900.0         4830        14970       7170.1  cudaStreamDestroy                 
      0.0            11260         16          703.8          570.0          520         1650        302.1  cuLibraryGetKernel                
      0.0             5150          1         5150.0         5150.0         5150         5150          0.0  cudaEventQuery                    
      0.0             4510          3         1503.3         1920.0          660         1930        730.4  cuInit                            
      0.0             3270          3         1090.0          280.0          280         2710       1403.0  cuModuleGetLoadingMode            
      0.0             1240          1         1240.0         1240.0         1240         1240          0.0  cuCtxSynchronize                  
      0.0              900          2          450.0          450.0          320          580        183.8  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.2      17557443264         20  877872163.2  879751542.5  864831047  883867257    4924300.4  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.5         92702823         20    4635141.2    4633318.0    4605016    4669207      28679.7  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.3         50595768         40    1264894.2    1258222.0      14016    2528510    1266500.8  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  -----------  --------  ---------  -----------  ----------------------------
     91.1       3103746575     41  75701136.0  124202544.0      1600  210332712   77176363.2  [CUDA memcpy Host-to-Device]
      8.9        303682241     21  14461059.1       1984.0      1952  303640929   66259432.2  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
  67200.208     41  1639.029  3200.000     0.010  3200.000     1619.389  [CUDA memcpy Host-to-Device]
   3200.000     21   152.381     0.000     0.000  3200.000      698.297  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 10 (num_steps = 40)
number of batches= 4
Generating '/tmp/nsys-report-87bd.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_10_40.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_10_40.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_10_40.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_10_40.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_40.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [1%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [2%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [3%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [4%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [5%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [6%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [7%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [8%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [9%                          ] nsys_report_ia_20000_10_40.sqlite[2/7] [10%                         ] nsys_report_ia_20000_10_40.sqlite[2/7] [11%                         ] nsys_report_ia_20000_10_40.sqlite[2/7] [12%                         ] nsys_report_ia_20000_10_40.sqlite[2/7] [13%                         ] nsys_report_ia_20000_10_40.sqlite[2/7] [14%                         ] nsys_report_ia_20000_10_40.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_10_40.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_10_40.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_10_40.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_10_40.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_10_40.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_10_40.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_10_40.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_10_40.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_10_40.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_10_40.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_10_40.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_10_40.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_10_40.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_10_40.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_10_40.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_10_40.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_10_40.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_10_40.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_10_40.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_10_40.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_10_40.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_10_40.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_10_40.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_10_40.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_10_40.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_10_40.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_10_40.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_10_40.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_10_40.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_10_40.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_10_40.sqlite[2/7] [============54%             ] nsys_report_ia_20000_10_40.sqlite[2/7] [============55%             ] nsys_report_ia_20000_10_40.sqlite[2/7] [============56%             ] nsys_report_ia_20000_10_40.sqlite[2/7] [============57%             ] nsys_report_ia_20000_10_40.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_10_40.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_10_40.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_10_40.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_10_40.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_10_40.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_10_40.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_10_40.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_10_40.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_10_40.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_10_40.sqlite[2/7] [================68%         ] nsys_report_ia_20000_10_40.sqlite[2/7] [================69%         ] nsys_report_ia_20000_10_40.sqlite[2/7] [================70%         ] nsys_report_ia_20000_10_40.sqlite[2/7] [================71%         ] nsys_report_ia_20000_10_40.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_10_40.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_10_40.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_10_40.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_10_40.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_10_40.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_10_40.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_10_40.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_10_40.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_10_40.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_10_40.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_10_40.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_10_40.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_10_40.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_10_40.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_10_40.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_10_40.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_10_40.sqlite[2/7] [========================97% ] nsys_report_ia_20000_10_40.sqlite[2/7] [========================98% ] nsys_report_ia_20000_10_40.sqlite[2/7] [========================99% ] nsys_report_ia_20000_10_40.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_40.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        294161639          1  294161639.0  294161639.0  294161639  294161639          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        173848772          1  173848772.0  173848772.0  173848772  173848772          0.0  cudaFree                      
      1.3          2328663          7     332666.1     217303.0       3980    1381280     473597.2  cudaMalloc                    
      0.2           326278        814        400.8        370.0        110       1560        230.0  cuGetProcAddress_v2           
      0.0            42991          2      21495.5      21495.5       2010      40981      27556.7  cudaStreamCreateWithFlags     
      0.0            18260         18       1014.4        495.0        390       7750       1721.6  cudaEventCreateWithFlags      
      0.0             7030          3       2343.3       2600.0        540       3890       1689.7  cuInit                        
      0.0             5280          3       1760.0        390.0        280       4610       2468.8  cuModuleGetLoadingMode        
      0.0             1000          2        500.0        500.0        460        540         56.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 10 (num_steps = 40)
number of batches= 4
Generating '/tmp/nsys-report-c5e4.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_10_40.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_10_40.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_10_40.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_10_40.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_40.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [1%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [2%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [3%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [4%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [5%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [6%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [7%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [8%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [9%                          ] nsys_report_db_20000_10_40.sqlite[2/7] [10%                         ] nsys_report_db_20000_10_40.sqlite[2/7] [11%                         ] nsys_report_db_20000_10_40.sqlite[2/7] [12%                         ] nsys_report_db_20000_10_40.sqlite[2/7] [13%                         ] nsys_report_db_20000_10_40.sqlite[2/7] [14%                         ] nsys_report_db_20000_10_40.sqlite[2/7] [=15%                        ] nsys_report_db_20000_10_40.sqlite[2/7] [=16%                        ] nsys_report_db_20000_10_40.sqlite[2/7] [=17%                        ] nsys_report_db_20000_10_40.sqlite[2/7] [==18%                       ] nsys_report_db_20000_10_40.sqlite[2/7] [==19%                       ] nsys_report_db_20000_10_40.sqlite[2/7] [==20%                       ] nsys_report_db_20000_10_40.sqlite[2/7] [==21%                       ] nsys_report_db_20000_10_40.sqlite[2/7] [===22%                      ] nsys_report_db_20000_10_40.sqlite[2/7] [===23%                      ] nsys_report_db_20000_10_40.sqlite[2/7] [===24%                      ] nsys_report_db_20000_10_40.sqlite[2/7] [====25%                     ] nsys_report_db_20000_10_40.sqlite[2/7] [====26%                     ] nsys_report_db_20000_10_40.sqlite[2/7] [====27%                     ] nsys_report_db_20000_10_40.sqlite[2/7] [====28%                     ] nsys_report_db_20000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_10_40.sqlite[2/7] [======33%                   ] nsys_report_db_20000_10_40.sqlite[2/7] [======34%                   ] nsys_report_db_20000_10_40.sqlite[2/7] [======35%                   ] nsys_report_db_20000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_10_40.sqlite[2/7] [========40%                 ] nsys_report_db_20000_10_40.sqlite[2/7] [========41%                 ] nsys_report_db_20000_10_40.sqlite[2/7] [========42%                 ] nsys_report_db_20000_10_40.sqlite[2/7] [=========43%                ] nsys_report_db_20000_10_40.sqlite[2/7] [=========44%                ] nsys_report_db_20000_10_40.sqlite[2/7] [=========45%                ] nsys_report_db_20000_10_40.sqlite[2/7] [=========46%                ] nsys_report_db_20000_10_40.sqlite[2/7] [==========47%               ] nsys_report_db_20000_10_40.sqlite[2/7] [==========48%               ] nsys_report_db_20000_10_40.sqlite[2/7] [==========49%               ] nsys_report_db_20000_10_40.sqlite[2/7] [===========50%              ] nsys_report_db_20000_10_40.sqlite[2/7] [===========51%              ] nsys_report_db_20000_10_40.sqlite[2/7] [===========52%              ] nsys_report_db_20000_10_40.sqlite[2/7] [===========53%              ] nsys_report_db_20000_10_40.sqlite[2/7] [============54%             ] nsys_report_db_20000_10_40.sqlite[2/7] [============55%             ] nsys_report_db_20000_10_40.sqlite[2/7] [============56%             ] nsys_report_db_20000_10_40.sqlite[2/7] [============57%             ] nsys_report_db_20000_10_40.sqlite[2/7] [=============58%            ] nsys_report_db_20000_10_40.sqlite[2/7] [=============59%            ] nsys_report_db_20000_10_40.sqlite[2/7] [=============60%            ] nsys_report_db_20000_10_40.sqlite[2/7] [==============61%           ] nsys_report_db_20000_10_40.sqlite[2/7] [==============62%           ] nsys_report_db_20000_10_40.sqlite[2/7] [==============63%           ] nsys_report_db_20000_10_40.sqlite[2/7] [==============64%           ] nsys_report_db_20000_10_40.sqlite[2/7] [===============65%          ] nsys_report_db_20000_10_40.sqlite[2/7] [===============66%          ] nsys_report_db_20000_10_40.sqlite[2/7] [===============67%          ] nsys_report_db_20000_10_40.sqlite[2/7] [================68%         ] nsys_report_db_20000_10_40.sqlite[2/7] [================69%         ] nsys_report_db_20000_10_40.sqlite[2/7] [================70%         ] nsys_report_db_20000_10_40.sqlite[2/7] [================71%         ] nsys_report_db_20000_10_40.sqlite[2/7] [=================72%        ] nsys_report_db_20000_10_40.sqlite[2/7] [=================73%        ] nsys_report_db_20000_10_40.sqlite[2/7] [=================74%        ] nsys_report_db_20000_10_40.sqlite[2/7] [==================75%       ] nsys_report_db_20000_10_40.sqlite[2/7] [==================76%       ] nsys_report_db_20000_10_40.sqlite[2/7] [==================77%       ] nsys_report_db_20000_10_40.sqlite[2/7] [==================78%       ] nsys_report_db_20000_10_40.sqlite[2/7] [===================79%      ] nsys_report_db_20000_10_40.sqlite[2/7] [===================80%      ] nsys_report_db_20000_10_40.sqlite[2/7] [===================81%      ] nsys_report_db_20000_10_40.sqlite[2/7] [===================82%      ] nsys_report_db_20000_10_40.sqlite[2/7] [====================83%     ] nsys_report_db_20000_10_40.sqlite[2/7] [====================84%     ] nsys_report_db_20000_10_40.sqlite[2/7] [====================85%     ] nsys_report_db_20000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_10_40.sqlite[2/7] [======================90%   ] nsys_report_db_20000_10_40.sqlite[2/7] [======================91%   ] nsys_report_db_20000_10_40.sqlite[2/7] [======================92%   ] nsys_report_db_20000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_10_40.sqlite[2/7] [========================97% ] nsys_report_db_20000_10_40.sqlite[2/7] [========================98% ] nsys_report_db_20000_10_40.sqlite[2/7] [========================99% ] nsys_report_db_20000_10_40.sqlite[2/7] [========================100%] nsys_report_db_20000_10_40.sqlite[2/7] [========================100%] nsys_report_db_20000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        242374536          1  242374536.0  242374536.0  242374536  242374536          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        132135352          1  132135352.0  132135352.0  132135352  132135352          0.0  cudaFree                      
      1.7          2278951          7     325564.4     205083.0       3760    1375029     473352.3  cudaMalloc                    
      0.2           300735        814        369.5        300.0        120       1520        227.4  cuGetProcAddress_v2           
      0.0            44931          2      22465.5      22465.5       3191      41740      27258.3  cudaStreamCreateWithFlags     
      0.0            28310         18       1572.8        520.0        390      10800       2995.0  cudaEventCreateWithFlags      
      0.0             6900          3       2300.0       2400.0        700       3800       1552.4  cuInit                        
      0.0             4430          3       1476.7        380.0        290       3760       1977.9  cuModuleGetLoadingMode        
      0.0              860          2        430.0        430.0        300        560        183.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 10 (num_steps = 40), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  3.05 GB
Used GPU Memory:  36.45 GB
------------------------

Process RSS:  128.92 GB
h_X_final[0] = 0.000050
h_X_final[1] = 0.000050
h_X_final[2] = 0.000050
h_X_final[3] = 0.000050
h_X_final[4] = 0.000050
t_alloc_gpu = 2.820015 ms
t_alloc_cpu = 32321.782112 ms
t_init      = 10481.600046 ms
t_h2d       = 5672.330997 ms
t_d2h       = 1584.529877 ms
t_gemm      = 36459.882019 ms
t_end_2_end = 94621.196985 ms
Generating '/tmp/nsys-report-f519.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [====25%                     ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [======35%                   ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=========45%                ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=========46%                ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==========47%               ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==========48%               ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==========49%               ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===========50%              ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===========51%              ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===========52%              ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===========53%              ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [============54%             ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [============55%             ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [============56%             ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [============57%             ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=============58%            ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=============59%            ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=============60%            ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==============61%           ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==============62%           ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==============63%           ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===============65%          ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===============66%          ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===============67%          ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [================68%         ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [================69%         ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [================70%         ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [================71%         ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=================72%        ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=================73%        ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=================74%        ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==================75%       ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==================76%       ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==================77%       ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [==================78%       ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===================79%      ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===================80%      ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===================81%      ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [===================82%      ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [====================83%     ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [====================84%     ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [====================85%     ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=====================86%    ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=====================87%    ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=====================88%    ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=====================89%    ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [======================90%   ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [======================91%   ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [======================92%   ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=======================93%  ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=======================94%  ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=======================95%  ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [=======================96%  ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [========================97% ] nsys_report_fo_20000_10_40.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_40.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [1%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [2%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [3%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [4%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [5%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [6%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [7%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [8%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [9%                          ] nsys_report_fo_20000_10_40.sqlite[2/7] [10%                         ] nsys_report_fo_20000_10_40.sqlite[2/7] [11%                         ] nsys_report_fo_20000_10_40.sqlite[2/7] [12%                         ] nsys_report_fo_20000_10_40.sqlite[2/7] [13%                         ] nsys_report_fo_20000_10_40.sqlite[2/7] [14%                         ] nsys_report_fo_20000_10_40.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_10_40.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_10_40.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_10_40.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_10_40.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_10_40.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_10_40.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_10_40.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_10_40.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_10_40.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_10_40.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_10_40.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_10_40.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_10_40.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_10_40.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_10_40.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_10_40.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_10_40.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_10_40.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_10_40.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_10_40.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_10_40.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_10_40.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_10_40.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_10_40.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_10_40.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_10_40.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_10_40.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_10_40.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_10_40.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_10_40.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_10_40.sqlite[2/7] [============54%             ] nsys_report_fo_20000_10_40.sqlite[2/7] [============55%             ] nsys_report_fo_20000_10_40.sqlite[2/7] [============56%             ] nsys_report_fo_20000_10_40.sqlite[2/7] [============57%             ] nsys_report_fo_20000_10_40.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_10_40.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_10_40.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_10_40.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_10_40.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_10_40.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_10_40.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_10_40.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_10_40.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_10_40.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_10_40.sqlite[2/7] [================68%         ] nsys_report_fo_20000_10_40.sqlite[2/7] [================69%         ] nsys_report_fo_20000_10_40.sqlite[2/7] [================70%         ] nsys_report_fo_20000_10_40.sqlite[2/7] [================71%         ] nsys_report_fo_20000_10_40.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_10_40.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_10_40.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_10_40.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_10_40.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_10_40.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_10_40.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_10_40.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_10_40.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_10_40.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_10_40.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_10_40.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_10_40.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_10_40.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_10_40.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_10_40.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_10_40.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_10_40.sqlite[2/7] [========================97% ] nsys_report_fo_20000_10_40.sqlite[2/7] [========================98% ] nsys_report_fo_20000_10_40.sqlite[2/7] [========================99% ] nsys_report_fo_20000_10_40.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_40.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        248785752          1  248785752.0  248785752.0  248785752  248785752          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     42.1      34629788559        120    288581571.3        20675.5         3380    894922699  417572835.0  cudaMemcpyAsync                   
     39.3      32321765030          1  32321765030.0  32321765030.0  32321765030  32321765030          0.0  cudaHostAlloc                     
     15.4      12683508776          1  12683508776.0  12683508776.0  12683508776  12683508776          0.0  cudaFreeHost                      
      1.7       1359848050         40     33996201.3         3800.0         1370   1359693718  214985827.8  cuKernelGetFunction               
      1.2        988912332          2    494456166.0    494456166.0    252390542    736521790  342332488.4  cudaMemcpy                        
      0.2        160679700         16     10042481.3      1643463.0        46581    131428854   32414355.3  cudaFree                          
      0.1        121419925          1    121419925.0    121419925.0    121419925    121419925          0.0  cudaDeviceReset                   
      0.0          5103790         15       340252.7       352845.0       147462       541817     136909.9  cuLibraryLoadData                 
      0.0          4779807         42       113804.9         4015.5         2360      4606894     710209.0  cudaStreamSynchronize             
      0.0          2999672         15       199978.1       226103.0         3690       288104      76181.3  cudaMalloc                        
      0.0          2459069        120        20492.2        10015.0         3940       324285      32394.4  cudaLaunchKernel                  
      0.0           922189        280         3293.5         2835.0          510        30390       2865.1  cudaEventRecord                   
      0.0           559823         40        13995.6        12215.0         8070        48370       6650.1  cuLaunchKernel                    
      0.0           356705        814          438.2          400.0          130         1610        251.0  cuGetProcAddress_v2               
      0.0           232487        200         1162.4          410.0          290        15061       1732.8  cudaStreamGetCaptureInfo_v2_v11030
      0.0           164023         70         2343.2         2795.0          640        10000       1570.3  cudaStreamWaitEvent               
      0.0           139212        160          870.1          510.0          470        13991       1364.5  cudaEventCreate                   
      0.0           111162          1       111162.0       111162.0       111162       111162          0.0  cudaMemGetInfo                    
      0.0            59141         38         1556.3          500.5          410        18040       3446.8  cudaEventCreateWithFlags          
      0.0            53940          2        26970.0        26970.0         2070        51870      35213.9  cudaStreamCreateWithFlags         
      0.0            46041          4        11510.3         3340.0         1700        37661      17467.5  cudaDeviceSynchronize             
      0.0            31790         38          836.6          540.0          350         5850        988.8  cudaEventDestroy                  
      0.0            27530          2        13765.0        13765.0         5670        21860      11448.1  cudaStreamDestroy                 
      0.0            10770         16          673.1          505.0          420         2540        525.6  cuLibraryGetKernel                
      0.0             7160          3         2386.7         2680.0         1100         3380       1168.0  cuInit                            
      0.0             5770          1         5770.0         5770.0         5770         5770          0.0  cudaEventQuery                    
      0.0             4380          3         1460.0          400.0          150         3830       2056.3  cuModuleGetLoadingMode            
      0.0             1391          1         1391.0         1391.0         1391         1391          0.0  cuCtxSynchronize                  
      0.0             1010          2          505.0          505.0          380          630        176.8  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------------------------------------------------------------------------------------------------
     99.2      35213812473         40  880345311.8  880560910.0  864281519  887854103    5205339.2  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_64x64_16x4_nn_align1>(T1::Params)             
      0.5        186217210         40    4655430.3    4671396.0    4604375    4680886      28425.6  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.3        101172764         80    1264659.6    1257949.5      13888    2532477    1258205.2  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  ----------  -----------  --------  ---------  -----------  ----------------------------
     88.5       5671434342     81  70017707.9  121378992.0      1600  252207154   71928639.6  [CUDA memcpy Host-to-Device]
     11.5        736340749     41  17959530.5       1984.0      1951  736259661  114984124.4  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 131200.415     81  1619.758  3200.000     0.010  3200.000     1609.841  [CUDA memcpy Host-to-Device]
   3200.000     41    78.049     0.000     0.000  3200.000      499.756  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 10 (num_steps = 60)
number of batches= 6
Generating '/tmp/nsys-report-1a2c.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_10_60.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_10_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_10_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_10_60.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_60.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [1%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [2%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [3%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [4%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [5%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [6%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [7%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [8%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [9%                          ] nsys_report_ia_20000_10_60.sqlite[2/7] [10%                         ] nsys_report_ia_20000_10_60.sqlite[2/7] [11%                         ] nsys_report_ia_20000_10_60.sqlite[2/7] [12%                         ] nsys_report_ia_20000_10_60.sqlite[2/7] [13%                         ] nsys_report_ia_20000_10_60.sqlite[2/7] [14%                         ] nsys_report_ia_20000_10_60.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_10_60.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_10_60.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_10_60.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_10_60.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_10_60.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_10_60.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_10_60.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_10_60.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_10_60.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_10_60.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_10_60.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_10_60.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_10_60.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_10_60.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_10_60.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_10_60.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_10_60.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_10_60.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_10_60.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_10_60.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_10_60.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_10_60.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_10_60.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_10_60.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_10_60.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_10_60.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_10_60.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_10_60.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_10_60.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_10_60.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_10_60.sqlite[2/7] [============54%             ] nsys_report_ia_20000_10_60.sqlite[2/7] [============55%             ] nsys_report_ia_20000_10_60.sqlite[2/7] [============56%             ] nsys_report_ia_20000_10_60.sqlite[2/7] [============57%             ] nsys_report_ia_20000_10_60.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_10_60.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_10_60.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_10_60.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_10_60.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_10_60.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_10_60.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_10_60.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_10_60.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_10_60.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_10_60.sqlite[2/7] [================68%         ] nsys_report_ia_20000_10_60.sqlite[2/7] [================69%         ] nsys_report_ia_20000_10_60.sqlite[2/7] [================70%         ] nsys_report_ia_20000_10_60.sqlite[2/7] [================71%         ] nsys_report_ia_20000_10_60.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_10_60.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_10_60.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_10_60.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_10_60.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_10_60.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_10_60.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_10_60.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_10_60.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_10_60.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_10_60.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_10_60.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_10_60.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_10_60.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_10_60.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_10_60.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_10_60.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_10_60.sqlite[2/7] [========================97% ] nsys_report_ia_20000_10_60.sqlite[2/7] [========================98% ] nsys_report_ia_20000_10_60.sqlite[2/7] [========================99% ] nsys_report_ia_20000_10_60.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_60.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        302223634          1  302223634.0  302223634.0  302223634  302223634          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        176004772          1  176004772.0  176004772.0  176004772  176004772          0.0  cudaFree                      
      1.3          2321632          7     331661.7     210843.0       3980    1390969     478293.6  cudaMalloc                    
      0.2           332353        814        408.3        390.0        120       1650        235.2  cuGetProcAddress_v2           
      0.0            55301          2      27650.5      27650.5       2060      53241      36190.4  cudaStreamCreateWithFlags     
      0.0            19320         18       1073.3        510.0        390       9250       2062.3  cudaEventCreateWithFlags      
      0.0             6330          3       2110.0       2100.0        640       3590       1475.0  cuInit                        
      0.0             4550          3       1516.7        400.0        140       4010       2163.2  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        300        580        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 10 (num_steps = 60)
number of batches= 6
Generating '/tmp/nsys-report-ea4e.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_10_60.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_10_60.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_10_60.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_10_60.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_60.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [1%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [2%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [3%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [4%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [5%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [6%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [7%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [8%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [9%                          ] nsys_report_db_20000_10_60.sqlite[2/7] [10%                         ] nsys_report_db_20000_10_60.sqlite[2/7] [11%                         ] nsys_report_db_20000_10_60.sqlite[2/7] [12%                         ] nsys_report_db_20000_10_60.sqlite[2/7] [13%                         ] nsys_report_db_20000_10_60.sqlite[2/7] [14%                         ] nsys_report_db_20000_10_60.sqlite[2/7] [=15%                        ] nsys_report_db_20000_10_60.sqlite[2/7] [=16%                        ] nsys_report_db_20000_10_60.sqlite[2/7] [=17%                        ] nsys_report_db_20000_10_60.sqlite[2/7] [==18%                       ] nsys_report_db_20000_10_60.sqlite[2/7] [==19%                       ] nsys_report_db_20000_10_60.sqlite[2/7] [==20%                       ] nsys_report_db_20000_10_60.sqlite[2/7] [==21%                       ] nsys_report_db_20000_10_60.sqlite[2/7] [===22%                      ] nsys_report_db_20000_10_60.sqlite[2/7] [===23%                      ] nsys_report_db_20000_10_60.sqlite[2/7] [===24%                      ] nsys_report_db_20000_10_60.sqlite[2/7] [====25%                     ] nsys_report_db_20000_10_60.sqlite[2/7] [====26%                     ] nsys_report_db_20000_10_60.sqlite[2/7] [====27%                     ] nsys_report_db_20000_10_60.sqlite[2/7] [====28%                     ] nsys_report_db_20000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_10_60.sqlite[2/7] [======33%                   ] nsys_report_db_20000_10_60.sqlite[2/7] [======34%                   ] nsys_report_db_20000_10_60.sqlite[2/7] [======35%                   ] nsys_report_db_20000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_10_60.sqlite[2/7] [========40%                 ] nsys_report_db_20000_10_60.sqlite[2/7] [========41%                 ] nsys_report_db_20000_10_60.sqlite[2/7] [========42%                 ] nsys_report_db_20000_10_60.sqlite[2/7] [=========43%                ] nsys_report_db_20000_10_60.sqlite[2/7] [=========44%                ] nsys_report_db_20000_10_60.sqlite[2/7] [=========45%                ] nsys_report_db_20000_10_60.sqlite[2/7] [=========46%                ] nsys_report_db_20000_10_60.sqlite[2/7] [==========47%               ] nsys_report_db_20000_10_60.sqlite[2/7] [==========48%               ] nsys_report_db_20000_10_60.sqlite[2/7] [==========49%               ] nsys_report_db_20000_10_60.sqlite[2/7] [===========50%              ] nsys_report_db_20000_10_60.sqlite[2/7] [===========51%              ] nsys_report_db_20000_10_60.sqlite[2/7] [===========52%              ] nsys_report_db_20000_10_60.sqlite[2/7] [===========53%              ] nsys_report_db_20000_10_60.sqlite[2/7] [============54%             ] nsys_report_db_20000_10_60.sqlite[2/7] [============55%             ] nsys_report_db_20000_10_60.sqlite[2/7] [============56%             ] nsys_report_db_20000_10_60.sqlite[2/7] [============57%             ] nsys_report_db_20000_10_60.sqlite[2/7] [=============58%            ] nsys_report_db_20000_10_60.sqlite[2/7] [=============59%            ] nsys_report_db_20000_10_60.sqlite[2/7] [=============60%            ] nsys_report_db_20000_10_60.sqlite[2/7] [==============61%           ] nsys_report_db_20000_10_60.sqlite[2/7] [==============62%           ] nsys_report_db_20000_10_60.sqlite[2/7] [==============63%           ] nsys_report_db_20000_10_60.sqlite[2/7] [==============64%           ] nsys_report_db_20000_10_60.sqlite[2/7] [===============65%          ] nsys_report_db_20000_10_60.sqlite[2/7] [===============66%          ] nsys_report_db_20000_10_60.sqlite[2/7] [===============67%          ] nsys_report_db_20000_10_60.sqlite[2/7] [================68%         ] nsys_report_db_20000_10_60.sqlite[2/7] [================69%         ] nsys_report_db_20000_10_60.sqlite[2/7] [================70%         ] nsys_report_db_20000_10_60.sqlite[2/7] [================71%         ] nsys_report_db_20000_10_60.sqlite[2/7] [=================72%        ] nsys_report_db_20000_10_60.sqlite[2/7] [=================73%        ] nsys_report_db_20000_10_60.sqlite[2/7] [=================74%        ] nsys_report_db_20000_10_60.sqlite[2/7] [==================75%       ] nsys_report_db_20000_10_60.sqlite[2/7] [==================76%       ] nsys_report_db_20000_10_60.sqlite[2/7] [==================77%       ] nsys_report_db_20000_10_60.sqlite[2/7] [==================78%       ] nsys_report_db_20000_10_60.sqlite[2/7] [===================79%      ] nsys_report_db_20000_10_60.sqlite[2/7] [===================80%      ] nsys_report_db_20000_10_60.sqlite[2/7] [===================81%      ] nsys_report_db_20000_10_60.sqlite[2/7] [===================82%      ] nsys_report_db_20000_10_60.sqlite[2/7] [====================83%     ] nsys_report_db_20000_10_60.sqlite[2/7] [====================84%     ] nsys_report_db_20000_10_60.sqlite[2/7] [====================85%     ] nsys_report_db_20000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_10_60.sqlite[2/7] [======================90%   ] nsys_report_db_20000_10_60.sqlite[2/7] [======================91%   ] nsys_report_db_20000_10_60.sqlite[2/7] [======================92%   ] nsys_report_db_20000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_10_60.sqlite[2/7] [========================97% ] nsys_report_db_20000_10_60.sqlite[2/7] [========================98% ] nsys_report_db_20000_10_60.sqlite[2/7] [========================99% ] nsys_report_db_20000_10_60.sqlite[2/7] [========================100%] nsys_report_db_20000_10_60.sqlite[2/7] [========================100%] nsys_report_db_20000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        249955498          1  249955498.0  249955498.0  249955498  249955498          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        133806005          1  133806005.0  133806005.0  133806005  133806005          0.0  cudaFree                      
      1.7          2291672          7     327381.7     207193.0       3870    1383239     476003.0  cudaMalloc                    
      0.3           347027        814        426.3        400.0        120       1460        244.3  cuGetProcAddress_v2           
      0.0            41191          2      20595.5      20595.5       2100      39091      26156.6  cudaStreamCreateWithFlags     
      0.0            29560         18       1642.2        530.0        400      18730       4283.6  cudaEventCreateWithFlags      
      0.0             6140          3       2046.7       2250.0        660       3230       1297.0  cuInit                        
      0.0             5020          3       1673.3        480.0        310       4230       2215.8  cuModuleGetLoadingMode        
      0.0             1220          2        610.0        610.0        310        910        424.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 10 (num_steps = 60), identity_test = 0
Generating '/tmp/nsys-report-1058.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_10_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_10_60.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_10_60.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_10_60.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_60.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [1%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [2%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [3%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [4%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [5%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [6%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [7%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [8%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [9%                          ] nsys_report_fo_20000_10_60.sqlite[2/7] [10%                         ] nsys_report_fo_20000_10_60.sqlite[2/7] [11%                         ] nsys_report_fo_20000_10_60.sqlite[2/7] [12%                         ] nsys_report_fo_20000_10_60.sqlite[2/7] [13%                         ] nsys_report_fo_20000_10_60.sqlite[2/7] [14%                         ] nsys_report_fo_20000_10_60.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_10_60.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_10_60.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_10_60.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_10_60.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_10_60.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_10_60.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_10_60.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_10_60.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_10_60.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_10_60.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_10_60.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_10_60.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_10_60.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_10_60.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_10_60.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_10_60.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_10_60.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_10_60.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_10_60.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_10_60.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_10_60.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_10_60.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_10_60.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_10_60.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_10_60.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_10_60.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_10_60.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_10_60.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_10_60.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_10_60.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_10_60.sqlite[2/7] [============54%             ] nsys_report_fo_20000_10_60.sqlite[2/7] [============55%             ] nsys_report_fo_20000_10_60.sqlite[2/7] [============56%             ] nsys_report_fo_20000_10_60.sqlite[2/7] [============57%             ] nsys_report_fo_20000_10_60.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_10_60.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_10_60.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_10_60.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_10_60.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_10_60.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_10_60.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_10_60.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_10_60.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_10_60.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_10_60.sqlite[2/7] [================68%         ] nsys_report_fo_20000_10_60.sqlite[2/7] [================69%         ] nsys_report_fo_20000_10_60.sqlite[2/7] [================70%         ] nsys_report_fo_20000_10_60.sqlite[2/7] [================71%         ] nsys_report_fo_20000_10_60.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_10_60.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_10_60.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_10_60.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_10_60.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_10_60.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_10_60.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_10_60.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_10_60.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_10_60.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_10_60.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_10_60.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_10_60.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_10_60.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_10_60.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_10_60.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_10_60.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_10_60.sqlite[2/7] [========================97% ] nsys_report_fo_20000_10_60.sqlite[2/7] [========================98% ] nsys_report_fo_20000_10_60.sqlite[2/7] [========================99% ] nsys_report_fo_20000_10_60.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_60.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245104759          1  245104759.0  245104759.0  245104759  245104759          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.5        133401817          1  133401817.0  133401817.0  133401817  133401817          0.0  cudaFree                      
      2.2          2979921         15     198661.4     227533.0       3960     281104      74990.6  cudaMalloc                    
      0.3           343873        814        422.4        390.0        120       1570        234.2  cuGetProcAddress_v2           
      0.0            43860          2      21930.0      21930.0       2390      41470      27633.7  cudaStreamCreateWithFlags     
      0.0            18240         18       1013.3        500.0        390       7980       1771.2  cudaEventCreateWithFlags      
      0.0            12891          1      12891.0      12891.0      12891      12891          0.0  cudaHostAlloc                 
      0.0             7320          3       2440.0       2710.0        920       3690       1404.6  cuInit                        
      0.0             4910          3       1636.7        510.0        270       4130       2162.6  cuModuleGetLoadingMode        
      0.0              850          2        425.0        425.0        300        550        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 10 (num_steps = 80)
number of batches= 8
Generating '/tmp/nsys-report-1a52.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_10_80.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_10_80.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_10_80.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_80.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [1%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [2%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [3%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [4%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [5%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [6%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [7%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [8%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [9%                          ] nsys_report_ia_20000_10_80.sqlite[2/7] [10%                         ] nsys_report_ia_20000_10_80.sqlite[2/7] [11%                         ] nsys_report_ia_20000_10_80.sqlite[2/7] [12%                         ] nsys_report_ia_20000_10_80.sqlite[2/7] [13%                         ] nsys_report_ia_20000_10_80.sqlite[2/7] [14%                         ] nsys_report_ia_20000_10_80.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_10_80.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_10_80.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_10_80.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_10_80.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_10_80.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_10_80.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_10_80.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_10_80.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_10_80.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_10_80.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_10_80.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_10_80.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_10_80.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_10_80.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_10_80.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_10_80.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_10_80.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_10_80.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_10_80.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_10_80.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_10_80.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_10_80.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_10_80.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_10_80.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_10_80.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_10_80.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_10_80.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_10_80.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_10_80.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_10_80.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_10_80.sqlite[2/7] [============54%             ] nsys_report_ia_20000_10_80.sqlite[2/7] [============55%             ] nsys_report_ia_20000_10_80.sqlite[2/7] [============56%             ] nsys_report_ia_20000_10_80.sqlite[2/7] [============57%             ] nsys_report_ia_20000_10_80.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_10_80.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_10_80.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_10_80.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_10_80.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_10_80.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_10_80.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_10_80.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_10_80.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_10_80.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_10_80.sqlite[2/7] [================68%         ] nsys_report_ia_20000_10_80.sqlite[2/7] [================69%         ] nsys_report_ia_20000_10_80.sqlite[2/7] [================70%         ] nsys_report_ia_20000_10_80.sqlite[2/7] [================71%         ] nsys_report_ia_20000_10_80.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_10_80.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_10_80.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_10_80.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_10_80.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_10_80.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_10_80.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_10_80.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_10_80.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_10_80.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_10_80.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_10_80.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_10_80.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_10_80.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_10_80.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_10_80.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_10_80.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_10_80.sqlite[2/7] [========================97% ] nsys_report_ia_20000_10_80.sqlite[2/7] [========================98% ] nsys_report_ia_20000_10_80.sqlite[2/7] [========================99% ] nsys_report_ia_20000_10_80.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_80.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        249631179          1  249631179.0  249631179.0  249631179  249631179          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        131013724          1  131013724.0  131013724.0  131013724  131013724          0.0  cudaFree                      
      1.7          2263501          7     323357.3     206733.0       4070    1358869     466875.5  cudaMalloc                    
      0.3           339724        814        417.4        380.0        120       1540        238.9  cuGetProcAddress_v2           
      0.0            52370          2      26185.0      26185.0       2100      50270      34061.3  cudaStreamCreateWithFlags     
      0.0            28091         18       1560.6        530.0        420      17071       3887.7  cudaEventCreateWithFlags      
      0.0             6520          3       2173.3       2010.0        770       3740       1491.7  cuInit                        
      0.0             5251          3       1750.3        400.0        320       4531       2408.5  cuModuleGetLoadingMode        
      0.0              940          2        470.0        470.0        330        610        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 10 (num_steps = 80)
number of batches= 8
Generating '/tmp/nsys-report-5759.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_10_80.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_10_80.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_10_80.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_80.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [1%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [2%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [3%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [4%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [5%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [6%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [7%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [8%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [9%                          ] nsys_report_db_20000_10_80.sqlite[2/7] [10%                         ] nsys_report_db_20000_10_80.sqlite[2/7] [11%                         ] nsys_report_db_20000_10_80.sqlite[2/7] [12%                         ] nsys_report_db_20000_10_80.sqlite[2/7] [13%                         ] nsys_report_db_20000_10_80.sqlite[2/7] [14%                         ] nsys_report_db_20000_10_80.sqlite[2/7] [=15%                        ] nsys_report_db_20000_10_80.sqlite[2/7] [=16%                        ] nsys_report_db_20000_10_80.sqlite[2/7] [=17%                        ] nsys_report_db_20000_10_80.sqlite[2/7] [==18%                       ] nsys_report_db_20000_10_80.sqlite[2/7] [==19%                       ] nsys_report_db_20000_10_80.sqlite[2/7] [==20%                       ] nsys_report_db_20000_10_80.sqlite[2/7] [==21%                       ] nsys_report_db_20000_10_80.sqlite[2/7] [===22%                      ] nsys_report_db_20000_10_80.sqlite[2/7] [===23%                      ] nsys_report_db_20000_10_80.sqlite[2/7] [===24%                      ] nsys_report_db_20000_10_80.sqlite[2/7] [====25%                     ] nsys_report_db_20000_10_80.sqlite[2/7] [====26%                     ] nsys_report_db_20000_10_80.sqlite[2/7] [====27%                     ] nsys_report_db_20000_10_80.sqlite[2/7] [====28%                     ] nsys_report_db_20000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_10_80.sqlite[2/7] [======33%                   ] nsys_report_db_20000_10_80.sqlite[2/7] [======34%                   ] nsys_report_db_20000_10_80.sqlite[2/7] [======35%                   ] nsys_report_db_20000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_10_80.sqlite[2/7] [========40%                 ] nsys_report_db_20000_10_80.sqlite[2/7] [========41%                 ] nsys_report_db_20000_10_80.sqlite[2/7] [========42%                 ] nsys_report_db_20000_10_80.sqlite[2/7] [=========43%                ] nsys_report_db_20000_10_80.sqlite[2/7] [=========44%                ] nsys_report_db_20000_10_80.sqlite[2/7] [=========45%                ] nsys_report_db_20000_10_80.sqlite[2/7] [=========46%                ] nsys_report_db_20000_10_80.sqlite[2/7] [==========47%               ] nsys_report_db_20000_10_80.sqlite[2/7] [==========48%               ] nsys_report_db_20000_10_80.sqlite[2/7] [==========49%               ] nsys_report_db_20000_10_80.sqlite[2/7] [===========50%              ] nsys_report_db_20000_10_80.sqlite[2/7] [===========51%              ] nsys_report_db_20000_10_80.sqlite[2/7] [===========52%              ] nsys_report_db_20000_10_80.sqlite[2/7] [===========53%              ] nsys_report_db_20000_10_80.sqlite[2/7] [============54%             ] nsys_report_db_20000_10_80.sqlite[2/7] [============55%             ] nsys_report_db_20000_10_80.sqlite[2/7] [============56%             ] nsys_report_db_20000_10_80.sqlite[2/7] [============57%             ] nsys_report_db_20000_10_80.sqlite[2/7] [=============58%            ] nsys_report_db_20000_10_80.sqlite[2/7] [=============59%            ] nsys_report_db_20000_10_80.sqlite[2/7] [=============60%            ] nsys_report_db_20000_10_80.sqlite[2/7] [==============61%           ] nsys_report_db_20000_10_80.sqlite[2/7] [==============62%           ] nsys_report_db_20000_10_80.sqlite[2/7] [==============63%           ] nsys_report_db_20000_10_80.sqlite[2/7] [==============64%           ] nsys_report_db_20000_10_80.sqlite[2/7] [===============65%          ] nsys_report_db_20000_10_80.sqlite[2/7] [===============66%          ] nsys_report_db_20000_10_80.sqlite[2/7] [===============67%          ] nsys_report_db_20000_10_80.sqlite[2/7] [================68%         ] nsys_report_db_20000_10_80.sqlite[2/7] [================69%         ] nsys_report_db_20000_10_80.sqlite[2/7] [================70%         ] nsys_report_db_20000_10_80.sqlite[2/7] [================71%         ] nsys_report_db_20000_10_80.sqlite[2/7] [=================72%        ] nsys_report_db_20000_10_80.sqlite[2/7] [=================73%        ] nsys_report_db_20000_10_80.sqlite[2/7] [=================74%        ] nsys_report_db_20000_10_80.sqlite[2/7] [==================75%       ] nsys_report_db_20000_10_80.sqlite[2/7] [==================76%       ] nsys_report_db_20000_10_80.sqlite[2/7] [==================77%       ] nsys_report_db_20000_10_80.sqlite[2/7] [==================78%       ] nsys_report_db_20000_10_80.sqlite[2/7] [===================79%      ] nsys_report_db_20000_10_80.sqlite[2/7] [===================80%      ] nsys_report_db_20000_10_80.sqlite[2/7] [===================81%      ] nsys_report_db_20000_10_80.sqlite[2/7] [===================82%      ] nsys_report_db_20000_10_80.sqlite[2/7] [====================83%     ] nsys_report_db_20000_10_80.sqlite[2/7] [====================84%     ] nsys_report_db_20000_10_80.sqlite[2/7] [====================85%     ] nsys_report_db_20000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_10_80.sqlite[2/7] [======================90%   ] nsys_report_db_20000_10_80.sqlite[2/7] [======================91%   ] nsys_report_db_20000_10_80.sqlite[2/7] [======================92%   ] nsys_report_db_20000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_10_80.sqlite[2/7] [========================97% ] nsys_report_db_20000_10_80.sqlite[2/7] [========================98% ] nsys_report_db_20000_10_80.sqlite[2/7] [========================99% ] nsys_report_db_20000_10_80.sqlite[2/7] [========================100%] nsys_report_db_20000_10_80.sqlite[2/7] [========================100%] nsys_report_db_20000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        253235266          1  253235266.0  253235266.0  253235266  253235266          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        133324214          1  133324214.0  133324214.0  133324214  133324214          0.0  cudaFree                      
      1.7          2293422          7     327631.7     208353.0       3750    1384869     476465.0  cudaMalloc                    
      0.3           344164        814        422.8        390.0        120       1910        249.0  cuGetProcAddress_v2           
      0.0            54261          2      27130.5      27130.5       2260      52001      35172.2  cudaStreamCreateWithFlags     
      0.0            24850         18       1380.6        500.0        390      14280       3238.5  cudaEventCreateWithFlags      
      0.0             6640          3       2213.3       2070.0        670       3900       1619.8  cuInit                        
      0.0             4720          3       1573.3        370.0        290       4060       2153.9  cuModuleGetLoadingMode        
      0.0             1120          2        560.0        560.0        390        730        240.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 10 (num_steps = 80), identity_test = 0
Generating '/tmp/nsys-report-601b.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_10_80.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_10_80.nsys-rep[1/7] [========================97% ] nsys_report_fo_20000_10_80.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_10_80.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_80.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [1%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [2%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [3%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [4%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [5%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [6%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [7%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [8%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [9%                          ] nsys_report_fo_20000_10_80.sqlite[2/7] [10%                         ] nsys_report_fo_20000_10_80.sqlite[2/7] [11%                         ] nsys_report_fo_20000_10_80.sqlite[2/7] [12%                         ] nsys_report_fo_20000_10_80.sqlite[2/7] [13%                         ] nsys_report_fo_20000_10_80.sqlite[2/7] [14%                         ] nsys_report_fo_20000_10_80.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_10_80.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_10_80.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_10_80.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_10_80.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_10_80.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_10_80.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_10_80.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_10_80.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_10_80.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_10_80.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_10_80.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_10_80.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_10_80.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_10_80.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_10_80.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_10_80.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_10_80.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_10_80.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_10_80.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_10_80.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_10_80.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_10_80.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_10_80.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_10_80.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_10_80.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_10_80.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_10_80.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_10_80.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_10_80.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_10_80.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_10_80.sqlite[2/7] [============54%             ] nsys_report_fo_20000_10_80.sqlite[2/7] [============55%             ] nsys_report_fo_20000_10_80.sqlite[2/7] [============56%             ] nsys_report_fo_20000_10_80.sqlite[2/7] [============57%             ] nsys_report_fo_20000_10_80.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_10_80.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_10_80.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_10_80.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_10_80.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_10_80.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_10_80.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_10_80.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_10_80.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_10_80.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_10_80.sqlite[2/7] [================68%         ] nsys_report_fo_20000_10_80.sqlite[2/7] [================69%         ] nsys_report_fo_20000_10_80.sqlite[2/7] [================70%         ] nsys_report_fo_20000_10_80.sqlite[2/7] [================71%         ] nsys_report_fo_20000_10_80.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_10_80.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_10_80.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_10_80.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_10_80.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_10_80.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_10_80.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_10_80.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_10_80.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_10_80.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_10_80.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_10_80.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_10_80.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_10_80.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_10_80.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_10_80.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_10_80.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_10_80.sqlite[2/7] [========================97% ] nsys_report_fo_20000_10_80.sqlite[2/7] [========================98% ] nsys_report_fo_20000_10_80.sqlite[2/7] [========================99% ] nsys_report_fo_20000_10_80.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_80.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        242504906          1  242504906.0  242504906.0  242504906  242504906          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.4        131027081          1  131027081.0  131027081.0  131027081  131027081          0.0  cudaFree                      
      2.2          3005852         15     200390.1     225783.0       4280     282154      76543.7  cudaMalloc                    
      0.2           335346        814        412.0        390.0        120       1440        234.5  cuGetProcAddress_v2           
      0.0            39851          2      19925.5      19925.5       2900      36951      24077.7  cudaStreamCreateWithFlags     
      0.0            33590         18       1866.1        445.0        410      13110       3846.7  cudaEventCreateWithFlags      
      0.0            14600          1      14600.0      14600.0      14600      14600          0.0  cudaHostAlloc                 
      0.0             7280          3       2426.7       2620.0        690       3970       1648.5  cuInit                        
      0.0             5090          3       1696.7        390.0        290       4410       2350.3  cuModuleGetLoadingMode        
      0.0              840          2        420.0        420.0        310        530        155.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 10 (num_steps = 100)
number of batches= 10
Generating '/tmp/nsys-report-43c3.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_10_100.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_10_100.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_10_100.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_10_100.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_100.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [1%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [2%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [3%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [4%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [5%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [6%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [7%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [8%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [9%                          ] nsys_report_ia_20000_10_100.sqlite[2/7] [10%                         ] nsys_report_ia_20000_10_100.sqlite[2/7] [11%                         ] nsys_report_ia_20000_10_100.sqlite[2/7] [12%                         ] nsys_report_ia_20000_10_100.sqlite[2/7] [13%                         ] nsys_report_ia_20000_10_100.sqlite[2/7] [14%                         ] nsys_report_ia_20000_10_100.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_10_100.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_10_100.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_10_100.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_10_100.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_10_100.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_10_100.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_10_100.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_10_100.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_10_100.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_10_100.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_10_100.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_10_100.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_10_100.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_10_100.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_10_100.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_10_100.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_10_100.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_10_100.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_10_100.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_10_100.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_10_100.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_10_100.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_10_100.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_10_100.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_10_100.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_10_100.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_10_100.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_10_100.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_10_100.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_10_100.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_10_100.sqlite[2/7] [============54%             ] nsys_report_ia_20000_10_100.sqlite[2/7] [============55%             ] nsys_report_ia_20000_10_100.sqlite[2/7] [============56%             ] nsys_report_ia_20000_10_100.sqlite[2/7] [============57%             ] nsys_report_ia_20000_10_100.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_10_100.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_10_100.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_10_100.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_10_100.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_10_100.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_10_100.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_10_100.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_10_100.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_10_100.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_10_100.sqlite[2/7] [================68%         ] nsys_report_ia_20000_10_100.sqlite[2/7] [================69%         ] nsys_report_ia_20000_10_100.sqlite[2/7] [================70%         ] nsys_report_ia_20000_10_100.sqlite[2/7] [================71%         ] nsys_report_ia_20000_10_100.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_10_100.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_10_100.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_10_100.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_10_100.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_10_100.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_10_100.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_10_100.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_10_100.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_10_100.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_10_100.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_10_100.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_10_100.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_10_100.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_10_100.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_10_100.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_10_100.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_10_100.sqlite[2/7] [========================97% ] nsys_report_ia_20000_10_100.sqlite[2/7] [========================98% ] nsys_report_ia_20000_10_100.sqlite[2/7] [========================99% ] nsys_report_ia_20000_10_100.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_100.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        251445756          1  251445756.0  251445756.0  251445756  251445756          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        133427393          1  133427393.0  133427393.0  133427393  133427393          0.0  cudaFree                      
      1.7          2289441          7     327063.0     210883.0       4240    1375268     472834.3  cudaMalloc                    
      0.2           319643        814        392.7        370.0        120       1540        227.6  cuGetProcAddress_v2           
      0.0            52241          2      26120.5      26120.5       1940      50301      34196.4  cudaStreamCreateWithFlags     
      0.0            30940         18       1718.9        520.0        390      19970       4574.3  cudaEventCreateWithFlags      
      0.0             6820          3       2273.3       2650.0        690       3480       1432.6  cuInit                        
      0.0             4810          3       1603.3        390.0        310       4110       2171.2  cuModuleGetLoadingMode        
      0.0             1340          2        670.0        670.0        540        800        183.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 10 (num_steps = 100)
number of batches= 10
Generating '/tmp/nsys-report-3f24.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_10_100.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_10_100.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_10_100.nsys-rep[1/7] [========================97% ] nsys_report_db_20000_10_100.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_10_100.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_100.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [1%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [2%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [3%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [4%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [5%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [6%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [7%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [8%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [9%                          ] nsys_report_db_20000_10_100.sqlite[2/7] [10%                         ] nsys_report_db_20000_10_100.sqlite[2/7] [11%                         ] nsys_report_db_20000_10_100.sqlite[2/7] [12%                         ] nsys_report_db_20000_10_100.sqlite[2/7] [13%                         ] nsys_report_db_20000_10_100.sqlite[2/7] [14%                         ] nsys_report_db_20000_10_100.sqlite[2/7] [=15%                        ] nsys_report_db_20000_10_100.sqlite[2/7] [=16%                        ] nsys_report_db_20000_10_100.sqlite[2/7] [=17%                        ] nsys_report_db_20000_10_100.sqlite[2/7] [==18%                       ] nsys_report_db_20000_10_100.sqlite[2/7] [==19%                       ] nsys_report_db_20000_10_100.sqlite[2/7] [==20%                       ] nsys_report_db_20000_10_100.sqlite[2/7] [==21%                       ] nsys_report_db_20000_10_100.sqlite[2/7] [===22%                      ] nsys_report_db_20000_10_100.sqlite[2/7] [===23%                      ] nsys_report_db_20000_10_100.sqlite[2/7] [===24%                      ] nsys_report_db_20000_10_100.sqlite[2/7] [====25%                     ] nsys_report_db_20000_10_100.sqlite[2/7] [====26%                     ] nsys_report_db_20000_10_100.sqlite[2/7] [====27%                     ] nsys_report_db_20000_10_100.sqlite[2/7] [====28%                     ] nsys_report_db_20000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_10_100.sqlite[2/7] [======33%                   ] nsys_report_db_20000_10_100.sqlite[2/7] [======34%                   ] nsys_report_db_20000_10_100.sqlite[2/7] [======35%                   ] nsys_report_db_20000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_10_100.sqlite[2/7] [========40%                 ] nsys_report_db_20000_10_100.sqlite[2/7] [========41%                 ] nsys_report_db_20000_10_100.sqlite[2/7] [========42%                 ] nsys_report_db_20000_10_100.sqlite[2/7] [=========43%                ] nsys_report_db_20000_10_100.sqlite[2/7] [=========44%                ] nsys_report_db_20000_10_100.sqlite[2/7] [=========45%                ] nsys_report_db_20000_10_100.sqlite[2/7] [=========46%                ] nsys_report_db_20000_10_100.sqlite[2/7] [==========47%               ] nsys_report_db_20000_10_100.sqlite[2/7] [==========48%               ] nsys_report_db_20000_10_100.sqlite[2/7] [==========49%               ] nsys_report_db_20000_10_100.sqlite[2/7] [===========50%              ] nsys_report_db_20000_10_100.sqlite[2/7] [===========51%              ] nsys_report_db_20000_10_100.sqlite[2/7] [===========52%              ] nsys_report_db_20000_10_100.sqlite[2/7] [===========53%              ] nsys_report_db_20000_10_100.sqlite[2/7] [============54%             ] nsys_report_db_20000_10_100.sqlite[2/7] [============55%             ] nsys_report_db_20000_10_100.sqlite[2/7] [============56%             ] nsys_report_db_20000_10_100.sqlite[2/7] [============57%             ] nsys_report_db_20000_10_100.sqlite[2/7] [=============58%            ] nsys_report_db_20000_10_100.sqlite[2/7] [=============59%            ] nsys_report_db_20000_10_100.sqlite[2/7] [=============60%            ] nsys_report_db_20000_10_100.sqlite[2/7] [==============61%           ] nsys_report_db_20000_10_100.sqlite[2/7] [==============62%           ] nsys_report_db_20000_10_100.sqlite[2/7] [==============63%           ] nsys_report_db_20000_10_100.sqlite[2/7] [==============64%           ] nsys_report_db_20000_10_100.sqlite[2/7] [===============65%          ] nsys_report_db_20000_10_100.sqlite[2/7] [===============66%          ] nsys_report_db_20000_10_100.sqlite[2/7] [===============67%          ] nsys_report_db_20000_10_100.sqlite[2/7] [================68%         ] nsys_report_db_20000_10_100.sqlite[2/7] [================69%         ] nsys_report_db_20000_10_100.sqlite[2/7] [================70%         ] nsys_report_db_20000_10_100.sqlite[2/7] [================71%         ] nsys_report_db_20000_10_100.sqlite[2/7] [=================72%        ] nsys_report_db_20000_10_100.sqlite[2/7] [=================73%        ] nsys_report_db_20000_10_100.sqlite[2/7] [=================74%        ] nsys_report_db_20000_10_100.sqlite[2/7] [==================75%       ] nsys_report_db_20000_10_100.sqlite[2/7] [==================76%       ] nsys_report_db_20000_10_100.sqlite[2/7] [==================77%       ] nsys_report_db_20000_10_100.sqlite[2/7] [==================78%       ] nsys_report_db_20000_10_100.sqlite[2/7] [===================79%      ] nsys_report_db_20000_10_100.sqlite[2/7] [===================80%      ] nsys_report_db_20000_10_100.sqlite[2/7] [===================81%      ] nsys_report_db_20000_10_100.sqlite[2/7] [===================82%      ] nsys_report_db_20000_10_100.sqlite[2/7] [====================83%     ] nsys_report_db_20000_10_100.sqlite[2/7] [====================84%     ] nsys_report_db_20000_10_100.sqlite[2/7] [====================85%     ] nsys_report_db_20000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_10_100.sqlite[2/7] [======================90%   ] nsys_report_db_20000_10_100.sqlite[2/7] [======================91%   ] nsys_report_db_20000_10_100.sqlite[2/7] [======================92%   ] nsys_report_db_20000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_10_100.sqlite[2/7] [========================97% ] nsys_report_db_20000_10_100.sqlite[2/7] [========================98% ] nsys_report_db_20000_10_100.sqlite[2/7] [========================99% ] nsys_report_db_20000_10_100.sqlite[2/7] [========================100%] nsys_report_db_20000_10_100.sqlite[2/7] [========================100%] nsys_report_db_20000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        250900396          1  250900396.0  250900396.0  250900396  250900396          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        131511876          1  131511876.0  131511876.0  131511876  131511876          0.0  cudaFree                      
      1.7          2267722          7     323960.3     203523.0       3910    1361419     467749.2  cudaMalloc                    
      0.2           332476        814        408.4        370.0        120       1510        237.9  cuGetProcAddress_v2           
      0.0            58581          2      29290.5      29290.5       2130      56451      38410.7  cudaStreamCreateWithFlags     
      0.0            26730         18       1485.0        425.0        370      16430       3760.7  cudaEventCreateWithFlags      
      0.0             7120          3       2373.3       2560.0        710       3850       1578.3  cuInit                        
      0.0             4980          3       1660.0        380.0        160       4440       2410.1  cuModuleGetLoadingMode        
      0.0             1050          2        525.0        525.0        300        750        318.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 10 (num_steps = 100), identity_test = 0
Generating '/tmp/nsys-report-cb80.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_10_100.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_10_100.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_10_100.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_10_100.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_100.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [1%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [2%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [3%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [4%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [5%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [6%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [7%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [8%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [9%                          ] nsys_report_fo_20000_10_100.sqlite[2/7] [10%                         ] nsys_report_fo_20000_10_100.sqlite[2/7] [11%                         ] nsys_report_fo_20000_10_100.sqlite[2/7] [12%                         ] nsys_report_fo_20000_10_100.sqlite[2/7] [13%                         ] nsys_report_fo_20000_10_100.sqlite[2/7] [14%                         ] nsys_report_fo_20000_10_100.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_10_100.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_10_100.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_10_100.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_10_100.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_10_100.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_10_100.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_10_100.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_10_100.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_10_100.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_10_100.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_10_100.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_10_100.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_10_100.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_10_100.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_10_100.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_10_100.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_10_100.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_10_100.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_10_100.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_10_100.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_10_100.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_10_100.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_10_100.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_10_100.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_10_100.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_10_100.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_10_100.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_10_100.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_10_100.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_10_100.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_10_100.sqlite[2/7] [============54%             ] nsys_report_fo_20000_10_100.sqlite[2/7] [============55%             ] nsys_report_fo_20000_10_100.sqlite[2/7] [============56%             ] nsys_report_fo_20000_10_100.sqlite[2/7] [============57%             ] nsys_report_fo_20000_10_100.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_10_100.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_10_100.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_10_100.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_10_100.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_10_100.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_10_100.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_10_100.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_10_100.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_10_100.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_10_100.sqlite[2/7] [================68%         ] nsys_report_fo_20000_10_100.sqlite[2/7] [================69%         ] nsys_report_fo_20000_10_100.sqlite[2/7] [================70%         ] nsys_report_fo_20000_10_100.sqlite[2/7] [================71%         ] nsys_report_fo_20000_10_100.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_10_100.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_10_100.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_10_100.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_10_100.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_10_100.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_10_100.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_10_100.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_10_100.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_10_100.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_10_100.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_10_100.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_10_100.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_10_100.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_10_100.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_10_100.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_10_100.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_10_100.sqlite[2/7] [========================97% ] nsys_report_fo_20000_10_100.sqlite[2/7] [========================98% ] nsys_report_fo_20000_10_100.sqlite[2/7] [========================99% ] nsys_report_fo_20000_10_100.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_100.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        253031161          1  253031161.0  253031161.0  253031161  253031161          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.5        136170296          1  136170296.0  136170296.0  136170296  136170296          0.0  cudaFree                      
      2.2          3010092         15     200672.8     230843.0       4090     284374      74910.5  cudaMalloc                    
      0.2           345244        814        424.1        390.0        120       1620        251.3  cuGetProcAddress_v2           
      0.0            40650          2      20325.0      20325.0       1780      38870      26226.6  cudaStreamCreateWithFlags     
      0.0            28660         18       1592.2        500.0        390      17290       3947.7  cudaEventCreateWithFlags      
      0.0            11870          1      11870.0      11870.0      11870      11870          0.0  cudaHostAlloc                 
      0.0             6350          3       2116.7       2350.0        680       3320       1335.4  cuInit                        
      0.0             4630          3       1543.3        580.0        280       3770       1934.2  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        320        560        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 10 (num_steps = 150)
number of batches= 15
Generating '/tmp/nsys-report-cc03.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_10_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_10_150.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_150.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [1%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [2%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [3%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [4%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [5%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [6%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [7%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [8%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [9%                          ] nsys_report_ia_20000_10_150.sqlite[2/7] [10%                         ] nsys_report_ia_20000_10_150.sqlite[2/7] [11%                         ] nsys_report_ia_20000_10_150.sqlite[2/7] [12%                         ] nsys_report_ia_20000_10_150.sqlite[2/7] [13%                         ] nsys_report_ia_20000_10_150.sqlite[2/7] [14%                         ] nsys_report_ia_20000_10_150.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_10_150.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_10_150.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_10_150.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_10_150.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_10_150.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_10_150.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_10_150.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_10_150.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_10_150.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_10_150.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_10_150.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_10_150.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_10_150.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_10_150.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_10_150.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_10_150.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_10_150.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_10_150.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_10_150.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_10_150.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_10_150.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_10_150.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_10_150.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_10_150.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_10_150.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_10_150.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_10_150.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_10_150.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_10_150.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_10_150.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_10_150.sqlite[2/7] [============54%             ] nsys_report_ia_20000_10_150.sqlite[2/7] [============55%             ] nsys_report_ia_20000_10_150.sqlite[2/7] [============56%             ] nsys_report_ia_20000_10_150.sqlite[2/7] [============57%             ] nsys_report_ia_20000_10_150.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_10_150.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_10_150.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_10_150.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_10_150.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_10_150.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_10_150.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_10_150.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_10_150.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_10_150.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_10_150.sqlite[2/7] [================68%         ] nsys_report_ia_20000_10_150.sqlite[2/7] [================69%         ] nsys_report_ia_20000_10_150.sqlite[2/7] [================70%         ] nsys_report_ia_20000_10_150.sqlite[2/7] [================71%         ] nsys_report_ia_20000_10_150.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_10_150.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_10_150.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_10_150.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_10_150.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_10_150.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_10_150.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_10_150.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_10_150.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_10_150.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_10_150.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_10_150.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_10_150.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_10_150.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_10_150.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_10_150.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_10_150.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_10_150.sqlite[2/7] [========================97% ] nsys_report_ia_20000_10_150.sqlite[2/7] [========================98% ] nsys_report_ia_20000_10_150.sqlite[2/7] [========================99% ] nsys_report_ia_20000_10_150.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_150.sqlite[2/7] [========================100%] nsys_report_ia_20000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        244831884          1  244831884.0  244831884.0  244831884  244831884          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        131516181          1  131516181.0  131516181.0  131516181  131516181          0.0  cudaFree                      
      1.7          2314671          7     330667.3     206233.0       4040    1379769     474077.5  cudaMalloc                    
      0.2           326715        814        401.4        370.0        120       1670        240.8  cuGetProcAddress_v2           
      0.0            50931          2      25465.5      25465.5       1800      49131      33468.1  cudaStreamCreateWithFlags     
      0.0            32111         18       1783.9        490.0        400      21271       4885.8  cudaEventCreateWithFlags      
      0.0             7060          3       2353.3       2770.0        650       3640       1537.9  cuInit                        
      0.0             4690          3       1563.3        390.0        290       4010       2119.5  cuModuleGetLoadingMode        
      0.0              840          2        420.0        420.0        310        530        155.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_10_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 10 (num_steps = 150)
number of batches= 15
Generating '/tmp/nsys-report-86bf.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_10_150.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_10_150.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_150.nsys-rep[1/7] [========================100%] nsys_report_db_20000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [1%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [2%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [3%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [4%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [5%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [6%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [7%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [8%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [9%                          ] nsys_report_db_20000_10_150.sqlite[2/7] [10%                         ] nsys_report_db_20000_10_150.sqlite[2/7] [11%                         ] nsys_report_db_20000_10_150.sqlite[2/7] [12%                         ] nsys_report_db_20000_10_150.sqlite[2/7] [13%                         ] nsys_report_db_20000_10_150.sqlite[2/7] [14%                         ] nsys_report_db_20000_10_150.sqlite[2/7] [=15%                        ] nsys_report_db_20000_10_150.sqlite[2/7] [=16%                        ] nsys_report_db_20000_10_150.sqlite[2/7] [=17%                        ] nsys_report_db_20000_10_150.sqlite[2/7] [==18%                       ] nsys_report_db_20000_10_150.sqlite[2/7] [==19%                       ] nsys_report_db_20000_10_150.sqlite[2/7] [==20%                       ] nsys_report_db_20000_10_150.sqlite[2/7] [==21%                       ] nsys_report_db_20000_10_150.sqlite[2/7] [===22%                      ] nsys_report_db_20000_10_150.sqlite[2/7] [===23%                      ] nsys_report_db_20000_10_150.sqlite[2/7] [===24%                      ] nsys_report_db_20000_10_150.sqlite[2/7] [====25%                     ] nsys_report_db_20000_10_150.sqlite[2/7] [====26%                     ] nsys_report_db_20000_10_150.sqlite[2/7] [====27%                     ] nsys_report_db_20000_10_150.sqlite[2/7] [====28%                     ] nsys_report_db_20000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_10_150.sqlite[2/7] [======33%                   ] nsys_report_db_20000_10_150.sqlite[2/7] [======34%                   ] nsys_report_db_20000_10_150.sqlite[2/7] [======35%                   ] nsys_report_db_20000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_10_150.sqlite[2/7] [========40%                 ] nsys_report_db_20000_10_150.sqlite[2/7] [========41%                 ] nsys_report_db_20000_10_150.sqlite[2/7] [========42%                 ] nsys_report_db_20000_10_150.sqlite[2/7] [=========43%                ] nsys_report_db_20000_10_150.sqlite[2/7] [=========44%                ] nsys_report_db_20000_10_150.sqlite[2/7] [=========45%                ] nsys_report_db_20000_10_150.sqlite[2/7] [=========46%                ] nsys_report_db_20000_10_150.sqlite[2/7] [==========47%               ] nsys_report_db_20000_10_150.sqlite[2/7] [==========48%               ] nsys_report_db_20000_10_150.sqlite[2/7] [==========49%               ] nsys_report_db_20000_10_150.sqlite[2/7] [===========50%              ] nsys_report_db_20000_10_150.sqlite[2/7] [===========51%              ] nsys_report_db_20000_10_150.sqlite[2/7] [===========52%              ] nsys_report_db_20000_10_150.sqlite[2/7] [===========53%              ] nsys_report_db_20000_10_150.sqlite[2/7] [============54%             ] nsys_report_db_20000_10_150.sqlite[2/7] [============55%             ] nsys_report_db_20000_10_150.sqlite[2/7] [============56%             ] nsys_report_db_20000_10_150.sqlite[2/7] [============57%             ] nsys_report_db_20000_10_150.sqlite[2/7] [=============58%            ] nsys_report_db_20000_10_150.sqlite[2/7] [=============59%            ] nsys_report_db_20000_10_150.sqlite[2/7] [=============60%            ] nsys_report_db_20000_10_150.sqlite[2/7] [==============61%           ] nsys_report_db_20000_10_150.sqlite[2/7] [==============62%           ] nsys_report_db_20000_10_150.sqlite[2/7] [==============63%           ] nsys_report_db_20000_10_150.sqlite[2/7] [==============64%           ] nsys_report_db_20000_10_150.sqlite[2/7] [===============65%          ] nsys_report_db_20000_10_150.sqlite[2/7] [===============66%          ] nsys_report_db_20000_10_150.sqlite[2/7] [===============67%          ] nsys_report_db_20000_10_150.sqlite[2/7] [================68%         ] nsys_report_db_20000_10_150.sqlite[2/7] [================69%         ] nsys_report_db_20000_10_150.sqlite[2/7] [================70%         ] nsys_report_db_20000_10_150.sqlite[2/7] [================71%         ] nsys_report_db_20000_10_150.sqlite[2/7] [=================72%        ] nsys_report_db_20000_10_150.sqlite[2/7] [=================73%        ] nsys_report_db_20000_10_150.sqlite[2/7] [=================74%        ] nsys_report_db_20000_10_150.sqlite[2/7] [==================75%       ] nsys_report_db_20000_10_150.sqlite[2/7] [==================76%       ] nsys_report_db_20000_10_150.sqlite[2/7] [==================77%       ] nsys_report_db_20000_10_150.sqlite[2/7] [==================78%       ] nsys_report_db_20000_10_150.sqlite[2/7] [===================79%      ] nsys_report_db_20000_10_150.sqlite[2/7] [===================80%      ] nsys_report_db_20000_10_150.sqlite[2/7] [===================81%      ] nsys_report_db_20000_10_150.sqlite[2/7] [===================82%      ] nsys_report_db_20000_10_150.sqlite[2/7] [====================83%     ] nsys_report_db_20000_10_150.sqlite[2/7] [====================84%     ] nsys_report_db_20000_10_150.sqlite[2/7] [====================85%     ] nsys_report_db_20000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_10_150.sqlite[2/7] [======================90%   ] nsys_report_db_20000_10_150.sqlite[2/7] [======================91%   ] nsys_report_db_20000_10_150.sqlite[2/7] [======================92%   ] nsys_report_db_20000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_10_150.sqlite[2/7] [========================97% ] nsys_report_db_20000_10_150.sqlite[2/7] [========================98% ] nsys_report_db_20000_10_150.sqlite[2/7] [========================99% ] nsys_report_db_20000_10_150.sqlite[2/7] [========================100%] nsys_report_db_20000_10_150.sqlite[2/7] [========================100%] nsys_report_db_20000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        258916249          1  258916249.0  258916249.0  258916249  258916249          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        140131739          1  140131739.0  140131739.0  140131739  140131739          0.0  cudaFree                      
      1.6          2329462          7     332780.3     204363.0       4061    1385669     476109.1  cudaMalloc                    
      0.2           357076        814        438.7        390.0        110      15171        573.2  cuGetProcAddress_v2           
      0.0            45300          2      22650.0      22650.0       1990      43310      29217.7  cudaStreamCreateWithFlags     
      0.0            24260         18       1347.8        525.0        390      13050       2952.9  cudaEventCreateWithFlags      
      0.0             7470          3       2490.0       2580.0        850       4040       1596.9  cuInit                        
      0.0             4840          3       1613.3        530.0        280       4030       2096.6  cuModuleGetLoadingMode        
      0.0              850          2        425.0        425.0        330        520        134.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_10_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 10 (num_steps = 150), identity_test = 0
Generating '/tmp/nsys-report-aa4a.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_10_150.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_10_150.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_150.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [1%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [2%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [3%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [4%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [5%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [6%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [7%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [8%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [9%                          ] nsys_report_fo_20000_10_150.sqlite[2/7] [10%                         ] nsys_report_fo_20000_10_150.sqlite[2/7] [11%                         ] nsys_report_fo_20000_10_150.sqlite[2/7] [12%                         ] nsys_report_fo_20000_10_150.sqlite[2/7] [13%                         ] nsys_report_fo_20000_10_150.sqlite[2/7] [14%                         ] nsys_report_fo_20000_10_150.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_10_150.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_10_150.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_10_150.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_10_150.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_10_150.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_10_150.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_10_150.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_10_150.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_10_150.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_10_150.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_10_150.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_10_150.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_10_150.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_10_150.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_10_150.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_10_150.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_10_150.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_10_150.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_10_150.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_10_150.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_10_150.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_10_150.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_10_150.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_10_150.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_10_150.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_10_150.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_10_150.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_10_150.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_10_150.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_10_150.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_10_150.sqlite[2/7] [============54%             ] nsys_report_fo_20000_10_150.sqlite[2/7] [============55%             ] nsys_report_fo_20000_10_150.sqlite[2/7] [============56%             ] nsys_report_fo_20000_10_150.sqlite[2/7] [============57%             ] nsys_report_fo_20000_10_150.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_10_150.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_10_150.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_10_150.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_10_150.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_10_150.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_10_150.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_10_150.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_10_150.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_10_150.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_10_150.sqlite[2/7] [================68%         ] nsys_report_fo_20000_10_150.sqlite[2/7] [================69%         ] nsys_report_fo_20000_10_150.sqlite[2/7] [================70%         ] nsys_report_fo_20000_10_150.sqlite[2/7] [================71%         ] nsys_report_fo_20000_10_150.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_10_150.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_10_150.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_10_150.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_10_150.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_10_150.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_10_150.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_10_150.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_10_150.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_10_150.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_10_150.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_10_150.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_10_150.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_10_150.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_10_150.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_10_150.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_10_150.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_10_150.sqlite[2/7] [========================97% ] nsys_report_fo_20000_10_150.sqlite[2/7] [========================98% ] nsys_report_fo_20000_10_150.sqlite[2/7] [========================99% ] nsys_report_fo_20000_10_150.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_150.sqlite[2/7] [========================100%] nsys_report_fo_20000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        251981599          1  251981599.0  251981599.0  251981599  251981599          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.5        134741262          1  134741262.0  134741262.0  134741262  134741262          0.0  cudaFree                      
      2.2          3011741         15     200782.7     228073.0       3770     287284      76035.5  cudaMalloc                    
      0.2           333014        814        409.1        390.0        120       1540        230.6  cuGetProcAddress_v2           
      0.0            42650          2      21325.0      21325.0       2150      40500      27117.5  cudaStreamCreateWithFlags     
      0.0            21550         18       1197.2        520.0        390       9810       2216.5  cudaEventCreateWithFlags      
      0.0            12381          1      12381.0      12381.0      12381      12381          0.0  cudaHostAlloc                 
      0.0             8140          3       2713.3       3240.0       1120       3780       1406.0  cuInit                        
      0.0             4400          3       1466.7        390.0        300       3710       1943.3  cuModuleGetLoadingMode        
      0.0              850          2        425.0        425.0        310        540        162.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_10_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 20 (num_steps = 20)
number of batches= 1
Generating '/tmp/nsys-report-2203.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_20_20.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_20_20.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_20_20.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_20.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [1%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [2%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [3%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [4%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [5%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [6%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [7%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [8%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [9%                          ] nsys_report_ia_20000_20_20.sqlite[2/7] [10%                         ] nsys_report_ia_20000_20_20.sqlite[2/7] [11%                         ] nsys_report_ia_20000_20_20.sqlite[2/7] [12%                         ] nsys_report_ia_20000_20_20.sqlite[2/7] [13%                         ] nsys_report_ia_20000_20_20.sqlite[2/7] [14%                         ] nsys_report_ia_20000_20_20.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_20_20.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_20_20.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_20_20.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_20_20.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_20_20.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_20_20.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_20_20.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_20_20.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_20_20.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_20_20.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_20_20.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_20_20.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_20_20.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_20_20.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_20_20.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_20_20.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_20_20.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_20_20.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_20_20.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_20_20.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_20_20.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_20_20.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_20_20.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_20_20.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_20_20.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_20_20.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_20_20.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_20_20.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_20_20.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_20_20.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_20_20.sqlite[2/7] [============54%             ] nsys_report_ia_20000_20_20.sqlite[2/7] [============55%             ] nsys_report_ia_20000_20_20.sqlite[2/7] [============56%             ] nsys_report_ia_20000_20_20.sqlite[2/7] [============57%             ] nsys_report_ia_20000_20_20.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_20_20.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_20_20.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_20_20.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_20_20.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_20_20.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_20_20.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_20_20.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_20_20.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_20_20.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_20_20.sqlite[2/7] [================68%         ] nsys_report_ia_20000_20_20.sqlite[2/7] [================69%         ] nsys_report_ia_20000_20_20.sqlite[2/7] [================70%         ] nsys_report_ia_20000_20_20.sqlite[2/7] [================71%         ] nsys_report_ia_20000_20_20.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_20_20.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_20_20.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_20_20.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_20_20.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_20_20.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_20_20.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_20_20.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_20_20.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_20_20.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_20_20.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_20_20.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_20_20.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_20_20.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_20_20.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_20_20.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_20_20.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_20_20.sqlite[2/7] [========================97% ] nsys_report_ia_20000_20_20.sqlite[2/7] [========================98% ] nsys_report_ia_20000_20_20.sqlite[2/7] [========================99% ] nsys_report_ia_20000_20_20.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_20.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245869372          1  245869372.0  245869372.0  245869372  245869372          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        133961620          1  133961620.0  133961620.0  133961620  133961620          0.0  cudaFree                      
      1.2          1567141          6     261190.2     168957.0       3960     858272     310859.3  cudaMalloc                    
      0.3           345104        814        424.0        380.0        120      10230        419.6  cuGetProcAddress_v2           
      0.0            40370          2      20185.0      20185.0       1820      38550      25972.0  cudaStreamCreateWithFlags     
      0.0            23730         18       1318.3        480.0        400      12790       2894.7  cudaEventCreateWithFlags      
      0.0             6790          3       2263.3       2180.0        720       3890       1586.6  cuInit                        
      0.0             4760          3       1586.7        420.0        290       4050       2134.3  cuModuleGetLoadingMode        
      0.0              980          2        490.0        490.0        320        660        240.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 20 (num_steps = 20)
number of batches= 1
Generating '/tmp/nsys-report-4f14.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_20_20.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_20_20.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_20_20.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_20.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [1%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [2%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [3%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [4%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [5%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [6%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [7%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [8%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [9%                          ] nsys_report_db_20000_20_20.sqlite[2/7] [10%                         ] nsys_report_db_20000_20_20.sqlite[2/7] [11%                         ] nsys_report_db_20000_20_20.sqlite[2/7] [12%                         ] nsys_report_db_20000_20_20.sqlite[2/7] [13%                         ] nsys_report_db_20000_20_20.sqlite[2/7] [14%                         ] nsys_report_db_20000_20_20.sqlite[2/7] [=15%                        ] nsys_report_db_20000_20_20.sqlite[2/7] [=16%                        ] nsys_report_db_20000_20_20.sqlite[2/7] [=17%                        ] nsys_report_db_20000_20_20.sqlite[2/7] [==18%                       ] nsys_report_db_20000_20_20.sqlite[2/7] [==19%                       ] nsys_report_db_20000_20_20.sqlite[2/7] [==20%                       ] nsys_report_db_20000_20_20.sqlite[2/7] [==21%                       ] nsys_report_db_20000_20_20.sqlite[2/7] [===22%                      ] nsys_report_db_20000_20_20.sqlite[2/7] [===23%                      ] nsys_report_db_20000_20_20.sqlite[2/7] [===24%                      ] nsys_report_db_20000_20_20.sqlite[2/7] [====25%                     ] nsys_report_db_20000_20_20.sqlite[2/7] [====26%                     ] nsys_report_db_20000_20_20.sqlite[2/7] [====27%                     ] nsys_report_db_20000_20_20.sqlite[2/7] [====28%                     ] nsys_report_db_20000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_20_20.sqlite[2/7] [======33%                   ] nsys_report_db_20000_20_20.sqlite[2/7] [======34%                   ] nsys_report_db_20000_20_20.sqlite[2/7] [======35%                   ] nsys_report_db_20000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_20_20.sqlite[2/7] [========40%                 ] nsys_report_db_20000_20_20.sqlite[2/7] [========41%                 ] nsys_report_db_20000_20_20.sqlite[2/7] [========42%                 ] nsys_report_db_20000_20_20.sqlite[2/7] [=========43%                ] nsys_report_db_20000_20_20.sqlite[2/7] [=========44%                ] nsys_report_db_20000_20_20.sqlite[2/7] [=========45%                ] nsys_report_db_20000_20_20.sqlite[2/7] [=========46%                ] nsys_report_db_20000_20_20.sqlite[2/7] [==========47%               ] nsys_report_db_20000_20_20.sqlite[2/7] [==========48%               ] nsys_report_db_20000_20_20.sqlite[2/7] [==========49%               ] nsys_report_db_20000_20_20.sqlite[2/7] [===========50%              ] nsys_report_db_20000_20_20.sqlite[2/7] [===========51%              ] nsys_report_db_20000_20_20.sqlite[2/7] [===========52%              ] nsys_report_db_20000_20_20.sqlite[2/7] [===========53%              ] nsys_report_db_20000_20_20.sqlite[2/7] [============54%             ] nsys_report_db_20000_20_20.sqlite[2/7] [============55%             ] nsys_report_db_20000_20_20.sqlite[2/7] [============56%             ] nsys_report_db_20000_20_20.sqlite[2/7] [============57%             ] nsys_report_db_20000_20_20.sqlite[2/7] [=============58%            ] nsys_report_db_20000_20_20.sqlite[2/7] [=============59%            ] nsys_report_db_20000_20_20.sqlite[2/7] [=============60%            ] nsys_report_db_20000_20_20.sqlite[2/7] [==============61%           ] nsys_report_db_20000_20_20.sqlite[2/7] [==============62%           ] nsys_report_db_20000_20_20.sqlite[2/7] [==============63%           ] nsys_report_db_20000_20_20.sqlite[2/7] [==============64%           ] nsys_report_db_20000_20_20.sqlite[2/7] [===============65%          ] nsys_report_db_20000_20_20.sqlite[2/7] [===============66%          ] nsys_report_db_20000_20_20.sqlite[2/7] [===============67%          ] nsys_report_db_20000_20_20.sqlite[2/7] [================68%         ] nsys_report_db_20000_20_20.sqlite[2/7] [================69%         ] nsys_report_db_20000_20_20.sqlite[2/7] [================70%         ] nsys_report_db_20000_20_20.sqlite[2/7] [================71%         ] nsys_report_db_20000_20_20.sqlite[2/7] [=================72%        ] nsys_report_db_20000_20_20.sqlite[2/7] [=================73%        ] nsys_report_db_20000_20_20.sqlite[2/7] [=================74%        ] nsys_report_db_20000_20_20.sqlite[2/7] [==================75%       ] nsys_report_db_20000_20_20.sqlite[2/7] [==================76%       ] nsys_report_db_20000_20_20.sqlite[2/7] [==================77%       ] nsys_report_db_20000_20_20.sqlite[2/7] [==================78%       ] nsys_report_db_20000_20_20.sqlite[2/7] [===================79%      ] nsys_report_db_20000_20_20.sqlite[2/7] [===================80%      ] nsys_report_db_20000_20_20.sqlite[2/7] [===================81%      ] nsys_report_db_20000_20_20.sqlite[2/7] [===================82%      ] nsys_report_db_20000_20_20.sqlite[2/7] [====================83%     ] nsys_report_db_20000_20_20.sqlite[2/7] [====================84%     ] nsys_report_db_20000_20_20.sqlite[2/7] [====================85%     ] nsys_report_db_20000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_20_20.sqlite[2/7] [======================90%   ] nsys_report_db_20000_20_20.sqlite[2/7] [======================91%   ] nsys_report_db_20000_20_20.sqlite[2/7] [======================92%   ] nsys_report_db_20000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_20_20.sqlite[2/7] [========================97% ] nsys_report_db_20000_20_20.sqlite[2/7] [========================98% ] nsys_report_db_20000_20_20.sqlite[2/7] [========================99% ] nsys_report_db_20000_20_20.sqlite[2/7] [========================100%] nsys_report_db_20000_20_20.sqlite[2/7] [========================100%] nsys_report_db_20000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        295741489          1  295741489.0  295741489.0  295741489  295741489          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.9        173758474          1  173758474.0  173758474.0  173758474  173758474          0.0  cudaFree                      
      0.9          1588272          6     264712.0     177747.5       3870     860062     312066.0  cudaMalloc                    
      0.2           343576        814        422.1        380.0        110      11831        468.3  cuGetProcAddress_v2           
      0.0            48861          2      24430.5      24430.5       2160      46701      31495.2  cudaStreamCreateWithFlags     
      0.0            21900         18       1216.7        440.0        400      11790       2661.7  cudaEventCreateWithFlags      
      0.0             6840          3       2280.0       2500.0        670       3670       1512.1  cuInit                        
      0.0             5280          3       1760.0        510.0        290       4480       2358.2  cuModuleGetLoadingMode        
      0.0              840          2        420.0        420.0        300        540        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 20 (num_steps = 20), identity_test = 0
Generating '/tmp/nsys-report-5704.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_20_20.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_20000_20_20.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_20_20.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_20.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [1%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [2%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [3%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [4%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [5%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [6%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [7%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [8%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [9%                          ] nsys_report_fo_20000_20_20.sqlite[2/7] [10%                         ] nsys_report_fo_20000_20_20.sqlite[2/7] [11%                         ] nsys_report_fo_20000_20_20.sqlite[2/7] [12%                         ] nsys_report_fo_20000_20_20.sqlite[2/7] [13%                         ] nsys_report_fo_20000_20_20.sqlite[2/7] [14%                         ] nsys_report_fo_20000_20_20.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_20_20.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_20_20.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_20_20.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_20_20.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_20_20.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_20_20.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_20_20.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_20_20.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_20_20.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_20_20.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_20_20.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_20_20.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_20_20.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_20_20.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_20_20.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_20_20.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_20_20.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_20_20.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_20_20.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_20_20.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_20_20.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_20_20.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_20_20.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_20_20.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_20_20.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_20_20.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_20_20.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_20_20.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_20_20.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_20_20.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_20_20.sqlite[2/7] [============54%             ] nsys_report_fo_20000_20_20.sqlite[2/7] [============55%             ] nsys_report_fo_20000_20_20.sqlite[2/7] [============56%             ] nsys_report_fo_20000_20_20.sqlite[2/7] [============57%             ] nsys_report_fo_20000_20_20.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_20_20.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_20_20.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_20_20.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_20_20.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_20_20.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_20_20.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_20_20.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_20_20.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_20_20.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_20_20.sqlite[2/7] [================68%         ] nsys_report_fo_20000_20_20.sqlite[2/7] [================69%         ] nsys_report_fo_20000_20_20.sqlite[2/7] [================70%         ] nsys_report_fo_20000_20_20.sqlite[2/7] [================71%         ] nsys_report_fo_20000_20_20.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_20_20.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_20_20.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_20_20.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_20_20.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_20_20.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_20_20.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_20_20.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_20_20.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_20_20.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_20_20.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_20_20.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_20_20.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_20_20.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_20_20.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_20_20.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_20_20.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_20_20.sqlite[2/7] [========================97% ] nsys_report_fo_20000_20_20.sqlite[2/7] [========================98% ] nsys_report_fo_20000_20_20.sqlite[2/7] [========================99% ] nsys_report_fo_20000_20_20.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_20.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        269665890          1  269665890.0  269665890.0  269665890  269665890          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.6        152098573          1  152098573.0  152098573.0  152098573  152098573          0.0  cudaFree                      
      2.2          3389836         17     199402.1     232373.0       3820     287444      77586.0  cudaMalloc                    
      0.2           333324        814        409.5        380.0        120       1730        240.7  cuGetProcAddress_v2           
      0.0            45251          2      22625.5      22625.5       5220      40031      24615.1  cudaStreamCreateWithFlags     
      0.0            22950         18       1275.0        495.0        400      11870       2686.8  cudaEventCreateWithFlags      
      0.0             7471          3       2490.3       2890.0        740       3841       1588.7  cuInit                        
      0.0             5340          3       1780.0        430.0        380       4530       2381.7  cuModuleGetLoadingMode        
      0.0              870          2        435.0        435.0        310        560        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 20 (num_steps = 40)
number of batches= 2
Generating '/tmp/nsys-report-a90f.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_20_40.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_20_40.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_20_40.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_20_40.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_40.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [1%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [2%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [3%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [4%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [5%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [6%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [7%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [8%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [9%                          ] nsys_report_ia_20000_20_40.sqlite[2/7] [10%                         ] nsys_report_ia_20000_20_40.sqlite[2/7] [11%                         ] nsys_report_ia_20000_20_40.sqlite[2/7] [12%                         ] nsys_report_ia_20000_20_40.sqlite[2/7] [13%                         ] nsys_report_ia_20000_20_40.sqlite[2/7] [14%                         ] nsys_report_ia_20000_20_40.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_20_40.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_20_40.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_20_40.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_20_40.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_20_40.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_20_40.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_20_40.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_20_40.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_20_40.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_20_40.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_20_40.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_20_40.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_20_40.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_20_40.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_20_40.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_20_40.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_20_40.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_20_40.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_20_40.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_20_40.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_20_40.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_20_40.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_20_40.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_20_40.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_20_40.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_20_40.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_20_40.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_20_40.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_20_40.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_20_40.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_20_40.sqlite[2/7] [============54%             ] nsys_report_ia_20000_20_40.sqlite[2/7] [============55%             ] nsys_report_ia_20000_20_40.sqlite[2/7] [============56%             ] nsys_report_ia_20000_20_40.sqlite[2/7] [============57%             ] nsys_report_ia_20000_20_40.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_20_40.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_20_40.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_20_40.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_20_40.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_20_40.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_20_40.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_20_40.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_20_40.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_20_40.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_20_40.sqlite[2/7] [================68%         ] nsys_report_ia_20000_20_40.sqlite[2/7] [================69%         ] nsys_report_ia_20000_20_40.sqlite[2/7] [================70%         ] nsys_report_ia_20000_20_40.sqlite[2/7] [================71%         ] nsys_report_ia_20000_20_40.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_20_40.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_20_40.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_20_40.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_20_40.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_20_40.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_20_40.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_20_40.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_20_40.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_20_40.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_20_40.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_20_40.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_20_40.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_20_40.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_20_40.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_20_40.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_20_40.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_20_40.sqlite[2/7] [========================97% ] nsys_report_ia_20000_20_40.sqlite[2/7] [========================98% ] nsys_report_ia_20000_20_40.sqlite[2/7] [========================99% ] nsys_report_ia_20000_20_40.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_40.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        253654202          1  253654202.0  253654202.0  253654202  253654202          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        136347739          1  136347739.0  136347739.0  136347739  136347739          0.0  cudaFree                      
      1.1          1583921          6     263986.8     174657.0       4310     861642     311709.0  cudaMalloc                    
      0.2           316416        814        388.7        300.0        120       1480        226.2  cuGetProcAddress_v2           
      0.0            40960          2      20480.0      20480.0       1750      39210      26488.2  cudaStreamCreateWithFlags     
      0.0            29011         18       1611.7        445.0        390      11740       3200.7  cudaEventCreateWithFlags      
      0.0             7080          3       2360.0       2520.0        840       3720       1446.7  cuInit                        
      0.0             4540          3       1513.3        380.0        300       3860       2032.7  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        330        620        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 20 (num_steps = 40)
number of batches= 2
Generating '/tmp/nsys-report-bc8a.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_20_40.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_20_40.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_20_40.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_20_40.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_40.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [1%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [2%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [3%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [4%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [5%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [6%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [7%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [8%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [9%                          ] nsys_report_db_20000_20_40.sqlite[2/7] [10%                         ] nsys_report_db_20000_20_40.sqlite[2/7] [11%                         ] nsys_report_db_20000_20_40.sqlite[2/7] [12%                         ] nsys_report_db_20000_20_40.sqlite[2/7] [13%                         ] nsys_report_db_20000_20_40.sqlite[2/7] [14%                         ] nsys_report_db_20000_20_40.sqlite[2/7] [=15%                        ] nsys_report_db_20000_20_40.sqlite[2/7] [=16%                        ] nsys_report_db_20000_20_40.sqlite[2/7] [=17%                        ] nsys_report_db_20000_20_40.sqlite[2/7] [==18%                       ] nsys_report_db_20000_20_40.sqlite[2/7] [==19%                       ] nsys_report_db_20000_20_40.sqlite[2/7] [==20%                       ] nsys_report_db_20000_20_40.sqlite[2/7] [==21%                       ] nsys_report_db_20000_20_40.sqlite[2/7] [===22%                      ] nsys_report_db_20000_20_40.sqlite[2/7] [===23%                      ] nsys_report_db_20000_20_40.sqlite[2/7] [===24%                      ] nsys_report_db_20000_20_40.sqlite[2/7] [====25%                     ] nsys_report_db_20000_20_40.sqlite[2/7] [====26%                     ] nsys_report_db_20000_20_40.sqlite[2/7] [====27%                     ] nsys_report_db_20000_20_40.sqlite[2/7] [====28%                     ] nsys_report_db_20000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_20_40.sqlite[2/7] [======33%                   ] nsys_report_db_20000_20_40.sqlite[2/7] [======34%                   ] nsys_report_db_20000_20_40.sqlite[2/7] [======35%                   ] nsys_report_db_20000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_20_40.sqlite[2/7] [========40%                 ] nsys_report_db_20000_20_40.sqlite[2/7] [========41%                 ] nsys_report_db_20000_20_40.sqlite[2/7] [========42%                 ] nsys_report_db_20000_20_40.sqlite[2/7] [=========43%                ] nsys_report_db_20000_20_40.sqlite[2/7] [=========44%                ] nsys_report_db_20000_20_40.sqlite[2/7] [=========45%                ] nsys_report_db_20000_20_40.sqlite[2/7] [=========46%                ] nsys_report_db_20000_20_40.sqlite[2/7] [==========47%               ] nsys_report_db_20000_20_40.sqlite[2/7] [==========48%               ] nsys_report_db_20000_20_40.sqlite[2/7] [==========49%               ] nsys_report_db_20000_20_40.sqlite[2/7] [===========50%              ] nsys_report_db_20000_20_40.sqlite[2/7] [===========51%              ] nsys_report_db_20000_20_40.sqlite[2/7] [===========52%              ] nsys_report_db_20000_20_40.sqlite[2/7] [===========53%              ] nsys_report_db_20000_20_40.sqlite[2/7] [============54%             ] nsys_report_db_20000_20_40.sqlite[2/7] [============55%             ] nsys_report_db_20000_20_40.sqlite[2/7] [============56%             ] nsys_report_db_20000_20_40.sqlite[2/7] [============57%             ] nsys_report_db_20000_20_40.sqlite[2/7] [=============58%            ] nsys_report_db_20000_20_40.sqlite[2/7] [=============59%            ] nsys_report_db_20000_20_40.sqlite[2/7] [=============60%            ] nsys_report_db_20000_20_40.sqlite[2/7] [==============61%           ] nsys_report_db_20000_20_40.sqlite[2/7] [==============62%           ] nsys_report_db_20000_20_40.sqlite[2/7] [==============63%           ] nsys_report_db_20000_20_40.sqlite[2/7] [==============64%           ] nsys_report_db_20000_20_40.sqlite[2/7] [===============65%          ] nsys_report_db_20000_20_40.sqlite[2/7] [===============66%          ] nsys_report_db_20000_20_40.sqlite[2/7] [===============67%          ] nsys_report_db_20000_20_40.sqlite[2/7] [================68%         ] nsys_report_db_20000_20_40.sqlite[2/7] [================69%         ] nsys_report_db_20000_20_40.sqlite[2/7] [================70%         ] nsys_report_db_20000_20_40.sqlite[2/7] [================71%         ] nsys_report_db_20000_20_40.sqlite[2/7] [=================72%        ] nsys_report_db_20000_20_40.sqlite[2/7] [=================73%        ] nsys_report_db_20000_20_40.sqlite[2/7] [=================74%        ] nsys_report_db_20000_20_40.sqlite[2/7] [==================75%       ] nsys_report_db_20000_20_40.sqlite[2/7] [==================76%       ] nsys_report_db_20000_20_40.sqlite[2/7] [==================77%       ] nsys_report_db_20000_20_40.sqlite[2/7] [==================78%       ] nsys_report_db_20000_20_40.sqlite[2/7] [===================79%      ] nsys_report_db_20000_20_40.sqlite[2/7] [===================80%      ] nsys_report_db_20000_20_40.sqlite[2/7] [===================81%      ] nsys_report_db_20000_20_40.sqlite[2/7] [===================82%      ] nsys_report_db_20000_20_40.sqlite[2/7] [====================83%     ] nsys_report_db_20000_20_40.sqlite[2/7] [====================84%     ] nsys_report_db_20000_20_40.sqlite[2/7] [====================85%     ] nsys_report_db_20000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_20_40.sqlite[2/7] [======================90%   ] nsys_report_db_20000_20_40.sqlite[2/7] [======================91%   ] nsys_report_db_20000_20_40.sqlite[2/7] [======================92%   ] nsys_report_db_20000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_20_40.sqlite[2/7] [========================97% ] nsys_report_db_20000_20_40.sqlite[2/7] [========================98% ] nsys_report_db_20000_20_40.sqlite[2/7] [========================99% ] nsys_report_db_20000_20_40.sqlite[2/7] [========================100%] nsys_report_db_20000_20_40.sqlite[2/7] [========================100%] nsys_report_db_20000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        263482969          1  263482969.0  263482969.0  263482969  263482969          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        145141215          1  145141215.0  145141215.0  145141215  145141215          0.0  cudaFree                      
      1.1          1578132          6     263022.0     171497.5       4050     860592     311535.0  cudaMalloc                    
      0.2           276165        814        339.3        290.0        120       1380        180.7  cuGetProcAddress_v2           
      0.0            51111          2      25555.5      25555.5       2180      48931      33057.9  cudaStreamCreateWithFlags     
      0.0            26710         18       1483.9        480.0        390      16220       3699.1  cudaEventCreateWithFlags      
      0.0             7280          3       2426.7       2800.0        710       3770       1563.8  cuInit                        
      0.0             4150          3       1383.3        540.0        160       3450       1799.8  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        310        580        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 20 (num_steps = 40), identity_test = 0
Generating '/tmp/nsys-report-e030.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_20_40.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_20_40.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_20_40.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_20_40.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_40.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [1%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [2%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [3%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [4%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [5%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [6%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [7%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [8%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [9%                          ] nsys_report_fo_20000_20_40.sqlite[2/7] [10%                         ] nsys_report_fo_20000_20_40.sqlite[2/7] [11%                         ] nsys_report_fo_20000_20_40.sqlite[2/7] [12%                         ] nsys_report_fo_20000_20_40.sqlite[2/7] [13%                         ] nsys_report_fo_20000_20_40.sqlite[2/7] [14%                         ] nsys_report_fo_20000_20_40.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_20_40.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_20_40.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_20_40.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_20_40.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_20_40.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_20_40.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_20_40.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_20_40.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_20_40.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_20_40.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_20_40.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_20_40.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_20_40.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_20_40.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_20_40.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_20_40.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_20_40.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_20_40.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_20_40.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_20_40.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_20_40.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_20_40.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_20_40.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_20_40.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_20_40.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_20_40.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_20_40.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_20_40.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_20_40.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_20_40.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_20_40.sqlite[2/7] [============54%             ] nsys_report_fo_20000_20_40.sqlite[2/7] [============55%             ] nsys_report_fo_20000_20_40.sqlite[2/7] [============56%             ] nsys_report_fo_20000_20_40.sqlite[2/7] [============57%             ] nsys_report_fo_20000_20_40.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_20_40.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_20_40.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_20_40.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_20_40.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_20_40.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_20_40.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_20_40.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_20_40.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_20_40.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_20_40.sqlite[2/7] [================68%         ] nsys_report_fo_20000_20_40.sqlite[2/7] [================69%         ] nsys_report_fo_20000_20_40.sqlite[2/7] [================70%         ] nsys_report_fo_20000_20_40.sqlite[2/7] [================71%         ] nsys_report_fo_20000_20_40.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_20_40.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_20_40.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_20_40.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_20_40.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_20_40.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_20_40.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_20_40.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_20_40.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_20_40.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_20_40.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_20_40.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_20_40.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_20_40.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_20_40.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_20_40.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_20_40.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_20_40.sqlite[2/7] [========================97% ] nsys_report_fo_20000_20_40.sqlite[2/7] [========================98% ] nsys_report_fo_20000_20_40.sqlite[2/7] [========================99% ] nsys_report_fo_20000_20_40.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_40.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        283925452          1  283925452.0  283925452.0  283925452  283925452          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.7        163237387          1  163237387.0  163237387.0  163237387  163237387          0.0  cudaFree                      
      2.1          3436185         17     202128.5     237563.0       3860     301634      80001.6  cudaMalloc                    
      0.2           346334        814        425.5        400.0        120       1510        249.3  cuGetProcAddress_v2           
      0.0            40060          2      20030.0      20030.0       2100      37960      25356.8  cudaStreamCreateWithFlags     
      0.0            21000         18       1166.7        530.0        400      10180       2278.1  cudaEventCreateWithFlags      
      0.0             5330          3       1776.7       2150.0        580       2600       1060.5  cuInit                        
      0.0             4730          3       1576.7        490.0        170       4070       2165.2  cuModuleGetLoadingMode        
      0.0              820          2        410.0        410.0        290        530        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 20 (num_steps = 60)
number of batches= 3
Generating '/tmp/nsys-report-a53e.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_20_60.nsys-rep[1/7] [=====31%                    ] nsys_report_ia_20000_20_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_20_60.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_60.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [1%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [2%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [3%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [4%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [5%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [6%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [7%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [8%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [9%                          ] nsys_report_ia_20000_20_60.sqlite[2/7] [10%                         ] nsys_report_ia_20000_20_60.sqlite[2/7] [11%                         ] nsys_report_ia_20000_20_60.sqlite[2/7] [12%                         ] nsys_report_ia_20000_20_60.sqlite[2/7] [13%                         ] nsys_report_ia_20000_20_60.sqlite[2/7] [14%                         ] nsys_report_ia_20000_20_60.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_20_60.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_20_60.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_20_60.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_20_60.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_20_60.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_20_60.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_20_60.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_20_60.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_20_60.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_20_60.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_20_60.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_20_60.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_20_60.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_20_60.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_20_60.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_20_60.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_20_60.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_20_60.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_20_60.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_20_60.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_20_60.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_20_60.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_20_60.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_20_60.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_20_60.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_20_60.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_20_60.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_20_60.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_20_60.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_20_60.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_20_60.sqlite[2/7] [============54%             ] nsys_report_ia_20000_20_60.sqlite[2/7] [============55%             ] nsys_report_ia_20000_20_60.sqlite[2/7] [============56%             ] nsys_report_ia_20000_20_60.sqlite[2/7] [============57%             ] nsys_report_ia_20000_20_60.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_20_60.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_20_60.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_20_60.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_20_60.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_20_60.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_20_60.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_20_60.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_20_60.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_20_60.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_20_60.sqlite[2/7] [================68%         ] nsys_report_ia_20000_20_60.sqlite[2/7] [================69%         ] nsys_report_ia_20000_20_60.sqlite[2/7] [================70%         ] nsys_report_ia_20000_20_60.sqlite[2/7] [================71%         ] nsys_report_ia_20000_20_60.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_20_60.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_20_60.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_20_60.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_20_60.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_20_60.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_20_60.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_20_60.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_20_60.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_20_60.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_20_60.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_20_60.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_20_60.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_20_60.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_20_60.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_20_60.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_20_60.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_20_60.sqlite[2/7] [========================97% ] nsys_report_ia_20000_20_60.sqlite[2/7] [========================98% ] nsys_report_ia_20000_20_60.sqlite[2/7] [========================99% ] nsys_report_ia_20000_20_60.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_60.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        246575638          1  246575638.0  246575638.0  246575638  246575638          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        129484512          1  129484512.0  129484512.0  129484512  129484512          0.0  cudaFree                      
      1.2          1562781          6     260463.5     167267.0       3680     869382     315704.8  cudaMalloc                    
      0.3           341404        814        419.4        390.0        120       1750        246.2  cuGetProcAddress_v2           
      0.0            53211          2      26605.5      26605.5       2370      50841      34274.2  cudaStreamCreateWithFlags     
      0.0            20120         18       1117.8        540.0        400       9000       2001.2  cudaEventCreateWithFlags      
      0.0             7040          3       2346.7       2600.0        860       3580       1377.6  cuInit                        
      0.0             4750          3       1583.3        390.0        150       4210       2277.9  cuModuleGetLoadingMode        
      0.0             1200          2        600.0        600.0        420        780        254.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 20 (num_steps = 60)
number of batches= 3
Generating '/tmp/nsys-report-dc29.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_20_60.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_20_60.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_20_60.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_60.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [1%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [2%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [3%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [4%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [5%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [6%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [7%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [8%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [9%                          ] nsys_report_db_20000_20_60.sqlite[2/7] [10%                         ] nsys_report_db_20000_20_60.sqlite[2/7] [11%                         ] nsys_report_db_20000_20_60.sqlite[2/7] [12%                         ] nsys_report_db_20000_20_60.sqlite[2/7] [13%                         ] nsys_report_db_20000_20_60.sqlite[2/7] [14%                         ] nsys_report_db_20000_20_60.sqlite[2/7] [=15%                        ] nsys_report_db_20000_20_60.sqlite[2/7] [=16%                        ] nsys_report_db_20000_20_60.sqlite[2/7] [=17%                        ] nsys_report_db_20000_20_60.sqlite[2/7] [==18%                       ] nsys_report_db_20000_20_60.sqlite[2/7] [==19%                       ] nsys_report_db_20000_20_60.sqlite[2/7] [==20%                       ] nsys_report_db_20000_20_60.sqlite[2/7] [==21%                       ] nsys_report_db_20000_20_60.sqlite[2/7] [===22%                      ] nsys_report_db_20000_20_60.sqlite[2/7] [===23%                      ] nsys_report_db_20000_20_60.sqlite[2/7] [===24%                      ] nsys_report_db_20000_20_60.sqlite[2/7] [====25%                     ] nsys_report_db_20000_20_60.sqlite[2/7] [====26%                     ] nsys_report_db_20000_20_60.sqlite[2/7] [====27%                     ] nsys_report_db_20000_20_60.sqlite[2/7] [====28%                     ] nsys_report_db_20000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_20_60.sqlite[2/7] [======33%                   ] nsys_report_db_20000_20_60.sqlite[2/7] [======34%                   ] nsys_report_db_20000_20_60.sqlite[2/7] [======35%                   ] nsys_report_db_20000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_20_60.sqlite[2/7] [========40%                 ] nsys_report_db_20000_20_60.sqlite[2/7] [========41%                 ] nsys_report_db_20000_20_60.sqlite[2/7] [========42%                 ] nsys_report_db_20000_20_60.sqlite[2/7] [=========43%                ] nsys_report_db_20000_20_60.sqlite[2/7] [=========44%                ] nsys_report_db_20000_20_60.sqlite[2/7] [=========45%                ] nsys_report_db_20000_20_60.sqlite[2/7] [=========46%                ] nsys_report_db_20000_20_60.sqlite[2/7] [==========47%               ] nsys_report_db_20000_20_60.sqlite[2/7] [==========48%               ] nsys_report_db_20000_20_60.sqlite[2/7] [==========49%               ] nsys_report_db_20000_20_60.sqlite[2/7] [===========50%              ] nsys_report_db_20000_20_60.sqlite[2/7] [===========51%              ] nsys_report_db_20000_20_60.sqlite[2/7] [===========52%              ] nsys_report_db_20000_20_60.sqlite[2/7] [===========53%              ] nsys_report_db_20000_20_60.sqlite[2/7] [============54%             ] nsys_report_db_20000_20_60.sqlite[2/7] [============55%             ] nsys_report_db_20000_20_60.sqlite[2/7] [============56%             ] nsys_report_db_20000_20_60.sqlite[2/7] [============57%             ] nsys_report_db_20000_20_60.sqlite[2/7] [=============58%            ] nsys_report_db_20000_20_60.sqlite[2/7] [=============59%            ] nsys_report_db_20000_20_60.sqlite[2/7] [=============60%            ] nsys_report_db_20000_20_60.sqlite[2/7] [==============61%           ] nsys_report_db_20000_20_60.sqlite[2/7] [==============62%           ] nsys_report_db_20000_20_60.sqlite[2/7] [==============63%           ] nsys_report_db_20000_20_60.sqlite[2/7] [==============64%           ] nsys_report_db_20000_20_60.sqlite[2/7] [===============65%          ] nsys_report_db_20000_20_60.sqlite[2/7] [===============66%          ] nsys_report_db_20000_20_60.sqlite[2/7] [===============67%          ] nsys_report_db_20000_20_60.sqlite[2/7] [================68%         ] nsys_report_db_20000_20_60.sqlite[2/7] [================69%         ] nsys_report_db_20000_20_60.sqlite[2/7] [================70%         ] nsys_report_db_20000_20_60.sqlite[2/7] [================71%         ] nsys_report_db_20000_20_60.sqlite[2/7] [=================72%        ] nsys_report_db_20000_20_60.sqlite[2/7] [=================73%        ] nsys_report_db_20000_20_60.sqlite[2/7] [=================74%        ] nsys_report_db_20000_20_60.sqlite[2/7] [==================75%       ] nsys_report_db_20000_20_60.sqlite[2/7] [==================76%       ] nsys_report_db_20000_20_60.sqlite[2/7] [==================77%       ] nsys_report_db_20000_20_60.sqlite[2/7] [==================78%       ] nsys_report_db_20000_20_60.sqlite[2/7] [===================79%      ] nsys_report_db_20000_20_60.sqlite[2/7] [===================80%      ] nsys_report_db_20000_20_60.sqlite[2/7] [===================81%      ] nsys_report_db_20000_20_60.sqlite[2/7] [===================82%      ] nsys_report_db_20000_20_60.sqlite[2/7] [====================83%     ] nsys_report_db_20000_20_60.sqlite[2/7] [====================84%     ] nsys_report_db_20000_20_60.sqlite[2/7] [====================85%     ] nsys_report_db_20000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_20_60.sqlite[2/7] [======================90%   ] nsys_report_db_20000_20_60.sqlite[2/7] [======================91%   ] nsys_report_db_20000_20_60.sqlite[2/7] [======================92%   ] nsys_report_db_20000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_20_60.sqlite[2/7] [========================97% ] nsys_report_db_20000_20_60.sqlite[2/7] [========================98% ] nsys_report_db_20000_20_60.sqlite[2/7] [========================99% ] nsys_report_db_20000_20_60.sqlite[2/7] [========================100%] nsys_report_db_20000_20_60.sqlite[2/7] [========================100%] nsys_report_db_20000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        273264194          1  273264194.0  273264194.0  273264194  273264194          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        153273840          1  153273840.0  153273840.0  153273840  153273840          0.0  cudaFree                      
      1.0          1600421          6     266736.8     173662.0       4090     870272     315789.2  cudaMalloc                    
      0.2           310675        814        381.7        320.0        110       1410        211.4  cuGetProcAddress_v2           
      0.0            44321          2      22160.5      22160.5       2050      42271      28440.5  cudaStreamCreateWithFlags     
      0.0            25070         18       1392.8        435.0        370      13800       3147.6  cudaEventCreateWithFlags      
      0.0             7980          3       2660.0       3510.0        740       3730       1666.4  cuInit                        
      0.0             4170          3       1390.0        480.0        300       3390       1734.4  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        320        560        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 20 (num_steps = 60), identity_test = 0
Generating '/tmp/nsys-report-52e3.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_20_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_20_60.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_20_60.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_60.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [1%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [2%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [3%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [4%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [5%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [6%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [7%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [8%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [9%                          ] nsys_report_fo_20000_20_60.sqlite[2/7] [10%                         ] nsys_report_fo_20000_20_60.sqlite[2/7] [11%                         ] nsys_report_fo_20000_20_60.sqlite[2/7] [12%                         ] nsys_report_fo_20000_20_60.sqlite[2/7] [13%                         ] nsys_report_fo_20000_20_60.sqlite[2/7] [14%                         ] nsys_report_fo_20000_20_60.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_20_60.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_20_60.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_20_60.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_20_60.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_20_60.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_20_60.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_20_60.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_20_60.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_20_60.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_20_60.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_20_60.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_20_60.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_20_60.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_20_60.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_20_60.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_20_60.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_20_60.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_20_60.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_20_60.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_20_60.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_20_60.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_20_60.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_20_60.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_20_60.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_20_60.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_20_60.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_20_60.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_20_60.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_20_60.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_20_60.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_20_60.sqlite[2/7] [============54%             ] nsys_report_fo_20000_20_60.sqlite[2/7] [============55%             ] nsys_report_fo_20000_20_60.sqlite[2/7] [============56%             ] nsys_report_fo_20000_20_60.sqlite[2/7] [============57%             ] nsys_report_fo_20000_20_60.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_20_60.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_20_60.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_20_60.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_20_60.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_20_60.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_20_60.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_20_60.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_20_60.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_20_60.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_20_60.sqlite[2/7] [================68%         ] nsys_report_fo_20000_20_60.sqlite[2/7] [================69%         ] nsys_report_fo_20000_20_60.sqlite[2/7] [================70%         ] nsys_report_fo_20000_20_60.sqlite[2/7] [================71%         ] nsys_report_fo_20000_20_60.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_20_60.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_20_60.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_20_60.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_20_60.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_20_60.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_20_60.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_20_60.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_20_60.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_20_60.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_20_60.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_20_60.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_20_60.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_20_60.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_20_60.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_20_60.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_20_60.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_20_60.sqlite[2/7] [========================97% ] nsys_report_fo_20000_20_60.sqlite[2/7] [========================98% ] nsys_report_fo_20000_20_60.sqlite[2/7] [========================99% ] nsys_report_fo_20000_20_60.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_60.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        286578249          1  286578249.0  286578249.0  286578249  286578249          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.7        162793906          1  162793906.0  162793906.0  162793906  162793906          0.0  cudaFree                      
      2.0          3389016         17     199353.9     229623.0       4201     294294      77863.6  cudaMalloc                    
      0.2           327575        814        402.4        370.0        110       1690        244.2  cuGetProcAddress_v2           
      0.0            38830          2      19415.0      19415.0       1810      37020      24897.2  cudaStreamCreateWithFlags     
      0.0            28200         18       1566.7        500.0        400      17210       3928.9  cudaEventCreateWithFlags      
      0.0             6550          3       2183.3       2650.0        690       3210       1323.2  cuInit                        
      0.0             4510          3       1503.3        560.0        400       3550       1774.3  cuModuleGetLoadingMode        
      0.0             1070          2        535.0        535.0        460        610        106.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 20 (num_steps = 80)
number of batches= 4
Generating '/tmp/nsys-report-0e74.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_20_80.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_20_80.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_20_80.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_20_80.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_80.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [1%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [2%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [3%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [4%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [5%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [6%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [7%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [8%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [9%                          ] nsys_report_ia_20000_20_80.sqlite[2/7] [10%                         ] nsys_report_ia_20000_20_80.sqlite[2/7] [11%                         ] nsys_report_ia_20000_20_80.sqlite[2/7] [12%                         ] nsys_report_ia_20000_20_80.sqlite[2/7] [13%                         ] nsys_report_ia_20000_20_80.sqlite[2/7] [14%                         ] nsys_report_ia_20000_20_80.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_20_80.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_20_80.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_20_80.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_20_80.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_20_80.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_20_80.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_20_80.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_20_80.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_20_80.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_20_80.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_20_80.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_20_80.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_20_80.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_20_80.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_20_80.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_20_80.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_20_80.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_20_80.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_20_80.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_20_80.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_20_80.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_20_80.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_20_80.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_20_80.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_20_80.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_20_80.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_20_80.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_20_80.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_20_80.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_20_80.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_20_80.sqlite[2/7] [============54%             ] nsys_report_ia_20000_20_80.sqlite[2/7] [============55%             ] nsys_report_ia_20000_20_80.sqlite[2/7] [============56%             ] nsys_report_ia_20000_20_80.sqlite[2/7] [============57%             ] nsys_report_ia_20000_20_80.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_20_80.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_20_80.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_20_80.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_20_80.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_20_80.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_20_80.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_20_80.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_20_80.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_20_80.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_20_80.sqlite[2/7] [================68%         ] nsys_report_ia_20000_20_80.sqlite[2/7] [================69%         ] nsys_report_ia_20000_20_80.sqlite[2/7] [================70%         ] nsys_report_ia_20000_20_80.sqlite[2/7] [================71%         ] nsys_report_ia_20000_20_80.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_20_80.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_20_80.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_20_80.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_20_80.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_20_80.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_20_80.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_20_80.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_20_80.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_20_80.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_20_80.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_20_80.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_20_80.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_20_80.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_20_80.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_20_80.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_20_80.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_20_80.sqlite[2/7] [========================97% ] nsys_report_ia_20000_20_80.sqlite[2/7] [========================98% ] nsys_report_ia_20000_20_80.sqlite[2/7] [========================99% ] nsys_report_ia_20000_20_80.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_80.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245010380          1  245010380.0  245010380.0  245010380  245010380          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        129745823          1  129745823.0  129745823.0  129745823  129745823          0.0  cudaFree                      
      1.2          1556872          6     259478.7     165882.5       3750     863922     314110.7  cudaMalloc                    
      0.2           273744        814        336.3        290.0        120       1400        175.3  cuGetProcAddress_v2           
      0.0            32951          2      16475.5      16475.5       1920      31031      20584.6  cudaStreamCreateWithFlags     
      0.0            25890         18       1438.3        515.0        400      15500       3524.8  cudaEventCreateWithFlags      
      0.0             4690          3       1563.3       1490.0        710       2490        892.3  cuInit                        
      0.0             3841          3       1280.3        280.0        250       3311       1758.7  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        320        610        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 20 (num_steps = 80)
number of batches= 4
Generating '/tmp/nsys-report-25b4.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_20_80.nsys-rep[1/7] [=====31%                    ] nsys_report_db_20000_20_80.nsys-rep[1/7] [===============65%          ] nsys_report_db_20000_20_80.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_20_80.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_80.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [1%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [2%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [3%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [4%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [5%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [6%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [7%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [8%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [9%                          ] nsys_report_db_20000_20_80.sqlite[2/7] [10%                         ] nsys_report_db_20000_20_80.sqlite[2/7] [11%                         ] nsys_report_db_20000_20_80.sqlite[2/7] [12%                         ] nsys_report_db_20000_20_80.sqlite[2/7] [13%                         ] nsys_report_db_20000_20_80.sqlite[2/7] [14%                         ] nsys_report_db_20000_20_80.sqlite[2/7] [=15%                        ] nsys_report_db_20000_20_80.sqlite[2/7] [=16%                        ] nsys_report_db_20000_20_80.sqlite[2/7] [=17%                        ] nsys_report_db_20000_20_80.sqlite[2/7] [==18%                       ] nsys_report_db_20000_20_80.sqlite[2/7] [==19%                       ] nsys_report_db_20000_20_80.sqlite[2/7] [==20%                       ] nsys_report_db_20000_20_80.sqlite[2/7] [==21%                       ] nsys_report_db_20000_20_80.sqlite[2/7] [===22%                      ] nsys_report_db_20000_20_80.sqlite[2/7] [===23%                      ] nsys_report_db_20000_20_80.sqlite[2/7] [===24%                      ] nsys_report_db_20000_20_80.sqlite[2/7] [====25%                     ] nsys_report_db_20000_20_80.sqlite[2/7] [====26%                     ] nsys_report_db_20000_20_80.sqlite[2/7] [====27%                     ] nsys_report_db_20000_20_80.sqlite[2/7] [====28%                     ] nsys_report_db_20000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_20_80.sqlite[2/7] [======33%                   ] nsys_report_db_20000_20_80.sqlite[2/7] [======34%                   ] nsys_report_db_20000_20_80.sqlite[2/7] [======35%                   ] nsys_report_db_20000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_20_80.sqlite[2/7] [========40%                 ] nsys_report_db_20000_20_80.sqlite[2/7] [========41%                 ] nsys_report_db_20000_20_80.sqlite[2/7] [========42%                 ] nsys_report_db_20000_20_80.sqlite[2/7] [=========43%                ] nsys_report_db_20000_20_80.sqlite[2/7] [=========44%                ] nsys_report_db_20000_20_80.sqlite[2/7] [=========45%                ] nsys_report_db_20000_20_80.sqlite[2/7] [=========46%                ] nsys_report_db_20000_20_80.sqlite[2/7] [==========47%               ] nsys_report_db_20000_20_80.sqlite[2/7] [==========48%               ] nsys_report_db_20000_20_80.sqlite[2/7] [==========49%               ] nsys_report_db_20000_20_80.sqlite[2/7] [===========50%              ] nsys_report_db_20000_20_80.sqlite[2/7] [===========51%              ] nsys_report_db_20000_20_80.sqlite[2/7] [===========52%              ] nsys_report_db_20000_20_80.sqlite[2/7] [===========53%              ] nsys_report_db_20000_20_80.sqlite[2/7] [============54%             ] nsys_report_db_20000_20_80.sqlite[2/7] [============55%             ] nsys_report_db_20000_20_80.sqlite[2/7] [============56%             ] nsys_report_db_20000_20_80.sqlite[2/7] [============57%             ] nsys_report_db_20000_20_80.sqlite[2/7] [=============58%            ] nsys_report_db_20000_20_80.sqlite[2/7] [=============59%            ] nsys_report_db_20000_20_80.sqlite[2/7] [=============60%            ] nsys_report_db_20000_20_80.sqlite[2/7] [==============61%           ] nsys_report_db_20000_20_80.sqlite[2/7] [==============62%           ] nsys_report_db_20000_20_80.sqlite[2/7] [==============63%           ] nsys_report_db_20000_20_80.sqlite[2/7] [==============64%           ] nsys_report_db_20000_20_80.sqlite[2/7] [===============65%          ] nsys_report_db_20000_20_80.sqlite[2/7] [===============66%          ] nsys_report_db_20000_20_80.sqlite[2/7] [===============67%          ] nsys_report_db_20000_20_80.sqlite[2/7] [================68%         ] nsys_report_db_20000_20_80.sqlite[2/7] [================69%         ] nsys_report_db_20000_20_80.sqlite[2/7] [================70%         ] nsys_report_db_20000_20_80.sqlite[2/7] [================71%         ] nsys_report_db_20000_20_80.sqlite[2/7] [=================72%        ] nsys_report_db_20000_20_80.sqlite[2/7] [=================73%        ] nsys_report_db_20000_20_80.sqlite[2/7] [=================74%        ] nsys_report_db_20000_20_80.sqlite[2/7] [==================75%       ] nsys_report_db_20000_20_80.sqlite[2/7] [==================76%       ] nsys_report_db_20000_20_80.sqlite[2/7] [==================77%       ] nsys_report_db_20000_20_80.sqlite[2/7] [==================78%       ] nsys_report_db_20000_20_80.sqlite[2/7] [===================79%      ] nsys_report_db_20000_20_80.sqlite[2/7] [===================80%      ] nsys_report_db_20000_20_80.sqlite[2/7] [===================81%      ] nsys_report_db_20000_20_80.sqlite[2/7] [===================82%      ] nsys_report_db_20000_20_80.sqlite[2/7] [====================83%     ] nsys_report_db_20000_20_80.sqlite[2/7] [====================84%     ] nsys_report_db_20000_20_80.sqlite[2/7] [====================85%     ] nsys_report_db_20000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_20_80.sqlite[2/7] [======================90%   ] nsys_report_db_20000_20_80.sqlite[2/7] [======================91%   ] nsys_report_db_20000_20_80.sqlite[2/7] [======================92%   ] nsys_report_db_20000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_20_80.sqlite[2/7] [========================97% ] nsys_report_db_20000_20_80.sqlite[2/7] [========================98% ] nsys_report_db_20000_20_80.sqlite[2/7] [========================99% ] nsys_report_db_20000_20_80.sqlite[2/7] [========================100%] nsys_report_db_20000_20_80.sqlite[2/7] [========================100%] nsys_report_db_20000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        254533994          1  254533994.0  254533994.0  254533994  254533994          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        137180510          1  137180510.0  137180510.0  137180510  137180510          0.0  cudaFree                      
      1.1          1577840          6     262973.3     168142.0       4180     874681     317477.4  cudaMalloc                    
      0.2           345446        814        424.4        390.0        120       1610        247.0  cuGetProcAddress_v2           
      0.0            44151          2      22075.5      22075.5       2150      42001      28178.9  cudaStreamCreateWithFlags     
      0.0            20781         18       1154.5        500.0        380       9340       2111.3  cudaEventCreateWithFlags      
      0.0             7140          3       2380.0       2750.0        750       3640       1480.1  cuInit                        
      0.0             4530          3       1510.0        400.0        280       3850       2027.4  cuModuleGetLoadingMode        
      0.0             1090          2        545.0        545.0        330        760        304.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 20 (num_steps = 80), identity_test = 0
Generating '/tmp/nsys-report-4324.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_20_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_20_80.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_20_80.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_20_80.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_80.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [1%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [2%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [3%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [4%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [5%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [6%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [7%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [8%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [9%                          ] nsys_report_fo_20000_20_80.sqlite[2/7] [10%                         ] nsys_report_fo_20000_20_80.sqlite[2/7] [11%                         ] nsys_report_fo_20000_20_80.sqlite[2/7] [12%                         ] nsys_report_fo_20000_20_80.sqlite[2/7] [13%                         ] nsys_report_fo_20000_20_80.sqlite[2/7] [14%                         ] nsys_report_fo_20000_20_80.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_20_80.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_20_80.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_20_80.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_20_80.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_20_80.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_20_80.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_20_80.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_20_80.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_20_80.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_20_80.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_20_80.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_20_80.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_20_80.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_20_80.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_20_80.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_20_80.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_20_80.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_20_80.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_20_80.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_20_80.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_20_80.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_20_80.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_20_80.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_20_80.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_20_80.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_20_80.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_20_80.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_20_80.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_20_80.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_20_80.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_20_80.sqlite[2/7] [============54%             ] nsys_report_fo_20000_20_80.sqlite[2/7] [============55%             ] nsys_report_fo_20000_20_80.sqlite[2/7] [============56%             ] nsys_report_fo_20000_20_80.sqlite[2/7] [============57%             ] nsys_report_fo_20000_20_80.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_20_80.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_20_80.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_20_80.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_20_80.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_20_80.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_20_80.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_20_80.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_20_80.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_20_80.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_20_80.sqlite[2/7] [================68%         ] nsys_report_fo_20000_20_80.sqlite[2/7] [================69%         ] nsys_report_fo_20000_20_80.sqlite[2/7] [================70%         ] nsys_report_fo_20000_20_80.sqlite[2/7] [================71%         ] nsys_report_fo_20000_20_80.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_20_80.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_20_80.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_20_80.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_20_80.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_20_80.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_20_80.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_20_80.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_20_80.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_20_80.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_20_80.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_20_80.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_20_80.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_20_80.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_20_80.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_20_80.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_20_80.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_20_80.sqlite[2/7] [========================97% ] nsys_report_fo_20000_20_80.sqlite[2/7] [========================98% ] nsys_report_fo_20000_20_80.sqlite[2/7] [========================99% ] nsys_report_fo_20000_20_80.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_80.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        285293672          1  285293672.0  285293672.0  285293672  285293672          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.7        164405713          1  164405713.0  164405713.0  164405713  164405713          0.0  cudaFree                      
      2.1          3458796         17     203458.6     239353.0       3870     292684      81141.8  cudaMalloc                    
      0.2           268382        814        329.7        280.0        120       1530        182.6  cuGetProcAddress_v2           
      0.0            43850          2      21925.0      21925.0       2190      41660      27909.5  cudaStreamCreateWithFlags     
      0.0            19741         18       1096.7        515.0        400       8680       1947.9  cudaEventCreateWithFlags      
      0.0             5460          3       1820.0       1740.0        610       3110       1251.9  cuInit                        
      0.0             3450          3       1150.0        400.0        160       2890       1511.7  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        310        610        212.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 20 (num_steps = 100)
number of batches= 5
Generating '/tmp/nsys-report-8b3c.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_20_100.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_20_100.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_20_100.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_20_100.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_100.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [1%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [2%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [3%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [4%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [5%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [6%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [7%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [8%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [9%                          ] nsys_report_ia_20000_20_100.sqlite[2/7] [10%                         ] nsys_report_ia_20000_20_100.sqlite[2/7] [11%                         ] nsys_report_ia_20000_20_100.sqlite[2/7] [12%                         ] nsys_report_ia_20000_20_100.sqlite[2/7] [13%                         ] nsys_report_ia_20000_20_100.sqlite[2/7] [14%                         ] nsys_report_ia_20000_20_100.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_20_100.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_20_100.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_20_100.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_20_100.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_20_100.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_20_100.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_20_100.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_20_100.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_20_100.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_20_100.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_20_100.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_20_100.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_20_100.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_20_100.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_20_100.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_20_100.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_20_100.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_20_100.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_20_100.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_20_100.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_20_100.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_20_100.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_20_100.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_20_100.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_20_100.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_20_100.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_20_100.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_20_100.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_20_100.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_20_100.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_20_100.sqlite[2/7] [============54%             ] nsys_report_ia_20000_20_100.sqlite[2/7] [============55%             ] nsys_report_ia_20000_20_100.sqlite[2/7] [============56%             ] nsys_report_ia_20000_20_100.sqlite[2/7] [============57%             ] nsys_report_ia_20000_20_100.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_20_100.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_20_100.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_20_100.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_20_100.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_20_100.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_20_100.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_20_100.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_20_100.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_20_100.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_20_100.sqlite[2/7] [================68%         ] nsys_report_ia_20000_20_100.sqlite[2/7] [================69%         ] nsys_report_ia_20000_20_100.sqlite[2/7] [================70%         ] nsys_report_ia_20000_20_100.sqlite[2/7] [================71%         ] nsys_report_ia_20000_20_100.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_20_100.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_20_100.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_20_100.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_20_100.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_20_100.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_20_100.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_20_100.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_20_100.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_20_100.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_20_100.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_20_100.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_20_100.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_20_100.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_20_100.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_20_100.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_20_100.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_20_100.sqlite[2/7] [========================97% ] nsys_report_ia_20000_20_100.sqlite[2/7] [========================98% ] nsys_report_ia_20000_20_100.sqlite[2/7] [========================99% ] nsys_report_ia_20000_20_100.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_100.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        244792588          1  244792588.0  244792588.0  244792588  244792588          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        132714007          1  132714007.0  132714007.0  132714007  132714007          0.0  cudaFree                      
      1.2          1559871          6     259978.5     169497.0       4040     860572     312471.2  cudaMalloc                    
      0.2           335894        814        412.6        380.0        120       1740        245.7  cuGetProcAddress_v2           
      0.0            49901          2      24950.5      24950.5       2120      47781      32287.2  cudaStreamCreateWithFlags     
      0.0            25131         18       1396.2        505.0        400      14271       3243.2  cudaEventCreateWithFlags      
      0.0             6700          3       2233.3       2420.0        640       3640       1508.7  cuInit                        
      0.0             5130          3       1710.0        520.0        380       4230       2183.5  cuModuleGetLoadingMode        
      0.0             1040          2        520.0        520.0        450        590         99.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 20 (num_steps = 100)
number of batches= 5
Generating '/tmp/nsys-report-5ab4.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_20_100.nsys-rep[1/7] [=====30%                    ] nsys_report_db_20000_20_100.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_20_100.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_20_100.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_100.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [1%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [2%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [3%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [4%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [5%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [6%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [7%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [8%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [9%                          ] nsys_report_db_20000_20_100.sqlite[2/7] [10%                         ] nsys_report_db_20000_20_100.sqlite[2/7] [11%                         ] nsys_report_db_20000_20_100.sqlite[2/7] [12%                         ] nsys_report_db_20000_20_100.sqlite[2/7] [13%                         ] nsys_report_db_20000_20_100.sqlite[2/7] [14%                         ] nsys_report_db_20000_20_100.sqlite[2/7] [=15%                        ] nsys_report_db_20000_20_100.sqlite[2/7] [=16%                        ] nsys_report_db_20000_20_100.sqlite[2/7] [=17%                        ] nsys_report_db_20000_20_100.sqlite[2/7] [==18%                       ] nsys_report_db_20000_20_100.sqlite[2/7] [==19%                       ] nsys_report_db_20000_20_100.sqlite[2/7] [==20%                       ] nsys_report_db_20000_20_100.sqlite[2/7] [==21%                       ] nsys_report_db_20000_20_100.sqlite[2/7] [===22%                      ] nsys_report_db_20000_20_100.sqlite[2/7] [===23%                      ] nsys_report_db_20000_20_100.sqlite[2/7] [===24%                      ] nsys_report_db_20000_20_100.sqlite[2/7] [====25%                     ] nsys_report_db_20000_20_100.sqlite[2/7] [====26%                     ] nsys_report_db_20000_20_100.sqlite[2/7] [====27%                     ] nsys_report_db_20000_20_100.sqlite[2/7] [====28%                     ] nsys_report_db_20000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_20_100.sqlite[2/7] [======33%                   ] nsys_report_db_20000_20_100.sqlite[2/7] [======34%                   ] nsys_report_db_20000_20_100.sqlite[2/7] [======35%                   ] nsys_report_db_20000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_20_100.sqlite[2/7] [========40%                 ] nsys_report_db_20000_20_100.sqlite[2/7] [========41%                 ] nsys_report_db_20000_20_100.sqlite[2/7] [========42%                 ] nsys_report_db_20000_20_100.sqlite[2/7] [=========43%                ] nsys_report_db_20000_20_100.sqlite[2/7] [=========44%                ] nsys_report_db_20000_20_100.sqlite[2/7] [=========45%                ] nsys_report_db_20000_20_100.sqlite[2/7] [=========46%                ] nsys_report_db_20000_20_100.sqlite[2/7] [==========47%               ] nsys_report_db_20000_20_100.sqlite[2/7] [==========48%               ] nsys_report_db_20000_20_100.sqlite[2/7] [==========49%               ] nsys_report_db_20000_20_100.sqlite[2/7] [===========50%              ] nsys_report_db_20000_20_100.sqlite[2/7] [===========51%              ] nsys_report_db_20000_20_100.sqlite[2/7] [===========52%              ] nsys_report_db_20000_20_100.sqlite[2/7] [===========53%              ] nsys_report_db_20000_20_100.sqlite[2/7] [============54%             ] nsys_report_db_20000_20_100.sqlite[2/7] [============55%             ] nsys_report_db_20000_20_100.sqlite[2/7] [============56%             ] nsys_report_db_20000_20_100.sqlite[2/7] [============57%             ] nsys_report_db_20000_20_100.sqlite[2/7] [=============58%            ] nsys_report_db_20000_20_100.sqlite[2/7] [=============59%            ] nsys_report_db_20000_20_100.sqlite[2/7] [=============60%            ] nsys_report_db_20000_20_100.sqlite[2/7] [==============61%           ] nsys_report_db_20000_20_100.sqlite[2/7] [==============62%           ] nsys_report_db_20000_20_100.sqlite[2/7] [==============63%           ] nsys_report_db_20000_20_100.sqlite[2/7] [==============64%           ] nsys_report_db_20000_20_100.sqlite[2/7] [===============65%          ] nsys_report_db_20000_20_100.sqlite[2/7] [===============66%          ] nsys_report_db_20000_20_100.sqlite[2/7] [===============67%          ] nsys_report_db_20000_20_100.sqlite[2/7] [================68%         ] nsys_report_db_20000_20_100.sqlite[2/7] [================69%         ] nsys_report_db_20000_20_100.sqlite[2/7] [================70%         ] nsys_report_db_20000_20_100.sqlite[2/7] [================71%         ] nsys_report_db_20000_20_100.sqlite[2/7] [=================72%        ] nsys_report_db_20000_20_100.sqlite[2/7] [=================73%        ] nsys_report_db_20000_20_100.sqlite[2/7] [=================74%        ] nsys_report_db_20000_20_100.sqlite[2/7] [==================75%       ] nsys_report_db_20000_20_100.sqlite[2/7] [==================76%       ] nsys_report_db_20000_20_100.sqlite[2/7] [==================77%       ] nsys_report_db_20000_20_100.sqlite[2/7] [==================78%       ] nsys_report_db_20000_20_100.sqlite[2/7] [===================79%      ] nsys_report_db_20000_20_100.sqlite[2/7] [===================80%      ] nsys_report_db_20000_20_100.sqlite[2/7] [===================81%      ] nsys_report_db_20000_20_100.sqlite[2/7] [===================82%      ] nsys_report_db_20000_20_100.sqlite[2/7] [====================83%     ] nsys_report_db_20000_20_100.sqlite[2/7] [====================84%     ] nsys_report_db_20000_20_100.sqlite[2/7] [====================85%     ] nsys_report_db_20000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_20_100.sqlite[2/7] [======================90%   ] nsys_report_db_20000_20_100.sqlite[2/7] [======================91%   ] nsys_report_db_20000_20_100.sqlite[2/7] [======================92%   ] nsys_report_db_20000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_20_100.sqlite[2/7] [========================97% ] nsys_report_db_20000_20_100.sqlite[2/7] [========================98% ] nsys_report_db_20000_20_100.sqlite[2/7] [========================99% ] nsys_report_db_20000_20_100.sqlite[2/7] [========================100%] nsys_report_db_20000_20_100.sqlite[2/7] [========================100%] nsys_report_db_20000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        281764051          1  281764051.0  281764051.0  281764051  281764051          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        161958898          1  161958898.0  161958898.0  161958898  161958898          0.0  cudaFree                      
      1.0          1583981          6     263996.8     174352.0       3730     869152     315549.9  cudaMalloc                    
      0.2           275711        814        338.7        290.0        120       1500        179.7  cuGetProcAddress_v2           
      0.0            40301          2      20150.5      20150.5       1770      38531      25994.0  cudaStreamCreateWithFlags     
      0.0            20541         18       1141.2        490.0        390      10091       2265.3  cudaEventCreateWithFlags      
      0.0             6170          3       2056.7       2250.0        670       3250       1300.8  cuInit                        
      0.0             3380          3       1126.7        250.0        170       2960       1588.2  cuModuleGetLoadingMode        
      0.0             1020          2        510.0        510.0        350        670        226.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 20 (num_steps = 100), identity_test = 0
Generating '/tmp/nsys-report-e1a5.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_20_100.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_20_100.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_20_100.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_20_100.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_100.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [1%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [2%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [3%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [4%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [5%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [6%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [7%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [8%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [9%                          ] nsys_report_fo_20000_20_100.sqlite[2/7] [10%                         ] nsys_report_fo_20000_20_100.sqlite[2/7] [11%                         ] nsys_report_fo_20000_20_100.sqlite[2/7] [12%                         ] nsys_report_fo_20000_20_100.sqlite[2/7] [13%                         ] nsys_report_fo_20000_20_100.sqlite[2/7] [14%                         ] nsys_report_fo_20000_20_100.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_20_100.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_20_100.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_20_100.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_20_100.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_20_100.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_20_100.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_20_100.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_20_100.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_20_100.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_20_100.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_20_100.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_20_100.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_20_100.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_20_100.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_20_100.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_20_100.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_20_100.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_20_100.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_20_100.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_20_100.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_20_100.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_20_100.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_20_100.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_20_100.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_20_100.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_20_100.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_20_100.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_20_100.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_20_100.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_20_100.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_20_100.sqlite[2/7] [============54%             ] nsys_report_fo_20000_20_100.sqlite[2/7] [============55%             ] nsys_report_fo_20000_20_100.sqlite[2/7] [============56%             ] nsys_report_fo_20000_20_100.sqlite[2/7] [============57%             ] nsys_report_fo_20000_20_100.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_20_100.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_20_100.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_20_100.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_20_100.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_20_100.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_20_100.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_20_100.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_20_100.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_20_100.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_20_100.sqlite[2/7] [================68%         ] nsys_report_fo_20000_20_100.sqlite[2/7] [================69%         ] nsys_report_fo_20000_20_100.sqlite[2/7] [================70%         ] nsys_report_fo_20000_20_100.sqlite[2/7] [================71%         ] nsys_report_fo_20000_20_100.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_20_100.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_20_100.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_20_100.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_20_100.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_20_100.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_20_100.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_20_100.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_20_100.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_20_100.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_20_100.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_20_100.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_20_100.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_20_100.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_20_100.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_20_100.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_20_100.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_20_100.sqlite[2/7] [========================97% ] nsys_report_fo_20000_20_100.sqlite[2/7] [========================98% ] nsys_report_fo_20000_20_100.sqlite[2/7] [========================99% ] nsys_report_fo_20000_20_100.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_100.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        276560739          1  276560739.0  276560739.0  276560739  276560739          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.6        156413832          1  156413832.0  156413832.0  156413832  156413832          0.0  cudaFree                      
      2.1          3426484         17     201557.9     234134.0       4140     306454      79258.5  cudaMalloc                    
      0.2           338013        814        415.2        390.0        130       1710        241.2  cuGetProcAddress_v2           
      0.0            39931          2      19965.5      19965.5       1980      37951      25435.3  cudaStreamCreateWithFlags     
      0.0            19721         18       1095.6        500.0        380       8880       1982.1  cudaEventCreateWithFlags      
      0.0             6660          3       2220.0       2480.0        700       3480       1408.1  cuInit                        
      0.0             4300          3       1433.3        380.0        300       3620       1894.1  cuModuleGetLoadingMode        
      0.0              860          2        430.0        430.0        310        550        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 20000, batch_size = 20 (num_steps = 150)
number of batches= 8
Generating '/tmp/nsys-report-71a6.qdstrm'
[1/7] [0%                          ] nsys_report_ia_20000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_20000_20_150.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_20000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_ia_20000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_20000_20_150.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_150.nsys-rep[1/7] [========================100%] nsys_report_ia_20000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [1%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [2%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [3%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [4%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [5%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [6%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [7%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [8%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [9%                          ] nsys_report_ia_20000_20_150.sqlite[2/7] [10%                         ] nsys_report_ia_20000_20_150.sqlite[2/7] [11%                         ] nsys_report_ia_20000_20_150.sqlite[2/7] [12%                         ] nsys_report_ia_20000_20_150.sqlite[2/7] [13%                         ] nsys_report_ia_20000_20_150.sqlite[2/7] [14%                         ] nsys_report_ia_20000_20_150.sqlite[2/7] [=15%                        ] nsys_report_ia_20000_20_150.sqlite[2/7] [=16%                        ] nsys_report_ia_20000_20_150.sqlite[2/7] [=17%                        ] nsys_report_ia_20000_20_150.sqlite[2/7] [==18%                       ] nsys_report_ia_20000_20_150.sqlite[2/7] [==19%                       ] nsys_report_ia_20000_20_150.sqlite[2/7] [==20%                       ] nsys_report_ia_20000_20_150.sqlite[2/7] [==21%                       ] nsys_report_ia_20000_20_150.sqlite[2/7] [===22%                      ] nsys_report_ia_20000_20_150.sqlite[2/7] [===23%                      ] nsys_report_ia_20000_20_150.sqlite[2/7] [===24%                      ] nsys_report_ia_20000_20_150.sqlite[2/7] [====25%                     ] nsys_report_ia_20000_20_150.sqlite[2/7] [====26%                     ] nsys_report_ia_20000_20_150.sqlite[2/7] [====27%                     ] nsys_report_ia_20000_20_150.sqlite[2/7] [====28%                     ] nsys_report_ia_20000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_20000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_20000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_20000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_20000_20_150.sqlite[2/7] [======33%                   ] nsys_report_ia_20000_20_150.sqlite[2/7] [======34%                   ] nsys_report_ia_20000_20_150.sqlite[2/7] [======35%                   ] nsys_report_ia_20000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_20000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_20000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_20000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_20000_20_150.sqlite[2/7] [========40%                 ] nsys_report_ia_20000_20_150.sqlite[2/7] [========41%                 ] nsys_report_ia_20000_20_150.sqlite[2/7] [========42%                 ] nsys_report_ia_20000_20_150.sqlite[2/7] [=========43%                ] nsys_report_ia_20000_20_150.sqlite[2/7] [=========44%                ] nsys_report_ia_20000_20_150.sqlite[2/7] [=========45%                ] nsys_report_ia_20000_20_150.sqlite[2/7] [=========46%                ] nsys_report_ia_20000_20_150.sqlite[2/7] [==========47%               ] nsys_report_ia_20000_20_150.sqlite[2/7] [==========48%               ] nsys_report_ia_20000_20_150.sqlite[2/7] [==========49%               ] nsys_report_ia_20000_20_150.sqlite[2/7] [===========50%              ] nsys_report_ia_20000_20_150.sqlite[2/7] [===========51%              ] nsys_report_ia_20000_20_150.sqlite[2/7] [===========52%              ] nsys_report_ia_20000_20_150.sqlite[2/7] [===========53%              ] nsys_report_ia_20000_20_150.sqlite[2/7] [============54%             ] nsys_report_ia_20000_20_150.sqlite[2/7] [============55%             ] nsys_report_ia_20000_20_150.sqlite[2/7] [============56%             ] nsys_report_ia_20000_20_150.sqlite[2/7] [============57%             ] nsys_report_ia_20000_20_150.sqlite[2/7] [=============58%            ] nsys_report_ia_20000_20_150.sqlite[2/7] [=============59%            ] nsys_report_ia_20000_20_150.sqlite[2/7] [=============60%            ] nsys_report_ia_20000_20_150.sqlite[2/7] [==============61%           ] nsys_report_ia_20000_20_150.sqlite[2/7] [==============62%           ] nsys_report_ia_20000_20_150.sqlite[2/7] [==============63%           ] nsys_report_ia_20000_20_150.sqlite[2/7] [==============64%           ] nsys_report_ia_20000_20_150.sqlite[2/7] [===============65%          ] nsys_report_ia_20000_20_150.sqlite[2/7] [===============66%          ] nsys_report_ia_20000_20_150.sqlite[2/7] [===============67%          ] nsys_report_ia_20000_20_150.sqlite[2/7] [================68%         ] nsys_report_ia_20000_20_150.sqlite[2/7] [================69%         ] nsys_report_ia_20000_20_150.sqlite[2/7] [================70%         ] nsys_report_ia_20000_20_150.sqlite[2/7] [================71%         ] nsys_report_ia_20000_20_150.sqlite[2/7] [=================72%        ] nsys_report_ia_20000_20_150.sqlite[2/7] [=================73%        ] nsys_report_ia_20000_20_150.sqlite[2/7] [=================74%        ] nsys_report_ia_20000_20_150.sqlite[2/7] [==================75%       ] nsys_report_ia_20000_20_150.sqlite[2/7] [==================76%       ] nsys_report_ia_20000_20_150.sqlite[2/7] [==================77%       ] nsys_report_ia_20000_20_150.sqlite[2/7] [==================78%       ] nsys_report_ia_20000_20_150.sqlite[2/7] [===================79%      ] nsys_report_ia_20000_20_150.sqlite[2/7] [===================80%      ] nsys_report_ia_20000_20_150.sqlite[2/7] [===================81%      ] nsys_report_ia_20000_20_150.sqlite[2/7] [===================82%      ] nsys_report_ia_20000_20_150.sqlite[2/7] [====================83%     ] nsys_report_ia_20000_20_150.sqlite[2/7] [====================84%     ] nsys_report_ia_20000_20_150.sqlite[2/7] [====================85%     ] nsys_report_ia_20000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_20000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_20000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_20000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_20000_20_150.sqlite[2/7] [======================90%   ] nsys_report_ia_20000_20_150.sqlite[2/7] [======================91%   ] nsys_report_ia_20000_20_150.sqlite[2/7] [======================92%   ] nsys_report_ia_20000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_20000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_20000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_20000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_20000_20_150.sqlite[2/7] [========================97% ] nsys_report_ia_20000_20_150.sqlite[2/7] [========================98% ] nsys_report_ia_20000_20_150.sqlite[2/7] [========================99% ] nsys_report_ia_20000_20_150.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_150.sqlite[2/7] [========================100%] nsys_report_ia_20000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        251831393          1  251831393.0  251831393.0  251831393  251831393          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        132471269          1  132471269.0  132471269.0  132471269  132471269          0.0  cudaFree                      
      1.2          1581262          6     263543.7     163927.5       4130     896082     326358.5  cudaMalloc                    
      0.2           329426        814        404.7        370.0        120       1550        231.3  cuGetProcAddress_v2           
      0.0            42240          2      21120.0      21120.0       2220      40020      26728.6  cudaStreamCreateWithFlags     
      0.0            25210         18       1400.6        455.0        380      13960       3186.1  cudaEventCreateWithFlags      
      0.0             7430          3       2476.7       3100.0        700       3630       1561.3  cuInit                        
      0.0             5301          3       1767.0        720.0        300       4281       2187.3  cuModuleGetLoadingMode        
      0.0              840          2        420.0        420.0        290        550        183.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_20000_20_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 20000, batch_size = 20 (num_steps = 150)
number of batches= 8
Generating '/tmp/nsys-report-c860.qdstrm'
[1/7] [0%                          ] nsys_report_db_20000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_db_20000_20_150.nsys-rep[1/7] [=====31%                    ] nsys_report_db_20000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_20000_20_150.nsys-rep[1/7] [========================97% ] nsys_report_db_20000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_db_20000_20_150.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_150.nsys-rep[1/7] [========================100%] nsys_report_db_20000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [1%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [2%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [3%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [4%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [5%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [6%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [7%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [8%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [9%                          ] nsys_report_db_20000_20_150.sqlite[2/7] [10%                         ] nsys_report_db_20000_20_150.sqlite[2/7] [11%                         ] nsys_report_db_20000_20_150.sqlite[2/7] [12%                         ] nsys_report_db_20000_20_150.sqlite[2/7] [13%                         ] nsys_report_db_20000_20_150.sqlite[2/7] [14%                         ] nsys_report_db_20000_20_150.sqlite[2/7] [=15%                        ] nsys_report_db_20000_20_150.sqlite[2/7] [=16%                        ] nsys_report_db_20000_20_150.sqlite[2/7] [=17%                        ] nsys_report_db_20000_20_150.sqlite[2/7] [==18%                       ] nsys_report_db_20000_20_150.sqlite[2/7] [==19%                       ] nsys_report_db_20000_20_150.sqlite[2/7] [==20%                       ] nsys_report_db_20000_20_150.sqlite[2/7] [==21%                       ] nsys_report_db_20000_20_150.sqlite[2/7] [===22%                      ] nsys_report_db_20000_20_150.sqlite[2/7] [===23%                      ] nsys_report_db_20000_20_150.sqlite[2/7] [===24%                      ] nsys_report_db_20000_20_150.sqlite[2/7] [====25%                     ] nsys_report_db_20000_20_150.sqlite[2/7] [====26%                     ] nsys_report_db_20000_20_150.sqlite[2/7] [====27%                     ] nsys_report_db_20000_20_150.sqlite[2/7] [====28%                     ] nsys_report_db_20000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_db_20000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_db_20000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_db_20000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_db_20000_20_150.sqlite[2/7] [======33%                   ] nsys_report_db_20000_20_150.sqlite[2/7] [======34%                   ] nsys_report_db_20000_20_150.sqlite[2/7] [======35%                   ] nsys_report_db_20000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_db_20000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_db_20000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_db_20000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_db_20000_20_150.sqlite[2/7] [========40%                 ] nsys_report_db_20000_20_150.sqlite[2/7] [========41%                 ] nsys_report_db_20000_20_150.sqlite[2/7] [========42%                 ] nsys_report_db_20000_20_150.sqlite[2/7] [=========43%                ] nsys_report_db_20000_20_150.sqlite[2/7] [=========44%                ] nsys_report_db_20000_20_150.sqlite[2/7] [=========45%                ] nsys_report_db_20000_20_150.sqlite[2/7] [=========46%                ] nsys_report_db_20000_20_150.sqlite[2/7] [==========47%               ] nsys_report_db_20000_20_150.sqlite[2/7] [==========48%               ] nsys_report_db_20000_20_150.sqlite[2/7] [==========49%               ] nsys_report_db_20000_20_150.sqlite[2/7] [===========50%              ] nsys_report_db_20000_20_150.sqlite[2/7] [===========51%              ] nsys_report_db_20000_20_150.sqlite[2/7] [===========52%              ] nsys_report_db_20000_20_150.sqlite[2/7] [===========53%              ] nsys_report_db_20000_20_150.sqlite[2/7] [============54%             ] nsys_report_db_20000_20_150.sqlite[2/7] [============55%             ] nsys_report_db_20000_20_150.sqlite[2/7] [============56%             ] nsys_report_db_20000_20_150.sqlite[2/7] [============57%             ] nsys_report_db_20000_20_150.sqlite[2/7] [=============58%            ] nsys_report_db_20000_20_150.sqlite[2/7] [=============59%            ] nsys_report_db_20000_20_150.sqlite[2/7] [=============60%            ] nsys_report_db_20000_20_150.sqlite[2/7] [==============61%           ] nsys_report_db_20000_20_150.sqlite[2/7] [==============62%           ] nsys_report_db_20000_20_150.sqlite[2/7] [==============63%           ] nsys_report_db_20000_20_150.sqlite[2/7] [==============64%           ] nsys_report_db_20000_20_150.sqlite[2/7] [===============65%          ] nsys_report_db_20000_20_150.sqlite[2/7] [===============66%          ] nsys_report_db_20000_20_150.sqlite[2/7] [===============67%          ] nsys_report_db_20000_20_150.sqlite[2/7] [================68%         ] nsys_report_db_20000_20_150.sqlite[2/7] [================69%         ] nsys_report_db_20000_20_150.sqlite[2/7] [================70%         ] nsys_report_db_20000_20_150.sqlite[2/7] [================71%         ] nsys_report_db_20000_20_150.sqlite[2/7] [=================72%        ] nsys_report_db_20000_20_150.sqlite[2/7] [=================73%        ] nsys_report_db_20000_20_150.sqlite[2/7] [=================74%        ] nsys_report_db_20000_20_150.sqlite[2/7] [==================75%       ] nsys_report_db_20000_20_150.sqlite[2/7] [==================76%       ] nsys_report_db_20000_20_150.sqlite[2/7] [==================77%       ] nsys_report_db_20000_20_150.sqlite[2/7] [==================78%       ] nsys_report_db_20000_20_150.sqlite[2/7] [===================79%      ] nsys_report_db_20000_20_150.sqlite[2/7] [===================80%      ] nsys_report_db_20000_20_150.sqlite[2/7] [===================81%      ] nsys_report_db_20000_20_150.sqlite[2/7] [===================82%      ] nsys_report_db_20000_20_150.sqlite[2/7] [====================83%     ] nsys_report_db_20000_20_150.sqlite[2/7] [====================84%     ] nsys_report_db_20000_20_150.sqlite[2/7] [====================85%     ] nsys_report_db_20000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_db_20000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_db_20000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_db_20000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_db_20000_20_150.sqlite[2/7] [======================90%   ] nsys_report_db_20000_20_150.sqlite[2/7] [======================91%   ] nsys_report_db_20000_20_150.sqlite[2/7] [======================92%   ] nsys_report_db_20000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_db_20000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_db_20000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_db_20000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_db_20000_20_150.sqlite[2/7] [========================97% ] nsys_report_db_20000_20_150.sqlite[2/7] [========================98% ] nsys_report_db_20000_20_150.sqlite[2/7] [========================99% ] nsys_report_db_20000_20_150.sqlite[2/7] [========================100%] nsys_report_db_20000_20_150.sqlite[2/7] [========================100%] nsys_report_db_20000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        283918413          1  283918413.0  283918413.0  283918413  283918413          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        162401880          1  162401880.0  162401880.0  162401880  162401880          0.0  cudaFree                      
      1.0          1567180          6     261196.7     170327.0       4020     848581     306979.5  cudaMalloc                    
      0.2           277484        814        340.9        300.0        120       1650        184.1  cuGetProcAddress_v2           
      0.0            35281          2      17640.5      17640.5       2020      33261      22090.7  cudaStreamCreateWithFlags     
      0.0            26021         18       1445.6        520.0        390      15251       3467.4  cudaEventCreateWithFlags      
      0.0             4430          3       1476.7       1580.0        720       2130        710.7  cuInit                        
      0.0             3510          3       1170.0        280.0        260       2970       1558.9  cuModuleGetLoadingMode        
      0.0              940          2        470.0        470.0        320        620        212.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_20000_20_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 20000, buff_size = 20 (num_steps = 150), identity_test = 0
Generating '/tmp/nsys-report-0054.qdstrm'
[1/7] [0%                          ] nsys_report_fo_20000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_20000_20_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_20000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_fo_20000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_fo_20000_20_150.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_150.nsys-rep[1/7] [========================100%] nsys_report_fo_20000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [1%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [2%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [3%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [4%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [5%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [6%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [7%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [8%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [9%                          ] nsys_report_fo_20000_20_150.sqlite[2/7] [10%                         ] nsys_report_fo_20000_20_150.sqlite[2/7] [11%                         ] nsys_report_fo_20000_20_150.sqlite[2/7] [12%                         ] nsys_report_fo_20000_20_150.sqlite[2/7] [13%                         ] nsys_report_fo_20000_20_150.sqlite[2/7] [14%                         ] nsys_report_fo_20000_20_150.sqlite[2/7] [=15%                        ] nsys_report_fo_20000_20_150.sqlite[2/7] [=16%                        ] nsys_report_fo_20000_20_150.sqlite[2/7] [=17%                        ] nsys_report_fo_20000_20_150.sqlite[2/7] [==18%                       ] nsys_report_fo_20000_20_150.sqlite[2/7] [==19%                       ] nsys_report_fo_20000_20_150.sqlite[2/7] [==20%                       ] nsys_report_fo_20000_20_150.sqlite[2/7] [==21%                       ] nsys_report_fo_20000_20_150.sqlite[2/7] [===22%                      ] nsys_report_fo_20000_20_150.sqlite[2/7] [===23%                      ] nsys_report_fo_20000_20_150.sqlite[2/7] [===24%                      ] nsys_report_fo_20000_20_150.sqlite[2/7] [====25%                     ] nsys_report_fo_20000_20_150.sqlite[2/7] [====26%                     ] nsys_report_fo_20000_20_150.sqlite[2/7] [====27%                     ] nsys_report_fo_20000_20_150.sqlite[2/7] [====28%                     ] nsys_report_fo_20000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_20000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_20000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_20000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_20000_20_150.sqlite[2/7] [======33%                   ] nsys_report_fo_20000_20_150.sqlite[2/7] [======34%                   ] nsys_report_fo_20000_20_150.sqlite[2/7] [======35%                   ] nsys_report_fo_20000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_20000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_20000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_20000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_20000_20_150.sqlite[2/7] [========40%                 ] nsys_report_fo_20000_20_150.sqlite[2/7] [========41%                 ] nsys_report_fo_20000_20_150.sqlite[2/7] [========42%                 ] nsys_report_fo_20000_20_150.sqlite[2/7] [=========43%                ] nsys_report_fo_20000_20_150.sqlite[2/7] [=========44%                ] nsys_report_fo_20000_20_150.sqlite[2/7] [=========45%                ] nsys_report_fo_20000_20_150.sqlite[2/7] [=========46%                ] nsys_report_fo_20000_20_150.sqlite[2/7] [==========47%               ] nsys_report_fo_20000_20_150.sqlite[2/7] [==========48%               ] nsys_report_fo_20000_20_150.sqlite[2/7] [==========49%               ] nsys_report_fo_20000_20_150.sqlite[2/7] [===========50%              ] nsys_report_fo_20000_20_150.sqlite[2/7] [===========51%              ] nsys_report_fo_20000_20_150.sqlite[2/7] [===========52%              ] nsys_report_fo_20000_20_150.sqlite[2/7] [===========53%              ] nsys_report_fo_20000_20_150.sqlite[2/7] [============54%             ] nsys_report_fo_20000_20_150.sqlite[2/7] [============55%             ] nsys_report_fo_20000_20_150.sqlite[2/7] [============56%             ] nsys_report_fo_20000_20_150.sqlite[2/7] [============57%             ] nsys_report_fo_20000_20_150.sqlite[2/7] [=============58%            ] nsys_report_fo_20000_20_150.sqlite[2/7] [=============59%            ] nsys_report_fo_20000_20_150.sqlite[2/7] [=============60%            ] nsys_report_fo_20000_20_150.sqlite[2/7] [==============61%           ] nsys_report_fo_20000_20_150.sqlite[2/7] [==============62%           ] nsys_report_fo_20000_20_150.sqlite[2/7] [==============63%           ] nsys_report_fo_20000_20_150.sqlite[2/7] [==============64%           ] nsys_report_fo_20000_20_150.sqlite[2/7] [===============65%          ] nsys_report_fo_20000_20_150.sqlite[2/7] [===============66%          ] nsys_report_fo_20000_20_150.sqlite[2/7] [===============67%          ] nsys_report_fo_20000_20_150.sqlite[2/7] [================68%         ] nsys_report_fo_20000_20_150.sqlite[2/7] [================69%         ] nsys_report_fo_20000_20_150.sqlite[2/7] [================70%         ] nsys_report_fo_20000_20_150.sqlite[2/7] [================71%         ] nsys_report_fo_20000_20_150.sqlite[2/7] [=================72%        ] nsys_report_fo_20000_20_150.sqlite[2/7] [=================73%        ] nsys_report_fo_20000_20_150.sqlite[2/7] [=================74%        ] nsys_report_fo_20000_20_150.sqlite[2/7] [==================75%       ] nsys_report_fo_20000_20_150.sqlite[2/7] [==================76%       ] nsys_report_fo_20000_20_150.sqlite[2/7] [==================77%       ] nsys_report_fo_20000_20_150.sqlite[2/7] [==================78%       ] nsys_report_fo_20000_20_150.sqlite[2/7] [===================79%      ] nsys_report_fo_20000_20_150.sqlite[2/7] [===================80%      ] nsys_report_fo_20000_20_150.sqlite[2/7] [===================81%      ] nsys_report_fo_20000_20_150.sqlite[2/7] [===================82%      ] nsys_report_fo_20000_20_150.sqlite[2/7] [====================83%     ] nsys_report_fo_20000_20_150.sqlite[2/7] [====================84%     ] nsys_report_fo_20000_20_150.sqlite[2/7] [====================85%     ] nsys_report_fo_20000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_20000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_20000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_20000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_20000_20_150.sqlite[2/7] [======================90%   ] nsys_report_fo_20000_20_150.sqlite[2/7] [======================91%   ] nsys_report_fo_20000_20_150.sqlite[2/7] [======================92%   ] nsys_report_fo_20000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_20000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_20000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_20000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_20000_20_150.sqlite[2/7] [========================97% ] nsys_report_fo_20000_20_150.sqlite[2/7] [========================98% ] nsys_report_fo_20000_20_150.sqlite[2/7] [========================99% ] nsys_report_fo_20000_20_150.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_150.sqlite[2/7] [========================100%] nsys_report_fo_20000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        257967961          1  257967961.0  257967961.0  257967961  257967961          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.4        138008171          1  138008171.0  138008171.0  138008171  138008171          0.0  cudaFree                      
      2.3          3328554         17     195797.3     227783.0       3910     290774      76910.8  cudaMalloc                    
      0.2           326027        814        400.5        380.0        120       1560        232.3  cuGetProcAddress_v2           
      0.0            41700          2      20850.0      20850.0       1750      39950      27011.5  cudaStreamCreateWithFlags     
      0.0            27141         18       1507.8        525.0        400      16361       3723.8  cudaEventCreateWithFlags      
      0.0             6511          3       2170.3       2890.0        670       2951       1299.7  cuInit                        
      0.0             4620          3       1540.0        390.0        290       3940       2079.1  cuModuleGetLoadingMode        
      0.0              860          2        430.0        430.0        310        550        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_20000_20_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 5 (num_steps = 20)
number of batches= 4
Generating '/tmp/nsys-report-40cb.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_5_20.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_5_20.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_5_20.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_5_20.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_20.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [1%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [2%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [3%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [4%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [5%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [6%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [7%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [8%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [9%                          ] nsys_report_ia_25000_5_20.sqlite[2/7] [10%                         ] nsys_report_ia_25000_5_20.sqlite[2/7] [11%                         ] nsys_report_ia_25000_5_20.sqlite[2/7] [12%                         ] nsys_report_ia_25000_5_20.sqlite[2/7] [13%                         ] nsys_report_ia_25000_5_20.sqlite[2/7] [14%                         ] nsys_report_ia_25000_5_20.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_5_20.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_5_20.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_5_20.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_5_20.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_5_20.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_5_20.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_5_20.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_5_20.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_5_20.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_5_20.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_5_20.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_5_20.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_5_20.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_5_20.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_5_20.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_5_20.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_5_20.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_5_20.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_5_20.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_5_20.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_5_20.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_5_20.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_5_20.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_5_20.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_5_20.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_5_20.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_5_20.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_5_20.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_5_20.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_5_20.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_5_20.sqlite[2/7] [============54%             ] nsys_report_ia_25000_5_20.sqlite[2/7] [============55%             ] nsys_report_ia_25000_5_20.sqlite[2/7] [============56%             ] nsys_report_ia_25000_5_20.sqlite[2/7] [============57%             ] nsys_report_ia_25000_5_20.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_5_20.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_5_20.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_5_20.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_5_20.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_5_20.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_5_20.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_5_20.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_5_20.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_5_20.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_5_20.sqlite[2/7] [================68%         ] nsys_report_ia_25000_5_20.sqlite[2/7] [================69%         ] nsys_report_ia_25000_5_20.sqlite[2/7] [================70%         ] nsys_report_ia_25000_5_20.sqlite[2/7] [================71%         ] nsys_report_ia_25000_5_20.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_5_20.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_5_20.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_5_20.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_5_20.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_5_20.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_5_20.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_5_20.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_5_20.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_5_20.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_5_20.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_5_20.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_5_20.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_5_20.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_5_20.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_5_20.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_5_20.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_5_20.sqlite[2/7] [========================97% ] nsys_report_ia_25000_5_20.sqlite[2/7] [========================98% ] nsys_report_ia_25000_5_20.sqlite[2/7] [========================99% ] nsys_report_ia_25000_5_20.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_20.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        244761493          1  244761493.0  244761493.0  244761493  244761493          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        134899338          1  134899338.0  134899338.0  134899338  134899338          0.0  cudaFree                      
      1.6          2259131          7     322733.0     263224.0       4940    1130975     381342.1  cudaMalloc                    
      0.2           292533        814        359.4        310.0        120       1390        192.4  cuGetProcAddress_v2           
      0.0            33401          2      16700.5      16700.5       1850      31551      21001.8  cudaStreamCreateWithFlags     
      0.0            22170         18       1231.7        505.0        390      13080       2965.6  cudaEventCreateWithFlags      
      0.0             4690          3       1563.3       1560.0        700       2430        865.0  cuInit                        
      0.0             3290          3       1096.7        270.0        170       2850       1519.3  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        340        610        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 5 (num_steps = 20)
number of batches= 4
Generating '/tmp/nsys-report-7b1e.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_5_20.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_5_20.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_5_20.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_5_20.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_20.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [1%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [2%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [3%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [4%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [5%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [6%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [7%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [8%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [9%                          ] nsys_report_db_25000_5_20.sqlite[2/7] [10%                         ] nsys_report_db_25000_5_20.sqlite[2/7] [11%                         ] nsys_report_db_25000_5_20.sqlite[2/7] [12%                         ] nsys_report_db_25000_5_20.sqlite[2/7] [13%                         ] nsys_report_db_25000_5_20.sqlite[2/7] [14%                         ] nsys_report_db_25000_5_20.sqlite[2/7] [=15%                        ] nsys_report_db_25000_5_20.sqlite[2/7] [=16%                        ] nsys_report_db_25000_5_20.sqlite[2/7] [=17%                        ] nsys_report_db_25000_5_20.sqlite[2/7] [==18%                       ] nsys_report_db_25000_5_20.sqlite[2/7] [==19%                       ] nsys_report_db_25000_5_20.sqlite[2/7] [==20%                       ] nsys_report_db_25000_5_20.sqlite[2/7] [==21%                       ] nsys_report_db_25000_5_20.sqlite[2/7] [===22%                      ] nsys_report_db_25000_5_20.sqlite[2/7] [===23%                      ] nsys_report_db_25000_5_20.sqlite[2/7] [===24%                      ] nsys_report_db_25000_5_20.sqlite[2/7] [====25%                     ] nsys_report_db_25000_5_20.sqlite[2/7] [====26%                     ] nsys_report_db_25000_5_20.sqlite[2/7] [====27%                     ] nsys_report_db_25000_5_20.sqlite[2/7] [====28%                     ] nsys_report_db_25000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_5_20.sqlite[2/7] [======33%                   ] nsys_report_db_25000_5_20.sqlite[2/7] [======34%                   ] nsys_report_db_25000_5_20.sqlite[2/7] [======35%                   ] nsys_report_db_25000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_5_20.sqlite[2/7] [========40%                 ] nsys_report_db_25000_5_20.sqlite[2/7] [========41%                 ] nsys_report_db_25000_5_20.sqlite[2/7] [========42%                 ] nsys_report_db_25000_5_20.sqlite[2/7] [=========43%                ] nsys_report_db_25000_5_20.sqlite[2/7] [=========44%                ] nsys_report_db_25000_5_20.sqlite[2/7] [=========45%                ] nsys_report_db_25000_5_20.sqlite[2/7] [=========46%                ] nsys_report_db_25000_5_20.sqlite[2/7] [==========47%               ] nsys_report_db_25000_5_20.sqlite[2/7] [==========48%               ] nsys_report_db_25000_5_20.sqlite[2/7] [==========49%               ] nsys_report_db_25000_5_20.sqlite[2/7] [===========50%              ] nsys_report_db_25000_5_20.sqlite[2/7] [===========51%              ] nsys_report_db_25000_5_20.sqlite[2/7] [===========52%              ] nsys_report_db_25000_5_20.sqlite[2/7] [===========53%              ] nsys_report_db_25000_5_20.sqlite[2/7] [============54%             ] nsys_report_db_25000_5_20.sqlite[2/7] [============55%             ] nsys_report_db_25000_5_20.sqlite[2/7] [============56%             ] nsys_report_db_25000_5_20.sqlite[2/7] [============57%             ] nsys_report_db_25000_5_20.sqlite[2/7] [=============58%            ] nsys_report_db_25000_5_20.sqlite[2/7] [=============59%            ] nsys_report_db_25000_5_20.sqlite[2/7] [=============60%            ] nsys_report_db_25000_5_20.sqlite[2/7] [==============61%           ] nsys_report_db_25000_5_20.sqlite[2/7] [==============62%           ] nsys_report_db_25000_5_20.sqlite[2/7] [==============63%           ] nsys_report_db_25000_5_20.sqlite[2/7] [==============64%           ] nsys_report_db_25000_5_20.sqlite[2/7] [===============65%          ] nsys_report_db_25000_5_20.sqlite[2/7] [===============66%          ] nsys_report_db_25000_5_20.sqlite[2/7] [===============67%          ] nsys_report_db_25000_5_20.sqlite[2/7] [================68%         ] nsys_report_db_25000_5_20.sqlite[2/7] [================69%         ] nsys_report_db_25000_5_20.sqlite[2/7] [================70%         ] nsys_report_db_25000_5_20.sqlite[2/7] [================71%         ] nsys_report_db_25000_5_20.sqlite[2/7] [=================72%        ] nsys_report_db_25000_5_20.sqlite[2/7] [=================73%        ] nsys_report_db_25000_5_20.sqlite[2/7] [=================74%        ] nsys_report_db_25000_5_20.sqlite[2/7] [==================75%       ] nsys_report_db_25000_5_20.sqlite[2/7] [==================76%       ] nsys_report_db_25000_5_20.sqlite[2/7] [==================77%       ] nsys_report_db_25000_5_20.sqlite[2/7] [==================78%       ] nsys_report_db_25000_5_20.sqlite[2/7] [===================79%      ] nsys_report_db_25000_5_20.sqlite[2/7] [===================80%      ] nsys_report_db_25000_5_20.sqlite[2/7] [===================81%      ] nsys_report_db_25000_5_20.sqlite[2/7] [===================82%      ] nsys_report_db_25000_5_20.sqlite[2/7] [====================83%     ] nsys_report_db_25000_5_20.sqlite[2/7] [====================84%     ] nsys_report_db_25000_5_20.sqlite[2/7] [====================85%     ] nsys_report_db_25000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_5_20.sqlite[2/7] [======================90%   ] nsys_report_db_25000_5_20.sqlite[2/7] [======================91%   ] nsys_report_db_25000_5_20.sqlite[2/7] [======================92%   ] nsys_report_db_25000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_5_20.sqlite[2/7] [========================97% ] nsys_report_db_25000_5_20.sqlite[2/7] [========================98% ] nsys_report_db_25000_5_20.sqlite[2/7] [========================99% ] nsys_report_db_25000_5_20.sqlite[2/7] [========================100%] nsys_report_db_25000_5_20.sqlite[2/7] [========================100%] nsys_report_db_25000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245076646          1  245076646.0  245076646.0  245076646  245076646          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        130511079          1  130511079.0  130511079.0  130511079  130511079          0.0  cudaFree                      
      1.7          2254250          7     322035.7     257264.0       3780    1141105     385068.5  cudaMalloc                    
      0.2           258432        814        317.5        280.0        130       1230        168.5  cuGetProcAddress_v2           
      0.0            32741          2      16370.5      16370.5       1970      30771      20365.4  cudaStreamCreateWithFlags     
      0.0            26700         18       1483.3        455.0        390      16740       3822.1  cudaEventCreateWithFlags      
      0.0             5040          3       1680.0       1770.0        710       2560        928.3  cuInit                        
      0.0             3790          3       1263.3        390.0        190       3210       1688.8  cuModuleGetLoadingMode        
      0.0              970          2        485.0        485.0        330        640        219.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 5 (num_steps = 20), identity_test = 0
--- GPU Memory Usage ---
Total GPU Memory: 39.50 GB
Free GPU Memory:  6.26 GB
Used GPU Memory:  33.24 GB
------------------------

Process RSS:  107.87 GB
h_X_final[0] = 0.000040
h_X_final[1] = 0.000040
h_X_final[2] = 0.000040
h_X_final[3] = 0.000040
h_X_final[4] = 0.000040
t_alloc_gpu = 2.266169 ms
t_alloc_cpu = 25200.989962 ms
t_init      = 7874.214888 ms
t_h2d       = 4552.824911 ms
t_d2h       = 972.908974 ms
t_gemm      = 33893.612305 ms
t_end_2_end = 79032.318115 ms
Generating '/tmp/nsys-report-8dff.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [11%                         ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===22%                      ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===23%                      ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===24%                      ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [====25%                     ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [====26%                     ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [====27%                     ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [====28%                     ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=====29%                    ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [======33%                   ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [======34%                   ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [======35%                   ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=======36%                  ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=======37%                  ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=======38%                  ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=======39%                  ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [========40%                 ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [========41%                 ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [========42%                 ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=========43%                ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=========44%                ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=========45%                ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=========46%                ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==========47%               ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==========48%               ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==========49%               ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===========50%              ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===========51%              ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===========52%              ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===========53%              ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [============54%             ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [============55%             ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [============56%             ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [============57%             ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=============58%            ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=============59%            ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=============60%            ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==============61%           ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==============62%           ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==============63%           ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===============65%          ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===============66%          ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [===============67%          ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [================68%         ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [================69%         ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [================70%         ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [================71%         ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=================72%        ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=================73%        ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [=================74%        ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==================75%       ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==================76%       ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==================77%       ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [==================78%       ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_5_20.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_20.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [1%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [2%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [3%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [4%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [5%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [6%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [7%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [8%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [9%                          ] nsys_report_fo_25000_5_20.sqlite[2/7] [10%                         ] nsys_report_fo_25000_5_20.sqlite[2/7] [11%                         ] nsys_report_fo_25000_5_20.sqlite[2/7] [12%                         ] nsys_report_fo_25000_5_20.sqlite[2/7] [13%                         ] nsys_report_fo_25000_5_20.sqlite[2/7] [14%                         ] nsys_report_fo_25000_5_20.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_5_20.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_5_20.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_5_20.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_5_20.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_5_20.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_5_20.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_5_20.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_5_20.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_5_20.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_5_20.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_5_20.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_5_20.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_5_20.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_5_20.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_5_20.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_5_20.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_5_20.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_5_20.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_5_20.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_5_20.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_5_20.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_5_20.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_5_20.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_5_20.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_5_20.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_5_20.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_5_20.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_5_20.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_5_20.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_5_20.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_5_20.sqlite[2/7] [============54%             ] nsys_report_fo_25000_5_20.sqlite[2/7] [============55%             ] nsys_report_fo_25000_5_20.sqlite[2/7] [============56%             ] nsys_report_fo_25000_5_20.sqlite[2/7] [============57%             ] nsys_report_fo_25000_5_20.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_5_20.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_5_20.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_5_20.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_5_20.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_5_20.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_5_20.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_5_20.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_5_20.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_5_20.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_5_20.sqlite[2/7] [================68%         ] nsys_report_fo_25000_5_20.sqlite[2/7] [================69%         ] nsys_report_fo_25000_5_20.sqlite[2/7] [================70%         ] nsys_report_fo_25000_5_20.sqlite[2/7] [================71%         ] nsys_report_fo_25000_5_20.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_5_20.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_5_20.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_5_20.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_5_20.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_5_20.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_5_20.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_5_20.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_5_20.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_5_20.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_5_20.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_5_20.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_5_20.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_5_20.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_5_20.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_5_20.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_5_20.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_5_20.sqlite[2/7] [========================97% ] nsys_report_fo_25000_5_20.sqlite[2/7] [========================98% ] nsys_report_fo_25000_5_20.sqlite[2/7] [========================99% ] nsys_report_fo_25000_5_20.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_20.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245660304          1  245660304.0  245660304.0  245660304  245660304          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)                 Name               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  ----------------------------------
     45.9      31640392654         60    527339877.6        20840.5         3611   1683532190  781041402.7  cudaMemcpyAsync                   
     36.6      25200972490          1  25200972490.0  25200972490.0  25200972490  25200972490          0.0  cudaHostAlloc                     
     14.4       9941013973          1   9941013973.0   9941013973.0   9941013973   9941013973          0.0  cudaFreeHost                      
      1.5       1010328321         20     50516416.1         2370.5         1070   1010285380  225906173.3  cuKernelGetFunction               
      1.2        815568990          2    407784495.0    407784495.0    330594646    484974344  109162931.3  cudaMemcpy                        
      0.2        159573588         11     14506689.8      2549863.0        37061    132935975   39339103.4  cudaFree                          
      0.2        121083709          1    121083709.0    121083709.0    121083709    121083709          0.0  cudaDeviceReset                   
      0.0          7264576         22       330208.0         3105.0         2520      7198065    1533957.5  cudaStreamSynchronize             
      0.0          4114864         15       274324.3       289624.0       117552       441936     110512.0  cuLibraryLoadData                 
      0.0          2452413         10       245241.3       307459.5         3931       389105     130740.5  cudaMalloc                        
      0.0          1095845         60        18264.1         8155.0         3970       293923      37807.4  cudaLaunchKernel                  
      0.0           414795        140         2962.8         2675.0          500        32020       3190.1  cudaEventRecord                   
      0.0           341276        814          419.3          390.0          120         1640        243.6  cuGetProcAddress_v2               
      0.0           223783         20        11189.2         9250.0         5990        49231       9039.9  cuLaunchKernel                    
      0.0           130952          1       130952.0       130952.0       130952       130952          0.0  cudaMemGetInfo                    
      0.0            97152        100          971.5          420.0          290         4781       1222.6  cudaStreamGetCaptureInfo_v2_v11030
      0.0            83500         28         2982.1          520.0          390        43130       8554.2  cudaEventCreateWithFlags          
      0.0            69271         35         1979.2         2080.0          610         4710       1100.1  cudaStreamWaitEvent               
      0.0            66400         80          830.0          590.0          480         9110       1032.9  cudaEventCreate                   
      0.0            44190          4        11047.5         3910.0         1500        34870      15941.5  cudaDeviceSynchronize             
      0.0            43711          2        21855.5        21855.5         1890        41821      28235.5  cudaStreamCreateWithFlags         
      0.0            29850          2        14925.0        14925.0         5910        23940      12749.1  cudaStreamDestroy                 
      0.0            22700         28          810.7          450.0          340         5080       1052.9  cudaEventDestroy                  
      0.0            17321         16         1082.6          600.0          480         5740       1362.1  cuLibraryGetKernel                
      0.0             7090          3         2363.3         2760.0          720         3610       1485.3  cuInit                            
      0.0             4800          1         4800.0         4800.0         4800         4800          0.0  cudaEventQuery                    
      0.0             4130          3         1376.7          520.0          280         3330       1695.9  cuModuleGetLoadingMode            
      0.0             1560          1         1560.0         1560.0         1560         1560          0.0  cuCtxSynchronize                  
      0.0              890          2          445.0          445.0          320          570        176.8  cudaGetDriverEntryPoint_v11030    

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                                                Name                                               
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------------------------------------------------------------------------------------------------
     99.3      33053542887         20  1652677144.4  1653280831.5  1629238368  1672460089   11339039.2  void cutlass::Kernel2<cutlass_80_tensorop_d884gemm_128x64_16x3_nn_align1>(T1::Params)            
      0.4        145656611         20     7282830.6     7312925.5     7195695     7325322      52160.0  void scal_kernel_val<double, double>(cublasScalParamsVal<T1, T2>)                                
      0.2         78169080         40     1954227.0     1949588.0       13856     3908364    1964748.0  void nrm2_kernel<double, double, double, (int)0, (int)0, (int)128>(cublasNrm2Params<int, T1, T3>)

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  --------  ---------  -----------  ----------------------------
     90.4       4552170165     41  111028540.6  189877396.0      1567  330376425  112246600.4  [CUDA memcpy Host-to-Device]
      9.6        484786943     21   23085092.5       1920.0      1888  484746399  105779894.1  [CUDA memcpy Device-to-Host]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
 105000.208     41  2560.981  5000.000     0.010  5000.000     2530.299  [CUDA memcpy Host-to-Device]
   5000.000     21   238.095     0.000     0.000  5000.000     1091.089  [CUDA memcpy Device-to-Host]

Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 5 (num_steps = 40)
number of batches= 8
Generating '/tmp/nsys-report-99d7.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_5_40.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_5_40.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_5_40.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_5_40.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_40.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [1%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [2%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [3%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [4%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [5%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [6%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [7%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [8%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [9%                          ] nsys_report_ia_25000_5_40.sqlite[2/7] [10%                         ] nsys_report_ia_25000_5_40.sqlite[2/7] [11%                         ] nsys_report_ia_25000_5_40.sqlite[2/7] [12%                         ] nsys_report_ia_25000_5_40.sqlite[2/7] [13%                         ] nsys_report_ia_25000_5_40.sqlite[2/7] [14%                         ] nsys_report_ia_25000_5_40.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_5_40.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_5_40.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_5_40.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_5_40.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_5_40.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_5_40.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_5_40.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_5_40.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_5_40.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_5_40.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_5_40.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_5_40.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_5_40.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_5_40.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_5_40.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_5_40.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_5_40.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_5_40.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_5_40.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_5_40.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_5_40.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_5_40.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_5_40.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_5_40.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_5_40.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_5_40.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_5_40.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_5_40.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_5_40.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_5_40.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_5_40.sqlite[2/7] [============54%             ] nsys_report_ia_25000_5_40.sqlite[2/7] [============55%             ] nsys_report_ia_25000_5_40.sqlite[2/7] [============56%             ] nsys_report_ia_25000_5_40.sqlite[2/7] [============57%             ] nsys_report_ia_25000_5_40.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_5_40.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_5_40.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_5_40.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_5_40.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_5_40.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_5_40.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_5_40.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_5_40.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_5_40.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_5_40.sqlite[2/7] [================68%         ] nsys_report_ia_25000_5_40.sqlite[2/7] [================69%         ] nsys_report_ia_25000_5_40.sqlite[2/7] [================70%         ] nsys_report_ia_25000_5_40.sqlite[2/7] [================71%         ] nsys_report_ia_25000_5_40.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_5_40.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_5_40.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_5_40.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_5_40.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_5_40.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_5_40.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_5_40.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_5_40.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_5_40.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_5_40.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_5_40.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_5_40.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_5_40.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_5_40.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_5_40.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_5_40.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_5_40.sqlite[2/7] [========================97% ] nsys_report_ia_25000_5_40.sqlite[2/7] [========================98% ] nsys_report_ia_25000_5_40.sqlite[2/7] [========================99% ] nsys_report_ia_25000_5_40.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_40.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        295358925          1  295358925.0  295358925.0  295358925  295358925          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        173529165          1  173529165.0  173529165.0  173529165  173529165          0.0  cudaFree                      
      1.3          2287650          7     326807.1     261224.0       4230    1125604     379554.5  cudaMalloc                    
      0.2           286884        814        352.4        290.0        110       7620        318.9  cuGetProcAddress_v2           
      0.0            44690          2      22345.0      22345.0       3550      41140      26580.1  cudaStreamCreateWithFlags     
      0.0            19831         18       1101.7        515.0        400       9251       2061.9  cudaEventCreateWithFlags      
      0.0             6920          3       2306.7       2500.0       1090       3330       1132.4  cuInit                        
      0.0             3870          3       1290.0        460.0        150       3260       1713.1  cuModuleGetLoadingMode        
      0.0              860          2        430.0        430.0        290        570        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 5 (num_steps = 40)
number of batches= 8
Generating '/tmp/nsys-report-e022.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_5_40.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_5_40.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_5_40.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_5_40.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_40.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [1%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [2%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [3%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [4%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [5%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [6%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [7%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [8%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [9%                          ] nsys_report_db_25000_5_40.sqlite[2/7] [10%                         ] nsys_report_db_25000_5_40.sqlite[2/7] [11%                         ] nsys_report_db_25000_5_40.sqlite[2/7] [12%                         ] nsys_report_db_25000_5_40.sqlite[2/7] [13%                         ] nsys_report_db_25000_5_40.sqlite[2/7] [14%                         ] nsys_report_db_25000_5_40.sqlite[2/7] [=15%                        ] nsys_report_db_25000_5_40.sqlite[2/7] [=16%                        ] nsys_report_db_25000_5_40.sqlite[2/7] [=17%                        ] nsys_report_db_25000_5_40.sqlite[2/7] [==18%                       ] nsys_report_db_25000_5_40.sqlite[2/7] [==19%                       ] nsys_report_db_25000_5_40.sqlite[2/7] [==20%                       ] nsys_report_db_25000_5_40.sqlite[2/7] [==21%                       ] nsys_report_db_25000_5_40.sqlite[2/7] [===22%                      ] nsys_report_db_25000_5_40.sqlite[2/7] [===23%                      ] nsys_report_db_25000_5_40.sqlite[2/7] [===24%                      ] nsys_report_db_25000_5_40.sqlite[2/7] [====25%                     ] nsys_report_db_25000_5_40.sqlite[2/7] [====26%                     ] nsys_report_db_25000_5_40.sqlite[2/7] [====27%                     ] nsys_report_db_25000_5_40.sqlite[2/7] [====28%                     ] nsys_report_db_25000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_5_40.sqlite[2/7] [======33%                   ] nsys_report_db_25000_5_40.sqlite[2/7] [======34%                   ] nsys_report_db_25000_5_40.sqlite[2/7] [======35%                   ] nsys_report_db_25000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_5_40.sqlite[2/7] [========40%                 ] nsys_report_db_25000_5_40.sqlite[2/7] [========41%                 ] nsys_report_db_25000_5_40.sqlite[2/7] [========42%                 ] nsys_report_db_25000_5_40.sqlite[2/7] [=========43%                ] nsys_report_db_25000_5_40.sqlite[2/7] [=========44%                ] nsys_report_db_25000_5_40.sqlite[2/7] [=========45%                ] nsys_report_db_25000_5_40.sqlite[2/7] [=========46%                ] nsys_report_db_25000_5_40.sqlite[2/7] [==========47%               ] nsys_report_db_25000_5_40.sqlite[2/7] [==========48%               ] nsys_report_db_25000_5_40.sqlite[2/7] [==========49%               ] nsys_report_db_25000_5_40.sqlite[2/7] [===========50%              ] nsys_report_db_25000_5_40.sqlite[2/7] [===========51%              ] nsys_report_db_25000_5_40.sqlite[2/7] [===========52%              ] nsys_report_db_25000_5_40.sqlite[2/7] [===========53%              ] nsys_report_db_25000_5_40.sqlite[2/7] [============54%             ] nsys_report_db_25000_5_40.sqlite[2/7] [============55%             ] nsys_report_db_25000_5_40.sqlite[2/7] [============56%             ] nsys_report_db_25000_5_40.sqlite[2/7] [============57%             ] nsys_report_db_25000_5_40.sqlite[2/7] [=============58%            ] nsys_report_db_25000_5_40.sqlite[2/7] [=============59%            ] nsys_report_db_25000_5_40.sqlite[2/7] [=============60%            ] nsys_report_db_25000_5_40.sqlite[2/7] [==============61%           ] nsys_report_db_25000_5_40.sqlite[2/7] [==============62%           ] nsys_report_db_25000_5_40.sqlite[2/7] [==============63%           ] nsys_report_db_25000_5_40.sqlite[2/7] [==============64%           ] nsys_report_db_25000_5_40.sqlite[2/7] [===============65%          ] nsys_report_db_25000_5_40.sqlite[2/7] [===============66%          ] nsys_report_db_25000_5_40.sqlite[2/7] [===============67%          ] nsys_report_db_25000_5_40.sqlite[2/7] [================68%         ] nsys_report_db_25000_5_40.sqlite[2/7] [================69%         ] nsys_report_db_25000_5_40.sqlite[2/7] [================70%         ] nsys_report_db_25000_5_40.sqlite[2/7] [================71%         ] nsys_report_db_25000_5_40.sqlite[2/7] [=================72%        ] nsys_report_db_25000_5_40.sqlite[2/7] [=================73%        ] nsys_report_db_25000_5_40.sqlite[2/7] [=================74%        ] nsys_report_db_25000_5_40.sqlite[2/7] [==================75%       ] nsys_report_db_25000_5_40.sqlite[2/7] [==================76%       ] nsys_report_db_25000_5_40.sqlite[2/7] [==================77%       ] nsys_report_db_25000_5_40.sqlite[2/7] [==================78%       ] nsys_report_db_25000_5_40.sqlite[2/7] [===================79%      ] nsys_report_db_25000_5_40.sqlite[2/7] [===================80%      ] nsys_report_db_25000_5_40.sqlite[2/7] [===================81%      ] nsys_report_db_25000_5_40.sqlite[2/7] [===================82%      ] nsys_report_db_25000_5_40.sqlite[2/7] [====================83%     ] nsys_report_db_25000_5_40.sqlite[2/7] [====================84%     ] nsys_report_db_25000_5_40.sqlite[2/7] [====================85%     ] nsys_report_db_25000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_5_40.sqlite[2/7] [======================90%   ] nsys_report_db_25000_5_40.sqlite[2/7] [======================91%   ] nsys_report_db_25000_5_40.sqlite[2/7] [======================92%   ] nsys_report_db_25000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_5_40.sqlite[2/7] [========================97% ] nsys_report_db_25000_5_40.sqlite[2/7] [========================98% ] nsys_report_db_25000_5_40.sqlite[2/7] [========================99% ] nsys_report_db_25000_5_40.sqlite[2/7] [========================100%] nsys_report_db_25000_5_40.sqlite[2/7] [========================100%] nsys_report_db_25000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        249119531          1  249119531.0  249119531.0  249119531  249119531          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        134129330          1  134129330.0  134129330.0  134129330  134129330          0.0  cudaFree                      
      1.6          2243070          7     320438.6     257264.0       3770    1146865     386947.0  cudaMalloc                    
      0.2           268443        814        329.8        290.0        120       1290        175.0  cuGetProcAddress_v2           
      0.0            41420          2      20710.0      20710.0       2030      39390      26417.5  cudaStreamCreateWithFlags     
      0.0            26240         18       1457.8        510.0        390      14660       3338.7  cudaEventCreateWithFlags      
      0.0             5500          3       1833.3       2010.0        590       2900       1165.1  cuInit                        
      0.0             3340          3       1113.3        270.0        150       2920       1565.8  cuModuleGetLoadingMode        
      0.0             1000          2        500.0        500.0        420        580        113.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 5 (num_steps = 40), identity_test = 0
Generating '/tmp/nsys-report-8e60.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_5_40.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_5_40.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_5_40.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_5_40.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_40.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [1%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [2%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [3%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [4%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [5%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [6%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [7%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [8%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [9%                          ] nsys_report_fo_25000_5_40.sqlite[2/7] [10%                         ] nsys_report_fo_25000_5_40.sqlite[2/7] [11%                         ] nsys_report_fo_25000_5_40.sqlite[2/7] [12%                         ] nsys_report_fo_25000_5_40.sqlite[2/7] [13%                         ] nsys_report_fo_25000_5_40.sqlite[2/7] [14%                         ] nsys_report_fo_25000_5_40.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_5_40.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_5_40.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_5_40.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_5_40.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_5_40.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_5_40.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_5_40.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_5_40.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_5_40.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_5_40.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_5_40.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_5_40.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_5_40.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_5_40.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_5_40.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_5_40.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_5_40.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_5_40.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_5_40.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_5_40.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_5_40.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_5_40.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_5_40.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_5_40.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_5_40.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_5_40.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_5_40.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_5_40.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_5_40.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_5_40.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_5_40.sqlite[2/7] [============54%             ] nsys_report_fo_25000_5_40.sqlite[2/7] [============55%             ] nsys_report_fo_25000_5_40.sqlite[2/7] [============56%             ] nsys_report_fo_25000_5_40.sqlite[2/7] [============57%             ] nsys_report_fo_25000_5_40.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_5_40.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_5_40.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_5_40.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_5_40.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_5_40.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_5_40.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_5_40.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_5_40.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_5_40.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_5_40.sqlite[2/7] [================68%         ] nsys_report_fo_25000_5_40.sqlite[2/7] [================69%         ] nsys_report_fo_25000_5_40.sqlite[2/7] [================70%         ] nsys_report_fo_25000_5_40.sqlite[2/7] [================71%         ] nsys_report_fo_25000_5_40.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_5_40.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_5_40.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_5_40.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_5_40.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_5_40.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_5_40.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_5_40.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_5_40.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_5_40.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_5_40.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_5_40.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_5_40.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_5_40.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_5_40.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_5_40.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_5_40.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_5_40.sqlite[2/7] [========================97% ] nsys_report_fo_25000_5_40.sqlite[2/7] [========================98% ] nsys_report_fo_25000_5_40.sqlite[2/7] [========================99% ] nsys_report_fo_25000_5_40.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_40.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        282218741          1  282218741.0  282218741.0  282218741  282218741          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.3        164987881          1  164987881.0  164987881.0  164987881  164987881          0.0  cudaFree                      
      1.5          2517393         10     251739.3     314394.0       4230     383665     132169.0  cudaMalloc                    
      0.2           286553        814        352.0        310.0        110       1290        182.7  cuGetProcAddress_v2           
      0.0            52760          2      26380.0      26380.0       2060      50700      34393.7  cudaStreamCreateWithFlags     
      0.0            19950         18       1108.3        500.0        390       9180       2063.2  cudaEventCreateWithFlags      
      0.0            11980          1      11980.0      11980.0      11980      11980          0.0  cudaHostAlloc                 
      0.0             6620          3       2206.7       2260.0        940       3420       1240.9  cuInit                        
      0.0             3870          3       1290.0        550.0        170       3150       1622.0  cuModuleGetLoadingMode        
      0.0              870          2        435.0        435.0        300        570        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 5 (num_steps = 60)
number of batches= 12
Generating '/tmp/nsys-report-6684.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_5_60.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_5_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_5_60.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_60.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [1%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [2%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [3%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [4%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [5%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [6%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [7%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [8%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [9%                          ] nsys_report_ia_25000_5_60.sqlite[2/7] [10%                         ] nsys_report_ia_25000_5_60.sqlite[2/7] [11%                         ] nsys_report_ia_25000_5_60.sqlite[2/7] [12%                         ] nsys_report_ia_25000_5_60.sqlite[2/7] [13%                         ] nsys_report_ia_25000_5_60.sqlite[2/7] [14%                         ] nsys_report_ia_25000_5_60.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_5_60.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_5_60.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_5_60.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_5_60.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_5_60.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_5_60.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_5_60.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_5_60.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_5_60.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_5_60.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_5_60.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_5_60.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_5_60.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_5_60.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_5_60.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_5_60.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_5_60.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_5_60.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_5_60.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_5_60.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_5_60.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_5_60.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_5_60.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_5_60.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_5_60.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_5_60.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_5_60.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_5_60.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_5_60.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_5_60.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_5_60.sqlite[2/7] [============54%             ] nsys_report_ia_25000_5_60.sqlite[2/7] [============55%             ] nsys_report_ia_25000_5_60.sqlite[2/7] [============56%             ] nsys_report_ia_25000_5_60.sqlite[2/7] [============57%             ] nsys_report_ia_25000_5_60.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_5_60.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_5_60.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_5_60.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_5_60.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_5_60.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_5_60.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_5_60.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_5_60.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_5_60.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_5_60.sqlite[2/7] [================68%         ] nsys_report_ia_25000_5_60.sqlite[2/7] [================69%         ] nsys_report_ia_25000_5_60.sqlite[2/7] [================70%         ] nsys_report_ia_25000_5_60.sqlite[2/7] [================71%         ] nsys_report_ia_25000_5_60.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_5_60.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_5_60.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_5_60.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_5_60.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_5_60.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_5_60.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_5_60.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_5_60.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_5_60.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_5_60.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_5_60.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_5_60.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_5_60.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_5_60.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_5_60.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_5_60.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_5_60.sqlite[2/7] [========================97% ] nsys_report_ia_25000_5_60.sqlite[2/7] [========================98% ] nsys_report_ia_25000_5_60.sqlite[2/7] [========================99% ] nsys_report_ia_25000_5_60.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_60.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245430861          1  245430861.0  245430861.0  245430861  245430861          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        129759393          1  129759393.0  129759393.0  129759393  129759393          0.0  cudaFree                      
      1.7          2222099          7     317442.7     257884.0       3840    1113774     375433.4  cudaMalloc                    
      0.2           325464        814        399.8        370.0        120       1580        236.5  cuGetProcAddress_v2           
      0.0            35901          2      17950.5      17950.5       1800      34101      22840.3  cudaStreamCreateWithFlags     
      0.0            27751         18       1541.7        480.0        380      17320       3958.9  cudaEventCreateWithFlags      
      0.0             5220          3       1740.0       1810.0        850       2560        857.1  cuInit                        
      0.0             4040          3       1346.7        430.0        250       3360       1745.9  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        300        650        247.5  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 5 (num_steps = 60)
number of batches= 12
Generating '/tmp/nsys-report-4b9e.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_5_60.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_5_60.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_5_60.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_60.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [1%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [2%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [3%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [4%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [5%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [6%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [7%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [8%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [9%                          ] nsys_report_db_25000_5_60.sqlite[2/7] [10%                         ] nsys_report_db_25000_5_60.sqlite[2/7] [11%                         ] nsys_report_db_25000_5_60.sqlite[2/7] [12%                         ] nsys_report_db_25000_5_60.sqlite[2/7] [13%                         ] nsys_report_db_25000_5_60.sqlite[2/7] [14%                         ] nsys_report_db_25000_5_60.sqlite[2/7] [=15%                        ] nsys_report_db_25000_5_60.sqlite[2/7] [=16%                        ] nsys_report_db_25000_5_60.sqlite[2/7] [=17%                        ] nsys_report_db_25000_5_60.sqlite[2/7] [==18%                       ] nsys_report_db_25000_5_60.sqlite[2/7] [==19%                       ] nsys_report_db_25000_5_60.sqlite[2/7] [==20%                       ] nsys_report_db_25000_5_60.sqlite[2/7] [==21%                       ] nsys_report_db_25000_5_60.sqlite[2/7] [===22%                      ] nsys_report_db_25000_5_60.sqlite[2/7] [===23%                      ] nsys_report_db_25000_5_60.sqlite[2/7] [===24%                      ] nsys_report_db_25000_5_60.sqlite[2/7] [====25%                     ] nsys_report_db_25000_5_60.sqlite[2/7] [====26%                     ] nsys_report_db_25000_5_60.sqlite[2/7] [====27%                     ] nsys_report_db_25000_5_60.sqlite[2/7] [====28%                     ] nsys_report_db_25000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_5_60.sqlite[2/7] [======33%                   ] nsys_report_db_25000_5_60.sqlite[2/7] [======34%                   ] nsys_report_db_25000_5_60.sqlite[2/7] [======35%                   ] nsys_report_db_25000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_5_60.sqlite[2/7] [========40%                 ] nsys_report_db_25000_5_60.sqlite[2/7] [========41%                 ] nsys_report_db_25000_5_60.sqlite[2/7] [========42%                 ] nsys_report_db_25000_5_60.sqlite[2/7] [=========43%                ] nsys_report_db_25000_5_60.sqlite[2/7] [=========44%                ] nsys_report_db_25000_5_60.sqlite[2/7] [=========45%                ] nsys_report_db_25000_5_60.sqlite[2/7] [=========46%                ] nsys_report_db_25000_5_60.sqlite[2/7] [==========47%               ] nsys_report_db_25000_5_60.sqlite[2/7] [==========48%               ] nsys_report_db_25000_5_60.sqlite[2/7] [==========49%               ] nsys_report_db_25000_5_60.sqlite[2/7] [===========50%              ] nsys_report_db_25000_5_60.sqlite[2/7] [===========51%              ] nsys_report_db_25000_5_60.sqlite[2/7] [===========52%              ] nsys_report_db_25000_5_60.sqlite[2/7] [===========53%              ] nsys_report_db_25000_5_60.sqlite[2/7] [============54%             ] nsys_report_db_25000_5_60.sqlite[2/7] [============55%             ] nsys_report_db_25000_5_60.sqlite[2/7] [============56%             ] nsys_report_db_25000_5_60.sqlite[2/7] [============57%             ] nsys_report_db_25000_5_60.sqlite[2/7] [=============58%            ] nsys_report_db_25000_5_60.sqlite[2/7] [=============59%            ] nsys_report_db_25000_5_60.sqlite[2/7] [=============60%            ] nsys_report_db_25000_5_60.sqlite[2/7] [==============61%           ] nsys_report_db_25000_5_60.sqlite[2/7] [==============62%           ] nsys_report_db_25000_5_60.sqlite[2/7] [==============63%           ] nsys_report_db_25000_5_60.sqlite[2/7] [==============64%           ] nsys_report_db_25000_5_60.sqlite[2/7] [===============65%          ] nsys_report_db_25000_5_60.sqlite[2/7] [===============66%          ] nsys_report_db_25000_5_60.sqlite[2/7] [===============67%          ] nsys_report_db_25000_5_60.sqlite[2/7] [================68%         ] nsys_report_db_25000_5_60.sqlite[2/7] [================69%         ] nsys_report_db_25000_5_60.sqlite[2/7] [================70%         ] nsys_report_db_25000_5_60.sqlite[2/7] [================71%         ] nsys_report_db_25000_5_60.sqlite[2/7] [=================72%        ] nsys_report_db_25000_5_60.sqlite[2/7] [=================73%        ] nsys_report_db_25000_5_60.sqlite[2/7] [=================74%        ] nsys_report_db_25000_5_60.sqlite[2/7] [==================75%       ] nsys_report_db_25000_5_60.sqlite[2/7] [==================76%       ] nsys_report_db_25000_5_60.sqlite[2/7] [==================77%       ] nsys_report_db_25000_5_60.sqlite[2/7] [==================78%       ] nsys_report_db_25000_5_60.sqlite[2/7] [===================79%      ] nsys_report_db_25000_5_60.sqlite[2/7] [===================80%      ] nsys_report_db_25000_5_60.sqlite[2/7] [===================81%      ] nsys_report_db_25000_5_60.sqlite[2/7] [===================82%      ] nsys_report_db_25000_5_60.sqlite[2/7] [====================83%     ] nsys_report_db_25000_5_60.sqlite[2/7] [====================84%     ] nsys_report_db_25000_5_60.sqlite[2/7] [====================85%     ] nsys_report_db_25000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_5_60.sqlite[2/7] [======================90%   ] nsys_report_db_25000_5_60.sqlite[2/7] [======================91%   ] nsys_report_db_25000_5_60.sqlite[2/7] [======================92%   ] nsys_report_db_25000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_5_60.sqlite[2/7] [========================97% ] nsys_report_db_25000_5_60.sqlite[2/7] [========================98% ] nsys_report_db_25000_5_60.sqlite[2/7] [========================99% ] nsys_report_db_25000_5_60.sqlite[2/7] [========================100%] nsys_report_db_25000_5_60.sqlite[2/7] [========================100%] nsys_report_db_25000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        261923831          1  261923831.0  261923831.0  261923831  261923831          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        144371000          1  144371000.0  144371000.0  144371000  144371000          0.0  cudaFree                      
      1.6          2296581          7     328083.0     257933.0       3990    1168486     394694.8  cudaMalloc                    
      0.2           286236        814        351.6        330.0        130       1270        172.6  cuGetProcAddress_v2           
      0.0            39180          2      19590.0      19590.0       1930      37250      24975.0  cudaStreamCreateWithFlags     
      0.0            30000         18       1666.7        495.0        390      20020       4592.2  cudaEventCreateWithFlags      
      0.0             5150          3       1716.7       2030.0        580       2540       1016.9  cuInit                        
      0.0             3230          3       1076.7        430.0        190       2610       1333.3  cuModuleGetLoadingMode        
      0.0              960          2        480.0        480.0        320        640        226.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 5 (num_steps = 60), identity_test = 0
Generating '/tmp/nsys-report-437c.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_5_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_5_60.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_5_60.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_60.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [1%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [2%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [3%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [4%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [5%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [6%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [7%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [8%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [9%                          ] nsys_report_fo_25000_5_60.sqlite[2/7] [10%                         ] nsys_report_fo_25000_5_60.sqlite[2/7] [11%                         ] nsys_report_fo_25000_5_60.sqlite[2/7] [12%                         ] nsys_report_fo_25000_5_60.sqlite[2/7] [13%                         ] nsys_report_fo_25000_5_60.sqlite[2/7] [14%                         ] nsys_report_fo_25000_5_60.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_5_60.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_5_60.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_5_60.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_5_60.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_5_60.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_5_60.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_5_60.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_5_60.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_5_60.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_5_60.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_5_60.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_5_60.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_5_60.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_5_60.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_5_60.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_5_60.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_5_60.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_5_60.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_5_60.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_5_60.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_5_60.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_5_60.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_5_60.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_5_60.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_5_60.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_5_60.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_5_60.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_5_60.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_5_60.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_5_60.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_5_60.sqlite[2/7] [============54%             ] nsys_report_fo_25000_5_60.sqlite[2/7] [============55%             ] nsys_report_fo_25000_5_60.sqlite[2/7] [============56%             ] nsys_report_fo_25000_5_60.sqlite[2/7] [============57%             ] nsys_report_fo_25000_5_60.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_5_60.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_5_60.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_5_60.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_5_60.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_5_60.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_5_60.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_5_60.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_5_60.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_5_60.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_5_60.sqlite[2/7] [================68%         ] nsys_report_fo_25000_5_60.sqlite[2/7] [================69%         ] nsys_report_fo_25000_5_60.sqlite[2/7] [================70%         ] nsys_report_fo_25000_5_60.sqlite[2/7] [================71%         ] nsys_report_fo_25000_5_60.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_5_60.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_5_60.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_5_60.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_5_60.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_5_60.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_5_60.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_5_60.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_5_60.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_5_60.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_5_60.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_5_60.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_5_60.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_5_60.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_5_60.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_5_60.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_5_60.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_5_60.sqlite[2/7] [========================97% ] nsys_report_fo_25000_5_60.sqlite[2/7] [========================98% ] nsys_report_fo_25000_5_60.sqlite[2/7] [========================99% ] nsys_report_fo_25000_5_60.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_60.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        251098287          1  251098287.0  251098287.0  251098287  251098287          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.9        134113586          1  134113586.0  134113586.0  134113586  134113586          0.0  cudaFree                      
      1.8          2485332         10     248533.2     317969.0       3680     361504     133078.7  cudaMalloc                    
      0.2           289823        814        356.0        310.0        120       1390        186.2  cuGetProcAddress_v2           
      0.0            38681          2      19340.5      19340.5       2730      35951      23490.8  cudaStreamCreateWithFlags     
      0.0            19670         18       1092.8        500.0        380       9680       2165.5  cudaEventCreateWithFlags      
      0.0            12220          1      12220.0      12220.0      12220      12220          0.0  cudaHostAlloc                 
      0.0             5280          3       1760.0       2130.0        630       2520        997.8  cuInit                        
      0.0             3180          3       1060.0        260.0        160       2760       1473.1  cuModuleGetLoadingMode        
      0.0              940          2        470.0        470.0        300        640        240.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 5 (num_steps = 80)
number of batches= 16
Generating '/tmp/nsys-report-4a4a.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_5_80.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_5_80.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_5_80.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_5_80.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_80.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [1%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [2%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [3%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [4%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [5%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [6%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [7%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [8%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [9%                          ] nsys_report_ia_25000_5_80.sqlite[2/7] [10%                         ] nsys_report_ia_25000_5_80.sqlite[2/7] [11%                         ] nsys_report_ia_25000_5_80.sqlite[2/7] [12%                         ] nsys_report_ia_25000_5_80.sqlite[2/7] [13%                         ] nsys_report_ia_25000_5_80.sqlite[2/7] [14%                         ] nsys_report_ia_25000_5_80.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_5_80.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_5_80.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_5_80.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_5_80.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_5_80.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_5_80.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_5_80.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_5_80.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_5_80.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_5_80.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_5_80.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_5_80.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_5_80.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_5_80.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_5_80.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_5_80.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_5_80.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_5_80.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_5_80.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_5_80.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_5_80.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_5_80.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_5_80.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_5_80.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_5_80.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_5_80.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_5_80.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_5_80.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_5_80.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_5_80.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_5_80.sqlite[2/7] [============54%             ] nsys_report_ia_25000_5_80.sqlite[2/7] [============55%             ] nsys_report_ia_25000_5_80.sqlite[2/7] [============56%             ] nsys_report_ia_25000_5_80.sqlite[2/7] [============57%             ] nsys_report_ia_25000_5_80.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_5_80.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_5_80.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_5_80.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_5_80.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_5_80.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_5_80.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_5_80.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_5_80.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_5_80.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_5_80.sqlite[2/7] [================68%         ] nsys_report_ia_25000_5_80.sqlite[2/7] [================69%         ] nsys_report_ia_25000_5_80.sqlite[2/7] [================70%         ] nsys_report_ia_25000_5_80.sqlite[2/7] [================71%         ] nsys_report_ia_25000_5_80.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_5_80.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_5_80.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_5_80.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_5_80.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_5_80.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_5_80.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_5_80.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_5_80.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_5_80.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_5_80.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_5_80.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_5_80.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_5_80.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_5_80.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_5_80.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_5_80.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_5_80.sqlite[2/7] [========================97% ] nsys_report_ia_25000_5_80.sqlite[2/7] [========================98% ] nsys_report_ia_25000_5_80.sqlite[2/7] [========================99% ] nsys_report_ia_25000_5_80.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_80.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        237518921          1  237518921.0  237518921.0  237518921  237518921          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        133079161          1  133079161.0  133079161.0  133079161  133079161          0.0  cudaFree                      
      1.7          2336230          7     333747.1     292534.0       3930    1171445     394669.4  cudaMalloc                    
      0.2           305674        814        375.5        320.0        130       1490        201.8  cuGetProcAddress_v2           
      0.0            35831          2      17915.5      17915.5       1850      33981      22720.0  cudaStreamCreateWithFlags     
      0.0            20000         18       1111.1        500.0        390       9470       2124.9  cudaEventCreateWithFlags      
      0.0             4890          3       1630.0       1710.0        700       2480        892.7  cuInit                        
      0.0             4750          3       1583.3        270.0        160       4320       2370.7  cuModuleGetLoadingMode        
      0.0              980          2        490.0        490.0        300        680        268.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 5 (num_steps = 80)
number of batches= 16
Generating '/tmp/nsys-report-0919.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_5_80.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_5_80.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_5_80.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_5_80.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_80.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [1%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [2%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [3%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [4%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [5%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [6%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [7%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [8%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [9%                          ] nsys_report_db_25000_5_80.sqlite[2/7] [10%                         ] nsys_report_db_25000_5_80.sqlite[2/7] [11%                         ] nsys_report_db_25000_5_80.sqlite[2/7] [12%                         ] nsys_report_db_25000_5_80.sqlite[2/7] [13%                         ] nsys_report_db_25000_5_80.sqlite[2/7] [14%                         ] nsys_report_db_25000_5_80.sqlite[2/7] [=15%                        ] nsys_report_db_25000_5_80.sqlite[2/7] [=16%                        ] nsys_report_db_25000_5_80.sqlite[2/7] [=17%                        ] nsys_report_db_25000_5_80.sqlite[2/7] [==18%                       ] nsys_report_db_25000_5_80.sqlite[2/7] [==19%                       ] nsys_report_db_25000_5_80.sqlite[2/7] [==20%                       ] nsys_report_db_25000_5_80.sqlite[2/7] [==21%                       ] nsys_report_db_25000_5_80.sqlite[2/7] [===22%                      ] nsys_report_db_25000_5_80.sqlite[2/7] [===23%                      ] nsys_report_db_25000_5_80.sqlite[2/7] [===24%                      ] nsys_report_db_25000_5_80.sqlite[2/7] [====25%                     ] nsys_report_db_25000_5_80.sqlite[2/7] [====26%                     ] nsys_report_db_25000_5_80.sqlite[2/7] [====27%                     ] nsys_report_db_25000_5_80.sqlite[2/7] [====28%                     ] nsys_report_db_25000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_5_80.sqlite[2/7] [======33%                   ] nsys_report_db_25000_5_80.sqlite[2/7] [======34%                   ] nsys_report_db_25000_5_80.sqlite[2/7] [======35%                   ] nsys_report_db_25000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_5_80.sqlite[2/7] [========40%                 ] nsys_report_db_25000_5_80.sqlite[2/7] [========41%                 ] nsys_report_db_25000_5_80.sqlite[2/7] [========42%                 ] nsys_report_db_25000_5_80.sqlite[2/7] [=========43%                ] nsys_report_db_25000_5_80.sqlite[2/7] [=========44%                ] nsys_report_db_25000_5_80.sqlite[2/7] [=========45%                ] nsys_report_db_25000_5_80.sqlite[2/7] [=========46%                ] nsys_report_db_25000_5_80.sqlite[2/7] [==========47%               ] nsys_report_db_25000_5_80.sqlite[2/7] [==========48%               ] nsys_report_db_25000_5_80.sqlite[2/7] [==========49%               ] nsys_report_db_25000_5_80.sqlite[2/7] [===========50%              ] nsys_report_db_25000_5_80.sqlite[2/7] [===========51%              ] nsys_report_db_25000_5_80.sqlite[2/7] [===========52%              ] nsys_report_db_25000_5_80.sqlite[2/7] [===========53%              ] nsys_report_db_25000_5_80.sqlite[2/7] [============54%             ] nsys_report_db_25000_5_80.sqlite[2/7] [============55%             ] nsys_report_db_25000_5_80.sqlite[2/7] [============56%             ] nsys_report_db_25000_5_80.sqlite[2/7] [============57%             ] nsys_report_db_25000_5_80.sqlite[2/7] [=============58%            ] nsys_report_db_25000_5_80.sqlite[2/7] [=============59%            ] nsys_report_db_25000_5_80.sqlite[2/7] [=============60%            ] nsys_report_db_25000_5_80.sqlite[2/7] [==============61%           ] nsys_report_db_25000_5_80.sqlite[2/7] [==============62%           ] nsys_report_db_25000_5_80.sqlite[2/7] [==============63%           ] nsys_report_db_25000_5_80.sqlite[2/7] [==============64%           ] nsys_report_db_25000_5_80.sqlite[2/7] [===============65%          ] nsys_report_db_25000_5_80.sqlite[2/7] [===============66%          ] nsys_report_db_25000_5_80.sqlite[2/7] [===============67%          ] nsys_report_db_25000_5_80.sqlite[2/7] [================68%         ] nsys_report_db_25000_5_80.sqlite[2/7] [================69%         ] nsys_report_db_25000_5_80.sqlite[2/7] [================70%         ] nsys_report_db_25000_5_80.sqlite[2/7] [================71%         ] nsys_report_db_25000_5_80.sqlite[2/7] [=================72%        ] nsys_report_db_25000_5_80.sqlite[2/7] [=================73%        ] nsys_report_db_25000_5_80.sqlite[2/7] [=================74%        ] nsys_report_db_25000_5_80.sqlite[2/7] [==================75%       ] nsys_report_db_25000_5_80.sqlite[2/7] [==================76%       ] nsys_report_db_25000_5_80.sqlite[2/7] [==================77%       ] nsys_report_db_25000_5_80.sqlite[2/7] [==================78%       ] nsys_report_db_25000_5_80.sqlite[2/7] [===================79%      ] nsys_report_db_25000_5_80.sqlite[2/7] [===================80%      ] nsys_report_db_25000_5_80.sqlite[2/7] [===================81%      ] nsys_report_db_25000_5_80.sqlite[2/7] [===================82%      ] nsys_report_db_25000_5_80.sqlite[2/7] [====================83%     ] nsys_report_db_25000_5_80.sqlite[2/7] [====================84%     ] nsys_report_db_25000_5_80.sqlite[2/7] [====================85%     ] nsys_report_db_25000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_5_80.sqlite[2/7] [======================90%   ] nsys_report_db_25000_5_80.sqlite[2/7] [======================91%   ] nsys_report_db_25000_5_80.sqlite[2/7] [======================92%   ] nsys_report_db_25000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_5_80.sqlite[2/7] [========================97% ] nsys_report_db_25000_5_80.sqlite[2/7] [========================98% ] nsys_report_db_25000_5_80.sqlite[2/7] [========================99% ] nsys_report_db_25000_5_80.sqlite[2/7] [========================100%] nsys_report_db_25000_5_80.sqlite[2/7] [========================100%] nsys_report_db_25000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        249425452          1  249425452.0  249425452.0  249425452  249425452          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        134154384          1  134154384.0  134154384.0  134154384  134154384          0.0  cudaFree                      
      1.7          2265910          7     323701.4     259493.0       4020    1151825     389165.8  cudaMalloc                    
      0.2           268181        814        329.5        280.0        130       1180        179.1  cuGetProcAddress_v2           
      0.0            32250          2      16125.0      16125.0       1800      30450      20258.6  cudaStreamCreateWithFlags     
      0.0            30730         18       1707.2        525.0        410      19660       4501.7  cudaEventCreateWithFlags      
      0.0             3990          3       1330.0       1220.0        560       2210        830.5  cuInit                        
      0.0             3520          3       1173.3        260.0        180       3080       1651.7  cuModuleGetLoadingMode        
      0.0              900          2        450.0        450.0        310        590        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 5 (num_steps = 80), identity_test = 0
Generating '/tmp/nsys-report-64fb.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_5_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_5_80.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_5_80.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_5_80.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_80.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [1%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [2%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [3%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [4%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [5%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [6%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [7%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [8%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [9%                          ] nsys_report_fo_25000_5_80.sqlite[2/7] [10%                         ] nsys_report_fo_25000_5_80.sqlite[2/7] [11%                         ] nsys_report_fo_25000_5_80.sqlite[2/7] [12%                         ] nsys_report_fo_25000_5_80.sqlite[2/7] [13%                         ] nsys_report_fo_25000_5_80.sqlite[2/7] [14%                         ] nsys_report_fo_25000_5_80.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_5_80.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_5_80.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_5_80.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_5_80.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_5_80.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_5_80.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_5_80.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_5_80.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_5_80.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_5_80.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_5_80.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_5_80.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_5_80.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_5_80.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_5_80.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_5_80.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_5_80.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_5_80.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_5_80.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_5_80.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_5_80.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_5_80.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_5_80.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_5_80.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_5_80.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_5_80.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_5_80.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_5_80.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_5_80.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_5_80.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_5_80.sqlite[2/7] [============54%             ] nsys_report_fo_25000_5_80.sqlite[2/7] [============55%             ] nsys_report_fo_25000_5_80.sqlite[2/7] [============56%             ] nsys_report_fo_25000_5_80.sqlite[2/7] [============57%             ] nsys_report_fo_25000_5_80.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_5_80.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_5_80.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_5_80.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_5_80.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_5_80.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_5_80.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_5_80.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_5_80.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_5_80.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_5_80.sqlite[2/7] [================68%         ] nsys_report_fo_25000_5_80.sqlite[2/7] [================69%         ] nsys_report_fo_25000_5_80.sqlite[2/7] [================70%         ] nsys_report_fo_25000_5_80.sqlite[2/7] [================71%         ] nsys_report_fo_25000_5_80.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_5_80.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_5_80.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_5_80.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_5_80.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_5_80.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_5_80.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_5_80.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_5_80.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_5_80.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_5_80.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_5_80.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_5_80.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_5_80.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_5_80.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_5_80.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_5_80.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_5_80.sqlite[2/7] [========================97% ] nsys_report_fo_25000_5_80.sqlite[2/7] [========================98% ] nsys_report_fo_25000_5_80.sqlite[2/7] [========================99% ] nsys_report_fo_25000_5_80.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_80.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        249509497          1  249509497.0  249509497.0  249509497  249509497          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        133448986          1  133448986.0  133448986.0  133448986  133448986          0.0  cudaFree                      
      1.8          2414432         10     241443.2     302959.0       3591     368505     129537.5  cudaMalloc                    
      0.2           289523        814        355.7        310.0        120       1280        188.2  cuGetProcAddress_v2           
      0.0            38101          2      19050.5      19050.5       1970      36131      24155.5  cudaStreamCreateWithFlags     
      0.0            20800         18       1155.6        515.0        390      10200       2291.2  cudaEventCreateWithFlags      
      0.0            15560          1      15560.0      15560.0      15560      15560          0.0  cudaHostAlloc                 
      0.0             5110          3       1703.3       1710.0       1000       2400        700.0  cuInit                        
      0.0             3520          3       1173.3        480.0        250       2790       1404.8  cuModuleGetLoadingMode        
      0.0              900          2        450.0        450.0        310        590        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 5 (num_steps = 100)
number of batches= 20
Generating '/tmp/nsys-report-ed06.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_5_100.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_5_100.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_5_100.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_5_100.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_100.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [1%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [2%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [3%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [4%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [5%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [6%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [7%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [8%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [9%                          ] nsys_report_ia_25000_5_100.sqlite[2/7] [10%                         ] nsys_report_ia_25000_5_100.sqlite[2/7] [11%                         ] nsys_report_ia_25000_5_100.sqlite[2/7] [12%                         ] nsys_report_ia_25000_5_100.sqlite[2/7] [13%                         ] nsys_report_ia_25000_5_100.sqlite[2/7] [14%                         ] nsys_report_ia_25000_5_100.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_5_100.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_5_100.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_5_100.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_5_100.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_5_100.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_5_100.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_5_100.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_5_100.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_5_100.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_5_100.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_5_100.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_5_100.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_5_100.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_5_100.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_5_100.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_5_100.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_5_100.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_5_100.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_5_100.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_5_100.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_5_100.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_5_100.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_5_100.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_5_100.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_5_100.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_5_100.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_5_100.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_5_100.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_5_100.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_5_100.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_5_100.sqlite[2/7] [============54%             ] nsys_report_ia_25000_5_100.sqlite[2/7] [============55%             ] nsys_report_ia_25000_5_100.sqlite[2/7] [============56%             ] nsys_report_ia_25000_5_100.sqlite[2/7] [============57%             ] nsys_report_ia_25000_5_100.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_5_100.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_5_100.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_5_100.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_5_100.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_5_100.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_5_100.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_5_100.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_5_100.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_5_100.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_5_100.sqlite[2/7] [================68%         ] nsys_report_ia_25000_5_100.sqlite[2/7] [================69%         ] nsys_report_ia_25000_5_100.sqlite[2/7] [================70%         ] nsys_report_ia_25000_5_100.sqlite[2/7] [================71%         ] nsys_report_ia_25000_5_100.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_5_100.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_5_100.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_5_100.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_5_100.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_5_100.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_5_100.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_5_100.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_5_100.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_5_100.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_5_100.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_5_100.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_5_100.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_5_100.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_5_100.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_5_100.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_5_100.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_5_100.sqlite[2/7] [========================97% ] nsys_report_ia_25000_5_100.sqlite[2/7] [========================98% ] nsys_report_ia_25000_5_100.sqlite[2/7] [========================99% ] nsys_report_ia_25000_5_100.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_100.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        251872872          1  251872872.0  251872872.0  251872872  251872872          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        133607006          1  133607006.0  133607006.0  133607006  133607006          0.0  cudaFree                      
      1.7          2298749          7     328392.7     264174.0       3950    1159415     391241.1  cudaMalloc                    
      0.3           343965        814        422.6        390.0        120       1590        234.5  cuGetProcAddress_v2           
      0.0            54571          2      27285.5      27285.5       2150      52421      35547.0  cudaStreamCreateWithFlags     
      0.0            19621         18       1090.1        450.0        380       9440       2120.1  cudaEventCreateWithFlags      
      0.0             7040          3       2346.7       2530.0        810       3700       1453.7  cuInit                        
      0.0             4680          3       1560.0        400.0        170       4110       2211.4  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        310        580        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 5 (num_steps = 100)
number of batches= 20
Generating '/tmp/nsys-report-ee5f.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_5_100.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_5_100.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_5_100.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_5_100.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_100.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [1%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [2%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [3%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [4%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [5%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [6%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [7%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [8%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [9%                          ] nsys_report_db_25000_5_100.sqlite[2/7] [10%                         ] nsys_report_db_25000_5_100.sqlite[2/7] [11%                         ] nsys_report_db_25000_5_100.sqlite[2/7] [12%                         ] nsys_report_db_25000_5_100.sqlite[2/7] [13%                         ] nsys_report_db_25000_5_100.sqlite[2/7] [14%                         ] nsys_report_db_25000_5_100.sqlite[2/7] [=15%                        ] nsys_report_db_25000_5_100.sqlite[2/7] [=16%                        ] nsys_report_db_25000_5_100.sqlite[2/7] [=17%                        ] nsys_report_db_25000_5_100.sqlite[2/7] [==18%                       ] nsys_report_db_25000_5_100.sqlite[2/7] [==19%                       ] nsys_report_db_25000_5_100.sqlite[2/7] [==20%                       ] nsys_report_db_25000_5_100.sqlite[2/7] [==21%                       ] nsys_report_db_25000_5_100.sqlite[2/7] [===22%                      ] nsys_report_db_25000_5_100.sqlite[2/7] [===23%                      ] nsys_report_db_25000_5_100.sqlite[2/7] [===24%                      ] nsys_report_db_25000_5_100.sqlite[2/7] [====25%                     ] nsys_report_db_25000_5_100.sqlite[2/7] [====26%                     ] nsys_report_db_25000_5_100.sqlite[2/7] [====27%                     ] nsys_report_db_25000_5_100.sqlite[2/7] [====28%                     ] nsys_report_db_25000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_5_100.sqlite[2/7] [======33%                   ] nsys_report_db_25000_5_100.sqlite[2/7] [======34%                   ] nsys_report_db_25000_5_100.sqlite[2/7] [======35%                   ] nsys_report_db_25000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_5_100.sqlite[2/7] [========40%                 ] nsys_report_db_25000_5_100.sqlite[2/7] [========41%                 ] nsys_report_db_25000_5_100.sqlite[2/7] [========42%                 ] nsys_report_db_25000_5_100.sqlite[2/7] [=========43%                ] nsys_report_db_25000_5_100.sqlite[2/7] [=========44%                ] nsys_report_db_25000_5_100.sqlite[2/7] [=========45%                ] nsys_report_db_25000_5_100.sqlite[2/7] [=========46%                ] nsys_report_db_25000_5_100.sqlite[2/7] [==========47%               ] nsys_report_db_25000_5_100.sqlite[2/7] [==========48%               ] nsys_report_db_25000_5_100.sqlite[2/7] [==========49%               ] nsys_report_db_25000_5_100.sqlite[2/7] [===========50%              ] nsys_report_db_25000_5_100.sqlite[2/7] [===========51%              ] nsys_report_db_25000_5_100.sqlite[2/7] [===========52%              ] nsys_report_db_25000_5_100.sqlite[2/7] [===========53%              ] nsys_report_db_25000_5_100.sqlite[2/7] [============54%             ] nsys_report_db_25000_5_100.sqlite[2/7] [============55%             ] nsys_report_db_25000_5_100.sqlite[2/7] [============56%             ] nsys_report_db_25000_5_100.sqlite[2/7] [============57%             ] nsys_report_db_25000_5_100.sqlite[2/7] [=============58%            ] nsys_report_db_25000_5_100.sqlite[2/7] [=============59%            ] nsys_report_db_25000_5_100.sqlite[2/7] [=============60%            ] nsys_report_db_25000_5_100.sqlite[2/7] [==============61%           ] nsys_report_db_25000_5_100.sqlite[2/7] [==============62%           ] nsys_report_db_25000_5_100.sqlite[2/7] [==============63%           ] nsys_report_db_25000_5_100.sqlite[2/7] [==============64%           ] nsys_report_db_25000_5_100.sqlite[2/7] [===============65%          ] nsys_report_db_25000_5_100.sqlite[2/7] [===============66%          ] nsys_report_db_25000_5_100.sqlite[2/7] [===============67%          ] nsys_report_db_25000_5_100.sqlite[2/7] [================68%         ] nsys_report_db_25000_5_100.sqlite[2/7] [================69%         ] nsys_report_db_25000_5_100.sqlite[2/7] [================70%         ] nsys_report_db_25000_5_100.sqlite[2/7] [================71%         ] nsys_report_db_25000_5_100.sqlite[2/7] [=================72%        ] nsys_report_db_25000_5_100.sqlite[2/7] [=================73%        ] nsys_report_db_25000_5_100.sqlite[2/7] [=================74%        ] nsys_report_db_25000_5_100.sqlite[2/7] [==================75%       ] nsys_report_db_25000_5_100.sqlite[2/7] [==================76%       ] nsys_report_db_25000_5_100.sqlite[2/7] [==================77%       ] nsys_report_db_25000_5_100.sqlite[2/7] [==================78%       ] nsys_report_db_25000_5_100.sqlite[2/7] [===================79%      ] nsys_report_db_25000_5_100.sqlite[2/7] [===================80%      ] nsys_report_db_25000_5_100.sqlite[2/7] [===================81%      ] nsys_report_db_25000_5_100.sqlite[2/7] [===================82%      ] nsys_report_db_25000_5_100.sqlite[2/7] [====================83%     ] nsys_report_db_25000_5_100.sqlite[2/7] [====================84%     ] nsys_report_db_25000_5_100.sqlite[2/7] [====================85%     ] nsys_report_db_25000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_5_100.sqlite[2/7] [======================90%   ] nsys_report_db_25000_5_100.sqlite[2/7] [======================91%   ] nsys_report_db_25000_5_100.sqlite[2/7] [======================92%   ] nsys_report_db_25000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_5_100.sqlite[2/7] [========================97% ] nsys_report_db_25000_5_100.sqlite[2/7] [========================98% ] nsys_report_db_25000_5_100.sqlite[2/7] [========================99% ] nsys_report_db_25000_5_100.sqlite[2/7] [========================100%] nsys_report_db_25000_5_100.sqlite[2/7] [========================100%] nsys_report_db_25000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        262037061          1  262037061.0  262037061.0  262037061  262037061          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        144585006          1  144585006.0  144585006.0  144585006  144585006          0.0  cudaFree                      
      1.5          2270358          7     324336.9     264913.0       3960    1110005     372715.6  cudaMalloc                    
      0.2           344984        814        423.8        390.0        120       1630        248.7  cuGetProcAddress_v2           
      0.0            53631          2      26815.5      26815.5       3530      50101      32930.7  cudaStreamCreateWithFlags     
      0.0            18502         18       1027.9        450.0        410       8320       1856.9  cudaEventCreateWithFlags      
      0.0             7180          3       2393.3       2730.0        600       3850       1650.9  cuInit                        
      0.0             4730          3       1576.7        390.0        290       4050       2142.6  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        310        640        233.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 5 (num_steps = 100), identity_test = 0
Generating '/tmp/nsys-report-339e.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_5_100.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_25000_5_100.nsys-rep[1/7] [===============65%          ] nsys_report_fo_25000_5_100.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_5_100.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_100.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [1%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [2%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [3%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [4%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [5%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [6%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [7%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [8%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [9%                          ] nsys_report_fo_25000_5_100.sqlite[2/7] [10%                         ] nsys_report_fo_25000_5_100.sqlite[2/7] [11%                         ] nsys_report_fo_25000_5_100.sqlite[2/7] [12%                         ] nsys_report_fo_25000_5_100.sqlite[2/7] [13%                         ] nsys_report_fo_25000_5_100.sqlite[2/7] [14%                         ] nsys_report_fo_25000_5_100.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_5_100.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_5_100.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_5_100.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_5_100.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_5_100.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_5_100.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_5_100.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_5_100.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_5_100.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_5_100.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_5_100.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_5_100.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_5_100.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_5_100.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_5_100.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_5_100.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_5_100.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_5_100.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_5_100.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_5_100.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_5_100.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_5_100.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_5_100.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_5_100.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_5_100.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_5_100.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_5_100.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_5_100.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_5_100.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_5_100.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_5_100.sqlite[2/7] [============54%             ] nsys_report_fo_25000_5_100.sqlite[2/7] [============55%             ] nsys_report_fo_25000_5_100.sqlite[2/7] [============56%             ] nsys_report_fo_25000_5_100.sqlite[2/7] [============57%             ] nsys_report_fo_25000_5_100.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_5_100.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_5_100.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_5_100.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_5_100.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_5_100.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_5_100.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_5_100.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_5_100.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_5_100.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_5_100.sqlite[2/7] [================68%         ] nsys_report_fo_25000_5_100.sqlite[2/7] [================69%         ] nsys_report_fo_25000_5_100.sqlite[2/7] [================70%         ] nsys_report_fo_25000_5_100.sqlite[2/7] [================71%         ] nsys_report_fo_25000_5_100.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_5_100.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_5_100.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_5_100.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_5_100.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_5_100.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_5_100.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_5_100.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_5_100.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_5_100.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_5_100.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_5_100.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_5_100.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_5_100.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_5_100.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_5_100.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_5_100.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_5_100.sqlite[2/7] [========================97% ] nsys_report_fo_25000_5_100.sqlite[2/7] [========================98% ] nsys_report_fo_25000_5_100.sqlite[2/7] [========================99% ] nsys_report_fo_25000_5_100.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_100.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        246140404          1  246140404.0  246140404.0  246140404  246140404          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.9        129902035          1  129902035.0  129902035.0  129902035  129902035          0.0  cudaFree                      
      1.8          2395051         10     239505.1     303334.0       4120     367875     128281.1  cudaMalloc                    
      0.2           300494        814        369.2        310.0        140       1470        185.7  cuGetProcAddress_v2           
      0.0            38861          2      19430.5      19430.5       3190      35671      22967.5  cudaStreamCreateWithFlags     
      0.0            23271         18       1292.8        515.0        400      12700       2868.0  cudaEventCreateWithFlags      
      0.0            11930          1      11930.0      11930.0      11930      11930          0.0  cudaHostAlloc                 
      0.0             4770          3       1590.0       1820.0        590       2360        907.1  cuInit                        
      0.0             3280          3       1093.3        280.0        280       2720       1408.7  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        330        560        162.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 5 (num_steps = 150)
number of batches= 30
Generating '/tmp/nsys-report-8f8d.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_5_150.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_5_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_5_150.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_150.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [1%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [2%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [3%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [4%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [5%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [6%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [7%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [8%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [9%                          ] nsys_report_ia_25000_5_150.sqlite[2/7] [10%                         ] nsys_report_ia_25000_5_150.sqlite[2/7] [11%                         ] nsys_report_ia_25000_5_150.sqlite[2/7] [12%                         ] nsys_report_ia_25000_5_150.sqlite[2/7] [13%                         ] nsys_report_ia_25000_5_150.sqlite[2/7] [14%                         ] nsys_report_ia_25000_5_150.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_5_150.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_5_150.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_5_150.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_5_150.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_5_150.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_5_150.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_5_150.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_5_150.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_5_150.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_5_150.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_5_150.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_5_150.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_5_150.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_5_150.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_5_150.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_5_150.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_5_150.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_5_150.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_5_150.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_5_150.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_5_150.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_5_150.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_5_150.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_5_150.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_5_150.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_5_150.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_5_150.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_5_150.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_5_150.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_5_150.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_5_150.sqlite[2/7] [============54%             ] nsys_report_ia_25000_5_150.sqlite[2/7] [============55%             ] nsys_report_ia_25000_5_150.sqlite[2/7] [============56%             ] nsys_report_ia_25000_5_150.sqlite[2/7] [============57%             ] nsys_report_ia_25000_5_150.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_5_150.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_5_150.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_5_150.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_5_150.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_5_150.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_5_150.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_5_150.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_5_150.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_5_150.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_5_150.sqlite[2/7] [================68%         ] nsys_report_ia_25000_5_150.sqlite[2/7] [================69%         ] nsys_report_ia_25000_5_150.sqlite[2/7] [================70%         ] nsys_report_ia_25000_5_150.sqlite[2/7] [================71%         ] nsys_report_ia_25000_5_150.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_5_150.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_5_150.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_5_150.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_5_150.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_5_150.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_5_150.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_5_150.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_5_150.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_5_150.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_5_150.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_5_150.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_5_150.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_5_150.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_5_150.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_5_150.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_5_150.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_5_150.sqlite[2/7] [========================97% ] nsys_report_ia_25000_5_150.sqlite[2/7] [========================98% ] nsys_report_ia_25000_5_150.sqlite[2/7] [========================99% ] nsys_report_ia_25000_5_150.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_150.sqlite[2/7] [========================100%] nsys_report_ia_25000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        250615639          1  250615639.0  250615639.0  250615639  250615639          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        132955374          1  132955374.0  132955374.0  132955374  132955374          0.0  cudaFree                      
      1.7          2290940          7     327277.1     268783.0       4080    1151865     388634.2  cudaMalloc                    
      0.2           334983        814        411.5        380.0        130       1720        241.1  cuGetProcAddress_v2           
      0.0            41461          2      20730.5      20730.5       2420      39041      25895.0  cudaStreamCreateWithFlags     
      0.0            20390         18       1132.8        505.0        390       9610       2148.3  cudaEventCreateWithFlags      
      0.0             5650          3       1883.3       2030.0        670       2950       1147.1  cuInit                        
      0.0             4430          3       1476.7        380.0        270       3780       1995.5  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        320        600        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_5_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 5 (num_steps = 150)
number of batches= 30
Generating '/tmp/nsys-report-934e.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_5_150.nsys-rep[1/7] [=====31%                    ] nsys_report_db_25000_5_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_5_150.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_5_150.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_150.nsys-rep[1/7] [========================100%] nsys_report_db_25000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [1%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [2%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [3%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [4%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [5%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [6%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [7%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [8%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [9%                          ] nsys_report_db_25000_5_150.sqlite[2/7] [10%                         ] nsys_report_db_25000_5_150.sqlite[2/7] [11%                         ] nsys_report_db_25000_5_150.sqlite[2/7] [12%                         ] nsys_report_db_25000_5_150.sqlite[2/7] [13%                         ] nsys_report_db_25000_5_150.sqlite[2/7] [14%                         ] nsys_report_db_25000_5_150.sqlite[2/7] [=15%                        ] nsys_report_db_25000_5_150.sqlite[2/7] [=16%                        ] nsys_report_db_25000_5_150.sqlite[2/7] [=17%                        ] nsys_report_db_25000_5_150.sqlite[2/7] [==18%                       ] nsys_report_db_25000_5_150.sqlite[2/7] [==19%                       ] nsys_report_db_25000_5_150.sqlite[2/7] [==20%                       ] nsys_report_db_25000_5_150.sqlite[2/7] [==21%                       ] nsys_report_db_25000_5_150.sqlite[2/7] [===22%                      ] nsys_report_db_25000_5_150.sqlite[2/7] [===23%                      ] nsys_report_db_25000_5_150.sqlite[2/7] [===24%                      ] nsys_report_db_25000_5_150.sqlite[2/7] [====25%                     ] nsys_report_db_25000_5_150.sqlite[2/7] [====26%                     ] nsys_report_db_25000_5_150.sqlite[2/7] [====27%                     ] nsys_report_db_25000_5_150.sqlite[2/7] [====28%                     ] nsys_report_db_25000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_5_150.sqlite[2/7] [======33%                   ] nsys_report_db_25000_5_150.sqlite[2/7] [======34%                   ] nsys_report_db_25000_5_150.sqlite[2/7] [======35%                   ] nsys_report_db_25000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_5_150.sqlite[2/7] [========40%                 ] nsys_report_db_25000_5_150.sqlite[2/7] [========41%                 ] nsys_report_db_25000_5_150.sqlite[2/7] [========42%                 ] nsys_report_db_25000_5_150.sqlite[2/7] [=========43%                ] nsys_report_db_25000_5_150.sqlite[2/7] [=========44%                ] nsys_report_db_25000_5_150.sqlite[2/7] [=========45%                ] nsys_report_db_25000_5_150.sqlite[2/7] [=========46%                ] nsys_report_db_25000_5_150.sqlite[2/7] [==========47%               ] nsys_report_db_25000_5_150.sqlite[2/7] [==========48%               ] nsys_report_db_25000_5_150.sqlite[2/7] [==========49%               ] nsys_report_db_25000_5_150.sqlite[2/7] [===========50%              ] nsys_report_db_25000_5_150.sqlite[2/7] [===========51%              ] nsys_report_db_25000_5_150.sqlite[2/7] [===========52%              ] nsys_report_db_25000_5_150.sqlite[2/7] [===========53%              ] nsys_report_db_25000_5_150.sqlite[2/7] [============54%             ] nsys_report_db_25000_5_150.sqlite[2/7] [============55%             ] nsys_report_db_25000_5_150.sqlite[2/7] [============56%             ] nsys_report_db_25000_5_150.sqlite[2/7] [============57%             ] nsys_report_db_25000_5_150.sqlite[2/7] [=============58%            ] nsys_report_db_25000_5_150.sqlite[2/7] [=============59%            ] nsys_report_db_25000_5_150.sqlite[2/7] [=============60%            ] nsys_report_db_25000_5_150.sqlite[2/7] [==============61%           ] nsys_report_db_25000_5_150.sqlite[2/7] [==============62%           ] nsys_report_db_25000_5_150.sqlite[2/7] [==============63%           ] nsys_report_db_25000_5_150.sqlite[2/7] [==============64%           ] nsys_report_db_25000_5_150.sqlite[2/7] [===============65%          ] nsys_report_db_25000_5_150.sqlite[2/7] [===============66%          ] nsys_report_db_25000_5_150.sqlite[2/7] [===============67%          ] nsys_report_db_25000_5_150.sqlite[2/7] [================68%         ] nsys_report_db_25000_5_150.sqlite[2/7] [================69%         ] nsys_report_db_25000_5_150.sqlite[2/7] [================70%         ] nsys_report_db_25000_5_150.sqlite[2/7] [================71%         ] nsys_report_db_25000_5_150.sqlite[2/7] [=================72%        ] nsys_report_db_25000_5_150.sqlite[2/7] [=================73%        ] nsys_report_db_25000_5_150.sqlite[2/7] [=================74%        ] nsys_report_db_25000_5_150.sqlite[2/7] [==================75%       ] nsys_report_db_25000_5_150.sqlite[2/7] [==================76%       ] nsys_report_db_25000_5_150.sqlite[2/7] [==================77%       ] nsys_report_db_25000_5_150.sqlite[2/7] [==================78%       ] nsys_report_db_25000_5_150.sqlite[2/7] [===================79%      ] nsys_report_db_25000_5_150.sqlite[2/7] [===================80%      ] nsys_report_db_25000_5_150.sqlite[2/7] [===================81%      ] nsys_report_db_25000_5_150.sqlite[2/7] [===================82%      ] nsys_report_db_25000_5_150.sqlite[2/7] [====================83%     ] nsys_report_db_25000_5_150.sqlite[2/7] [====================84%     ] nsys_report_db_25000_5_150.sqlite[2/7] [====================85%     ] nsys_report_db_25000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_5_150.sqlite[2/7] [======================90%   ] nsys_report_db_25000_5_150.sqlite[2/7] [======================91%   ] nsys_report_db_25000_5_150.sqlite[2/7] [======================92%   ] nsys_report_db_25000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_5_150.sqlite[2/7] [========================97% ] nsys_report_db_25000_5_150.sqlite[2/7] [========================98% ] nsys_report_db_25000_5_150.sqlite[2/7] [========================99% ] nsys_report_db_25000_5_150.sqlite[2/7] [========================100%] nsys_report_db_25000_5_150.sqlite[2/7] [========================100%] nsys_report_db_25000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        243590967          1  243590967.0  243590967.0  243590967  243590967          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.9        128904411          1  128904411.0  128904411.0  128904411  128904411          0.0  cudaFree                      
      1.7          2283950          7     326278.6     258463.0       3670    1145455     385724.8  cudaMalloc                    
      0.3           355015        814        436.1        400.0        120       1570        242.8  cuGetProcAddress_v2           
      0.0            40251          2      20125.5      20125.5       2040      38211      25576.8  cudaStreamCreateWithFlags     
      0.0            21300         18       1183.3        515.0        390      10720       2405.6  cudaEventCreateWithFlags      
      0.0             5190          3       1730.0       1790.0        590       2810       1111.2  cuInit                        
      0.0             3930          3       1310.0        460.0        170       3300       1729.5  cuModuleGetLoadingMode        
      0.0             1040          2        520.0        520.0        440        600        113.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_5_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 5 (num_steps = 150), identity_test = 0
Generating '/tmp/nsys-report-e474.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_5_150.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_5_150.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_5_150.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_150.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [1%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [2%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [3%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [4%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [5%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [6%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [7%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [8%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [9%                          ] nsys_report_fo_25000_5_150.sqlite[2/7] [10%                         ] nsys_report_fo_25000_5_150.sqlite[2/7] [11%                         ] nsys_report_fo_25000_5_150.sqlite[2/7] [12%                         ] nsys_report_fo_25000_5_150.sqlite[2/7] [13%                         ] nsys_report_fo_25000_5_150.sqlite[2/7] [14%                         ] nsys_report_fo_25000_5_150.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_5_150.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_5_150.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_5_150.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_5_150.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_5_150.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_5_150.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_5_150.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_5_150.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_5_150.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_5_150.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_5_150.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_5_150.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_5_150.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_5_150.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_5_150.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_5_150.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_5_150.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_5_150.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_5_150.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_5_150.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_5_150.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_5_150.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_5_150.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_5_150.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_5_150.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_5_150.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_5_150.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_5_150.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_5_150.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_5_150.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_5_150.sqlite[2/7] [============54%             ] nsys_report_fo_25000_5_150.sqlite[2/7] [============55%             ] nsys_report_fo_25000_5_150.sqlite[2/7] [============56%             ] nsys_report_fo_25000_5_150.sqlite[2/7] [============57%             ] nsys_report_fo_25000_5_150.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_5_150.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_5_150.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_5_150.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_5_150.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_5_150.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_5_150.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_5_150.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_5_150.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_5_150.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_5_150.sqlite[2/7] [================68%         ] nsys_report_fo_25000_5_150.sqlite[2/7] [================69%         ] nsys_report_fo_25000_5_150.sqlite[2/7] [================70%         ] nsys_report_fo_25000_5_150.sqlite[2/7] [================71%         ] nsys_report_fo_25000_5_150.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_5_150.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_5_150.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_5_150.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_5_150.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_5_150.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_5_150.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_5_150.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_5_150.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_5_150.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_5_150.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_5_150.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_5_150.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_5_150.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_5_150.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_5_150.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_5_150.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_5_150.sqlite[2/7] [========================97% ] nsys_report_fo_25000_5_150.sqlite[2/7] [========================98% ] nsys_report_fo_25000_5_150.sqlite[2/7] [========================99% ] nsys_report_fo_25000_5_150.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_150.sqlite[2/7] [========================100%] nsys_report_fo_25000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        266041967          1  266041967.0  266041967.0  266041967  266041967          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        147832246          1  147832246.0  147832246.0  147832246  147832246          0.0  cudaFree                      
      1.6          2460123         10     246012.3     311344.0       3670     389575     133412.4  cudaMalloc                    
      0.2           345744        814        424.7        390.0        120       1870        245.3  cuGetProcAddress_v2           
      0.0            49631          2      24815.5      24815.5       2120      47511      32096.3  cudaStreamCreateWithFlags     
      0.0            18980         18       1054.4        495.0        390       8680       1938.8  cudaEventCreateWithFlags      
      0.0            13120          1      13120.0      13120.0      13120      13120          0.0  cudaHostAlloc                 
      0.0             7630          3       2543.3       3270.0        880       3480       1444.3  cuInit                        
      0.0             5240          3       1746.7        570.0        270       4400       2302.7  cuModuleGetLoadingMode        
      0.0             1030          2        515.0        515.0        330        700        261.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_5_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 10 (num_steps = 20)
number of batches= 2
Generating '/tmp/nsys-report-386c.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_10_20.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_10_20.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_10_20.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_10_20.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_20.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [1%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [2%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [3%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [4%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [5%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [6%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [7%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [8%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [9%                          ] nsys_report_ia_25000_10_20.sqlite[2/7] [10%                         ] nsys_report_ia_25000_10_20.sqlite[2/7] [11%                         ] nsys_report_ia_25000_10_20.sqlite[2/7] [12%                         ] nsys_report_ia_25000_10_20.sqlite[2/7] [13%                         ] nsys_report_ia_25000_10_20.sqlite[2/7] [14%                         ] nsys_report_ia_25000_10_20.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_10_20.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_10_20.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_10_20.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_10_20.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_10_20.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_10_20.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_10_20.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_10_20.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_10_20.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_10_20.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_10_20.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_10_20.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_10_20.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_10_20.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_10_20.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_10_20.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_10_20.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_10_20.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_10_20.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_10_20.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_10_20.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_10_20.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_10_20.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_10_20.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_10_20.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_10_20.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_10_20.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_10_20.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_10_20.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_10_20.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_10_20.sqlite[2/7] [============54%             ] nsys_report_ia_25000_10_20.sqlite[2/7] [============55%             ] nsys_report_ia_25000_10_20.sqlite[2/7] [============56%             ] nsys_report_ia_25000_10_20.sqlite[2/7] [============57%             ] nsys_report_ia_25000_10_20.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_10_20.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_10_20.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_10_20.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_10_20.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_10_20.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_10_20.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_10_20.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_10_20.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_10_20.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_10_20.sqlite[2/7] [================68%         ] nsys_report_ia_25000_10_20.sqlite[2/7] [================69%         ] nsys_report_ia_25000_10_20.sqlite[2/7] [================70%         ] nsys_report_ia_25000_10_20.sqlite[2/7] [================71%         ] nsys_report_ia_25000_10_20.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_10_20.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_10_20.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_10_20.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_10_20.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_10_20.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_10_20.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_10_20.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_10_20.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_10_20.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_10_20.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_10_20.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_10_20.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_10_20.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_10_20.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_10_20.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_10_20.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_10_20.sqlite[2/7] [========================97% ] nsys_report_ia_25000_10_20.sqlite[2/7] [========================98% ] nsys_report_ia_25000_10_20.sqlite[2/7] [========================99% ] nsys_report_ia_25000_10_20.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_20.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        249251938          1  249251938.0  249251938.0  249251938  249251938          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        132036250          1  132036250.0  132036250.0  132036250  132036250          0.0  cudaFree                      
      1.2          1613669          6     268944.8     204847.5       4010     765019     280880.9  cudaMalloc                    
      0.2           269334        814        330.9        290.0        120       1360        173.2  cuGetProcAddress_v2           
      0.0            32891          2      16445.5      16445.5       1870      31021      20612.9  cudaStreamCreateWithFlags     
      0.0            19531         18       1085.1        495.0        380       9400       2103.8  cudaEventCreateWithFlags      
      0.0             4310          3       1436.7       1300.0        560       2450        952.4  cuInit                        
      0.0             3580          3       1193.3        250.0        170       3160       1703.7  cuModuleGetLoadingMode        
      0.0              970          2        485.0        485.0        310        660        247.5  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 10 (num_steps = 20)
number of batches= 2
Generating '/tmp/nsys-report-d330.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_10_20.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_10_20.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_10_20.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_10_20.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_20.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [1%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [2%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [3%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [4%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [5%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [6%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [7%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [8%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [9%                          ] nsys_report_db_25000_10_20.sqlite[2/7] [10%                         ] nsys_report_db_25000_10_20.sqlite[2/7] [11%                         ] nsys_report_db_25000_10_20.sqlite[2/7] [12%                         ] nsys_report_db_25000_10_20.sqlite[2/7] [13%                         ] nsys_report_db_25000_10_20.sqlite[2/7] [14%                         ] nsys_report_db_25000_10_20.sqlite[2/7] [=15%                        ] nsys_report_db_25000_10_20.sqlite[2/7] [=16%                        ] nsys_report_db_25000_10_20.sqlite[2/7] [=17%                        ] nsys_report_db_25000_10_20.sqlite[2/7] [==18%                       ] nsys_report_db_25000_10_20.sqlite[2/7] [==19%                       ] nsys_report_db_25000_10_20.sqlite[2/7] [==20%                       ] nsys_report_db_25000_10_20.sqlite[2/7] [==21%                       ] nsys_report_db_25000_10_20.sqlite[2/7] [===22%                      ] nsys_report_db_25000_10_20.sqlite[2/7] [===23%                      ] nsys_report_db_25000_10_20.sqlite[2/7] [===24%                      ] nsys_report_db_25000_10_20.sqlite[2/7] [====25%                     ] nsys_report_db_25000_10_20.sqlite[2/7] [====26%                     ] nsys_report_db_25000_10_20.sqlite[2/7] [====27%                     ] nsys_report_db_25000_10_20.sqlite[2/7] [====28%                     ] nsys_report_db_25000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_10_20.sqlite[2/7] [======33%                   ] nsys_report_db_25000_10_20.sqlite[2/7] [======34%                   ] nsys_report_db_25000_10_20.sqlite[2/7] [======35%                   ] nsys_report_db_25000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_10_20.sqlite[2/7] [========40%                 ] nsys_report_db_25000_10_20.sqlite[2/7] [========41%                 ] nsys_report_db_25000_10_20.sqlite[2/7] [========42%                 ] nsys_report_db_25000_10_20.sqlite[2/7] [=========43%                ] nsys_report_db_25000_10_20.sqlite[2/7] [=========44%                ] nsys_report_db_25000_10_20.sqlite[2/7] [=========45%                ] nsys_report_db_25000_10_20.sqlite[2/7] [=========46%                ] nsys_report_db_25000_10_20.sqlite[2/7] [==========47%               ] nsys_report_db_25000_10_20.sqlite[2/7] [==========48%               ] nsys_report_db_25000_10_20.sqlite[2/7] [==========49%               ] nsys_report_db_25000_10_20.sqlite[2/7] [===========50%              ] nsys_report_db_25000_10_20.sqlite[2/7] [===========51%              ] nsys_report_db_25000_10_20.sqlite[2/7] [===========52%              ] nsys_report_db_25000_10_20.sqlite[2/7] [===========53%              ] nsys_report_db_25000_10_20.sqlite[2/7] [============54%             ] nsys_report_db_25000_10_20.sqlite[2/7] [============55%             ] nsys_report_db_25000_10_20.sqlite[2/7] [============56%             ] nsys_report_db_25000_10_20.sqlite[2/7] [============57%             ] nsys_report_db_25000_10_20.sqlite[2/7] [=============58%            ] nsys_report_db_25000_10_20.sqlite[2/7] [=============59%            ] nsys_report_db_25000_10_20.sqlite[2/7] [=============60%            ] nsys_report_db_25000_10_20.sqlite[2/7] [==============61%           ] nsys_report_db_25000_10_20.sqlite[2/7] [==============62%           ] nsys_report_db_25000_10_20.sqlite[2/7] [==============63%           ] nsys_report_db_25000_10_20.sqlite[2/7] [==============64%           ] nsys_report_db_25000_10_20.sqlite[2/7] [===============65%          ] nsys_report_db_25000_10_20.sqlite[2/7] [===============66%          ] nsys_report_db_25000_10_20.sqlite[2/7] [===============67%          ] nsys_report_db_25000_10_20.sqlite[2/7] [================68%         ] nsys_report_db_25000_10_20.sqlite[2/7] [================69%         ] nsys_report_db_25000_10_20.sqlite[2/7] [================70%         ] nsys_report_db_25000_10_20.sqlite[2/7] [================71%         ] nsys_report_db_25000_10_20.sqlite[2/7] [=================72%        ] nsys_report_db_25000_10_20.sqlite[2/7] [=================73%        ] nsys_report_db_25000_10_20.sqlite[2/7] [=================74%        ] nsys_report_db_25000_10_20.sqlite[2/7] [==================75%       ] nsys_report_db_25000_10_20.sqlite[2/7] [==================76%       ] nsys_report_db_25000_10_20.sqlite[2/7] [==================77%       ] nsys_report_db_25000_10_20.sqlite[2/7] [==================78%       ] nsys_report_db_25000_10_20.sqlite[2/7] [===================79%      ] nsys_report_db_25000_10_20.sqlite[2/7] [===================80%      ] nsys_report_db_25000_10_20.sqlite[2/7] [===================81%      ] nsys_report_db_25000_10_20.sqlite[2/7] [===================82%      ] nsys_report_db_25000_10_20.sqlite[2/7] [====================83%     ] nsys_report_db_25000_10_20.sqlite[2/7] [====================84%     ] nsys_report_db_25000_10_20.sqlite[2/7] [====================85%     ] nsys_report_db_25000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_10_20.sqlite[2/7] [======================90%   ] nsys_report_db_25000_10_20.sqlite[2/7] [======================91%   ] nsys_report_db_25000_10_20.sqlite[2/7] [======================92%   ] nsys_report_db_25000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_10_20.sqlite[2/7] [========================97% ] nsys_report_db_25000_10_20.sqlite[2/7] [========================98% ] nsys_report_db_25000_10_20.sqlite[2/7] [========================99% ] nsys_report_db_25000_10_20.sqlite[2/7] [========================100%] nsys_report_db_25000_10_20.sqlite[2/7] [========================100%] nsys_report_db_25000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        278259949          1  278259949.0  278259949.0  278259949  278259949          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        159608405          1  159608405.0  159608405.0  159608405  159608405          0.0  cudaFree                      
      1.0          1637411          6     272901.8     209197.5       3820     773860     283504.5  cudaMalloc                    
      0.2           272573        814        334.9        280.0        120       1340        177.9  cuGetProcAddress_v2           
      0.0            33731          2      16865.5      16865.5       2730      31001      19990.6  cudaStreamCreateWithFlags     
      0.0            19560         18       1086.7        490.0        390       9450       2119.5  cudaEventCreateWithFlags      
      0.0             4630          3       1543.3       1310.0        690       2630        990.8  cuInit                        
      0.0             3750          3       1250.0        370.0        160       3220       1709.3  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        310        610        212.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 10 (num_steps = 20), identity_test = 0
Generating '/tmp/nsys-report-d08d.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_10_20.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_10_20.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_10_20.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_10_20.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_20.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [1%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [2%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [3%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [4%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [5%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [6%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [7%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [8%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [9%                          ] nsys_report_fo_25000_10_20.sqlite[2/7] [10%                         ] nsys_report_fo_25000_10_20.sqlite[2/7] [11%                         ] nsys_report_fo_25000_10_20.sqlite[2/7] [12%                         ] nsys_report_fo_25000_10_20.sqlite[2/7] [13%                         ] nsys_report_fo_25000_10_20.sqlite[2/7] [14%                         ] nsys_report_fo_25000_10_20.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_10_20.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_10_20.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_10_20.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_10_20.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_10_20.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_10_20.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_10_20.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_10_20.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_10_20.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_10_20.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_10_20.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_10_20.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_10_20.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_10_20.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_10_20.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_10_20.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_10_20.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_10_20.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_10_20.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_10_20.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_10_20.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_10_20.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_10_20.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_10_20.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_10_20.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_10_20.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_10_20.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_10_20.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_10_20.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_10_20.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_10_20.sqlite[2/7] [============54%             ] nsys_report_fo_25000_10_20.sqlite[2/7] [============55%             ] nsys_report_fo_25000_10_20.sqlite[2/7] [============56%             ] nsys_report_fo_25000_10_20.sqlite[2/7] [============57%             ] nsys_report_fo_25000_10_20.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_10_20.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_10_20.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_10_20.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_10_20.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_10_20.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_10_20.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_10_20.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_10_20.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_10_20.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_10_20.sqlite[2/7] [================68%         ] nsys_report_fo_25000_10_20.sqlite[2/7] [================69%         ] nsys_report_fo_25000_10_20.sqlite[2/7] [================70%         ] nsys_report_fo_25000_10_20.sqlite[2/7] [================71%         ] nsys_report_fo_25000_10_20.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_10_20.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_10_20.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_10_20.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_10_20.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_10_20.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_10_20.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_10_20.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_10_20.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_10_20.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_10_20.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_10_20.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_10_20.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_10_20.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_10_20.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_10_20.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_10_20.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_10_20.sqlite[2/7] [========================97% ] nsys_report_fo_25000_10_20.sqlite[2/7] [========================98% ] nsys_report_fo_25000_10_20.sqlite[2/7] [========================99% ] nsys_report_fo_25000_10_20.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_20.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        272549004          1  272549004.0  272549004.0  272549004  272549004          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.9        152802885          1  152802885.0  152802885.0  152802885  152802885          0.0  cudaFree                      
      1.9          2967018         12     247251.5     318979.0       3720     368905     127941.1  cudaMalloc                    
      0.2           296863        814        364.7        310.5        130       1320        187.5  cuGetProcAddress_v2           
      0.0            38781          2      19390.5      19390.5       2010      36771      24579.7  cudaStreamCreateWithFlags     
      0.0            27131         18       1507.3        510.0        420      16391       3732.7  cudaEventCreateWithFlags      
      0.0             5400          3       1800.0       1970.0        710       2720       1015.7  cuInit                        
      0.0             3490          3       1163.3        540.0        280       2670       1311.3  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        290        660        261.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 10 (num_steps = 40)
number of batches= 4
Generating '/tmp/nsys-report-7a7c.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_10_40.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_10_40.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_10_40.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_10_40.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_40.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [1%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [2%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [3%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [4%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [5%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [6%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [7%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [8%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [9%                          ] nsys_report_ia_25000_10_40.sqlite[2/7] [10%                         ] nsys_report_ia_25000_10_40.sqlite[2/7] [11%                         ] nsys_report_ia_25000_10_40.sqlite[2/7] [12%                         ] nsys_report_ia_25000_10_40.sqlite[2/7] [13%                         ] nsys_report_ia_25000_10_40.sqlite[2/7] [14%                         ] nsys_report_ia_25000_10_40.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_10_40.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_10_40.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_10_40.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_10_40.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_10_40.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_10_40.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_10_40.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_10_40.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_10_40.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_10_40.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_10_40.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_10_40.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_10_40.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_10_40.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_10_40.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_10_40.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_10_40.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_10_40.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_10_40.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_10_40.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_10_40.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_10_40.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_10_40.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_10_40.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_10_40.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_10_40.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_10_40.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_10_40.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_10_40.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_10_40.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_10_40.sqlite[2/7] [============54%             ] nsys_report_ia_25000_10_40.sqlite[2/7] [============55%             ] nsys_report_ia_25000_10_40.sqlite[2/7] [============56%             ] nsys_report_ia_25000_10_40.sqlite[2/7] [============57%             ] nsys_report_ia_25000_10_40.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_10_40.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_10_40.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_10_40.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_10_40.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_10_40.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_10_40.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_10_40.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_10_40.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_10_40.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_10_40.sqlite[2/7] [================68%         ] nsys_report_ia_25000_10_40.sqlite[2/7] [================69%         ] nsys_report_ia_25000_10_40.sqlite[2/7] [================70%         ] nsys_report_ia_25000_10_40.sqlite[2/7] [================71%         ] nsys_report_ia_25000_10_40.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_10_40.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_10_40.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_10_40.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_10_40.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_10_40.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_10_40.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_10_40.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_10_40.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_10_40.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_10_40.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_10_40.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_10_40.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_10_40.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_10_40.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_10_40.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_10_40.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_10_40.sqlite[2/7] [========================97% ] nsys_report_ia_25000_10_40.sqlite[2/7] [========================98% ] nsys_report_ia_25000_10_40.sqlite[2/7] [========================99% ] nsys_report_ia_25000_10_40.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_40.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        249366640          1  249366640.0  249366640.0  249366640  249366640          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        132660883          1  132660883.0  132660883.0  132660883  132660883          0.0  cudaFree                      
      1.2          1635972          6     272662.0     212608.0       3790     770370     283493.1  cudaMalloc                    
      0.2           267933        814        329.2        290.0        120       1630        172.7  cuGetProcAddress_v2           
      0.0            40370          2      20185.0      20185.0       2050      38320      25646.8  cudaStreamCreateWithFlags     
      0.0            22120         18       1228.9        495.0        380      12270       2773.2  cudaEventCreateWithFlags      
      0.0             4650          3       1550.0       1890.0        550       2210        880.7  cuInit                        
      0.0             3390          3       1130.0        260.0        180       2950       1576.7  cuModuleGetLoadingMode        
      0.0              960          2        480.0        480.0        330        630        212.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 10 (num_steps = 40)
number of batches= 4
Generating '/tmp/nsys-report-aad0.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_10_40.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_10_40.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_10_40.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_10_40.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_40.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [1%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [2%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [3%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [4%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [5%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [6%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [7%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [8%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [9%                          ] nsys_report_db_25000_10_40.sqlite[2/7] [10%                         ] nsys_report_db_25000_10_40.sqlite[2/7] [11%                         ] nsys_report_db_25000_10_40.sqlite[2/7] [12%                         ] nsys_report_db_25000_10_40.sqlite[2/7] [13%                         ] nsys_report_db_25000_10_40.sqlite[2/7] [14%                         ] nsys_report_db_25000_10_40.sqlite[2/7] [=15%                        ] nsys_report_db_25000_10_40.sqlite[2/7] [=16%                        ] nsys_report_db_25000_10_40.sqlite[2/7] [=17%                        ] nsys_report_db_25000_10_40.sqlite[2/7] [==18%                       ] nsys_report_db_25000_10_40.sqlite[2/7] [==19%                       ] nsys_report_db_25000_10_40.sqlite[2/7] [==20%                       ] nsys_report_db_25000_10_40.sqlite[2/7] [==21%                       ] nsys_report_db_25000_10_40.sqlite[2/7] [===22%                      ] nsys_report_db_25000_10_40.sqlite[2/7] [===23%                      ] nsys_report_db_25000_10_40.sqlite[2/7] [===24%                      ] nsys_report_db_25000_10_40.sqlite[2/7] [====25%                     ] nsys_report_db_25000_10_40.sqlite[2/7] [====26%                     ] nsys_report_db_25000_10_40.sqlite[2/7] [====27%                     ] nsys_report_db_25000_10_40.sqlite[2/7] [====28%                     ] nsys_report_db_25000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_10_40.sqlite[2/7] [======33%                   ] nsys_report_db_25000_10_40.sqlite[2/7] [======34%                   ] nsys_report_db_25000_10_40.sqlite[2/7] [======35%                   ] nsys_report_db_25000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_10_40.sqlite[2/7] [========40%                 ] nsys_report_db_25000_10_40.sqlite[2/7] [========41%                 ] nsys_report_db_25000_10_40.sqlite[2/7] [========42%                 ] nsys_report_db_25000_10_40.sqlite[2/7] [=========43%                ] nsys_report_db_25000_10_40.sqlite[2/7] [=========44%                ] nsys_report_db_25000_10_40.sqlite[2/7] [=========45%                ] nsys_report_db_25000_10_40.sqlite[2/7] [=========46%                ] nsys_report_db_25000_10_40.sqlite[2/7] [==========47%               ] nsys_report_db_25000_10_40.sqlite[2/7] [==========48%               ] nsys_report_db_25000_10_40.sqlite[2/7] [==========49%               ] nsys_report_db_25000_10_40.sqlite[2/7] [===========50%              ] nsys_report_db_25000_10_40.sqlite[2/7] [===========51%              ] nsys_report_db_25000_10_40.sqlite[2/7] [===========52%              ] nsys_report_db_25000_10_40.sqlite[2/7] [===========53%              ] nsys_report_db_25000_10_40.sqlite[2/7] [============54%             ] nsys_report_db_25000_10_40.sqlite[2/7] [============55%             ] nsys_report_db_25000_10_40.sqlite[2/7] [============56%             ] nsys_report_db_25000_10_40.sqlite[2/7] [============57%             ] nsys_report_db_25000_10_40.sqlite[2/7] [=============58%            ] nsys_report_db_25000_10_40.sqlite[2/7] [=============59%            ] nsys_report_db_25000_10_40.sqlite[2/7] [=============60%            ] nsys_report_db_25000_10_40.sqlite[2/7] [==============61%           ] nsys_report_db_25000_10_40.sqlite[2/7] [==============62%           ] nsys_report_db_25000_10_40.sqlite[2/7] [==============63%           ] nsys_report_db_25000_10_40.sqlite[2/7] [==============64%           ] nsys_report_db_25000_10_40.sqlite[2/7] [===============65%          ] nsys_report_db_25000_10_40.sqlite[2/7] [===============66%          ] nsys_report_db_25000_10_40.sqlite[2/7] [===============67%          ] nsys_report_db_25000_10_40.sqlite[2/7] [================68%         ] nsys_report_db_25000_10_40.sqlite[2/7] [================69%         ] nsys_report_db_25000_10_40.sqlite[2/7] [================70%         ] nsys_report_db_25000_10_40.sqlite[2/7] [================71%         ] nsys_report_db_25000_10_40.sqlite[2/7] [=================72%        ] nsys_report_db_25000_10_40.sqlite[2/7] [=================73%        ] nsys_report_db_25000_10_40.sqlite[2/7] [=================74%        ] nsys_report_db_25000_10_40.sqlite[2/7] [==================75%       ] nsys_report_db_25000_10_40.sqlite[2/7] [==================76%       ] nsys_report_db_25000_10_40.sqlite[2/7] [==================77%       ] nsys_report_db_25000_10_40.sqlite[2/7] [==================78%       ] nsys_report_db_25000_10_40.sqlite[2/7] [===================79%      ] nsys_report_db_25000_10_40.sqlite[2/7] [===================80%      ] nsys_report_db_25000_10_40.sqlite[2/7] [===================81%      ] nsys_report_db_25000_10_40.sqlite[2/7] [===================82%      ] nsys_report_db_25000_10_40.sqlite[2/7] [====================83%     ] nsys_report_db_25000_10_40.sqlite[2/7] [====================84%     ] nsys_report_db_25000_10_40.sqlite[2/7] [====================85%     ] nsys_report_db_25000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_10_40.sqlite[2/7] [======================90%   ] nsys_report_db_25000_10_40.sqlite[2/7] [======================91%   ] nsys_report_db_25000_10_40.sqlite[2/7] [======================92%   ] nsys_report_db_25000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_10_40.sqlite[2/7] [========================97% ] nsys_report_db_25000_10_40.sqlite[2/7] [========================98% ] nsys_report_db_25000_10_40.sqlite[2/7] [========================99% ] nsys_report_db_25000_10_40.sqlite[2/7] [========================100%] nsys_report_db_25000_10_40.sqlite[2/7] [========================100%] nsys_report_db_25000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        279231107          1  279231107.0  279231107.0  279231107  279231107          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        157244331          1  157244331.0  157244331.0  157244331  157244331          0.0  cudaFree                      
      1.0          1664411          6     277401.8     209047.5       3630     779180     287216.0  cudaMalloc                    
      0.2           323986        814        398.0        370.0        120       1500        235.7  cuGetProcAddress_v2           
      0.0            43001          2      21500.5      21500.5       2270      40731      27196.0  cudaStreamCreateWithFlags     
      0.0            22550         18       1252.8        480.0        380      12350       2795.3  cudaEventCreateWithFlags      
      0.0             6020          3       2006.7       1820.0        640       3560       1468.9  cuInit                        
      0.0             4210          3       1403.3        380.0        290       3540       1851.0  cuModuleGetLoadingMode        
      0.0             1030          2        515.0        515.0        300        730        304.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 10 (num_steps = 40), identity_test = 0
Generating '/tmp/nsys-report-2fd4.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_10_40.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_10_40.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_10_40.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_10_40.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_40.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [1%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [2%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [3%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [4%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [5%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [6%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [7%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [8%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [9%                          ] nsys_report_fo_25000_10_40.sqlite[2/7] [10%                         ] nsys_report_fo_25000_10_40.sqlite[2/7] [11%                         ] nsys_report_fo_25000_10_40.sqlite[2/7] [12%                         ] nsys_report_fo_25000_10_40.sqlite[2/7] [13%                         ] nsys_report_fo_25000_10_40.sqlite[2/7] [14%                         ] nsys_report_fo_25000_10_40.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_10_40.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_10_40.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_10_40.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_10_40.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_10_40.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_10_40.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_10_40.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_10_40.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_10_40.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_10_40.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_10_40.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_10_40.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_10_40.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_10_40.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_10_40.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_10_40.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_10_40.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_10_40.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_10_40.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_10_40.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_10_40.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_10_40.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_10_40.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_10_40.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_10_40.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_10_40.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_10_40.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_10_40.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_10_40.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_10_40.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_10_40.sqlite[2/7] [============54%             ] nsys_report_fo_25000_10_40.sqlite[2/7] [============55%             ] nsys_report_fo_25000_10_40.sqlite[2/7] [============56%             ] nsys_report_fo_25000_10_40.sqlite[2/7] [============57%             ] nsys_report_fo_25000_10_40.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_10_40.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_10_40.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_10_40.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_10_40.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_10_40.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_10_40.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_10_40.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_10_40.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_10_40.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_10_40.sqlite[2/7] [================68%         ] nsys_report_fo_25000_10_40.sqlite[2/7] [================69%         ] nsys_report_fo_25000_10_40.sqlite[2/7] [================70%         ] nsys_report_fo_25000_10_40.sqlite[2/7] [================71%         ] nsys_report_fo_25000_10_40.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_10_40.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_10_40.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_10_40.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_10_40.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_10_40.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_10_40.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_10_40.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_10_40.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_10_40.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_10_40.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_10_40.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_10_40.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_10_40.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_10_40.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_10_40.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_10_40.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_10_40.sqlite[2/7] [========================97% ] nsys_report_fo_25000_10_40.sqlite[2/7] [========================98% ] nsys_report_fo_25000_10_40.sqlite[2/7] [========================99% ] nsys_report_fo_25000_10_40.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_40.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        274010607          1  274010607.0  274010607.0  274010607  274010607          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.9        152330827          1  152330827.0  152330827.0  152330827  152330827          0.0  cudaFree                      
      1.9          2966349         12     247195.8     312039.0       4820     383025     126278.0  cudaMalloc                    
      0.2           278695        814        342.4        300.0        120       1210        179.0  cuGetProcAddress_v2           
      0.0            38121          2      19060.5      19060.5       2010      36111      24113.0  cudaStreamCreateWithFlags     
      0.0            27120         18       1506.7        620.0        500      13490       3037.4  cudaEventCreateWithFlags      
      0.0             5070          3       1690.0       2200.0        600       2270        944.6  cuInit                        
      0.0             3260          3       1086.7        270.0        150       2840       1519.6  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        330        620        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 10 (num_steps = 60)
number of batches= 6
Generating '/tmp/nsys-report-74bb.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_10_60.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_10_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_10_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_10_60.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_60.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [1%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [2%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [3%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [4%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [5%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [6%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [7%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [8%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [9%                          ] nsys_report_ia_25000_10_60.sqlite[2/7] [10%                         ] nsys_report_ia_25000_10_60.sqlite[2/7] [11%                         ] nsys_report_ia_25000_10_60.sqlite[2/7] [12%                         ] nsys_report_ia_25000_10_60.sqlite[2/7] [13%                         ] nsys_report_ia_25000_10_60.sqlite[2/7] [14%                         ] nsys_report_ia_25000_10_60.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_10_60.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_10_60.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_10_60.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_10_60.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_10_60.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_10_60.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_10_60.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_10_60.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_10_60.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_10_60.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_10_60.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_10_60.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_10_60.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_10_60.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_10_60.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_10_60.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_10_60.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_10_60.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_10_60.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_10_60.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_10_60.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_10_60.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_10_60.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_10_60.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_10_60.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_10_60.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_10_60.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_10_60.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_10_60.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_10_60.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_10_60.sqlite[2/7] [============54%             ] nsys_report_ia_25000_10_60.sqlite[2/7] [============55%             ] nsys_report_ia_25000_10_60.sqlite[2/7] [============56%             ] nsys_report_ia_25000_10_60.sqlite[2/7] [============57%             ] nsys_report_ia_25000_10_60.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_10_60.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_10_60.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_10_60.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_10_60.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_10_60.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_10_60.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_10_60.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_10_60.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_10_60.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_10_60.sqlite[2/7] [================68%         ] nsys_report_ia_25000_10_60.sqlite[2/7] [================69%         ] nsys_report_ia_25000_10_60.sqlite[2/7] [================70%         ] nsys_report_ia_25000_10_60.sqlite[2/7] [================71%         ] nsys_report_ia_25000_10_60.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_10_60.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_10_60.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_10_60.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_10_60.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_10_60.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_10_60.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_10_60.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_10_60.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_10_60.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_10_60.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_10_60.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_10_60.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_10_60.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_10_60.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_10_60.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_10_60.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_10_60.sqlite[2/7] [========================97% ] nsys_report_ia_25000_10_60.sqlite[2/7] [========================98% ] nsys_report_ia_25000_10_60.sqlite[2/7] [========================99% ] nsys_report_ia_25000_10_60.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_60.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        246104355          1  246104355.0  246104355.0  246104355  246104355          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        130399602          1  130399602.0  130399602.0  130399602  130399602          0.0  cudaFree                      
      1.2          1651101          6     275183.5     203372.5       3620     786560     289619.0  cudaMalloc                    
      0.2           284773        814        349.8        305.0        120       1190        183.5  cuGetProcAddress_v2           
      0.0            42420          2      21210.0      21210.0       1930      40490      27266.0  cudaStreamCreateWithFlags     
      0.0            22590         18       1255.0        470.0        390      12020       2718.0  cudaEventCreateWithFlags      
      0.0             4600          3       1533.3       1850.0        750       2000        682.5  cuInit                        
      0.0             3180          3       1060.0        270.0        200       2710       1429.4  cuModuleGetLoadingMode        
      0.0             1240          2        620.0        620.0        450        790        240.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 10 (num_steps = 60)
number of batches= 6
Generating '/tmp/nsys-report-fd30.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_10_60.nsys-rep[1/7] [=====31%                    ] nsys_report_db_25000_10_60.nsys-rep[1/7] [===============65%          ] nsys_report_db_25000_10_60.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_10_60.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_60.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [1%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [2%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [3%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [4%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [5%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [6%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [7%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [8%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [9%                          ] nsys_report_db_25000_10_60.sqlite[2/7] [10%                         ] nsys_report_db_25000_10_60.sqlite[2/7] [11%                         ] nsys_report_db_25000_10_60.sqlite[2/7] [12%                         ] nsys_report_db_25000_10_60.sqlite[2/7] [13%                         ] nsys_report_db_25000_10_60.sqlite[2/7] [14%                         ] nsys_report_db_25000_10_60.sqlite[2/7] [=15%                        ] nsys_report_db_25000_10_60.sqlite[2/7] [=16%                        ] nsys_report_db_25000_10_60.sqlite[2/7] [=17%                        ] nsys_report_db_25000_10_60.sqlite[2/7] [==18%                       ] nsys_report_db_25000_10_60.sqlite[2/7] [==19%                       ] nsys_report_db_25000_10_60.sqlite[2/7] [==20%                       ] nsys_report_db_25000_10_60.sqlite[2/7] [==21%                       ] nsys_report_db_25000_10_60.sqlite[2/7] [===22%                      ] nsys_report_db_25000_10_60.sqlite[2/7] [===23%                      ] nsys_report_db_25000_10_60.sqlite[2/7] [===24%                      ] nsys_report_db_25000_10_60.sqlite[2/7] [====25%                     ] nsys_report_db_25000_10_60.sqlite[2/7] [====26%                     ] nsys_report_db_25000_10_60.sqlite[2/7] [====27%                     ] nsys_report_db_25000_10_60.sqlite[2/7] [====28%                     ] nsys_report_db_25000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_10_60.sqlite[2/7] [======33%                   ] nsys_report_db_25000_10_60.sqlite[2/7] [======34%                   ] nsys_report_db_25000_10_60.sqlite[2/7] [======35%                   ] nsys_report_db_25000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_10_60.sqlite[2/7] [========40%                 ] nsys_report_db_25000_10_60.sqlite[2/7] [========41%                 ] nsys_report_db_25000_10_60.sqlite[2/7] [========42%                 ] nsys_report_db_25000_10_60.sqlite[2/7] [=========43%                ] nsys_report_db_25000_10_60.sqlite[2/7] [=========44%                ] nsys_report_db_25000_10_60.sqlite[2/7] [=========45%                ] nsys_report_db_25000_10_60.sqlite[2/7] [=========46%                ] nsys_report_db_25000_10_60.sqlite[2/7] [==========47%               ] nsys_report_db_25000_10_60.sqlite[2/7] [==========48%               ] nsys_report_db_25000_10_60.sqlite[2/7] [==========49%               ] nsys_report_db_25000_10_60.sqlite[2/7] [===========50%              ] nsys_report_db_25000_10_60.sqlite[2/7] [===========51%              ] nsys_report_db_25000_10_60.sqlite[2/7] [===========52%              ] nsys_report_db_25000_10_60.sqlite[2/7] [===========53%              ] nsys_report_db_25000_10_60.sqlite[2/7] [============54%             ] nsys_report_db_25000_10_60.sqlite[2/7] [============55%             ] nsys_report_db_25000_10_60.sqlite[2/7] [============56%             ] nsys_report_db_25000_10_60.sqlite[2/7] [============57%             ] nsys_report_db_25000_10_60.sqlite[2/7] [=============58%            ] nsys_report_db_25000_10_60.sqlite[2/7] [=============59%            ] nsys_report_db_25000_10_60.sqlite[2/7] [=============60%            ] nsys_report_db_25000_10_60.sqlite[2/7] [==============61%           ] nsys_report_db_25000_10_60.sqlite[2/7] [==============62%           ] nsys_report_db_25000_10_60.sqlite[2/7] [==============63%           ] nsys_report_db_25000_10_60.sqlite[2/7] [==============64%           ] nsys_report_db_25000_10_60.sqlite[2/7] [===============65%          ] nsys_report_db_25000_10_60.sqlite[2/7] [===============66%          ] nsys_report_db_25000_10_60.sqlite[2/7] [===============67%          ] nsys_report_db_25000_10_60.sqlite[2/7] [================68%         ] nsys_report_db_25000_10_60.sqlite[2/7] [================69%         ] nsys_report_db_25000_10_60.sqlite[2/7] [================70%         ] nsys_report_db_25000_10_60.sqlite[2/7] [================71%         ] nsys_report_db_25000_10_60.sqlite[2/7] [=================72%        ] nsys_report_db_25000_10_60.sqlite[2/7] [=================73%        ] nsys_report_db_25000_10_60.sqlite[2/7] [=================74%        ] nsys_report_db_25000_10_60.sqlite[2/7] [==================75%       ] nsys_report_db_25000_10_60.sqlite[2/7] [==================76%       ] nsys_report_db_25000_10_60.sqlite[2/7] [==================77%       ] nsys_report_db_25000_10_60.sqlite[2/7] [==================78%       ] nsys_report_db_25000_10_60.sqlite[2/7] [===================79%      ] nsys_report_db_25000_10_60.sqlite[2/7] [===================80%      ] nsys_report_db_25000_10_60.sqlite[2/7] [===================81%      ] nsys_report_db_25000_10_60.sqlite[2/7] [===================82%      ] nsys_report_db_25000_10_60.sqlite[2/7] [====================83%     ] nsys_report_db_25000_10_60.sqlite[2/7] [====================84%     ] nsys_report_db_25000_10_60.sqlite[2/7] [====================85%     ] nsys_report_db_25000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_10_60.sqlite[2/7] [======================90%   ] nsys_report_db_25000_10_60.sqlite[2/7] [======================91%   ] nsys_report_db_25000_10_60.sqlite[2/7] [======================92%   ] nsys_report_db_25000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_10_60.sqlite[2/7] [========================97% ] nsys_report_db_25000_10_60.sqlite[2/7] [========================98% ] nsys_report_db_25000_10_60.sqlite[2/7] [========================99% ] nsys_report_db_25000_10_60.sqlite[2/7] [========================100%] nsys_report_db_25000_10_60.sqlite[2/7] [========================100%] nsys_report_db_25000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        282895258          1  282895258.0  282895258.0  282895258  282895258          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        161499632          1  161499632.0  161499632.0  161499632  161499632          0.0  cudaFree                      
      1.0          1670002          6     278333.7     211818.0       3780     769900     285488.2  cudaMalloc                    
      0.2           265503        814        326.2        290.0        120       1080        167.4  cuGetProcAddress_v2           
      0.0            35500          2      17750.0      17750.0       1870      33630      22457.7  cudaStreamCreateWithFlags     
      0.0            23361         18       1297.8        490.0        390      13220       2994.0  cudaEventCreateWithFlags      
      0.0             4510          3       1503.3       1570.0        610       2330        861.9  cuInit                        
      0.0             3460          3       1153.3        250.0        150       3060       1652.0  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        300        620        226.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 10 (num_steps = 60), identity_test = 0
Generating '/tmp/nsys-report-e944.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_10_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_10_60.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_10_60.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_10_60.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_60.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [1%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [2%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [3%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [4%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [5%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [6%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [7%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [8%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [9%                          ] nsys_report_fo_25000_10_60.sqlite[2/7] [10%                         ] nsys_report_fo_25000_10_60.sqlite[2/7] [11%                         ] nsys_report_fo_25000_10_60.sqlite[2/7] [12%                         ] nsys_report_fo_25000_10_60.sqlite[2/7] [13%                         ] nsys_report_fo_25000_10_60.sqlite[2/7] [14%                         ] nsys_report_fo_25000_10_60.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_10_60.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_10_60.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_10_60.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_10_60.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_10_60.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_10_60.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_10_60.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_10_60.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_10_60.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_10_60.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_10_60.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_10_60.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_10_60.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_10_60.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_10_60.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_10_60.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_10_60.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_10_60.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_10_60.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_10_60.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_10_60.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_10_60.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_10_60.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_10_60.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_10_60.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_10_60.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_10_60.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_10_60.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_10_60.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_10_60.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_10_60.sqlite[2/7] [============54%             ] nsys_report_fo_25000_10_60.sqlite[2/7] [============55%             ] nsys_report_fo_25000_10_60.sqlite[2/7] [============56%             ] nsys_report_fo_25000_10_60.sqlite[2/7] [============57%             ] nsys_report_fo_25000_10_60.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_10_60.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_10_60.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_10_60.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_10_60.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_10_60.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_10_60.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_10_60.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_10_60.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_10_60.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_10_60.sqlite[2/7] [================68%         ] nsys_report_fo_25000_10_60.sqlite[2/7] [================69%         ] nsys_report_fo_25000_10_60.sqlite[2/7] [================70%         ] nsys_report_fo_25000_10_60.sqlite[2/7] [================71%         ] nsys_report_fo_25000_10_60.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_10_60.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_10_60.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_10_60.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_10_60.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_10_60.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_10_60.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_10_60.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_10_60.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_10_60.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_10_60.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_10_60.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_10_60.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_10_60.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_10_60.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_10_60.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_10_60.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_10_60.sqlite[2/7] [========================97% ] nsys_report_fo_25000_10_60.sqlite[2/7] [========================98% ] nsys_report_fo_25000_10_60.sqlite[2/7] [========================99% ] nsys_report_fo_25000_10_60.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_60.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        267868190          1  267868190.0  267868190.0  267868190  267868190          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.8        148749596          1  148749596.0  148749596.0  148749596  148749596          0.0  cudaFree                      
      1.9          2909978         12     242498.2     312259.0       4200     367785     126200.2  cudaMalloc                    
      0.2           340404        814        418.2        380.0        120       1550        243.4  cuGetProcAddress_v2           
      0.0            47301          2      23650.5      23650.5       2120      45181      30448.7  cudaStreamCreateWithFlags     
      0.0            25610         18       1422.8        440.0        390      14520       3311.6  cudaEventCreateWithFlags      
      0.0             7180          3       2393.3       2390.0        830       3960       1565.0  cuInit                        
      0.0             4640          3       1546.7        510.0        290       3840       1989.1  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        290        640        247.5  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 10 (num_steps = 80)
number of batches= 8
Generating '/tmp/nsys-report-f205.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_10_80.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_10_80.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_10_80.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_80.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [1%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [2%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [3%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [4%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [5%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [6%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [7%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [8%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [9%                          ] nsys_report_ia_25000_10_80.sqlite[2/7] [10%                         ] nsys_report_ia_25000_10_80.sqlite[2/7] [11%                         ] nsys_report_ia_25000_10_80.sqlite[2/7] [12%                         ] nsys_report_ia_25000_10_80.sqlite[2/7] [13%                         ] nsys_report_ia_25000_10_80.sqlite[2/7] [14%                         ] nsys_report_ia_25000_10_80.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_10_80.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_10_80.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_10_80.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_10_80.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_10_80.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_10_80.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_10_80.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_10_80.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_10_80.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_10_80.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_10_80.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_10_80.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_10_80.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_10_80.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_10_80.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_10_80.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_10_80.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_10_80.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_10_80.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_10_80.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_10_80.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_10_80.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_10_80.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_10_80.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_10_80.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_10_80.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_10_80.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_10_80.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_10_80.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_10_80.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_10_80.sqlite[2/7] [============54%             ] nsys_report_ia_25000_10_80.sqlite[2/7] [============55%             ] nsys_report_ia_25000_10_80.sqlite[2/7] [============56%             ] nsys_report_ia_25000_10_80.sqlite[2/7] [============57%             ] nsys_report_ia_25000_10_80.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_10_80.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_10_80.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_10_80.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_10_80.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_10_80.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_10_80.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_10_80.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_10_80.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_10_80.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_10_80.sqlite[2/7] [================68%         ] nsys_report_ia_25000_10_80.sqlite[2/7] [================69%         ] nsys_report_ia_25000_10_80.sqlite[2/7] [================70%         ] nsys_report_ia_25000_10_80.sqlite[2/7] [================71%         ] nsys_report_ia_25000_10_80.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_10_80.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_10_80.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_10_80.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_10_80.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_10_80.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_10_80.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_10_80.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_10_80.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_10_80.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_10_80.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_10_80.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_10_80.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_10_80.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_10_80.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_10_80.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_10_80.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_10_80.sqlite[2/7] [========================97% ] nsys_report_ia_25000_10_80.sqlite[2/7] [========================98% ] nsys_report_ia_25000_10_80.sqlite[2/7] [========================99% ] nsys_report_ia_25000_10_80.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_80.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        252806118          1  252806118.0  252806118.0  252806118  252806118          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        136232466          1  136232466.0  136232466.0  136232466  136232466          0.0  cudaFree                      
      1.2          1617380          6     269563.3     205562.5       3980     762340     279334.7  cudaMalloc                    
      0.2           285614        814        350.9        310.0        120       1490        190.9  cuGetProcAddress_v2           
      0.0            33291          2      16645.5      16645.5       1880      31411      20881.6  cudaStreamCreateWithFlags     
      0.0            25950         18       1441.7        545.0        410      14640       3321.7  cudaEventCreateWithFlags      
      0.0             4780          3       1593.3       1610.0        580       2590       1005.1  cuInit                        
      0.0             3320          3       1106.7        290.0        160       2870       1528.5  cuModuleGetLoadingMode        
      0.0             1010          2        505.0        505.0        410        600        134.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 10 (num_steps = 80)
number of batches= 8
Generating '/tmp/nsys-report-b060.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_10_80.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_10_80.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_10_80.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_80.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [1%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [2%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [3%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [4%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [5%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [6%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [7%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [8%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [9%                          ] nsys_report_db_25000_10_80.sqlite[2/7] [10%                         ] nsys_report_db_25000_10_80.sqlite[2/7] [11%                         ] nsys_report_db_25000_10_80.sqlite[2/7] [12%                         ] nsys_report_db_25000_10_80.sqlite[2/7] [13%                         ] nsys_report_db_25000_10_80.sqlite[2/7] [14%                         ] nsys_report_db_25000_10_80.sqlite[2/7] [=15%                        ] nsys_report_db_25000_10_80.sqlite[2/7] [=16%                        ] nsys_report_db_25000_10_80.sqlite[2/7] [=17%                        ] nsys_report_db_25000_10_80.sqlite[2/7] [==18%                       ] nsys_report_db_25000_10_80.sqlite[2/7] [==19%                       ] nsys_report_db_25000_10_80.sqlite[2/7] [==20%                       ] nsys_report_db_25000_10_80.sqlite[2/7] [==21%                       ] nsys_report_db_25000_10_80.sqlite[2/7] [===22%                      ] nsys_report_db_25000_10_80.sqlite[2/7] [===23%                      ] nsys_report_db_25000_10_80.sqlite[2/7] [===24%                      ] nsys_report_db_25000_10_80.sqlite[2/7] [====25%                     ] nsys_report_db_25000_10_80.sqlite[2/7] [====26%                     ] nsys_report_db_25000_10_80.sqlite[2/7] [====27%                     ] nsys_report_db_25000_10_80.sqlite[2/7] [====28%                     ] nsys_report_db_25000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_10_80.sqlite[2/7] [======33%                   ] nsys_report_db_25000_10_80.sqlite[2/7] [======34%                   ] nsys_report_db_25000_10_80.sqlite[2/7] [======35%                   ] nsys_report_db_25000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_10_80.sqlite[2/7] [========40%                 ] nsys_report_db_25000_10_80.sqlite[2/7] [========41%                 ] nsys_report_db_25000_10_80.sqlite[2/7] [========42%                 ] nsys_report_db_25000_10_80.sqlite[2/7] [=========43%                ] nsys_report_db_25000_10_80.sqlite[2/7] [=========44%                ] nsys_report_db_25000_10_80.sqlite[2/7] [=========45%                ] nsys_report_db_25000_10_80.sqlite[2/7] [=========46%                ] nsys_report_db_25000_10_80.sqlite[2/7] [==========47%               ] nsys_report_db_25000_10_80.sqlite[2/7] [==========48%               ] nsys_report_db_25000_10_80.sqlite[2/7] [==========49%               ] nsys_report_db_25000_10_80.sqlite[2/7] [===========50%              ] nsys_report_db_25000_10_80.sqlite[2/7] [===========51%              ] nsys_report_db_25000_10_80.sqlite[2/7] [===========52%              ] nsys_report_db_25000_10_80.sqlite[2/7] [===========53%              ] nsys_report_db_25000_10_80.sqlite[2/7] [============54%             ] nsys_report_db_25000_10_80.sqlite[2/7] [============55%             ] nsys_report_db_25000_10_80.sqlite[2/7] [============56%             ] nsys_report_db_25000_10_80.sqlite[2/7] [============57%             ] nsys_report_db_25000_10_80.sqlite[2/7] [=============58%            ] nsys_report_db_25000_10_80.sqlite[2/7] [=============59%            ] nsys_report_db_25000_10_80.sqlite[2/7] [=============60%            ] nsys_report_db_25000_10_80.sqlite[2/7] [==============61%           ] nsys_report_db_25000_10_80.sqlite[2/7] [==============62%           ] nsys_report_db_25000_10_80.sqlite[2/7] [==============63%           ] nsys_report_db_25000_10_80.sqlite[2/7] [==============64%           ] nsys_report_db_25000_10_80.sqlite[2/7] [===============65%          ] nsys_report_db_25000_10_80.sqlite[2/7] [===============66%          ] nsys_report_db_25000_10_80.sqlite[2/7] [===============67%          ] nsys_report_db_25000_10_80.sqlite[2/7] [================68%         ] nsys_report_db_25000_10_80.sqlite[2/7] [================69%         ] nsys_report_db_25000_10_80.sqlite[2/7] [================70%         ] nsys_report_db_25000_10_80.sqlite[2/7] [================71%         ] nsys_report_db_25000_10_80.sqlite[2/7] [=================72%        ] nsys_report_db_25000_10_80.sqlite[2/7] [=================73%        ] nsys_report_db_25000_10_80.sqlite[2/7] [=================74%        ] nsys_report_db_25000_10_80.sqlite[2/7] [==================75%       ] nsys_report_db_25000_10_80.sqlite[2/7] [==================76%       ] nsys_report_db_25000_10_80.sqlite[2/7] [==================77%       ] nsys_report_db_25000_10_80.sqlite[2/7] [==================78%       ] nsys_report_db_25000_10_80.sqlite[2/7] [===================79%      ] nsys_report_db_25000_10_80.sqlite[2/7] [===================80%      ] nsys_report_db_25000_10_80.sqlite[2/7] [===================81%      ] nsys_report_db_25000_10_80.sqlite[2/7] [===================82%      ] nsys_report_db_25000_10_80.sqlite[2/7] [====================83%     ] nsys_report_db_25000_10_80.sqlite[2/7] [====================84%     ] nsys_report_db_25000_10_80.sqlite[2/7] [====================85%     ] nsys_report_db_25000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_10_80.sqlite[2/7] [======================90%   ] nsys_report_db_25000_10_80.sqlite[2/7] [======================91%   ] nsys_report_db_25000_10_80.sqlite[2/7] [======================92%   ] nsys_report_db_25000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_10_80.sqlite[2/7] [========================97% ] nsys_report_db_25000_10_80.sqlite[2/7] [========================98% ] nsys_report_db_25000_10_80.sqlite[2/7] [========================99% ] nsys_report_db_25000_10_80.sqlite[2/7] [========================100%] nsys_report_db_25000_10_80.sqlite[2/7] [========================100%] nsys_report_db_25000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        288812280          1  288812280.0  288812280.0  288812280  288812280          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        167357585          1  167357585.0  167357585.0  167357585  167357585          0.0  cudaFree                      
      1.0          1644551          6     274091.8     216742.5       4020     772450     283697.9  cudaMalloc                    
      0.2           265245        814        325.9        300.0        120       1290        165.6  cuGetProcAddress_v2           
      0.0            34160          2      17080.0      17080.0       1800      32360      21609.2  cudaStreamCreateWithFlags     
      0.0            30780         18       1710.0        520.0        390      20360       4665.5  cudaEventCreateWithFlags      
      0.0             4930          3       1643.3       2040.0        590       2300        921.4  cuInit                        
      0.0             3850          3       1283.3        270.0        180       3400       1833.6  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        310        610        212.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 10 (num_steps = 80), identity_test = 0
Generating '/tmp/nsys-report-bafb.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_10_80.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_10_80.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_10_80.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_80.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [1%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [2%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [3%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [4%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [5%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [6%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [7%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [8%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [9%                          ] nsys_report_fo_25000_10_80.sqlite[2/7] [10%                         ] nsys_report_fo_25000_10_80.sqlite[2/7] [11%                         ] nsys_report_fo_25000_10_80.sqlite[2/7] [12%                         ] nsys_report_fo_25000_10_80.sqlite[2/7] [13%                         ] nsys_report_fo_25000_10_80.sqlite[2/7] [14%                         ] nsys_report_fo_25000_10_80.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_10_80.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_10_80.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_10_80.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_10_80.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_10_80.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_10_80.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_10_80.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_10_80.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_10_80.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_10_80.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_10_80.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_10_80.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_10_80.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_10_80.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_10_80.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_10_80.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_10_80.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_10_80.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_10_80.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_10_80.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_10_80.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_10_80.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_10_80.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_10_80.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_10_80.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_10_80.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_10_80.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_10_80.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_10_80.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_10_80.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_10_80.sqlite[2/7] [============54%             ] nsys_report_fo_25000_10_80.sqlite[2/7] [============55%             ] nsys_report_fo_25000_10_80.sqlite[2/7] [============56%             ] nsys_report_fo_25000_10_80.sqlite[2/7] [============57%             ] nsys_report_fo_25000_10_80.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_10_80.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_10_80.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_10_80.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_10_80.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_10_80.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_10_80.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_10_80.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_10_80.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_10_80.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_10_80.sqlite[2/7] [================68%         ] nsys_report_fo_25000_10_80.sqlite[2/7] [================69%         ] nsys_report_fo_25000_10_80.sqlite[2/7] [================70%         ] nsys_report_fo_25000_10_80.sqlite[2/7] [================71%         ] nsys_report_fo_25000_10_80.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_10_80.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_10_80.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_10_80.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_10_80.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_10_80.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_10_80.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_10_80.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_10_80.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_10_80.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_10_80.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_10_80.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_10_80.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_10_80.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_10_80.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_10_80.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_10_80.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_10_80.sqlite[2/7] [========================97% ] nsys_report_fo_25000_10_80.sqlite[2/7] [========================98% ] nsys_report_fo_25000_10_80.sqlite[2/7] [========================99% ] nsys_report_fo_25000_10_80.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_80.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        283601889          1  283601889.0  283601889.0  283601889  283601889          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        162841696          1  162841696.0  162841696.0  162841696  162841696          0.0  cudaFree                      
      1.8          2958689         12     246557.4     317204.5       4000     373655     128492.2  cudaMalloc                    
      0.2           259544        814        318.9        270.0        120       1190        169.7  cuGetProcAddress_v2           
      0.0            37130          2      18565.0      18565.0       1880      35250      23596.2  cudaStreamCreateWithFlags     
      0.0            20350         18       1130.6        495.0        380       9910       2223.1  cudaEventCreateWithFlags      
      0.0             5760          3       1920.0       2520.0        640       2600       1109.2  cuInit                        
      0.0             3630          3       1210.0        260.0        180       3190       1715.2  cuModuleGetLoadingMode        
      0.0             1000          2        500.0        500.0        410        590        127.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 10 (num_steps = 100)
number of batches= 10
Generating '/tmp/nsys-report-ff97.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_10_100.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_10_100.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_10_100.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_10_100.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_100.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [1%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [2%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [3%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [4%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [5%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [6%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [7%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [8%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [9%                          ] nsys_report_ia_25000_10_100.sqlite[2/7] [10%                         ] nsys_report_ia_25000_10_100.sqlite[2/7] [11%                         ] nsys_report_ia_25000_10_100.sqlite[2/7] [12%                         ] nsys_report_ia_25000_10_100.sqlite[2/7] [13%                         ] nsys_report_ia_25000_10_100.sqlite[2/7] [14%                         ] nsys_report_ia_25000_10_100.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_10_100.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_10_100.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_10_100.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_10_100.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_10_100.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_10_100.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_10_100.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_10_100.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_10_100.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_10_100.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_10_100.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_10_100.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_10_100.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_10_100.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_10_100.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_10_100.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_10_100.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_10_100.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_10_100.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_10_100.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_10_100.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_10_100.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_10_100.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_10_100.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_10_100.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_10_100.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_10_100.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_10_100.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_10_100.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_10_100.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_10_100.sqlite[2/7] [============54%             ] nsys_report_ia_25000_10_100.sqlite[2/7] [============55%             ] nsys_report_ia_25000_10_100.sqlite[2/7] [============56%             ] nsys_report_ia_25000_10_100.sqlite[2/7] [============57%             ] nsys_report_ia_25000_10_100.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_10_100.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_10_100.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_10_100.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_10_100.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_10_100.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_10_100.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_10_100.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_10_100.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_10_100.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_10_100.sqlite[2/7] [================68%         ] nsys_report_ia_25000_10_100.sqlite[2/7] [================69%         ] nsys_report_ia_25000_10_100.sqlite[2/7] [================70%         ] nsys_report_ia_25000_10_100.sqlite[2/7] [================71%         ] nsys_report_ia_25000_10_100.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_10_100.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_10_100.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_10_100.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_10_100.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_10_100.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_10_100.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_10_100.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_10_100.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_10_100.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_10_100.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_10_100.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_10_100.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_10_100.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_10_100.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_10_100.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_10_100.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_10_100.sqlite[2/7] [========================97% ] nsys_report_ia_25000_10_100.sqlite[2/7] [========================98% ] nsys_report_ia_25000_10_100.sqlite[2/7] [========================99% ] nsys_report_ia_25000_10_100.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_100.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        250688812          1  250688812.0  250688812.0  250688812  250688812          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        136044568          1  136044568.0  136044568.0  136044568  136044568          0.0  cudaFree                      
      1.2          1607591          6     267931.8     202112.5       3661     769670     281832.5  cudaMalloc                    
      0.2           285095        814        350.2        300.0        130       1220        184.4  cuGetProcAddress_v2           
      0.0            41001          2      20500.5      20500.5       3030      37971      24707.0  cudaStreamCreateWithFlags     
      0.0            19550         18       1086.1        495.0        400       9060       2025.7  cudaEventCreateWithFlags      
      0.0             5931          3       1977.0       2250.0        620       3061       1243.2  cuInit                        
      0.0             3390          3       1130.0        270.0        270       2850       1489.6  cuModuleGetLoadingMode        
      0.0             1190          2        595.0        595.0        300        890        417.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 10 (num_steps = 100)
number of batches= 10
Generating '/tmp/nsys-report-5931.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_10_100.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_10_100.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_10_100.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_10_100.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_100.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [1%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [2%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [3%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [4%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [5%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [6%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [7%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [8%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [9%                          ] nsys_report_db_25000_10_100.sqlite[2/7] [10%                         ] nsys_report_db_25000_10_100.sqlite[2/7] [11%                         ] nsys_report_db_25000_10_100.sqlite[2/7] [12%                         ] nsys_report_db_25000_10_100.sqlite[2/7] [13%                         ] nsys_report_db_25000_10_100.sqlite[2/7] [14%                         ] nsys_report_db_25000_10_100.sqlite[2/7] [=15%                        ] nsys_report_db_25000_10_100.sqlite[2/7] [=16%                        ] nsys_report_db_25000_10_100.sqlite[2/7] [=17%                        ] nsys_report_db_25000_10_100.sqlite[2/7] [==18%                       ] nsys_report_db_25000_10_100.sqlite[2/7] [==19%                       ] nsys_report_db_25000_10_100.sqlite[2/7] [==20%                       ] nsys_report_db_25000_10_100.sqlite[2/7] [==21%                       ] nsys_report_db_25000_10_100.sqlite[2/7] [===22%                      ] nsys_report_db_25000_10_100.sqlite[2/7] [===23%                      ] nsys_report_db_25000_10_100.sqlite[2/7] [===24%                      ] nsys_report_db_25000_10_100.sqlite[2/7] [====25%                     ] nsys_report_db_25000_10_100.sqlite[2/7] [====26%                     ] nsys_report_db_25000_10_100.sqlite[2/7] [====27%                     ] nsys_report_db_25000_10_100.sqlite[2/7] [====28%                     ] nsys_report_db_25000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_10_100.sqlite[2/7] [======33%                   ] nsys_report_db_25000_10_100.sqlite[2/7] [======34%                   ] nsys_report_db_25000_10_100.sqlite[2/7] [======35%                   ] nsys_report_db_25000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_10_100.sqlite[2/7] [========40%                 ] nsys_report_db_25000_10_100.sqlite[2/7] [========41%                 ] nsys_report_db_25000_10_100.sqlite[2/7] [========42%                 ] nsys_report_db_25000_10_100.sqlite[2/7] [=========43%                ] nsys_report_db_25000_10_100.sqlite[2/7] [=========44%                ] nsys_report_db_25000_10_100.sqlite[2/7] [=========45%                ] nsys_report_db_25000_10_100.sqlite[2/7] [=========46%                ] nsys_report_db_25000_10_100.sqlite[2/7] [==========47%               ] nsys_report_db_25000_10_100.sqlite[2/7] [==========48%               ] nsys_report_db_25000_10_100.sqlite[2/7] [==========49%               ] nsys_report_db_25000_10_100.sqlite[2/7] [===========50%              ] nsys_report_db_25000_10_100.sqlite[2/7] [===========51%              ] nsys_report_db_25000_10_100.sqlite[2/7] [===========52%              ] nsys_report_db_25000_10_100.sqlite[2/7] [===========53%              ] nsys_report_db_25000_10_100.sqlite[2/7] [============54%             ] nsys_report_db_25000_10_100.sqlite[2/7] [============55%             ] nsys_report_db_25000_10_100.sqlite[2/7] [============56%             ] nsys_report_db_25000_10_100.sqlite[2/7] [============57%             ] nsys_report_db_25000_10_100.sqlite[2/7] [=============58%            ] nsys_report_db_25000_10_100.sqlite[2/7] [=============59%            ] nsys_report_db_25000_10_100.sqlite[2/7] [=============60%            ] nsys_report_db_25000_10_100.sqlite[2/7] [==============61%           ] nsys_report_db_25000_10_100.sqlite[2/7] [==============62%           ] nsys_report_db_25000_10_100.sqlite[2/7] [==============63%           ] nsys_report_db_25000_10_100.sqlite[2/7] [==============64%           ] nsys_report_db_25000_10_100.sqlite[2/7] [===============65%          ] nsys_report_db_25000_10_100.sqlite[2/7] [===============66%          ] nsys_report_db_25000_10_100.sqlite[2/7] [===============67%          ] nsys_report_db_25000_10_100.sqlite[2/7] [================68%         ] nsys_report_db_25000_10_100.sqlite[2/7] [================69%         ] nsys_report_db_25000_10_100.sqlite[2/7] [================70%         ] nsys_report_db_25000_10_100.sqlite[2/7] [================71%         ] nsys_report_db_25000_10_100.sqlite[2/7] [=================72%        ] nsys_report_db_25000_10_100.sqlite[2/7] [=================73%        ] nsys_report_db_25000_10_100.sqlite[2/7] [=================74%        ] nsys_report_db_25000_10_100.sqlite[2/7] [==================75%       ] nsys_report_db_25000_10_100.sqlite[2/7] [==================76%       ] nsys_report_db_25000_10_100.sqlite[2/7] [==================77%       ] nsys_report_db_25000_10_100.sqlite[2/7] [==================78%       ] nsys_report_db_25000_10_100.sqlite[2/7] [===================79%      ] nsys_report_db_25000_10_100.sqlite[2/7] [===================80%      ] nsys_report_db_25000_10_100.sqlite[2/7] [===================81%      ] nsys_report_db_25000_10_100.sqlite[2/7] [===================82%      ] nsys_report_db_25000_10_100.sqlite[2/7] [====================83%     ] nsys_report_db_25000_10_100.sqlite[2/7] [====================84%     ] nsys_report_db_25000_10_100.sqlite[2/7] [====================85%     ] nsys_report_db_25000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_10_100.sqlite[2/7] [======================90%   ] nsys_report_db_25000_10_100.sqlite[2/7] [======================91%   ] nsys_report_db_25000_10_100.sqlite[2/7] [======================92%   ] nsys_report_db_25000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_10_100.sqlite[2/7] [========================97% ] nsys_report_db_25000_10_100.sqlite[2/7] [========================98% ] nsys_report_db_25000_10_100.sqlite[2/7] [========================99% ] nsys_report_db_25000_10_100.sqlite[2/7] [========================100%] nsys_report_db_25000_10_100.sqlite[2/7] [========================100%] nsys_report_db_25000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        288591008          1  288591008.0  288591008.0  288591008  288591008          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        165191573          1  165191573.0  165191573.0  165191573  165191573          0.0  cudaFree                      
      1.0          1650891          6     275148.5     215307.5       3890     763470     281368.9  cudaMalloc                    
      0.2           342454        814        420.7        390.0        120       1790        237.7  cuGetProcAddress_v2           
      0.0            40310          2      20155.0      20155.0       1850      38460      25887.2  cudaStreamCreateWithFlags     
      0.0            19430         18       1079.4        510.0        390       8590       1916.2  cudaEventCreateWithFlags      
      0.0             6900          3       2300.0       2700.0        620       3580       1520.0  cuInit                        
      0.0             4550          3       1516.7        380.0        280       3890       2056.0  cuModuleGetLoadingMode        
      0.0              820          2        410.0        410.0        300        520        155.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 10 (num_steps = 100), identity_test = 0
Generating '/tmp/nsys-report-db20.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_10_100.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_25000_10_100.nsys-rep[1/7] [===============65%          ] nsys_report_fo_25000_10_100.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_10_100.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_100.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [1%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [2%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [3%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [4%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [5%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [6%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [7%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [8%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [9%                          ] nsys_report_fo_25000_10_100.sqlite[2/7] [10%                         ] nsys_report_fo_25000_10_100.sqlite[2/7] [11%                         ] nsys_report_fo_25000_10_100.sqlite[2/7] [12%                         ] nsys_report_fo_25000_10_100.sqlite[2/7] [13%                         ] nsys_report_fo_25000_10_100.sqlite[2/7] [14%                         ] nsys_report_fo_25000_10_100.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_10_100.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_10_100.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_10_100.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_10_100.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_10_100.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_10_100.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_10_100.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_10_100.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_10_100.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_10_100.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_10_100.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_10_100.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_10_100.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_10_100.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_10_100.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_10_100.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_10_100.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_10_100.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_10_100.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_10_100.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_10_100.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_10_100.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_10_100.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_10_100.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_10_100.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_10_100.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_10_100.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_10_100.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_10_100.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_10_100.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_10_100.sqlite[2/7] [============54%             ] nsys_report_fo_25000_10_100.sqlite[2/7] [============55%             ] nsys_report_fo_25000_10_100.sqlite[2/7] [============56%             ] nsys_report_fo_25000_10_100.sqlite[2/7] [============57%             ] nsys_report_fo_25000_10_100.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_10_100.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_10_100.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_10_100.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_10_100.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_10_100.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_10_100.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_10_100.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_10_100.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_10_100.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_10_100.sqlite[2/7] [================68%         ] nsys_report_fo_25000_10_100.sqlite[2/7] [================69%         ] nsys_report_fo_25000_10_100.sqlite[2/7] [================70%         ] nsys_report_fo_25000_10_100.sqlite[2/7] [================71%         ] nsys_report_fo_25000_10_100.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_10_100.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_10_100.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_10_100.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_10_100.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_10_100.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_10_100.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_10_100.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_10_100.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_10_100.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_10_100.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_10_100.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_10_100.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_10_100.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_10_100.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_10_100.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_10_100.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_10_100.sqlite[2/7] [========================97% ] nsys_report_fo_25000_10_100.sqlite[2/7] [========================98% ] nsys_report_fo_25000_10_100.sqlite[2/7] [========================99% ] nsys_report_fo_25000_10_100.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_100.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        268230524          1  268230524.0  268230524.0  268230524  268230524          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.9        150500993          1  150500993.0  150500993.0  150500993  150500993          0.0  cudaFree                      
      1.9          2933038         12     244419.8     311374.0       3730     413625     130284.1  cudaMalloc                    
      0.2           284864        814        350.0        310.0        120       1230        182.0  cuGetProcAddress_v2           
      0.0            37151          2      18575.5      18575.5       1860      35291      23639.3  cudaStreamCreateWithFlags     
      0.0            25610         18       1422.8        510.0        400      14910       3386.3  cudaEventCreateWithFlags      
      0.0             4650          3       1550.0       1730.0        540       2380        933.1  cuInit                        
      0.0             3650          3       1216.7        260.0        160       3230       1744.3  cuModuleGetLoadingMode        
      0.0              900          2        450.0        450.0        300        600        212.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 10 (num_steps = 150)
number of batches= 15
Generating '/tmp/nsys-report-f229.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_10_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_10_150.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_150.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [1%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [2%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [3%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [4%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [5%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [6%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [7%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [8%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [9%                          ] nsys_report_ia_25000_10_150.sqlite[2/7] [10%                         ] nsys_report_ia_25000_10_150.sqlite[2/7] [11%                         ] nsys_report_ia_25000_10_150.sqlite[2/7] [12%                         ] nsys_report_ia_25000_10_150.sqlite[2/7] [13%                         ] nsys_report_ia_25000_10_150.sqlite[2/7] [14%                         ] nsys_report_ia_25000_10_150.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_10_150.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_10_150.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_10_150.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_10_150.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_10_150.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_10_150.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_10_150.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_10_150.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_10_150.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_10_150.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_10_150.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_10_150.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_10_150.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_10_150.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_10_150.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_10_150.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_10_150.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_10_150.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_10_150.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_10_150.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_10_150.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_10_150.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_10_150.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_10_150.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_10_150.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_10_150.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_10_150.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_10_150.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_10_150.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_10_150.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_10_150.sqlite[2/7] [============54%             ] nsys_report_ia_25000_10_150.sqlite[2/7] [============55%             ] nsys_report_ia_25000_10_150.sqlite[2/7] [============56%             ] nsys_report_ia_25000_10_150.sqlite[2/7] [============57%             ] nsys_report_ia_25000_10_150.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_10_150.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_10_150.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_10_150.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_10_150.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_10_150.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_10_150.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_10_150.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_10_150.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_10_150.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_10_150.sqlite[2/7] [================68%         ] nsys_report_ia_25000_10_150.sqlite[2/7] [================69%         ] nsys_report_ia_25000_10_150.sqlite[2/7] [================70%         ] nsys_report_ia_25000_10_150.sqlite[2/7] [================71%         ] nsys_report_ia_25000_10_150.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_10_150.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_10_150.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_10_150.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_10_150.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_10_150.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_10_150.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_10_150.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_10_150.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_10_150.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_10_150.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_10_150.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_10_150.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_10_150.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_10_150.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_10_150.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_10_150.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_10_150.sqlite[2/7] [========================97% ] nsys_report_ia_25000_10_150.sqlite[2/7] [========================98% ] nsys_report_ia_25000_10_150.sqlite[2/7] [========================99% ] nsys_report_ia_25000_10_150.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_150.sqlite[2/7] [========================100%] nsys_report_ia_25000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        250730040          1  250730040.0  250730040.0  250730040  250730040          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        133081429          1  133081429.0  133081429.0  133081429  133081429          0.0  cudaFree                      
      1.2          1632531          6     272088.5     209053.0       4040     776530     284169.1  cudaMalloc                    
      0.3           351155        814        431.4        380.0        120      16841        625.7  cuGetProcAddress_v2           
      0.0            40750          2      20375.0      20375.0       1950      38800      26056.9  cudaStreamCreateWithFlags     
      0.0            24150         18       1341.7        515.0        390      13420       3040.7  cudaEventCreateWithFlags      
      0.0             6651          3       2217.0       2180.0        730       3741       1505.8  cuInit                        
      0.0             4580          3       1526.7        380.0        290       3910       2064.5  cuModuleGetLoadingMode        
      0.0              820          2        410.0        410.0        320        500        127.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_10_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 10 (num_steps = 150)
number of batches= 15
Generating '/tmp/nsys-report-2946.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_10_150.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_10_150.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_150.nsys-rep[1/7] [========================100%] nsys_report_db_25000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [1%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [2%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [3%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [4%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [5%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [6%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [7%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [8%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [9%                          ] nsys_report_db_25000_10_150.sqlite[2/7] [10%                         ] nsys_report_db_25000_10_150.sqlite[2/7] [11%                         ] nsys_report_db_25000_10_150.sqlite[2/7] [12%                         ] nsys_report_db_25000_10_150.sqlite[2/7] [13%                         ] nsys_report_db_25000_10_150.sqlite[2/7] [14%                         ] nsys_report_db_25000_10_150.sqlite[2/7] [=15%                        ] nsys_report_db_25000_10_150.sqlite[2/7] [=16%                        ] nsys_report_db_25000_10_150.sqlite[2/7] [=17%                        ] nsys_report_db_25000_10_150.sqlite[2/7] [==18%                       ] nsys_report_db_25000_10_150.sqlite[2/7] [==19%                       ] nsys_report_db_25000_10_150.sqlite[2/7] [==20%                       ] nsys_report_db_25000_10_150.sqlite[2/7] [==21%                       ] nsys_report_db_25000_10_150.sqlite[2/7] [===22%                      ] nsys_report_db_25000_10_150.sqlite[2/7] [===23%                      ] nsys_report_db_25000_10_150.sqlite[2/7] [===24%                      ] nsys_report_db_25000_10_150.sqlite[2/7] [====25%                     ] nsys_report_db_25000_10_150.sqlite[2/7] [====26%                     ] nsys_report_db_25000_10_150.sqlite[2/7] [====27%                     ] nsys_report_db_25000_10_150.sqlite[2/7] [====28%                     ] nsys_report_db_25000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_10_150.sqlite[2/7] [======33%                   ] nsys_report_db_25000_10_150.sqlite[2/7] [======34%                   ] nsys_report_db_25000_10_150.sqlite[2/7] [======35%                   ] nsys_report_db_25000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_10_150.sqlite[2/7] [========40%                 ] nsys_report_db_25000_10_150.sqlite[2/7] [========41%                 ] nsys_report_db_25000_10_150.sqlite[2/7] [========42%                 ] nsys_report_db_25000_10_150.sqlite[2/7] [=========43%                ] nsys_report_db_25000_10_150.sqlite[2/7] [=========44%                ] nsys_report_db_25000_10_150.sqlite[2/7] [=========45%                ] nsys_report_db_25000_10_150.sqlite[2/7] [=========46%                ] nsys_report_db_25000_10_150.sqlite[2/7] [==========47%               ] nsys_report_db_25000_10_150.sqlite[2/7] [==========48%               ] nsys_report_db_25000_10_150.sqlite[2/7] [==========49%               ] nsys_report_db_25000_10_150.sqlite[2/7] [===========50%              ] nsys_report_db_25000_10_150.sqlite[2/7] [===========51%              ] nsys_report_db_25000_10_150.sqlite[2/7] [===========52%              ] nsys_report_db_25000_10_150.sqlite[2/7] [===========53%              ] nsys_report_db_25000_10_150.sqlite[2/7] [============54%             ] nsys_report_db_25000_10_150.sqlite[2/7] [============55%             ] nsys_report_db_25000_10_150.sqlite[2/7] [============56%             ] nsys_report_db_25000_10_150.sqlite[2/7] [============57%             ] nsys_report_db_25000_10_150.sqlite[2/7] [=============58%            ] nsys_report_db_25000_10_150.sqlite[2/7] [=============59%            ] nsys_report_db_25000_10_150.sqlite[2/7] [=============60%            ] nsys_report_db_25000_10_150.sqlite[2/7] [==============61%           ] nsys_report_db_25000_10_150.sqlite[2/7] [==============62%           ] nsys_report_db_25000_10_150.sqlite[2/7] [==============63%           ] nsys_report_db_25000_10_150.sqlite[2/7] [==============64%           ] nsys_report_db_25000_10_150.sqlite[2/7] [===============65%          ] nsys_report_db_25000_10_150.sqlite[2/7] [===============66%          ] nsys_report_db_25000_10_150.sqlite[2/7] [===============67%          ] nsys_report_db_25000_10_150.sqlite[2/7] [================68%         ] nsys_report_db_25000_10_150.sqlite[2/7] [================69%         ] nsys_report_db_25000_10_150.sqlite[2/7] [================70%         ] nsys_report_db_25000_10_150.sqlite[2/7] [================71%         ] nsys_report_db_25000_10_150.sqlite[2/7] [=================72%        ] nsys_report_db_25000_10_150.sqlite[2/7] [=================73%        ] nsys_report_db_25000_10_150.sqlite[2/7] [=================74%        ] nsys_report_db_25000_10_150.sqlite[2/7] [==================75%       ] nsys_report_db_25000_10_150.sqlite[2/7] [==================76%       ] nsys_report_db_25000_10_150.sqlite[2/7] [==================77%       ] nsys_report_db_25000_10_150.sqlite[2/7] [==================78%       ] nsys_report_db_25000_10_150.sqlite[2/7] [===================79%      ] nsys_report_db_25000_10_150.sqlite[2/7] [===================80%      ] nsys_report_db_25000_10_150.sqlite[2/7] [===================81%      ] nsys_report_db_25000_10_150.sqlite[2/7] [===================82%      ] nsys_report_db_25000_10_150.sqlite[2/7] [====================83%     ] nsys_report_db_25000_10_150.sqlite[2/7] [====================84%     ] nsys_report_db_25000_10_150.sqlite[2/7] [====================85%     ] nsys_report_db_25000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_10_150.sqlite[2/7] [======================90%   ] nsys_report_db_25000_10_150.sqlite[2/7] [======================91%   ] nsys_report_db_25000_10_150.sqlite[2/7] [======================92%   ] nsys_report_db_25000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_10_150.sqlite[2/7] [========================97% ] nsys_report_db_25000_10_150.sqlite[2/7] [========================98% ] nsys_report_db_25000_10_150.sqlite[2/7] [========================99% ] nsys_report_db_25000_10_150.sqlite[2/7] [========================100%] nsys_report_db_25000_10_150.sqlite[2/7] [========================100%] nsys_report_db_25000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        281497771          1  281497771.0  281497771.0  281497771  281497771          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        161630873          1  161630873.0  161630873.0  161630873  161630873          0.0  cudaFree                      
      1.0          1629410          6     271568.3     210482.5       3920     767880     280479.8  cudaMalloc                    
      0.2           322834        814        396.6        370.0        120       1520        234.1  cuGetProcAddress_v2           
      0.0            35410          2      17705.0      17705.0       1870      33540      22394.1  cudaStreamCreateWithFlags     
      0.0            24921         18       1384.5        500.0        390      14080       3200.0  cudaEventCreateWithFlags      
      0.0             4760          3       1586.7       1350.0        880       2530        850.1  cuInit                        
      0.0             3790          3       1263.3        240.0        150       3400       1851.0  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        300        620        226.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_10_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 10 (num_steps = 150), identity_test = 0
Generating '/tmp/nsys-report-52b6.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_10_150.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_10_150.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_150.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [1%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [2%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [3%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [4%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [5%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [6%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [7%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [8%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [9%                          ] nsys_report_fo_25000_10_150.sqlite[2/7] [10%                         ] nsys_report_fo_25000_10_150.sqlite[2/7] [11%                         ] nsys_report_fo_25000_10_150.sqlite[2/7] [12%                         ] nsys_report_fo_25000_10_150.sqlite[2/7] [13%                         ] nsys_report_fo_25000_10_150.sqlite[2/7] [14%                         ] nsys_report_fo_25000_10_150.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_10_150.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_10_150.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_10_150.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_10_150.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_10_150.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_10_150.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_10_150.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_10_150.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_10_150.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_10_150.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_10_150.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_10_150.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_10_150.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_10_150.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_10_150.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_10_150.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_10_150.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_10_150.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_10_150.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_10_150.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_10_150.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_10_150.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_10_150.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_10_150.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_10_150.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_10_150.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_10_150.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_10_150.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_10_150.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_10_150.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_10_150.sqlite[2/7] [============54%             ] nsys_report_fo_25000_10_150.sqlite[2/7] [============55%             ] nsys_report_fo_25000_10_150.sqlite[2/7] [============56%             ] nsys_report_fo_25000_10_150.sqlite[2/7] [============57%             ] nsys_report_fo_25000_10_150.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_10_150.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_10_150.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_10_150.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_10_150.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_10_150.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_10_150.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_10_150.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_10_150.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_10_150.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_10_150.sqlite[2/7] [================68%         ] nsys_report_fo_25000_10_150.sqlite[2/7] [================69%         ] nsys_report_fo_25000_10_150.sqlite[2/7] [================70%         ] nsys_report_fo_25000_10_150.sqlite[2/7] [================71%         ] nsys_report_fo_25000_10_150.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_10_150.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_10_150.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_10_150.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_10_150.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_10_150.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_10_150.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_10_150.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_10_150.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_10_150.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_10_150.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_10_150.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_10_150.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_10_150.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_10_150.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_10_150.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_10_150.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_10_150.sqlite[2/7] [========================97% ] nsys_report_fo_25000_10_150.sqlite[2/7] [========================98% ] nsys_report_fo_25000_10_150.sqlite[2/7] [========================99% ] nsys_report_fo_25000_10_150.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_150.sqlite[2/7] [========================100%] nsys_report_fo_25000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        279385062          1  279385062.0  279385062.0  279385062  279385062          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        159444725          1  159444725.0  159444725.0  159444725  159444725          0.0  cudaFree                      
      1.8          2936258         12     244688.2     315659.0       4710     382625     127628.4  cudaMalloc                    
      0.2           278544        814        342.2        300.0        120       1500        183.7  cuGetProcAddress_v2           
      0.0            36201          2      18100.5      18100.5       1690      34511      23208.0  cudaStreamCreateWithFlags     
      0.0            19590         18       1088.3        440.0        390      10670       2405.6  cudaEventCreateWithFlags      
      0.0             5220          3       1740.0       1750.0        560       2910       1175.0  cuInit                        
      0.0             3340          3       1113.3        280.0        180       2880       1530.8  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        330        560        162.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_10_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 20 (num_steps = 20)
number of batches= 1
Generating '/tmp/nsys-report-0b61.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_20_20.nsys-rep[1/7] [=====31%                    ] nsys_report_ia_25000_20_20.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_20_20.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_20.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [1%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [2%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [3%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [4%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [5%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [6%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [7%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [8%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [9%                          ] nsys_report_ia_25000_20_20.sqlite[2/7] [10%                         ] nsys_report_ia_25000_20_20.sqlite[2/7] [11%                         ] nsys_report_ia_25000_20_20.sqlite[2/7] [12%                         ] nsys_report_ia_25000_20_20.sqlite[2/7] [13%                         ] nsys_report_ia_25000_20_20.sqlite[2/7] [14%                         ] nsys_report_ia_25000_20_20.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_20_20.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_20_20.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_20_20.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_20_20.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_20_20.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_20_20.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_20_20.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_20_20.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_20_20.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_20_20.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_20_20.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_20_20.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_20_20.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_20_20.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_20_20.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_20_20.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_20_20.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_20_20.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_20_20.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_20_20.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_20_20.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_20_20.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_20_20.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_20_20.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_20_20.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_20_20.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_20_20.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_20_20.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_20_20.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_20_20.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_20_20.sqlite[2/7] [============54%             ] nsys_report_ia_25000_20_20.sqlite[2/7] [============55%             ] nsys_report_ia_25000_20_20.sqlite[2/7] [============56%             ] nsys_report_ia_25000_20_20.sqlite[2/7] [============57%             ] nsys_report_ia_25000_20_20.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_20_20.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_20_20.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_20_20.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_20_20.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_20_20.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_20_20.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_20_20.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_20_20.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_20_20.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_20_20.sqlite[2/7] [================68%         ] nsys_report_ia_25000_20_20.sqlite[2/7] [================69%         ] nsys_report_ia_25000_20_20.sqlite[2/7] [================70%         ] nsys_report_ia_25000_20_20.sqlite[2/7] [================71%         ] nsys_report_ia_25000_20_20.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_20_20.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_20_20.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_20_20.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_20_20.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_20_20.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_20_20.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_20_20.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_20_20.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_20_20.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_20_20.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_20_20.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_20_20.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_20_20.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_20_20.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_20_20.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_20_20.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_20_20.sqlite[2/7] [========================97% ] nsys_report_ia_25000_20_20.sqlite[2/7] [========================98% ] nsys_report_ia_25000_20_20.sqlite[2/7] [========================99% ] nsys_report_ia_25000_20_20.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_20.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        243383829          1  243383829.0  243383829.0  243383829  243383829          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        129427980          1  129427980.0  129427980.0  129427980  129427980          0.0  cudaFree                      
      1.3          1686571          6     281095.2     212972.5       4800     825141     302253.7  cudaMalloc                    
      0.2           286394        814        351.8        310.0        120       1210        182.8  cuGetProcAddress_v2           
      0.0            34821          2      17410.5      17410.5       2010      32811      21779.6  cudaStreamCreateWithFlags     
      0.0            19610         18       1089.4        465.0        380      10330       2329.4  cudaEventCreateWithFlags      
      0.0             4390          3       1463.3       1610.0        590       2190        810.0  cuInit                        
      0.0             3830          3       1276.7        290.0        150       3390       1831.5  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        290        630        240.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 20 (num_steps = 20)
number of batches= 1
Generating '/tmp/nsys-report-3eea.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_20_20.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_20_20.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_20_20.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_20.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [1%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [2%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [3%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [4%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [5%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [6%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [7%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [8%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [9%                          ] nsys_report_db_25000_20_20.sqlite[2/7] [10%                         ] nsys_report_db_25000_20_20.sqlite[2/7] [11%                         ] nsys_report_db_25000_20_20.sqlite[2/7] [12%                         ] nsys_report_db_25000_20_20.sqlite[2/7] [13%                         ] nsys_report_db_25000_20_20.sqlite[2/7] [14%                         ] nsys_report_db_25000_20_20.sqlite[2/7] [=15%                        ] nsys_report_db_25000_20_20.sqlite[2/7] [=16%                        ] nsys_report_db_25000_20_20.sqlite[2/7] [=17%                        ] nsys_report_db_25000_20_20.sqlite[2/7] [==18%                       ] nsys_report_db_25000_20_20.sqlite[2/7] [==19%                       ] nsys_report_db_25000_20_20.sqlite[2/7] [==20%                       ] nsys_report_db_25000_20_20.sqlite[2/7] [==21%                       ] nsys_report_db_25000_20_20.sqlite[2/7] [===22%                      ] nsys_report_db_25000_20_20.sqlite[2/7] [===23%                      ] nsys_report_db_25000_20_20.sqlite[2/7] [===24%                      ] nsys_report_db_25000_20_20.sqlite[2/7] [====25%                     ] nsys_report_db_25000_20_20.sqlite[2/7] [====26%                     ] nsys_report_db_25000_20_20.sqlite[2/7] [====27%                     ] nsys_report_db_25000_20_20.sqlite[2/7] [====28%                     ] nsys_report_db_25000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_20_20.sqlite[2/7] [======33%                   ] nsys_report_db_25000_20_20.sqlite[2/7] [======34%                   ] nsys_report_db_25000_20_20.sqlite[2/7] [======35%                   ] nsys_report_db_25000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_20_20.sqlite[2/7] [========40%                 ] nsys_report_db_25000_20_20.sqlite[2/7] [========41%                 ] nsys_report_db_25000_20_20.sqlite[2/7] [========42%                 ] nsys_report_db_25000_20_20.sqlite[2/7] [=========43%                ] nsys_report_db_25000_20_20.sqlite[2/7] [=========44%                ] nsys_report_db_25000_20_20.sqlite[2/7] [=========45%                ] nsys_report_db_25000_20_20.sqlite[2/7] [=========46%                ] nsys_report_db_25000_20_20.sqlite[2/7] [==========47%               ] nsys_report_db_25000_20_20.sqlite[2/7] [==========48%               ] nsys_report_db_25000_20_20.sqlite[2/7] [==========49%               ] nsys_report_db_25000_20_20.sqlite[2/7] [===========50%              ] nsys_report_db_25000_20_20.sqlite[2/7] [===========51%              ] nsys_report_db_25000_20_20.sqlite[2/7] [===========52%              ] nsys_report_db_25000_20_20.sqlite[2/7] [===========53%              ] nsys_report_db_25000_20_20.sqlite[2/7] [============54%             ] nsys_report_db_25000_20_20.sqlite[2/7] [============55%             ] nsys_report_db_25000_20_20.sqlite[2/7] [============56%             ] nsys_report_db_25000_20_20.sqlite[2/7] [============57%             ] nsys_report_db_25000_20_20.sqlite[2/7] [=============58%            ] nsys_report_db_25000_20_20.sqlite[2/7] [=============59%            ] nsys_report_db_25000_20_20.sqlite[2/7] [=============60%            ] nsys_report_db_25000_20_20.sqlite[2/7] [==============61%           ] nsys_report_db_25000_20_20.sqlite[2/7] [==============62%           ] nsys_report_db_25000_20_20.sqlite[2/7] [==============63%           ] nsys_report_db_25000_20_20.sqlite[2/7] [==============64%           ] nsys_report_db_25000_20_20.sqlite[2/7] [===============65%          ] nsys_report_db_25000_20_20.sqlite[2/7] [===============66%          ] nsys_report_db_25000_20_20.sqlite[2/7] [===============67%          ] nsys_report_db_25000_20_20.sqlite[2/7] [================68%         ] nsys_report_db_25000_20_20.sqlite[2/7] [================69%         ] nsys_report_db_25000_20_20.sqlite[2/7] [================70%         ] nsys_report_db_25000_20_20.sqlite[2/7] [================71%         ] nsys_report_db_25000_20_20.sqlite[2/7] [=================72%        ] nsys_report_db_25000_20_20.sqlite[2/7] [=================73%        ] nsys_report_db_25000_20_20.sqlite[2/7] [=================74%        ] nsys_report_db_25000_20_20.sqlite[2/7] [==================75%       ] nsys_report_db_25000_20_20.sqlite[2/7] [==================76%       ] nsys_report_db_25000_20_20.sqlite[2/7] [==================77%       ] nsys_report_db_25000_20_20.sqlite[2/7] [==================78%       ] nsys_report_db_25000_20_20.sqlite[2/7] [===================79%      ] nsys_report_db_25000_20_20.sqlite[2/7] [===================80%      ] nsys_report_db_25000_20_20.sqlite[2/7] [===================81%      ] nsys_report_db_25000_20_20.sqlite[2/7] [===================82%      ] nsys_report_db_25000_20_20.sqlite[2/7] [====================83%     ] nsys_report_db_25000_20_20.sqlite[2/7] [====================84%     ] nsys_report_db_25000_20_20.sqlite[2/7] [====================85%     ] nsys_report_db_25000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_20_20.sqlite[2/7] [======================90%   ] nsys_report_db_25000_20_20.sqlite[2/7] [======================91%   ] nsys_report_db_25000_20_20.sqlite[2/7] [======================92%   ] nsys_report_db_25000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_20_20.sqlite[2/7] [========================97% ] nsys_report_db_25000_20_20.sqlite[2/7] [========================98% ] nsys_report_db_25000_20_20.sqlite[2/7] [========================99% ] nsys_report_db_25000_20_20.sqlite[2/7] [========================100%] nsys_report_db_25000_20_20.sqlite[2/7] [========================100%] nsys_report_db_25000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        274932491          1  274932491.0  274932491.0  274932491  274932491          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        155017975          1  155017975.0  155017975.0  155017975  155017975          0.0  cudaFree                      
      1.1          1705751          6     284291.8     216813.0       4100     827730     303935.7  cudaMalloc                    
      0.2           292885        814        359.8        320.0        130       1530        187.3  cuGetProcAddress_v2           
      0.0            34120          2      17060.0      17060.0       1880      32240      21467.8  cudaStreamCreateWithFlags     
      0.0            24010         18       1333.9        470.0        400      13130       2975.2  cudaEventCreateWithFlags      
      0.0             5120          3       1706.7       1820.0        600       2700       1054.6  cuInit                        
      0.0             3480          3       1160.0        280.0        280       2920       1524.2  cuModuleGetLoadingMode        
      0.0              870          2        435.0        435.0        310        560        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 20 (num_steps = 20), identity_test = 0
Generating '/tmp/nsys-report-2714.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_20_20.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_20_20.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_20_20.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_20.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [1%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [2%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [3%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [4%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [5%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [6%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [7%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [8%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [9%                          ] nsys_report_fo_25000_20_20.sqlite[2/7] [10%                         ] nsys_report_fo_25000_20_20.sqlite[2/7] [11%                         ] nsys_report_fo_25000_20_20.sqlite[2/7] [12%                         ] nsys_report_fo_25000_20_20.sqlite[2/7] [13%                         ] nsys_report_fo_25000_20_20.sqlite[2/7] [14%                         ] nsys_report_fo_25000_20_20.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_20_20.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_20_20.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_20_20.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_20_20.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_20_20.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_20_20.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_20_20.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_20_20.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_20_20.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_20_20.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_20_20.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_20_20.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_20_20.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_20_20.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_20_20.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_20_20.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_20_20.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_20_20.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_20_20.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_20_20.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_20_20.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_20_20.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_20_20.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_20_20.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_20_20.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_20_20.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_20_20.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_20_20.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_20_20.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_20_20.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_20_20.sqlite[2/7] [============54%             ] nsys_report_fo_25000_20_20.sqlite[2/7] [============55%             ] nsys_report_fo_25000_20_20.sqlite[2/7] [============56%             ] nsys_report_fo_25000_20_20.sqlite[2/7] [============57%             ] nsys_report_fo_25000_20_20.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_20_20.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_20_20.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_20_20.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_20_20.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_20_20.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_20_20.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_20_20.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_20_20.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_20_20.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_20_20.sqlite[2/7] [================68%         ] nsys_report_fo_25000_20_20.sqlite[2/7] [================69%         ] nsys_report_fo_25000_20_20.sqlite[2/7] [================70%         ] nsys_report_fo_25000_20_20.sqlite[2/7] [================71%         ] nsys_report_fo_25000_20_20.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_20_20.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_20_20.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_20_20.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_20_20.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_20_20.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_20_20.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_20_20.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_20_20.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_20_20.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_20_20.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_20_20.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_20_20.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_20_20.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_20_20.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_20_20.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_20_20.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_20_20.sqlite[2/7] [========================97% ] nsys_report_fo_25000_20_20.sqlite[2/7] [========================98% ] nsys_report_fo_25000_20_20.sqlite[2/7] [========================99% ] nsys_report_fo_25000_20_20.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_20.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        270696314          1  270696314.0  270696314.0  270696314  270696314          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.9        153348002          1  153348002.0  153348002.0  153348002  153348002          0.0  cudaFree                      
      1.9          2900957         12     241746.4     309859.0       3800     375055     126924.4  cudaMalloc                    
      0.2           265754        814        326.5        290.0        130       1310        168.1  cuGetProcAddress_v2           
      0.0            35730          2      17865.0      17865.0       2790      32940      21319.3  cudaStreamCreateWithFlags     
      0.0            20780         18       1154.4        455.0        390      10380       2334.6  cudaEventCreateWithFlags      
      0.0             5050          3       1683.3       2040.0        640       2370        918.5  cuInit                        
      0.0             3350          3       1116.7        270.0        170       2910       1553.9  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        320        600        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 20 (num_steps = 40)
number of batches= 2
Generating '/tmp/nsys-report-de1b.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_20_40.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_20_40.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_20_40.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_20_40.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_40.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [1%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [2%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [3%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [4%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [5%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [6%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [7%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [8%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [9%                          ] nsys_report_ia_25000_20_40.sqlite[2/7] [10%                         ] nsys_report_ia_25000_20_40.sqlite[2/7] [11%                         ] nsys_report_ia_25000_20_40.sqlite[2/7] [12%                         ] nsys_report_ia_25000_20_40.sqlite[2/7] [13%                         ] nsys_report_ia_25000_20_40.sqlite[2/7] [14%                         ] nsys_report_ia_25000_20_40.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_20_40.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_20_40.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_20_40.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_20_40.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_20_40.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_20_40.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_20_40.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_20_40.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_20_40.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_20_40.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_20_40.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_20_40.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_20_40.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_20_40.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_20_40.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_20_40.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_20_40.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_20_40.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_20_40.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_20_40.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_20_40.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_20_40.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_20_40.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_20_40.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_20_40.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_20_40.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_20_40.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_20_40.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_20_40.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_20_40.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_20_40.sqlite[2/7] [============54%             ] nsys_report_ia_25000_20_40.sqlite[2/7] [============55%             ] nsys_report_ia_25000_20_40.sqlite[2/7] [============56%             ] nsys_report_ia_25000_20_40.sqlite[2/7] [============57%             ] nsys_report_ia_25000_20_40.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_20_40.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_20_40.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_20_40.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_20_40.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_20_40.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_20_40.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_20_40.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_20_40.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_20_40.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_20_40.sqlite[2/7] [================68%         ] nsys_report_ia_25000_20_40.sqlite[2/7] [================69%         ] nsys_report_ia_25000_20_40.sqlite[2/7] [================70%         ] nsys_report_ia_25000_20_40.sqlite[2/7] [================71%         ] nsys_report_ia_25000_20_40.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_20_40.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_20_40.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_20_40.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_20_40.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_20_40.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_20_40.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_20_40.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_20_40.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_20_40.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_20_40.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_20_40.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_20_40.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_20_40.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_20_40.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_20_40.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_20_40.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_20_40.sqlite[2/7] [========================97% ] nsys_report_ia_25000_20_40.sqlite[2/7] [========================98% ] nsys_report_ia_25000_20_40.sqlite[2/7] [========================99% ] nsys_report_ia_25000_20_40.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_40.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        248325369          1  248325369.0  248325369.0  248325369  248325369          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        129442257          1  129442257.0  129442257.0  129442257  129442257          0.0  cudaFree                      
      1.3          1661600          6     276933.3     202477.5       3770     821500     300651.8  cudaMalloc                    
      0.2           268135        814        329.4        290.0        110       1460        177.3  cuGetProcAddress_v2           
      0.0            31080          2      15540.0      15540.0       1840      29240      19374.7  cudaStreamCreateWithFlags     
      0.0            26430         18       1468.3        520.0        400      15380       3496.7  cudaEventCreateWithFlags      
      0.0             5030          3       1676.7       1440.0       1140       2450        686.3  cuInit                        
      0.0             3650          3       1216.7        400.0        170       3080       1617.8  cuModuleGetLoadingMode        
      0.0             1000          2        500.0        500.0        340        660        226.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 20 (num_steps = 40)
number of batches= 2
Generating '/tmp/nsys-report-97fc.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_20_40.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_20_40.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_20_40.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_20_40.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_40.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [1%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [2%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [3%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [4%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [5%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [6%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [7%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [8%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [9%                          ] nsys_report_db_25000_20_40.sqlite[2/7] [10%                         ] nsys_report_db_25000_20_40.sqlite[2/7] [11%                         ] nsys_report_db_25000_20_40.sqlite[2/7] [12%                         ] nsys_report_db_25000_20_40.sqlite[2/7] [13%                         ] nsys_report_db_25000_20_40.sqlite[2/7] [14%                         ] nsys_report_db_25000_20_40.sqlite[2/7] [=15%                        ] nsys_report_db_25000_20_40.sqlite[2/7] [=16%                        ] nsys_report_db_25000_20_40.sqlite[2/7] [=17%                        ] nsys_report_db_25000_20_40.sqlite[2/7] [==18%                       ] nsys_report_db_25000_20_40.sqlite[2/7] [==19%                       ] nsys_report_db_25000_20_40.sqlite[2/7] [==20%                       ] nsys_report_db_25000_20_40.sqlite[2/7] [==21%                       ] nsys_report_db_25000_20_40.sqlite[2/7] [===22%                      ] nsys_report_db_25000_20_40.sqlite[2/7] [===23%                      ] nsys_report_db_25000_20_40.sqlite[2/7] [===24%                      ] nsys_report_db_25000_20_40.sqlite[2/7] [====25%                     ] nsys_report_db_25000_20_40.sqlite[2/7] [====26%                     ] nsys_report_db_25000_20_40.sqlite[2/7] [====27%                     ] nsys_report_db_25000_20_40.sqlite[2/7] [====28%                     ] nsys_report_db_25000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_20_40.sqlite[2/7] [======33%                   ] nsys_report_db_25000_20_40.sqlite[2/7] [======34%                   ] nsys_report_db_25000_20_40.sqlite[2/7] [======35%                   ] nsys_report_db_25000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_20_40.sqlite[2/7] [========40%                 ] nsys_report_db_25000_20_40.sqlite[2/7] [========41%                 ] nsys_report_db_25000_20_40.sqlite[2/7] [========42%                 ] nsys_report_db_25000_20_40.sqlite[2/7] [=========43%                ] nsys_report_db_25000_20_40.sqlite[2/7] [=========44%                ] nsys_report_db_25000_20_40.sqlite[2/7] [=========45%                ] nsys_report_db_25000_20_40.sqlite[2/7] [=========46%                ] nsys_report_db_25000_20_40.sqlite[2/7] [==========47%               ] nsys_report_db_25000_20_40.sqlite[2/7] [==========48%               ] nsys_report_db_25000_20_40.sqlite[2/7] [==========49%               ] nsys_report_db_25000_20_40.sqlite[2/7] [===========50%              ] nsys_report_db_25000_20_40.sqlite[2/7] [===========51%              ] nsys_report_db_25000_20_40.sqlite[2/7] [===========52%              ] nsys_report_db_25000_20_40.sqlite[2/7] [===========53%              ] nsys_report_db_25000_20_40.sqlite[2/7] [============54%             ] nsys_report_db_25000_20_40.sqlite[2/7] [============55%             ] nsys_report_db_25000_20_40.sqlite[2/7] [============56%             ] nsys_report_db_25000_20_40.sqlite[2/7] [============57%             ] nsys_report_db_25000_20_40.sqlite[2/7] [=============58%            ] nsys_report_db_25000_20_40.sqlite[2/7] [=============59%            ] nsys_report_db_25000_20_40.sqlite[2/7] [=============60%            ] nsys_report_db_25000_20_40.sqlite[2/7] [==============61%           ] nsys_report_db_25000_20_40.sqlite[2/7] [==============62%           ] nsys_report_db_25000_20_40.sqlite[2/7] [==============63%           ] nsys_report_db_25000_20_40.sqlite[2/7] [==============64%           ] nsys_report_db_25000_20_40.sqlite[2/7] [===============65%          ] nsys_report_db_25000_20_40.sqlite[2/7] [===============66%          ] nsys_report_db_25000_20_40.sqlite[2/7] [===============67%          ] nsys_report_db_25000_20_40.sqlite[2/7] [================68%         ] nsys_report_db_25000_20_40.sqlite[2/7] [================69%         ] nsys_report_db_25000_20_40.sqlite[2/7] [================70%         ] nsys_report_db_25000_20_40.sqlite[2/7] [================71%         ] nsys_report_db_25000_20_40.sqlite[2/7] [=================72%        ] nsys_report_db_25000_20_40.sqlite[2/7] [=================73%        ] nsys_report_db_25000_20_40.sqlite[2/7] [=================74%        ] nsys_report_db_25000_20_40.sqlite[2/7] [==================75%       ] nsys_report_db_25000_20_40.sqlite[2/7] [==================76%       ] nsys_report_db_25000_20_40.sqlite[2/7] [==================77%       ] nsys_report_db_25000_20_40.sqlite[2/7] [==================78%       ] nsys_report_db_25000_20_40.sqlite[2/7] [===================79%      ] nsys_report_db_25000_20_40.sqlite[2/7] [===================80%      ] nsys_report_db_25000_20_40.sqlite[2/7] [===================81%      ] nsys_report_db_25000_20_40.sqlite[2/7] [===================82%      ] nsys_report_db_25000_20_40.sqlite[2/7] [====================83%     ] nsys_report_db_25000_20_40.sqlite[2/7] [====================84%     ] nsys_report_db_25000_20_40.sqlite[2/7] [====================85%     ] nsys_report_db_25000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_20_40.sqlite[2/7] [======================90%   ] nsys_report_db_25000_20_40.sqlite[2/7] [======================91%   ] nsys_report_db_25000_20_40.sqlite[2/7] [======================92%   ] nsys_report_db_25000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_20_40.sqlite[2/7] [========================97% ] nsys_report_db_25000_20_40.sqlite[2/7] [========================98% ] nsys_report_db_25000_20_40.sqlite[2/7] [========================99% ] nsys_report_db_25000_20_40.sqlite[2/7] [========================100%] nsys_report_db_25000_20_40.sqlite[2/7] [========================100%] nsys_report_db_25000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        277364880          1  277364880.0  277364880.0  277364880  277364880          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        156055208          1  156055208.0  156055208.0  156055208  156055208          0.0  cudaFree                      
      1.1          1719692          6     286615.3     209797.5       3740     820581     301468.7  cudaMalloc                    
      0.2           269953        814        331.6        290.0        120       1300        171.6  cuGetProcAddress_v2           
      0.0            32840          2      16420.0      16420.0       1910      30930      20520.2  cudaStreamCreateWithFlags     
      0.0            21761         18       1208.9        525.0        400      10330       2314.8  cudaEventCreateWithFlags      
      0.0             4940          3       1646.7       1730.0        580       2630       1027.5  cuInit                        
      0.0             3640          3       1213.3        430.0        280       2930       1488.6  cuModuleGetLoadingMode        
      0.0             1010          2        505.0        505.0        440        570         91.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 20 (num_steps = 40), identity_test = 0
Generating '/tmp/nsys-report-e802.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_20_40.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_20_40.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_20_40.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_20_40.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_40.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [1%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [2%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [3%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [4%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [5%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [6%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [7%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [8%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [9%                          ] nsys_report_fo_25000_20_40.sqlite[2/7] [10%                         ] nsys_report_fo_25000_20_40.sqlite[2/7] [11%                         ] nsys_report_fo_25000_20_40.sqlite[2/7] [12%                         ] nsys_report_fo_25000_20_40.sqlite[2/7] [13%                         ] nsys_report_fo_25000_20_40.sqlite[2/7] [14%                         ] nsys_report_fo_25000_20_40.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_20_40.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_20_40.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_20_40.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_20_40.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_20_40.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_20_40.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_20_40.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_20_40.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_20_40.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_20_40.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_20_40.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_20_40.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_20_40.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_20_40.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_20_40.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_20_40.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_20_40.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_20_40.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_20_40.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_20_40.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_20_40.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_20_40.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_20_40.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_20_40.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_20_40.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_20_40.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_20_40.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_20_40.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_20_40.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_20_40.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_20_40.sqlite[2/7] [============54%             ] nsys_report_fo_25000_20_40.sqlite[2/7] [============55%             ] nsys_report_fo_25000_20_40.sqlite[2/7] [============56%             ] nsys_report_fo_25000_20_40.sqlite[2/7] [============57%             ] nsys_report_fo_25000_20_40.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_20_40.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_20_40.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_20_40.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_20_40.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_20_40.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_20_40.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_20_40.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_20_40.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_20_40.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_20_40.sqlite[2/7] [================68%         ] nsys_report_fo_25000_20_40.sqlite[2/7] [================69%         ] nsys_report_fo_25000_20_40.sqlite[2/7] [================70%         ] nsys_report_fo_25000_20_40.sqlite[2/7] [================71%         ] nsys_report_fo_25000_20_40.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_20_40.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_20_40.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_20_40.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_20_40.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_20_40.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_20_40.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_20_40.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_20_40.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_20_40.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_20_40.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_20_40.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_20_40.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_20_40.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_20_40.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_20_40.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_20_40.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_20_40.sqlite[2/7] [========================97% ] nsys_report_fo_25000_20_40.sqlite[2/7] [========================98% ] nsys_report_fo_25000_20_40.sqlite[2/7] [========================99% ] nsys_report_fo_25000_20_40.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_40.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        246202196          1  246202196.0  246202196.0  246202196  246202196          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.6        129904130          1  129904130.0  129904130.0  129904130  129904130          0.0  cudaFree                      
      2.1          2829866         12     235822.2     301964.0       3690     346884     122266.4  cudaMalloc                    
      0.2           263874        814        324.2        280.0        120       1530        178.9  cuGetProcAddress_v2           
      0.0            38111          2      19055.5      19055.5       1930      36181      24219.1  cudaStreamCreateWithFlags     
      0.0            24170         18       1342.8        485.0        390      13920       3160.4  cudaEventCreateWithFlags      
      0.0             4900          3       1633.3       1620.0        620       2660       1020.1  cuInit                        
      0.0             3150          3       1050.0        260.0        190       2700       1429.4  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        310        640        233.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 20 (num_steps = 60)
number of batches= 3
Generating '/tmp/nsys-report-d76a.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_20_60.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_20_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_20_60.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_60.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [1%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [2%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [3%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [4%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [5%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [6%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [7%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [8%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [9%                          ] nsys_report_ia_25000_20_60.sqlite[2/7] [10%                         ] nsys_report_ia_25000_20_60.sqlite[2/7] [11%                         ] nsys_report_ia_25000_20_60.sqlite[2/7] [12%                         ] nsys_report_ia_25000_20_60.sqlite[2/7] [13%                         ] nsys_report_ia_25000_20_60.sqlite[2/7] [14%                         ] nsys_report_ia_25000_20_60.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_20_60.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_20_60.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_20_60.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_20_60.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_20_60.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_20_60.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_20_60.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_20_60.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_20_60.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_20_60.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_20_60.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_20_60.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_20_60.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_20_60.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_20_60.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_20_60.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_20_60.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_20_60.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_20_60.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_20_60.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_20_60.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_20_60.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_20_60.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_20_60.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_20_60.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_20_60.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_20_60.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_20_60.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_20_60.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_20_60.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_20_60.sqlite[2/7] [============54%             ] nsys_report_ia_25000_20_60.sqlite[2/7] [============55%             ] nsys_report_ia_25000_20_60.sqlite[2/7] [============56%             ] nsys_report_ia_25000_20_60.sqlite[2/7] [============57%             ] nsys_report_ia_25000_20_60.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_20_60.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_20_60.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_20_60.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_20_60.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_20_60.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_20_60.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_20_60.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_20_60.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_20_60.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_20_60.sqlite[2/7] [================68%         ] nsys_report_ia_25000_20_60.sqlite[2/7] [================69%         ] nsys_report_ia_25000_20_60.sqlite[2/7] [================70%         ] nsys_report_ia_25000_20_60.sqlite[2/7] [================71%         ] nsys_report_ia_25000_20_60.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_20_60.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_20_60.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_20_60.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_20_60.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_20_60.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_20_60.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_20_60.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_20_60.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_20_60.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_20_60.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_20_60.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_20_60.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_20_60.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_20_60.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_20_60.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_20_60.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_20_60.sqlite[2/7] [========================97% ] nsys_report_ia_25000_20_60.sqlite[2/7] [========================98% ] nsys_report_ia_25000_20_60.sqlite[2/7] [========================99% ] nsys_report_ia_25000_20_60.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_60.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        250989006          1  250989006.0  250989006.0  250989006  250989006          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        135965607          1  135965607.0  135965607.0  135965607  135965607          0.0  cudaFree                      
      1.2          1675273          6     279212.2     213082.5       4291     824821     302606.1  cudaMalloc                    
      0.2           270514        814        332.3        290.0        120       1300        175.8  cuGetProcAddress_v2           
      0.0            45530          2      22765.0      22765.0       1940      43590      29451.0  cudaStreamCreateWithFlags     
      0.0            23780         18       1321.1        520.0        400      13260       2999.9  cudaEventCreateWithFlags      
      0.0             4530          3       1510.0       1470.0        650       2410        880.7  cuInit                        
      0.0             3500          3       1166.7        360.0        170       2970       1564.6  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        310        580        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 20 (num_steps = 60)
number of batches= 3
Generating '/tmp/nsys-report-60f0.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_20_60.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_20_60.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_20_60.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_60.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [1%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [2%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [3%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [4%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [5%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [6%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [7%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [8%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [9%                          ] nsys_report_db_25000_20_60.sqlite[2/7] [10%                         ] nsys_report_db_25000_20_60.sqlite[2/7] [11%                         ] nsys_report_db_25000_20_60.sqlite[2/7] [12%                         ] nsys_report_db_25000_20_60.sqlite[2/7] [13%                         ] nsys_report_db_25000_20_60.sqlite[2/7] [14%                         ] nsys_report_db_25000_20_60.sqlite[2/7] [=15%                        ] nsys_report_db_25000_20_60.sqlite[2/7] [=16%                        ] nsys_report_db_25000_20_60.sqlite[2/7] [=17%                        ] nsys_report_db_25000_20_60.sqlite[2/7] [==18%                       ] nsys_report_db_25000_20_60.sqlite[2/7] [==19%                       ] nsys_report_db_25000_20_60.sqlite[2/7] [==20%                       ] nsys_report_db_25000_20_60.sqlite[2/7] [==21%                       ] nsys_report_db_25000_20_60.sqlite[2/7] [===22%                      ] nsys_report_db_25000_20_60.sqlite[2/7] [===23%                      ] nsys_report_db_25000_20_60.sqlite[2/7] [===24%                      ] nsys_report_db_25000_20_60.sqlite[2/7] [====25%                     ] nsys_report_db_25000_20_60.sqlite[2/7] [====26%                     ] nsys_report_db_25000_20_60.sqlite[2/7] [====27%                     ] nsys_report_db_25000_20_60.sqlite[2/7] [====28%                     ] nsys_report_db_25000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_20_60.sqlite[2/7] [======33%                   ] nsys_report_db_25000_20_60.sqlite[2/7] [======34%                   ] nsys_report_db_25000_20_60.sqlite[2/7] [======35%                   ] nsys_report_db_25000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_20_60.sqlite[2/7] [========40%                 ] nsys_report_db_25000_20_60.sqlite[2/7] [========41%                 ] nsys_report_db_25000_20_60.sqlite[2/7] [========42%                 ] nsys_report_db_25000_20_60.sqlite[2/7] [=========43%                ] nsys_report_db_25000_20_60.sqlite[2/7] [=========44%                ] nsys_report_db_25000_20_60.sqlite[2/7] [=========45%                ] nsys_report_db_25000_20_60.sqlite[2/7] [=========46%                ] nsys_report_db_25000_20_60.sqlite[2/7] [==========47%               ] nsys_report_db_25000_20_60.sqlite[2/7] [==========48%               ] nsys_report_db_25000_20_60.sqlite[2/7] [==========49%               ] nsys_report_db_25000_20_60.sqlite[2/7] [===========50%              ] nsys_report_db_25000_20_60.sqlite[2/7] [===========51%              ] nsys_report_db_25000_20_60.sqlite[2/7] [===========52%              ] nsys_report_db_25000_20_60.sqlite[2/7] [===========53%              ] nsys_report_db_25000_20_60.sqlite[2/7] [============54%             ] nsys_report_db_25000_20_60.sqlite[2/7] [============55%             ] nsys_report_db_25000_20_60.sqlite[2/7] [============56%             ] nsys_report_db_25000_20_60.sqlite[2/7] [============57%             ] nsys_report_db_25000_20_60.sqlite[2/7] [=============58%            ] nsys_report_db_25000_20_60.sqlite[2/7] [=============59%            ] nsys_report_db_25000_20_60.sqlite[2/7] [=============60%            ] nsys_report_db_25000_20_60.sqlite[2/7] [==============61%           ] nsys_report_db_25000_20_60.sqlite[2/7] [==============62%           ] nsys_report_db_25000_20_60.sqlite[2/7] [==============63%           ] nsys_report_db_25000_20_60.sqlite[2/7] [==============64%           ] nsys_report_db_25000_20_60.sqlite[2/7] [===============65%          ] nsys_report_db_25000_20_60.sqlite[2/7] [===============66%          ] nsys_report_db_25000_20_60.sqlite[2/7] [===============67%          ] nsys_report_db_25000_20_60.sqlite[2/7] [================68%         ] nsys_report_db_25000_20_60.sqlite[2/7] [================69%         ] nsys_report_db_25000_20_60.sqlite[2/7] [================70%         ] nsys_report_db_25000_20_60.sqlite[2/7] [================71%         ] nsys_report_db_25000_20_60.sqlite[2/7] [=================72%        ] nsys_report_db_25000_20_60.sqlite[2/7] [=================73%        ] nsys_report_db_25000_20_60.sqlite[2/7] [=================74%        ] nsys_report_db_25000_20_60.sqlite[2/7] [==================75%       ] nsys_report_db_25000_20_60.sqlite[2/7] [==================76%       ] nsys_report_db_25000_20_60.sqlite[2/7] [==================77%       ] nsys_report_db_25000_20_60.sqlite[2/7] [==================78%       ] nsys_report_db_25000_20_60.sqlite[2/7] [===================79%      ] nsys_report_db_25000_20_60.sqlite[2/7] [===================80%      ] nsys_report_db_25000_20_60.sqlite[2/7] [===================81%      ] nsys_report_db_25000_20_60.sqlite[2/7] [===================82%      ] nsys_report_db_25000_20_60.sqlite[2/7] [====================83%     ] nsys_report_db_25000_20_60.sqlite[2/7] [====================84%     ] nsys_report_db_25000_20_60.sqlite[2/7] [====================85%     ] nsys_report_db_25000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_20_60.sqlite[2/7] [======================90%   ] nsys_report_db_25000_20_60.sqlite[2/7] [======================91%   ] nsys_report_db_25000_20_60.sqlite[2/7] [======================92%   ] nsys_report_db_25000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_20_60.sqlite[2/7] [========================97% ] nsys_report_db_25000_20_60.sqlite[2/7] [========================98% ] nsys_report_db_25000_20_60.sqlite[2/7] [========================99% ] nsys_report_db_25000_20_60.sqlite[2/7] [========================100%] nsys_report_db_25000_20_60.sqlite[2/7] [========================100%] nsys_report_db_25000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        272909626          1  272909626.0  272909626.0  272909626  272909626          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        154268800          1  154268800.0  154268800.0  154268800  154268800          0.0  cudaFree                      
      1.1          1693062          6     282177.0     210793.0       3880     830601     303216.6  cudaMalloc                    
      0.2           298664        814        366.9        320.0        120       1490        195.7  cuGetProcAddress_v2           
      0.0            32111          2      16055.5      16055.5       2040      30071      19820.9  cudaStreamCreateWithFlags     
      0.0            23240         18       1291.1        505.0        400      12330       2782.6  cudaEventCreateWithFlags      
      0.0             4760          3       1586.7       1780.0        570       2410        935.1  cuInit                        
      0.0             3490          3       1163.3        260.0        150       3080       1660.8  cuModuleGetLoadingMode        
      0.0             1020          2        510.0        510.0        310        710        282.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 20 (num_steps = 60), identity_test = 0
Generating '/tmp/nsys-report-68e7.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_20_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_20_60.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_20_60.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_60.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [1%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [2%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [3%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [4%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [5%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [6%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [7%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [8%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [9%                          ] nsys_report_fo_25000_20_60.sqlite[2/7] [10%                         ] nsys_report_fo_25000_20_60.sqlite[2/7] [11%                         ] nsys_report_fo_25000_20_60.sqlite[2/7] [12%                         ] nsys_report_fo_25000_20_60.sqlite[2/7] [13%                         ] nsys_report_fo_25000_20_60.sqlite[2/7] [14%                         ] nsys_report_fo_25000_20_60.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_20_60.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_20_60.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_20_60.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_20_60.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_20_60.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_20_60.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_20_60.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_20_60.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_20_60.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_20_60.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_20_60.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_20_60.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_20_60.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_20_60.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_20_60.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_20_60.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_20_60.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_20_60.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_20_60.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_20_60.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_20_60.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_20_60.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_20_60.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_20_60.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_20_60.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_20_60.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_20_60.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_20_60.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_20_60.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_20_60.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_20_60.sqlite[2/7] [============54%             ] nsys_report_fo_25000_20_60.sqlite[2/7] [============55%             ] nsys_report_fo_25000_20_60.sqlite[2/7] [============56%             ] nsys_report_fo_25000_20_60.sqlite[2/7] [============57%             ] nsys_report_fo_25000_20_60.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_20_60.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_20_60.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_20_60.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_20_60.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_20_60.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_20_60.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_20_60.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_20_60.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_20_60.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_20_60.sqlite[2/7] [================68%         ] nsys_report_fo_25000_20_60.sqlite[2/7] [================69%         ] nsys_report_fo_25000_20_60.sqlite[2/7] [================70%         ] nsys_report_fo_25000_20_60.sqlite[2/7] [================71%         ] nsys_report_fo_25000_20_60.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_20_60.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_20_60.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_20_60.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_20_60.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_20_60.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_20_60.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_20_60.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_20_60.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_20_60.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_20_60.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_20_60.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_20_60.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_20_60.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_20_60.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_20_60.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_20_60.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_20_60.sqlite[2/7] [========================97% ] nsys_report_fo_25000_20_60.sqlite[2/7] [========================98% ] nsys_report_fo_25000_20_60.sqlite[2/7] [========================99% ] nsys_report_fo_25000_20_60.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_60.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        264449094          1  264449094.0  264449094.0  264449094  264449094          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.8        146634862          1  146634862.0  146634862.0  146634862  146634862          0.0  cudaFree                      
      1.9          2909618         12     242468.2     315609.0       3970     353385     126265.5  cudaMalloc                    
      0.2           293823        814        361.0        320.0        120       1670        191.6  cuGetProcAddress_v2           
      0.0            37460          2      18730.0      18730.0       1840      35620      23886.1  cudaStreamCreateWithFlags     
      0.0            22630         18       1257.2        455.0        400      12070       2730.8  cudaEventCreateWithFlags      
      0.0             5250          3       1750.0       2270.0        690       2290        918.0  cuInit                        
      0.0             3340          3       1113.3        270.0        160       2910       1556.9  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        300        590        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 20 (num_steps = 80)
number of batches= 4
Generating '/tmp/nsys-report-0629.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_20_80.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_25000_20_80.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_20_80.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_20_80.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_80.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [1%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [2%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [3%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [4%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [5%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [6%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [7%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [8%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [9%                          ] nsys_report_ia_25000_20_80.sqlite[2/7] [10%                         ] nsys_report_ia_25000_20_80.sqlite[2/7] [11%                         ] nsys_report_ia_25000_20_80.sqlite[2/7] [12%                         ] nsys_report_ia_25000_20_80.sqlite[2/7] [13%                         ] nsys_report_ia_25000_20_80.sqlite[2/7] [14%                         ] nsys_report_ia_25000_20_80.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_20_80.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_20_80.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_20_80.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_20_80.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_20_80.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_20_80.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_20_80.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_20_80.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_20_80.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_20_80.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_20_80.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_20_80.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_20_80.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_20_80.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_20_80.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_20_80.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_20_80.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_20_80.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_20_80.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_20_80.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_20_80.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_20_80.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_20_80.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_20_80.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_20_80.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_20_80.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_20_80.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_20_80.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_20_80.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_20_80.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_20_80.sqlite[2/7] [============54%             ] nsys_report_ia_25000_20_80.sqlite[2/7] [============55%             ] nsys_report_ia_25000_20_80.sqlite[2/7] [============56%             ] nsys_report_ia_25000_20_80.sqlite[2/7] [============57%             ] nsys_report_ia_25000_20_80.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_20_80.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_20_80.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_20_80.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_20_80.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_20_80.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_20_80.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_20_80.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_20_80.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_20_80.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_20_80.sqlite[2/7] [================68%         ] nsys_report_ia_25000_20_80.sqlite[2/7] [================69%         ] nsys_report_ia_25000_20_80.sqlite[2/7] [================70%         ] nsys_report_ia_25000_20_80.sqlite[2/7] [================71%         ] nsys_report_ia_25000_20_80.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_20_80.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_20_80.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_20_80.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_20_80.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_20_80.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_20_80.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_20_80.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_20_80.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_20_80.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_20_80.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_20_80.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_20_80.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_20_80.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_20_80.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_20_80.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_20_80.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_20_80.sqlite[2/7] [========================97% ] nsys_report_ia_25000_20_80.sqlite[2/7] [========================98% ] nsys_report_ia_25000_20_80.sqlite[2/7] [========================99% ] nsys_report_ia_25000_20_80.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_80.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        238189427          1  238189427.0  238189427.0  238189427  238189427          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        134240741          1  134240741.0  134240741.0  134240741  134240741          0.0  cudaFree                      
      1.3          1754462          6     292410.3     205372.5       4060     876951     322554.1  cudaMalloc                    
      0.2           311704        814        382.9        340.0        120       1280        209.2  cuGetProcAddress_v2           
      0.0            39200          2      19600.0      19600.0       2210      36990      24593.2  cudaStreamCreateWithFlags     
      0.0            22610         18       1256.1        575.0        410       9960       2235.9  cudaEventCreateWithFlags      
      0.0             5130          3       1710.0       2250.0        560       2320        996.5  cuInit                        
      0.0             3370          3       1123.3        260.0        180       2930       1565.1  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        320        570        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 20 (num_steps = 80)
number of batches= 4
Generating '/tmp/nsys-report-a9f0.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_20_80.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_20_80.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_20_80.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_20_80.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_80.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [1%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [2%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [3%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [4%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [5%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [6%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [7%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [8%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [9%                          ] nsys_report_db_25000_20_80.sqlite[2/7] [10%                         ] nsys_report_db_25000_20_80.sqlite[2/7] [11%                         ] nsys_report_db_25000_20_80.sqlite[2/7] [12%                         ] nsys_report_db_25000_20_80.sqlite[2/7] [13%                         ] nsys_report_db_25000_20_80.sqlite[2/7] [14%                         ] nsys_report_db_25000_20_80.sqlite[2/7] [=15%                        ] nsys_report_db_25000_20_80.sqlite[2/7] [=16%                        ] nsys_report_db_25000_20_80.sqlite[2/7] [=17%                        ] nsys_report_db_25000_20_80.sqlite[2/7] [==18%                       ] nsys_report_db_25000_20_80.sqlite[2/7] [==19%                       ] nsys_report_db_25000_20_80.sqlite[2/7] [==20%                       ] nsys_report_db_25000_20_80.sqlite[2/7] [==21%                       ] nsys_report_db_25000_20_80.sqlite[2/7] [===22%                      ] nsys_report_db_25000_20_80.sqlite[2/7] [===23%                      ] nsys_report_db_25000_20_80.sqlite[2/7] [===24%                      ] nsys_report_db_25000_20_80.sqlite[2/7] [====25%                     ] nsys_report_db_25000_20_80.sqlite[2/7] [====26%                     ] nsys_report_db_25000_20_80.sqlite[2/7] [====27%                     ] nsys_report_db_25000_20_80.sqlite[2/7] [====28%                     ] nsys_report_db_25000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_20_80.sqlite[2/7] [======33%                   ] nsys_report_db_25000_20_80.sqlite[2/7] [======34%                   ] nsys_report_db_25000_20_80.sqlite[2/7] [======35%                   ] nsys_report_db_25000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_20_80.sqlite[2/7] [========40%                 ] nsys_report_db_25000_20_80.sqlite[2/7] [========41%                 ] nsys_report_db_25000_20_80.sqlite[2/7] [========42%                 ] nsys_report_db_25000_20_80.sqlite[2/7] [=========43%                ] nsys_report_db_25000_20_80.sqlite[2/7] [=========44%                ] nsys_report_db_25000_20_80.sqlite[2/7] [=========45%                ] nsys_report_db_25000_20_80.sqlite[2/7] [=========46%                ] nsys_report_db_25000_20_80.sqlite[2/7] [==========47%               ] nsys_report_db_25000_20_80.sqlite[2/7] [==========48%               ] nsys_report_db_25000_20_80.sqlite[2/7] [==========49%               ] nsys_report_db_25000_20_80.sqlite[2/7] [===========50%              ] nsys_report_db_25000_20_80.sqlite[2/7] [===========51%              ] nsys_report_db_25000_20_80.sqlite[2/7] [===========52%              ] nsys_report_db_25000_20_80.sqlite[2/7] [===========53%              ] nsys_report_db_25000_20_80.sqlite[2/7] [============54%             ] nsys_report_db_25000_20_80.sqlite[2/7] [============55%             ] nsys_report_db_25000_20_80.sqlite[2/7] [============56%             ] nsys_report_db_25000_20_80.sqlite[2/7] [============57%             ] nsys_report_db_25000_20_80.sqlite[2/7] [=============58%            ] nsys_report_db_25000_20_80.sqlite[2/7] [=============59%            ] nsys_report_db_25000_20_80.sqlite[2/7] [=============60%            ] nsys_report_db_25000_20_80.sqlite[2/7] [==============61%           ] nsys_report_db_25000_20_80.sqlite[2/7] [==============62%           ] nsys_report_db_25000_20_80.sqlite[2/7] [==============63%           ] nsys_report_db_25000_20_80.sqlite[2/7] [==============64%           ] nsys_report_db_25000_20_80.sqlite[2/7] [===============65%          ] nsys_report_db_25000_20_80.sqlite[2/7] [===============66%          ] nsys_report_db_25000_20_80.sqlite[2/7] [===============67%          ] nsys_report_db_25000_20_80.sqlite[2/7] [================68%         ] nsys_report_db_25000_20_80.sqlite[2/7] [================69%         ] nsys_report_db_25000_20_80.sqlite[2/7] [================70%         ] nsys_report_db_25000_20_80.sqlite[2/7] [================71%         ] nsys_report_db_25000_20_80.sqlite[2/7] [=================72%        ] nsys_report_db_25000_20_80.sqlite[2/7] [=================73%        ] nsys_report_db_25000_20_80.sqlite[2/7] [=================74%        ] nsys_report_db_25000_20_80.sqlite[2/7] [==================75%       ] nsys_report_db_25000_20_80.sqlite[2/7] [==================76%       ] nsys_report_db_25000_20_80.sqlite[2/7] [==================77%       ] nsys_report_db_25000_20_80.sqlite[2/7] [==================78%       ] nsys_report_db_25000_20_80.sqlite[2/7] [===================79%      ] nsys_report_db_25000_20_80.sqlite[2/7] [===================80%      ] nsys_report_db_25000_20_80.sqlite[2/7] [===================81%      ] nsys_report_db_25000_20_80.sqlite[2/7] [===================82%      ] nsys_report_db_25000_20_80.sqlite[2/7] [====================83%     ] nsys_report_db_25000_20_80.sqlite[2/7] [====================84%     ] nsys_report_db_25000_20_80.sqlite[2/7] [====================85%     ] nsys_report_db_25000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_20_80.sqlite[2/7] [======================90%   ] nsys_report_db_25000_20_80.sqlite[2/7] [======================91%   ] nsys_report_db_25000_20_80.sqlite[2/7] [======================92%   ] nsys_report_db_25000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_20_80.sqlite[2/7] [========================97% ] nsys_report_db_25000_20_80.sqlite[2/7] [========================98% ] nsys_report_db_25000_20_80.sqlite[2/7] [========================99% ] nsys_report_db_25000_20_80.sqlite[2/7] [========================100%] nsys_report_db_25000_20_80.sqlite[2/7] [========================100%] nsys_report_db_25000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        282878268          1  282878268.0  282878268.0  282878268  282878268          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        162480552          1  162480552.0  162480552.0  162480552  162480552          0.0  cudaFree                      
      1.0          1713332          6     285555.3     220797.5       3780     822661     302549.1  cudaMalloc                    
      0.2           262684        814        322.7        290.0        120       1400        166.0  cuGetProcAddress_v2           
      0.0            38741          2      19370.5      19370.5       1910      36831      24692.9  cudaStreamCreateWithFlags     
      0.0            23010         18       1278.3        500.0        390      12440       2811.1  cudaEventCreateWithFlags      
      0.0             4750          3       1583.3       1750.0        630       2370        881.9  cuInit                        
      0.0             4240          3       1413.3        550.0        250       3440       1761.5  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        330        600        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 20 (num_steps = 80), identity_test = 0
Generating '/tmp/nsys-report-1127.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_20_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_20_80.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_20_80.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_20_80.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_80.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [1%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [2%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [3%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [4%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [5%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [6%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [7%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [8%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [9%                          ] nsys_report_fo_25000_20_80.sqlite[2/7] [10%                         ] nsys_report_fo_25000_20_80.sqlite[2/7] [11%                         ] nsys_report_fo_25000_20_80.sqlite[2/7] [12%                         ] nsys_report_fo_25000_20_80.sqlite[2/7] [13%                         ] nsys_report_fo_25000_20_80.sqlite[2/7] [14%                         ] nsys_report_fo_25000_20_80.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_20_80.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_20_80.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_20_80.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_20_80.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_20_80.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_20_80.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_20_80.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_20_80.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_20_80.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_20_80.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_20_80.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_20_80.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_20_80.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_20_80.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_20_80.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_20_80.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_20_80.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_20_80.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_20_80.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_20_80.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_20_80.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_20_80.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_20_80.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_20_80.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_20_80.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_20_80.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_20_80.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_20_80.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_20_80.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_20_80.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_20_80.sqlite[2/7] [============54%             ] nsys_report_fo_25000_20_80.sqlite[2/7] [============55%             ] nsys_report_fo_25000_20_80.sqlite[2/7] [============56%             ] nsys_report_fo_25000_20_80.sqlite[2/7] [============57%             ] nsys_report_fo_25000_20_80.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_20_80.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_20_80.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_20_80.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_20_80.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_20_80.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_20_80.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_20_80.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_20_80.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_20_80.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_20_80.sqlite[2/7] [================68%         ] nsys_report_fo_25000_20_80.sqlite[2/7] [================69%         ] nsys_report_fo_25000_20_80.sqlite[2/7] [================70%         ] nsys_report_fo_25000_20_80.sqlite[2/7] [================71%         ] nsys_report_fo_25000_20_80.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_20_80.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_20_80.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_20_80.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_20_80.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_20_80.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_20_80.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_20_80.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_20_80.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_20_80.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_20_80.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_20_80.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_20_80.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_20_80.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_20_80.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_20_80.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_20_80.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_20_80.sqlite[2/7] [========================97% ] nsys_report_fo_25000_20_80.sqlite[2/7] [========================98% ] nsys_report_fo_25000_20_80.sqlite[2/7] [========================99% ] nsys_report_fo_25000_20_80.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_80.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        264750285          1  264750285.0  264750285.0  264750285  264750285          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.8        145676407          1  145676407.0  145676407.0  145676407  145676407          0.0  cudaFree                      
      2.0          2912477         12     242706.4     311904.0       3730     368945     127451.7  cudaMalloc                    
      0.2           264413        814        324.8        290.0        120       1120        167.3  cuGetProcAddress_v2           
      0.0            34841          2      17420.5      17420.5       1780      33061      22119.0  cudaStreamCreateWithFlags     
      0.0            22750         18       1263.9        510.0        380      12470       2817.1  cudaEventCreateWithFlags      
      0.0             4250          3       1416.7       1200.0        630       2420        914.5  cuInit                        
      0.0             3100          3       1033.3        280.0        180       2640       1392.3  cuModuleGetLoadingMode        
      0.0              940          2        470.0        470.0        310        630        226.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 20 (num_steps = 100)
number of batches= 5
Generating '/tmp/nsys-report-6da1.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_20_100.nsys-rep[1/7] [======35%                   ] nsys_report_ia_25000_20_100.nsys-rep[1/7] [================69%         ] nsys_report_ia_25000_20_100.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_20_100.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_100.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [1%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [2%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [3%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [4%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [5%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [6%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [7%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [8%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [9%                          ] nsys_report_ia_25000_20_100.sqlite[2/7] [10%                         ] nsys_report_ia_25000_20_100.sqlite[2/7] [11%                         ] nsys_report_ia_25000_20_100.sqlite[2/7] [12%                         ] nsys_report_ia_25000_20_100.sqlite[2/7] [13%                         ] nsys_report_ia_25000_20_100.sqlite[2/7] [14%                         ] nsys_report_ia_25000_20_100.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_20_100.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_20_100.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_20_100.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_20_100.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_20_100.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_20_100.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_20_100.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_20_100.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_20_100.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_20_100.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_20_100.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_20_100.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_20_100.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_20_100.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_20_100.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_20_100.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_20_100.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_20_100.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_20_100.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_20_100.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_20_100.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_20_100.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_20_100.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_20_100.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_20_100.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_20_100.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_20_100.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_20_100.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_20_100.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_20_100.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_20_100.sqlite[2/7] [============54%             ] nsys_report_ia_25000_20_100.sqlite[2/7] [============55%             ] nsys_report_ia_25000_20_100.sqlite[2/7] [============56%             ] nsys_report_ia_25000_20_100.sqlite[2/7] [============57%             ] nsys_report_ia_25000_20_100.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_20_100.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_20_100.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_20_100.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_20_100.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_20_100.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_20_100.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_20_100.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_20_100.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_20_100.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_20_100.sqlite[2/7] [================68%         ] nsys_report_ia_25000_20_100.sqlite[2/7] [================69%         ] nsys_report_ia_25000_20_100.sqlite[2/7] [================70%         ] nsys_report_ia_25000_20_100.sqlite[2/7] [================71%         ] nsys_report_ia_25000_20_100.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_20_100.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_20_100.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_20_100.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_20_100.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_20_100.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_20_100.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_20_100.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_20_100.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_20_100.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_20_100.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_20_100.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_20_100.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_20_100.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_20_100.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_20_100.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_20_100.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_20_100.sqlite[2/7] [========================97% ] nsys_report_ia_25000_20_100.sqlite[2/7] [========================98% ] nsys_report_ia_25000_20_100.sqlite[2/7] [========================99% ] nsys_report_ia_25000_20_100.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_100.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        250686634          1  250686634.0  250686634.0  250686634  250686634          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        134532404          1  134532404.0  134532404.0  134532404  134532404          0.0  cudaFree                      
      1.2          1655941          6     275990.2     205997.5       3600     820920     299980.6  cudaMalloc                    
      0.2           286563        814        352.0        300.0        120       1270        190.9  cuGetProcAddress_v2           
      0.0            34820          2      17410.0      17410.0       2200      32620      21510.2  cudaStreamCreateWithFlags     
      0.0            19640         18       1091.1        525.0        400       9080       2025.4  cudaEventCreateWithFlags      
      0.0             4210          3       1403.3       1630.0        710       1870        612.3  cuInit                        
      0.0             3980          3       1326.7        270.0        270       3440       1830.2  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        330        620        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 20 (num_steps = 100)
number of batches= 5
Generating '/tmp/nsys-report-0260.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_20_100.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_20_100.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_20_100.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_20_100.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_100.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [1%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [2%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [3%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [4%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [5%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [6%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [7%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [8%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [9%                          ] nsys_report_db_25000_20_100.sqlite[2/7] [10%                         ] nsys_report_db_25000_20_100.sqlite[2/7] [11%                         ] nsys_report_db_25000_20_100.sqlite[2/7] [12%                         ] nsys_report_db_25000_20_100.sqlite[2/7] [13%                         ] nsys_report_db_25000_20_100.sqlite[2/7] [14%                         ] nsys_report_db_25000_20_100.sqlite[2/7] [=15%                        ] nsys_report_db_25000_20_100.sqlite[2/7] [=16%                        ] nsys_report_db_25000_20_100.sqlite[2/7] [=17%                        ] nsys_report_db_25000_20_100.sqlite[2/7] [==18%                       ] nsys_report_db_25000_20_100.sqlite[2/7] [==19%                       ] nsys_report_db_25000_20_100.sqlite[2/7] [==20%                       ] nsys_report_db_25000_20_100.sqlite[2/7] [==21%                       ] nsys_report_db_25000_20_100.sqlite[2/7] [===22%                      ] nsys_report_db_25000_20_100.sqlite[2/7] [===23%                      ] nsys_report_db_25000_20_100.sqlite[2/7] [===24%                      ] nsys_report_db_25000_20_100.sqlite[2/7] [====25%                     ] nsys_report_db_25000_20_100.sqlite[2/7] [====26%                     ] nsys_report_db_25000_20_100.sqlite[2/7] [====27%                     ] nsys_report_db_25000_20_100.sqlite[2/7] [====28%                     ] nsys_report_db_25000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_20_100.sqlite[2/7] [======33%                   ] nsys_report_db_25000_20_100.sqlite[2/7] [======34%                   ] nsys_report_db_25000_20_100.sqlite[2/7] [======35%                   ] nsys_report_db_25000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_20_100.sqlite[2/7] [========40%                 ] nsys_report_db_25000_20_100.sqlite[2/7] [========41%                 ] nsys_report_db_25000_20_100.sqlite[2/7] [========42%                 ] nsys_report_db_25000_20_100.sqlite[2/7] [=========43%                ] nsys_report_db_25000_20_100.sqlite[2/7] [=========44%                ] nsys_report_db_25000_20_100.sqlite[2/7] [=========45%                ] nsys_report_db_25000_20_100.sqlite[2/7] [=========46%                ] nsys_report_db_25000_20_100.sqlite[2/7] [==========47%               ] nsys_report_db_25000_20_100.sqlite[2/7] [==========48%               ] nsys_report_db_25000_20_100.sqlite[2/7] [==========49%               ] nsys_report_db_25000_20_100.sqlite[2/7] [===========50%              ] nsys_report_db_25000_20_100.sqlite[2/7] [===========51%              ] nsys_report_db_25000_20_100.sqlite[2/7] [===========52%              ] nsys_report_db_25000_20_100.sqlite[2/7] [===========53%              ] nsys_report_db_25000_20_100.sqlite[2/7] [============54%             ] nsys_report_db_25000_20_100.sqlite[2/7] [============55%             ] nsys_report_db_25000_20_100.sqlite[2/7] [============56%             ] nsys_report_db_25000_20_100.sqlite[2/7] [============57%             ] nsys_report_db_25000_20_100.sqlite[2/7] [=============58%            ] nsys_report_db_25000_20_100.sqlite[2/7] [=============59%            ] nsys_report_db_25000_20_100.sqlite[2/7] [=============60%            ] nsys_report_db_25000_20_100.sqlite[2/7] [==============61%           ] nsys_report_db_25000_20_100.sqlite[2/7] [==============62%           ] nsys_report_db_25000_20_100.sqlite[2/7] [==============63%           ] nsys_report_db_25000_20_100.sqlite[2/7] [==============64%           ] nsys_report_db_25000_20_100.sqlite[2/7] [===============65%          ] nsys_report_db_25000_20_100.sqlite[2/7] [===============66%          ] nsys_report_db_25000_20_100.sqlite[2/7] [===============67%          ] nsys_report_db_25000_20_100.sqlite[2/7] [================68%         ] nsys_report_db_25000_20_100.sqlite[2/7] [================69%         ] nsys_report_db_25000_20_100.sqlite[2/7] [================70%         ] nsys_report_db_25000_20_100.sqlite[2/7] [================71%         ] nsys_report_db_25000_20_100.sqlite[2/7] [=================72%        ] nsys_report_db_25000_20_100.sqlite[2/7] [=================73%        ] nsys_report_db_25000_20_100.sqlite[2/7] [=================74%        ] nsys_report_db_25000_20_100.sqlite[2/7] [==================75%       ] nsys_report_db_25000_20_100.sqlite[2/7] [==================76%       ] nsys_report_db_25000_20_100.sqlite[2/7] [==================77%       ] nsys_report_db_25000_20_100.sqlite[2/7] [==================78%       ] nsys_report_db_25000_20_100.sqlite[2/7] [===================79%      ] nsys_report_db_25000_20_100.sqlite[2/7] [===================80%      ] nsys_report_db_25000_20_100.sqlite[2/7] [===================81%      ] nsys_report_db_25000_20_100.sqlite[2/7] [===================82%      ] nsys_report_db_25000_20_100.sqlite[2/7] [====================83%     ] nsys_report_db_25000_20_100.sqlite[2/7] [====================84%     ] nsys_report_db_25000_20_100.sqlite[2/7] [====================85%     ] nsys_report_db_25000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_20_100.sqlite[2/7] [======================90%   ] nsys_report_db_25000_20_100.sqlite[2/7] [======================91%   ] nsys_report_db_25000_20_100.sqlite[2/7] [======================92%   ] nsys_report_db_25000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_20_100.sqlite[2/7] [========================97% ] nsys_report_db_25000_20_100.sqlite[2/7] [========================98% ] nsys_report_db_25000_20_100.sqlite[2/7] [========================99% ] nsys_report_db_25000_20_100.sqlite[2/7] [========================100%] nsys_report_db_25000_20_100.sqlite[2/7] [========================100%] nsys_report_db_25000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        278704909          1  278704909.0  278704909.0  278704909  278704909          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        159880266          1  159880266.0  159880266.0  159880266  159880266          0.0  cudaFree                      
      1.0          1686662          6     281110.3     211177.5       3751     819001     300260.5  cudaMalloc                    
      0.2           257433        814        316.3        270.0        120       1370        173.9  cuGetProcAddress_v2           
      0.0            33110          2      16555.0      16555.0       1830      31280      20824.3  cudaStreamCreateWithFlags     
      0.0            22450         18       1247.2        470.0        390      11920       2692.6  cudaEventCreateWithFlags      
      0.0             4810          3       1603.3       2050.0        620       2140        852.8  cuInit                        
      0.0             3330          3       1110.0        290.0        180       2860       1516.5  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        320        570        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 20 (num_steps = 100), identity_test = 0
Generating '/tmp/nsys-report-d58b.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_20_100.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_20_100.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_20_100.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_20_100.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_100.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [1%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [2%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [3%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [4%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [5%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [6%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [7%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [8%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [9%                          ] nsys_report_fo_25000_20_100.sqlite[2/7] [10%                         ] nsys_report_fo_25000_20_100.sqlite[2/7] [11%                         ] nsys_report_fo_25000_20_100.sqlite[2/7] [12%                         ] nsys_report_fo_25000_20_100.sqlite[2/7] [13%                         ] nsys_report_fo_25000_20_100.sqlite[2/7] [14%                         ] nsys_report_fo_25000_20_100.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_20_100.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_20_100.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_20_100.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_20_100.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_20_100.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_20_100.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_20_100.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_20_100.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_20_100.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_20_100.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_20_100.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_20_100.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_20_100.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_20_100.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_20_100.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_20_100.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_20_100.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_20_100.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_20_100.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_20_100.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_20_100.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_20_100.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_20_100.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_20_100.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_20_100.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_20_100.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_20_100.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_20_100.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_20_100.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_20_100.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_20_100.sqlite[2/7] [============54%             ] nsys_report_fo_25000_20_100.sqlite[2/7] [============55%             ] nsys_report_fo_25000_20_100.sqlite[2/7] [============56%             ] nsys_report_fo_25000_20_100.sqlite[2/7] [============57%             ] nsys_report_fo_25000_20_100.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_20_100.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_20_100.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_20_100.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_20_100.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_20_100.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_20_100.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_20_100.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_20_100.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_20_100.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_20_100.sqlite[2/7] [================68%         ] nsys_report_fo_25000_20_100.sqlite[2/7] [================69%         ] nsys_report_fo_25000_20_100.sqlite[2/7] [================70%         ] nsys_report_fo_25000_20_100.sqlite[2/7] [================71%         ] nsys_report_fo_25000_20_100.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_20_100.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_20_100.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_20_100.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_20_100.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_20_100.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_20_100.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_20_100.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_20_100.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_20_100.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_20_100.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_20_100.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_20_100.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_20_100.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_20_100.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_20_100.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_20_100.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_20_100.sqlite[2/7] [========================97% ] nsys_report_fo_25000_20_100.sqlite[2/7] [========================98% ] nsys_report_fo_25000_20_100.sqlite[2/7] [========================99% ] nsys_report_fo_25000_20_100.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_100.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        246319235          1  246319235.0  246319235.0  246319235  246319235          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     97.6        129241555          1  129241555.0  129241555.0  129241555  129241555          0.0  cudaFree                      
      2.1          2846005         12     237167.1     302283.5       3870     354675     122026.6  cudaMalloc                    
      0.2           283725        814        348.6        310.0        120       1421        180.8  cuGetProcAddress_v2           
      0.0            39590          2      19795.0      19795.0       1840      37750      25392.2  cudaStreamCreateWithFlags     
      0.0            20571         18       1142.8        485.0        401       9860       2209.5  cudaEventCreateWithFlags      
      0.0             5090          3       1696.7       1950.0        600       2540        994.5  cuInit                        
      0.0             3130          3       1043.3        350.0        190       2590       1341.8  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        330        590        183.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 25000, batch_size = 20 (num_steps = 150)
number of batches= 8
Generating '/tmp/nsys-report-f1e2.qdstrm'
[1/7] [0%                          ] nsys_report_ia_25000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_25000_20_150.nsys-rep[1/7] [=====29%                    ] nsys_report_ia_25000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_ia_25000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_25000_20_150.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_150.nsys-rep[1/7] [========================100%] nsys_report_ia_25000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [1%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [2%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [3%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [4%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [5%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [6%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [7%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [8%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [9%                          ] nsys_report_ia_25000_20_150.sqlite[2/7] [10%                         ] nsys_report_ia_25000_20_150.sqlite[2/7] [11%                         ] nsys_report_ia_25000_20_150.sqlite[2/7] [12%                         ] nsys_report_ia_25000_20_150.sqlite[2/7] [13%                         ] nsys_report_ia_25000_20_150.sqlite[2/7] [14%                         ] nsys_report_ia_25000_20_150.sqlite[2/7] [=15%                        ] nsys_report_ia_25000_20_150.sqlite[2/7] [=16%                        ] nsys_report_ia_25000_20_150.sqlite[2/7] [=17%                        ] nsys_report_ia_25000_20_150.sqlite[2/7] [==18%                       ] nsys_report_ia_25000_20_150.sqlite[2/7] [==19%                       ] nsys_report_ia_25000_20_150.sqlite[2/7] [==20%                       ] nsys_report_ia_25000_20_150.sqlite[2/7] [==21%                       ] nsys_report_ia_25000_20_150.sqlite[2/7] [===22%                      ] nsys_report_ia_25000_20_150.sqlite[2/7] [===23%                      ] nsys_report_ia_25000_20_150.sqlite[2/7] [===24%                      ] nsys_report_ia_25000_20_150.sqlite[2/7] [====25%                     ] nsys_report_ia_25000_20_150.sqlite[2/7] [====26%                     ] nsys_report_ia_25000_20_150.sqlite[2/7] [====27%                     ] nsys_report_ia_25000_20_150.sqlite[2/7] [====28%                     ] nsys_report_ia_25000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_25000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_25000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_25000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_25000_20_150.sqlite[2/7] [======33%                   ] nsys_report_ia_25000_20_150.sqlite[2/7] [======34%                   ] nsys_report_ia_25000_20_150.sqlite[2/7] [======35%                   ] nsys_report_ia_25000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_25000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_25000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_25000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_25000_20_150.sqlite[2/7] [========40%                 ] nsys_report_ia_25000_20_150.sqlite[2/7] [========41%                 ] nsys_report_ia_25000_20_150.sqlite[2/7] [========42%                 ] nsys_report_ia_25000_20_150.sqlite[2/7] [=========43%                ] nsys_report_ia_25000_20_150.sqlite[2/7] [=========44%                ] nsys_report_ia_25000_20_150.sqlite[2/7] [=========45%                ] nsys_report_ia_25000_20_150.sqlite[2/7] [=========46%                ] nsys_report_ia_25000_20_150.sqlite[2/7] [==========47%               ] nsys_report_ia_25000_20_150.sqlite[2/7] [==========48%               ] nsys_report_ia_25000_20_150.sqlite[2/7] [==========49%               ] nsys_report_ia_25000_20_150.sqlite[2/7] [===========50%              ] nsys_report_ia_25000_20_150.sqlite[2/7] [===========51%              ] nsys_report_ia_25000_20_150.sqlite[2/7] [===========52%              ] nsys_report_ia_25000_20_150.sqlite[2/7] [===========53%              ] nsys_report_ia_25000_20_150.sqlite[2/7] [============54%             ] nsys_report_ia_25000_20_150.sqlite[2/7] [============55%             ] nsys_report_ia_25000_20_150.sqlite[2/7] [============56%             ] nsys_report_ia_25000_20_150.sqlite[2/7] [============57%             ] nsys_report_ia_25000_20_150.sqlite[2/7] [=============58%            ] nsys_report_ia_25000_20_150.sqlite[2/7] [=============59%            ] nsys_report_ia_25000_20_150.sqlite[2/7] [=============60%            ] nsys_report_ia_25000_20_150.sqlite[2/7] [==============61%           ] nsys_report_ia_25000_20_150.sqlite[2/7] [==============62%           ] nsys_report_ia_25000_20_150.sqlite[2/7] [==============63%           ] nsys_report_ia_25000_20_150.sqlite[2/7] [==============64%           ] nsys_report_ia_25000_20_150.sqlite[2/7] [===============65%          ] nsys_report_ia_25000_20_150.sqlite[2/7] [===============66%          ] nsys_report_ia_25000_20_150.sqlite[2/7] [===============67%          ] nsys_report_ia_25000_20_150.sqlite[2/7] [================68%         ] nsys_report_ia_25000_20_150.sqlite[2/7] [================69%         ] nsys_report_ia_25000_20_150.sqlite[2/7] [================70%         ] nsys_report_ia_25000_20_150.sqlite[2/7] [================71%         ] nsys_report_ia_25000_20_150.sqlite[2/7] [=================72%        ] nsys_report_ia_25000_20_150.sqlite[2/7] [=================73%        ] nsys_report_ia_25000_20_150.sqlite[2/7] [=================74%        ] nsys_report_ia_25000_20_150.sqlite[2/7] [==================75%       ] nsys_report_ia_25000_20_150.sqlite[2/7] [==================76%       ] nsys_report_ia_25000_20_150.sqlite[2/7] [==================77%       ] nsys_report_ia_25000_20_150.sqlite[2/7] [==================78%       ] nsys_report_ia_25000_20_150.sqlite[2/7] [===================79%      ] nsys_report_ia_25000_20_150.sqlite[2/7] [===================80%      ] nsys_report_ia_25000_20_150.sqlite[2/7] [===================81%      ] nsys_report_ia_25000_20_150.sqlite[2/7] [===================82%      ] nsys_report_ia_25000_20_150.sqlite[2/7] [====================83%     ] nsys_report_ia_25000_20_150.sqlite[2/7] [====================84%     ] nsys_report_ia_25000_20_150.sqlite[2/7] [====================85%     ] nsys_report_ia_25000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_25000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_25000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_25000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_25000_20_150.sqlite[2/7] [======================90%   ] nsys_report_ia_25000_20_150.sqlite[2/7] [======================91%   ] nsys_report_ia_25000_20_150.sqlite[2/7] [======================92%   ] nsys_report_ia_25000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_25000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_25000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_25000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_25000_20_150.sqlite[2/7] [========================97% ] nsys_report_ia_25000_20_150.sqlite[2/7] [========================98% ] nsys_report_ia_25000_20_150.sqlite[2/7] [========================99% ] nsys_report_ia_25000_20_150.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_150.sqlite[2/7] [========================100%] nsys_report_ia_25000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        243404376          1  243404376.0  243404376.0  243404376  243404376          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        128449564          1  128449564.0  128449564.0  128449564  128449564          0.0  cudaFree                      
      1.3          1665111          6     277518.5     201072.5       3970     838811     306171.2  cudaMalloc                    
      0.2           287673        814        353.4        310.0        120       1580        178.2  cuGetProcAddress_v2           
      0.0            35520          2      17760.0      17760.0       2240      33280      21948.6  cudaStreamCreateWithFlags     
      0.0            19130         18       1062.8        515.0        390       8690       1936.2  cudaEventCreateWithFlags      
      0.0             4510          3       1503.3       1600.0        610       2300        849.1  cuInit                        
      0.0             3760          3       1253.3        480.0        360       2920       1444.6  cuModuleGetLoadingMode        
      0.0              891          2        445.5        445.5        311        580        190.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_25000_20_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 25000, batch_size = 20 (num_steps = 150)
number of batches= 8
Generating '/tmp/nsys-report-c39c.qdstrm'
[1/7] [0%                          ] nsys_report_db_25000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_db_25000_20_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_25000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_25000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_db_25000_20_150.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_150.nsys-rep[1/7] [========================100%] nsys_report_db_25000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [1%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [2%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [3%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [4%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [5%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [6%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [7%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [8%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [9%                          ] nsys_report_db_25000_20_150.sqlite[2/7] [10%                         ] nsys_report_db_25000_20_150.sqlite[2/7] [11%                         ] nsys_report_db_25000_20_150.sqlite[2/7] [12%                         ] nsys_report_db_25000_20_150.sqlite[2/7] [13%                         ] nsys_report_db_25000_20_150.sqlite[2/7] [14%                         ] nsys_report_db_25000_20_150.sqlite[2/7] [=15%                        ] nsys_report_db_25000_20_150.sqlite[2/7] [=16%                        ] nsys_report_db_25000_20_150.sqlite[2/7] [=17%                        ] nsys_report_db_25000_20_150.sqlite[2/7] [==18%                       ] nsys_report_db_25000_20_150.sqlite[2/7] [==19%                       ] nsys_report_db_25000_20_150.sqlite[2/7] [==20%                       ] nsys_report_db_25000_20_150.sqlite[2/7] [==21%                       ] nsys_report_db_25000_20_150.sqlite[2/7] [===22%                      ] nsys_report_db_25000_20_150.sqlite[2/7] [===23%                      ] nsys_report_db_25000_20_150.sqlite[2/7] [===24%                      ] nsys_report_db_25000_20_150.sqlite[2/7] [====25%                     ] nsys_report_db_25000_20_150.sqlite[2/7] [====26%                     ] nsys_report_db_25000_20_150.sqlite[2/7] [====27%                     ] nsys_report_db_25000_20_150.sqlite[2/7] [====28%                     ] nsys_report_db_25000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_db_25000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_db_25000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_db_25000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_db_25000_20_150.sqlite[2/7] [======33%                   ] nsys_report_db_25000_20_150.sqlite[2/7] [======34%                   ] nsys_report_db_25000_20_150.sqlite[2/7] [======35%                   ] nsys_report_db_25000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_db_25000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_db_25000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_db_25000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_db_25000_20_150.sqlite[2/7] [========40%                 ] nsys_report_db_25000_20_150.sqlite[2/7] [========41%                 ] nsys_report_db_25000_20_150.sqlite[2/7] [========42%                 ] nsys_report_db_25000_20_150.sqlite[2/7] [=========43%                ] nsys_report_db_25000_20_150.sqlite[2/7] [=========44%                ] nsys_report_db_25000_20_150.sqlite[2/7] [=========45%                ] nsys_report_db_25000_20_150.sqlite[2/7] [=========46%                ] nsys_report_db_25000_20_150.sqlite[2/7] [==========47%               ] nsys_report_db_25000_20_150.sqlite[2/7] [==========48%               ] nsys_report_db_25000_20_150.sqlite[2/7] [==========49%               ] nsys_report_db_25000_20_150.sqlite[2/7] [===========50%              ] nsys_report_db_25000_20_150.sqlite[2/7] [===========51%              ] nsys_report_db_25000_20_150.sqlite[2/7] [===========52%              ] nsys_report_db_25000_20_150.sqlite[2/7] [===========53%              ] nsys_report_db_25000_20_150.sqlite[2/7] [============54%             ] nsys_report_db_25000_20_150.sqlite[2/7] [============55%             ] nsys_report_db_25000_20_150.sqlite[2/7] [============56%             ] nsys_report_db_25000_20_150.sqlite[2/7] [============57%             ] nsys_report_db_25000_20_150.sqlite[2/7] [=============58%            ] nsys_report_db_25000_20_150.sqlite[2/7] [=============59%            ] nsys_report_db_25000_20_150.sqlite[2/7] [=============60%            ] nsys_report_db_25000_20_150.sqlite[2/7] [==============61%           ] nsys_report_db_25000_20_150.sqlite[2/7] [==============62%           ] nsys_report_db_25000_20_150.sqlite[2/7] [==============63%           ] nsys_report_db_25000_20_150.sqlite[2/7] [==============64%           ] nsys_report_db_25000_20_150.sqlite[2/7] [===============65%          ] nsys_report_db_25000_20_150.sqlite[2/7] [===============66%          ] nsys_report_db_25000_20_150.sqlite[2/7] [===============67%          ] nsys_report_db_25000_20_150.sqlite[2/7] [================68%         ] nsys_report_db_25000_20_150.sqlite[2/7] [================69%         ] nsys_report_db_25000_20_150.sqlite[2/7] [================70%         ] nsys_report_db_25000_20_150.sqlite[2/7] [================71%         ] nsys_report_db_25000_20_150.sqlite[2/7] [=================72%        ] nsys_report_db_25000_20_150.sqlite[2/7] [=================73%        ] nsys_report_db_25000_20_150.sqlite[2/7] [=================74%        ] nsys_report_db_25000_20_150.sqlite[2/7] [==================75%       ] nsys_report_db_25000_20_150.sqlite[2/7] [==================76%       ] nsys_report_db_25000_20_150.sqlite[2/7] [==================77%       ] nsys_report_db_25000_20_150.sqlite[2/7] [==================78%       ] nsys_report_db_25000_20_150.sqlite[2/7] [===================79%      ] nsys_report_db_25000_20_150.sqlite[2/7] [===================80%      ] nsys_report_db_25000_20_150.sqlite[2/7] [===================81%      ] nsys_report_db_25000_20_150.sqlite[2/7] [===================82%      ] nsys_report_db_25000_20_150.sqlite[2/7] [====================83%     ] nsys_report_db_25000_20_150.sqlite[2/7] [====================84%     ] nsys_report_db_25000_20_150.sqlite[2/7] [====================85%     ] nsys_report_db_25000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_db_25000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_db_25000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_db_25000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_db_25000_20_150.sqlite[2/7] [======================90%   ] nsys_report_db_25000_20_150.sqlite[2/7] [======================91%   ] nsys_report_db_25000_20_150.sqlite[2/7] [======================92%   ] nsys_report_db_25000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_db_25000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_db_25000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_db_25000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_db_25000_20_150.sqlite[2/7] [========================97% ] nsys_report_db_25000_20_150.sqlite[2/7] [========================98% ] nsys_report_db_25000_20_150.sqlite[2/7] [========================99% ] nsys_report_db_25000_20_150.sqlite[2/7] [========================100%] nsys_report_db_25000_20_150.sqlite[2/7] [========================100%] nsys_report_db_25000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        272595424          1  272595424.0  272595424.0  272595424  272595424          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        150535833          1  150535833.0  150535833.0  150535833  150535833          0.0  cudaFree                      
      1.1          1687321          6     281220.2     216272.5       3730     825211     302423.6  cudaMalloc                    
      0.2           291912        814        358.6        320.0        120       1180        181.3  cuGetProcAddress_v2           
      0.0            33601          2      16800.5      16800.5       2150      31451      20718.9  cudaStreamCreateWithFlags     
      0.0            25571         18       1420.6        545.0        410      14601       3303.3  cudaEventCreateWithFlags      
      0.0             4580          3       1526.7       1630.0        600       2350        879.6  cuInit                        
      0.0             3430          3       1143.3        270.0        180       2980       1591.2  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        330        550        155.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_25000_20_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 25000, buff_size = 20 (num_steps = 150), identity_test = 0
Generating '/tmp/nsys-report-28ff.qdstrm'
[1/7] [0%                          ] nsys_report_fo_25000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_25000_20_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_25000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_fo_25000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_fo_25000_20_150.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_150.nsys-rep[1/7] [========================100%] nsys_report_fo_25000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [1%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [2%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [3%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [4%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [5%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [6%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [7%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [8%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [9%                          ] nsys_report_fo_25000_20_150.sqlite[2/7] [10%                         ] nsys_report_fo_25000_20_150.sqlite[2/7] [11%                         ] nsys_report_fo_25000_20_150.sqlite[2/7] [12%                         ] nsys_report_fo_25000_20_150.sqlite[2/7] [13%                         ] nsys_report_fo_25000_20_150.sqlite[2/7] [14%                         ] nsys_report_fo_25000_20_150.sqlite[2/7] [=15%                        ] nsys_report_fo_25000_20_150.sqlite[2/7] [=16%                        ] nsys_report_fo_25000_20_150.sqlite[2/7] [=17%                        ] nsys_report_fo_25000_20_150.sqlite[2/7] [==18%                       ] nsys_report_fo_25000_20_150.sqlite[2/7] [==19%                       ] nsys_report_fo_25000_20_150.sqlite[2/7] [==20%                       ] nsys_report_fo_25000_20_150.sqlite[2/7] [==21%                       ] nsys_report_fo_25000_20_150.sqlite[2/7] [===22%                      ] nsys_report_fo_25000_20_150.sqlite[2/7] [===23%                      ] nsys_report_fo_25000_20_150.sqlite[2/7] [===24%                      ] nsys_report_fo_25000_20_150.sqlite[2/7] [====25%                     ] nsys_report_fo_25000_20_150.sqlite[2/7] [====26%                     ] nsys_report_fo_25000_20_150.sqlite[2/7] [====27%                     ] nsys_report_fo_25000_20_150.sqlite[2/7] [====28%                     ] nsys_report_fo_25000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_25000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_25000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_25000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_25000_20_150.sqlite[2/7] [======33%                   ] nsys_report_fo_25000_20_150.sqlite[2/7] [======34%                   ] nsys_report_fo_25000_20_150.sqlite[2/7] [======35%                   ] nsys_report_fo_25000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_25000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_25000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_25000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_25000_20_150.sqlite[2/7] [========40%                 ] nsys_report_fo_25000_20_150.sqlite[2/7] [========41%                 ] nsys_report_fo_25000_20_150.sqlite[2/7] [========42%                 ] nsys_report_fo_25000_20_150.sqlite[2/7] [=========43%                ] nsys_report_fo_25000_20_150.sqlite[2/7] [=========44%                ] nsys_report_fo_25000_20_150.sqlite[2/7] [=========45%                ] nsys_report_fo_25000_20_150.sqlite[2/7] [=========46%                ] nsys_report_fo_25000_20_150.sqlite[2/7] [==========47%               ] nsys_report_fo_25000_20_150.sqlite[2/7] [==========48%               ] nsys_report_fo_25000_20_150.sqlite[2/7] [==========49%               ] nsys_report_fo_25000_20_150.sqlite[2/7] [===========50%              ] nsys_report_fo_25000_20_150.sqlite[2/7] [===========51%              ] nsys_report_fo_25000_20_150.sqlite[2/7] [===========52%              ] nsys_report_fo_25000_20_150.sqlite[2/7] [===========53%              ] nsys_report_fo_25000_20_150.sqlite[2/7] [============54%             ] nsys_report_fo_25000_20_150.sqlite[2/7] [============55%             ] nsys_report_fo_25000_20_150.sqlite[2/7] [============56%             ] nsys_report_fo_25000_20_150.sqlite[2/7] [============57%             ] nsys_report_fo_25000_20_150.sqlite[2/7] [=============58%            ] nsys_report_fo_25000_20_150.sqlite[2/7] [=============59%            ] nsys_report_fo_25000_20_150.sqlite[2/7] [=============60%            ] nsys_report_fo_25000_20_150.sqlite[2/7] [==============61%           ] nsys_report_fo_25000_20_150.sqlite[2/7] [==============62%           ] nsys_report_fo_25000_20_150.sqlite[2/7] [==============63%           ] nsys_report_fo_25000_20_150.sqlite[2/7] [==============64%           ] nsys_report_fo_25000_20_150.sqlite[2/7] [===============65%          ] nsys_report_fo_25000_20_150.sqlite[2/7] [===============66%          ] nsys_report_fo_25000_20_150.sqlite[2/7] [===============67%          ] nsys_report_fo_25000_20_150.sqlite[2/7] [================68%         ] nsys_report_fo_25000_20_150.sqlite[2/7] [================69%         ] nsys_report_fo_25000_20_150.sqlite[2/7] [================70%         ] nsys_report_fo_25000_20_150.sqlite[2/7] [================71%         ] nsys_report_fo_25000_20_150.sqlite[2/7] [=================72%        ] nsys_report_fo_25000_20_150.sqlite[2/7] [=================73%        ] nsys_report_fo_25000_20_150.sqlite[2/7] [=================74%        ] nsys_report_fo_25000_20_150.sqlite[2/7] [==================75%       ] nsys_report_fo_25000_20_150.sqlite[2/7] [==================76%       ] nsys_report_fo_25000_20_150.sqlite[2/7] [==================77%       ] nsys_report_fo_25000_20_150.sqlite[2/7] [==================78%       ] nsys_report_fo_25000_20_150.sqlite[2/7] [===================79%      ] nsys_report_fo_25000_20_150.sqlite[2/7] [===================80%      ] nsys_report_fo_25000_20_150.sqlite[2/7] [===================81%      ] nsys_report_fo_25000_20_150.sqlite[2/7] [===================82%      ] nsys_report_fo_25000_20_150.sqlite[2/7] [====================83%     ] nsys_report_fo_25000_20_150.sqlite[2/7] [====================84%     ] nsys_report_fo_25000_20_150.sqlite[2/7] [====================85%     ] nsys_report_fo_25000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_25000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_25000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_25000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_25000_20_150.sqlite[2/7] [======================90%   ] nsys_report_fo_25000_20_150.sqlite[2/7] [======================91%   ] nsys_report_fo_25000_20_150.sqlite[2/7] [======================92%   ] nsys_report_fo_25000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_25000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_25000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_25000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_25000_20_150.sqlite[2/7] [========================97% ] nsys_report_fo_25000_20_150.sqlite[2/7] [========================98% ] nsys_report_fo_25000_20_150.sqlite[2/7] [========================99% ] nsys_report_fo_25000_20_150.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_150.sqlite[2/7] [========================100%] nsys_report_fo_25000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        279684755          1  279684755.0  279684755.0  279684755  279684755          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        159566558          1  159566558.0  159566558.0  159566558  159566558          0.0  cudaFree                      
      1.8          2930187         12     244182.3     314194.0       3740     381985     126607.1  cudaMalloc                    
      0.2           266753        814        327.7        280.0        120       1200        167.7  cuGetProcAddress_v2           
      0.0            37691          2      18845.5      18845.5       1700      35991      24247.4  cudaStreamCreateWithFlags     
      0.0            22720         18       1262.2        455.0        400      12300       2784.5  cudaEventCreateWithFlags      
      0.0             4610          3       1536.7       1740.0        570       2300        882.7  cuInit                        
      0.0             3340          3       1113.3        380.0        170       2790       1455.8  cuModuleGetLoadingMode        
      0.0              990          2        495.0        495.0        410        580        120.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_25000_20_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 5 (num_steps = 20)
number of batches= 4
Generating '/tmp/nsys-report-8a67.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_5_20.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_5_20.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_5_20.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_5_20.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_20.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [1%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [2%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [3%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [4%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [5%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [6%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [7%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [8%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [9%                          ] nsys_report_ia_30000_5_20.sqlite[2/7] [10%                         ] nsys_report_ia_30000_5_20.sqlite[2/7] [11%                         ] nsys_report_ia_30000_5_20.sqlite[2/7] [12%                         ] nsys_report_ia_30000_5_20.sqlite[2/7] [13%                         ] nsys_report_ia_30000_5_20.sqlite[2/7] [14%                         ] nsys_report_ia_30000_5_20.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_5_20.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_5_20.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_5_20.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_5_20.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_5_20.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_5_20.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_5_20.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_5_20.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_5_20.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_5_20.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_5_20.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_5_20.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_5_20.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_5_20.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_5_20.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_5_20.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_5_20.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_5_20.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_5_20.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_5_20.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_5_20.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_5_20.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_5_20.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_5_20.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_5_20.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_5_20.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_5_20.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_5_20.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_5_20.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_5_20.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_5_20.sqlite[2/7] [============54%             ] nsys_report_ia_30000_5_20.sqlite[2/7] [============55%             ] nsys_report_ia_30000_5_20.sqlite[2/7] [============56%             ] nsys_report_ia_30000_5_20.sqlite[2/7] [============57%             ] nsys_report_ia_30000_5_20.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_5_20.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_5_20.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_5_20.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_5_20.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_5_20.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_5_20.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_5_20.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_5_20.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_5_20.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_5_20.sqlite[2/7] [================68%         ] nsys_report_ia_30000_5_20.sqlite[2/7] [================69%         ] nsys_report_ia_30000_5_20.sqlite[2/7] [================70%         ] nsys_report_ia_30000_5_20.sqlite[2/7] [================71%         ] nsys_report_ia_30000_5_20.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_5_20.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_5_20.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_5_20.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_5_20.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_5_20.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_5_20.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_5_20.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_5_20.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_5_20.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_5_20.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_5_20.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_5_20.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_5_20.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_5_20.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_5_20.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_5_20.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_5_20.sqlite[2/7] [========================97% ] nsys_report_ia_30000_5_20.sqlite[2/7] [========================98% ] nsys_report_ia_30000_5_20.sqlite[2/7] [========================99% ] nsys_report_ia_30000_5_20.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_20.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245634290          1  245634290.0  245634290.0  245634290  245634290          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        129000329          1  129000329.0  129000329.0  129000329  129000329          0.0  cudaFree                      
      1.3          1742182          6     290363.7     254933.0       4140     699109     274327.8  cudaMalloc                    
      0.2           274873        814        337.7        300.0        120       1400        172.3  cuGetProcAddress_v2           
      0.0            33850          2      16925.0      16925.0       2330      31520      20640.4  cudaStreamCreateWithFlags     
      0.0            24370         18       1353.9        525.0        390      13190       2978.6  cudaEventCreateWithFlags      
      0.0             5660          3       1886.7       1760.0        960       2940        996.1  cuInit                        
      0.0             3440          3       1146.7        260.0        170       3010       1614.3  cuModuleGetLoadingMode        
      0.0             1040          2        520.0        520.0        330        710        268.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 5 (num_steps = 20)
number of batches= 4
Generating '/tmp/nsys-report-dac3.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_5_20.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_5_20.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_5_20.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_5_20.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_20.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [1%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [2%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [3%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [4%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [5%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [6%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [7%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [8%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [9%                          ] nsys_report_db_30000_5_20.sqlite[2/7] [10%                         ] nsys_report_db_30000_5_20.sqlite[2/7] [11%                         ] nsys_report_db_30000_5_20.sqlite[2/7] [12%                         ] nsys_report_db_30000_5_20.sqlite[2/7] [13%                         ] nsys_report_db_30000_5_20.sqlite[2/7] [14%                         ] nsys_report_db_30000_5_20.sqlite[2/7] [=15%                        ] nsys_report_db_30000_5_20.sqlite[2/7] [=16%                        ] nsys_report_db_30000_5_20.sqlite[2/7] [=17%                        ] nsys_report_db_30000_5_20.sqlite[2/7] [==18%                       ] nsys_report_db_30000_5_20.sqlite[2/7] [==19%                       ] nsys_report_db_30000_5_20.sqlite[2/7] [==20%                       ] nsys_report_db_30000_5_20.sqlite[2/7] [==21%                       ] nsys_report_db_30000_5_20.sqlite[2/7] [===22%                      ] nsys_report_db_30000_5_20.sqlite[2/7] [===23%                      ] nsys_report_db_30000_5_20.sqlite[2/7] [===24%                      ] nsys_report_db_30000_5_20.sqlite[2/7] [====25%                     ] nsys_report_db_30000_5_20.sqlite[2/7] [====26%                     ] nsys_report_db_30000_5_20.sqlite[2/7] [====27%                     ] nsys_report_db_30000_5_20.sqlite[2/7] [====28%                     ] nsys_report_db_30000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_5_20.sqlite[2/7] [======33%                   ] nsys_report_db_30000_5_20.sqlite[2/7] [======34%                   ] nsys_report_db_30000_5_20.sqlite[2/7] [======35%                   ] nsys_report_db_30000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_5_20.sqlite[2/7] [========40%                 ] nsys_report_db_30000_5_20.sqlite[2/7] [========41%                 ] nsys_report_db_30000_5_20.sqlite[2/7] [========42%                 ] nsys_report_db_30000_5_20.sqlite[2/7] [=========43%                ] nsys_report_db_30000_5_20.sqlite[2/7] [=========44%                ] nsys_report_db_30000_5_20.sqlite[2/7] [=========45%                ] nsys_report_db_30000_5_20.sqlite[2/7] [=========46%                ] nsys_report_db_30000_5_20.sqlite[2/7] [==========47%               ] nsys_report_db_30000_5_20.sqlite[2/7] [==========48%               ] nsys_report_db_30000_5_20.sqlite[2/7] [==========49%               ] nsys_report_db_30000_5_20.sqlite[2/7] [===========50%              ] nsys_report_db_30000_5_20.sqlite[2/7] [===========51%              ] nsys_report_db_30000_5_20.sqlite[2/7] [===========52%              ] nsys_report_db_30000_5_20.sqlite[2/7] [===========53%              ] nsys_report_db_30000_5_20.sqlite[2/7] [============54%             ] nsys_report_db_30000_5_20.sqlite[2/7] [============55%             ] nsys_report_db_30000_5_20.sqlite[2/7] [============56%             ] nsys_report_db_30000_5_20.sqlite[2/7] [============57%             ] nsys_report_db_30000_5_20.sqlite[2/7] [=============58%            ] nsys_report_db_30000_5_20.sqlite[2/7] [=============59%            ] nsys_report_db_30000_5_20.sqlite[2/7] [=============60%            ] nsys_report_db_30000_5_20.sqlite[2/7] [==============61%           ] nsys_report_db_30000_5_20.sqlite[2/7] [==============62%           ] nsys_report_db_30000_5_20.sqlite[2/7] [==============63%           ] nsys_report_db_30000_5_20.sqlite[2/7] [==============64%           ] nsys_report_db_30000_5_20.sqlite[2/7] [===============65%          ] nsys_report_db_30000_5_20.sqlite[2/7] [===============66%          ] nsys_report_db_30000_5_20.sqlite[2/7] [===============67%          ] nsys_report_db_30000_5_20.sqlite[2/7] [================68%         ] nsys_report_db_30000_5_20.sqlite[2/7] [================69%         ] nsys_report_db_30000_5_20.sqlite[2/7] [================70%         ] nsys_report_db_30000_5_20.sqlite[2/7] [================71%         ] nsys_report_db_30000_5_20.sqlite[2/7] [=================72%        ] nsys_report_db_30000_5_20.sqlite[2/7] [=================73%        ] nsys_report_db_30000_5_20.sqlite[2/7] [=================74%        ] nsys_report_db_30000_5_20.sqlite[2/7] [==================75%       ] nsys_report_db_30000_5_20.sqlite[2/7] [==================76%       ] nsys_report_db_30000_5_20.sqlite[2/7] [==================77%       ] nsys_report_db_30000_5_20.sqlite[2/7] [==================78%       ] nsys_report_db_30000_5_20.sqlite[2/7] [===================79%      ] nsys_report_db_30000_5_20.sqlite[2/7] [===================80%      ] nsys_report_db_30000_5_20.sqlite[2/7] [===================81%      ] nsys_report_db_30000_5_20.sqlite[2/7] [===================82%      ] nsys_report_db_30000_5_20.sqlite[2/7] [====================83%     ] nsys_report_db_30000_5_20.sqlite[2/7] [====================84%     ] nsys_report_db_30000_5_20.sqlite[2/7] [====================85%     ] nsys_report_db_30000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_5_20.sqlite[2/7] [======================90%   ] nsys_report_db_30000_5_20.sqlite[2/7] [======================91%   ] nsys_report_db_30000_5_20.sqlite[2/7] [======================92%   ] nsys_report_db_30000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_5_20.sqlite[2/7] [========================97% ] nsys_report_db_30000_5_20.sqlite[2/7] [========================98% ] nsys_report_db_30000_5_20.sqlite[2/7] [========================99% ] nsys_report_db_30000_5_20.sqlite[2/7] [========================100%] nsys_report_db_30000_5_20.sqlite[2/7] [========================100%] nsys_report_db_30000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        243158457          1  243158457.0  243158457.0  243158457  243158457          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        127926155          1  127926155.0  127926155.0  127926155  127926155          0.0  cudaFree                      
      1.3          1720662          6     286777.0     252598.0       3890     689839     270035.7  cudaMalloc                    
      0.2           274861        814        337.7        290.0        120       1250        170.6  cuGetProcAddress_v2           
      0.0            33950          2      16975.0      16975.0       2070      31880      21078.9  cudaStreamCreateWithFlags     
      0.0            23530         18       1307.2        515.0        410      12840       2903.0  cudaEventCreateWithFlags      
      0.0             4240          3       1413.3       1400.0        610       2230        810.1  cuInit                        
      0.0             3810          3       1270.0        560.0        280       2970       1478.9  cuModuleGetLoadingMode        
      0.0              900          2        450.0        450.0        310        590        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 5 (num_steps = 20), identity_test = 0
Generating '/tmp/nsys-report-f524.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_5_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_5_20.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_5_20.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_5_20.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_5_20.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_20.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [1%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [2%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [3%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [4%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [5%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [6%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [7%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [8%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [9%                          ] nsys_report_fo_30000_5_20.sqlite[2/7] [10%                         ] nsys_report_fo_30000_5_20.sqlite[2/7] [11%                         ] nsys_report_fo_30000_5_20.sqlite[2/7] [12%                         ] nsys_report_fo_30000_5_20.sqlite[2/7] [13%                         ] nsys_report_fo_30000_5_20.sqlite[2/7] [14%                         ] nsys_report_fo_30000_5_20.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_5_20.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_5_20.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_5_20.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_5_20.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_5_20.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_5_20.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_5_20.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_5_20.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_5_20.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_5_20.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_5_20.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_5_20.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_5_20.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_5_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_5_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_5_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_5_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_5_20.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_5_20.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_5_20.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_5_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_5_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_5_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_5_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_5_20.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_5_20.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_5_20.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_5_20.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_5_20.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_5_20.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_5_20.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_5_20.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_5_20.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_5_20.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_5_20.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_5_20.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_5_20.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_5_20.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_5_20.sqlite[2/7] [============54%             ] nsys_report_fo_30000_5_20.sqlite[2/7] [============55%             ] nsys_report_fo_30000_5_20.sqlite[2/7] [============56%             ] nsys_report_fo_30000_5_20.sqlite[2/7] [============57%             ] nsys_report_fo_30000_5_20.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_5_20.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_5_20.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_5_20.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_5_20.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_5_20.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_5_20.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_5_20.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_5_20.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_5_20.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_5_20.sqlite[2/7] [================68%         ] nsys_report_fo_30000_5_20.sqlite[2/7] [================69%         ] nsys_report_fo_30000_5_20.sqlite[2/7] [================70%         ] nsys_report_fo_30000_5_20.sqlite[2/7] [================71%         ] nsys_report_fo_30000_5_20.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_5_20.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_5_20.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_5_20.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_5_20.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_5_20.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_5_20.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_5_20.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_5_20.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_5_20.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_5_20.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_5_20.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_5_20.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_5_20.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_5_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_5_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_5_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_5_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_5_20.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_5_20.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_5_20.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_5_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_5_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_5_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_5_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_5_20.sqlite[2/7] [========================97% ] nsys_report_fo_30000_5_20.sqlite[2/7] [========================98% ] nsys_report_fo_30000_5_20.sqlite[2/7] [========================99% ] nsys_report_fo_30000_5_20.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_20.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245599647          1  245599647.0  245599647.0  245599647  245599647          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        140241040          1  140241040.0  140241040.0  140241040  140241040          0.0  cudaFree                      
      1.8          2513952          9     279328.0     402556.0       3820     456096     178480.5  cudaMalloc                    
      0.2           280503        814        344.6        290.0        120       1520        195.9  cuGetProcAddress_v2           
      0.0            37580          2      18790.0      18790.0       1680      35900      24197.2  cudaStreamCreateWithFlags     
      0.0            26160         18       1453.3        480.0        390      15300       3482.9  cudaEventCreateWithFlags      
      0.0             4510          3       1503.3       1240.0        630       2640       1030.6  cuInit                        
      0.0             3100          3       1033.3        270.0        170       2660       1409.6  cuModuleGetLoadingMode        
      0.0              970          2        485.0        485.0        360        610        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 5 (num_steps = 40)
number of batches= 8
Generating '/tmp/nsys-report-89f8.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_5_40.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_5_40.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_5_40.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_5_40.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_40.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [1%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [2%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [3%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [4%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [5%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [6%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [7%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [8%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [9%                          ] nsys_report_ia_30000_5_40.sqlite[2/7] [10%                         ] nsys_report_ia_30000_5_40.sqlite[2/7] [11%                         ] nsys_report_ia_30000_5_40.sqlite[2/7] [12%                         ] nsys_report_ia_30000_5_40.sqlite[2/7] [13%                         ] nsys_report_ia_30000_5_40.sqlite[2/7] [14%                         ] nsys_report_ia_30000_5_40.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_5_40.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_5_40.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_5_40.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_5_40.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_5_40.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_5_40.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_5_40.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_5_40.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_5_40.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_5_40.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_5_40.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_5_40.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_5_40.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_5_40.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_5_40.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_5_40.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_5_40.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_5_40.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_5_40.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_5_40.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_5_40.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_5_40.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_5_40.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_5_40.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_5_40.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_5_40.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_5_40.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_5_40.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_5_40.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_5_40.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_5_40.sqlite[2/7] [============54%             ] nsys_report_ia_30000_5_40.sqlite[2/7] [============55%             ] nsys_report_ia_30000_5_40.sqlite[2/7] [============56%             ] nsys_report_ia_30000_5_40.sqlite[2/7] [============57%             ] nsys_report_ia_30000_5_40.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_5_40.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_5_40.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_5_40.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_5_40.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_5_40.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_5_40.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_5_40.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_5_40.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_5_40.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_5_40.sqlite[2/7] [================68%         ] nsys_report_ia_30000_5_40.sqlite[2/7] [================69%         ] nsys_report_ia_30000_5_40.sqlite[2/7] [================70%         ] nsys_report_ia_30000_5_40.sqlite[2/7] [================71%         ] nsys_report_ia_30000_5_40.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_5_40.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_5_40.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_5_40.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_5_40.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_5_40.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_5_40.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_5_40.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_5_40.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_5_40.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_5_40.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_5_40.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_5_40.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_5_40.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_5_40.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_5_40.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_5_40.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_5_40.sqlite[2/7] [========================97% ] nsys_report_ia_30000_5_40.sqlite[2/7] [========================98% ] nsys_report_ia_30000_5_40.sqlite[2/7] [========================99% ] nsys_report_ia_30000_5_40.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_40.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        250869073          1  250869073.0  250869073.0  250869073  250869073          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        134882011          1  134882011.0  134882011.0  134882011  134882011          0.0  cudaFree                      
      1.3          1750112          6     291685.3     251663.0       3600     709209     276603.5  cudaMalloc                    
      0.2           265172        814        325.8        290.0        120       1190        161.0  cuGetProcAddress_v2           
      0.0            41770          2      20885.0      20885.0       1830      39940      26947.8  cudaStreamCreateWithFlags     
      0.0            26330         18       1462.8        495.0        390      16010       3647.8  cudaEventCreateWithFlags      
      0.0             4470          3       1490.0       1450.0        760       2260        750.8  cuInit                        
      0.0             3480          3       1160.0        270.0        150       3060       1646.5  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        300        650        247.5  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 5 (num_steps = 40)
number of batches= 8
Generating '/tmp/nsys-report-dfe0.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_5_40.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_5_40.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_5_40.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_5_40.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_40.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [1%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [2%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [3%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [4%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [5%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [6%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [7%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [8%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [9%                          ] nsys_report_db_30000_5_40.sqlite[2/7] [10%                         ] nsys_report_db_30000_5_40.sqlite[2/7] [11%                         ] nsys_report_db_30000_5_40.sqlite[2/7] [12%                         ] nsys_report_db_30000_5_40.sqlite[2/7] [13%                         ] nsys_report_db_30000_5_40.sqlite[2/7] [14%                         ] nsys_report_db_30000_5_40.sqlite[2/7] [=15%                        ] nsys_report_db_30000_5_40.sqlite[2/7] [=16%                        ] nsys_report_db_30000_5_40.sqlite[2/7] [=17%                        ] nsys_report_db_30000_5_40.sqlite[2/7] [==18%                       ] nsys_report_db_30000_5_40.sqlite[2/7] [==19%                       ] nsys_report_db_30000_5_40.sqlite[2/7] [==20%                       ] nsys_report_db_30000_5_40.sqlite[2/7] [==21%                       ] nsys_report_db_30000_5_40.sqlite[2/7] [===22%                      ] nsys_report_db_30000_5_40.sqlite[2/7] [===23%                      ] nsys_report_db_30000_5_40.sqlite[2/7] [===24%                      ] nsys_report_db_30000_5_40.sqlite[2/7] [====25%                     ] nsys_report_db_30000_5_40.sqlite[2/7] [====26%                     ] nsys_report_db_30000_5_40.sqlite[2/7] [====27%                     ] nsys_report_db_30000_5_40.sqlite[2/7] [====28%                     ] nsys_report_db_30000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_5_40.sqlite[2/7] [======33%                   ] nsys_report_db_30000_5_40.sqlite[2/7] [======34%                   ] nsys_report_db_30000_5_40.sqlite[2/7] [======35%                   ] nsys_report_db_30000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_5_40.sqlite[2/7] [========40%                 ] nsys_report_db_30000_5_40.sqlite[2/7] [========41%                 ] nsys_report_db_30000_5_40.sqlite[2/7] [========42%                 ] nsys_report_db_30000_5_40.sqlite[2/7] [=========43%                ] nsys_report_db_30000_5_40.sqlite[2/7] [=========44%                ] nsys_report_db_30000_5_40.sqlite[2/7] [=========45%                ] nsys_report_db_30000_5_40.sqlite[2/7] [=========46%                ] nsys_report_db_30000_5_40.sqlite[2/7] [==========47%               ] nsys_report_db_30000_5_40.sqlite[2/7] [==========48%               ] nsys_report_db_30000_5_40.sqlite[2/7] [==========49%               ] nsys_report_db_30000_5_40.sqlite[2/7] [===========50%              ] nsys_report_db_30000_5_40.sqlite[2/7] [===========51%              ] nsys_report_db_30000_5_40.sqlite[2/7] [===========52%              ] nsys_report_db_30000_5_40.sqlite[2/7] [===========53%              ] nsys_report_db_30000_5_40.sqlite[2/7] [============54%             ] nsys_report_db_30000_5_40.sqlite[2/7] [============55%             ] nsys_report_db_30000_5_40.sqlite[2/7] [============56%             ] nsys_report_db_30000_5_40.sqlite[2/7] [============57%             ] nsys_report_db_30000_5_40.sqlite[2/7] [=============58%            ] nsys_report_db_30000_5_40.sqlite[2/7] [=============59%            ] nsys_report_db_30000_5_40.sqlite[2/7] [=============60%            ] nsys_report_db_30000_5_40.sqlite[2/7] [==============61%           ] nsys_report_db_30000_5_40.sqlite[2/7] [==============62%           ] nsys_report_db_30000_5_40.sqlite[2/7] [==============63%           ] nsys_report_db_30000_5_40.sqlite[2/7] [==============64%           ] nsys_report_db_30000_5_40.sqlite[2/7] [===============65%          ] nsys_report_db_30000_5_40.sqlite[2/7] [===============66%          ] nsys_report_db_30000_5_40.sqlite[2/7] [===============67%          ] nsys_report_db_30000_5_40.sqlite[2/7] [================68%         ] nsys_report_db_30000_5_40.sqlite[2/7] [================69%         ] nsys_report_db_30000_5_40.sqlite[2/7] [================70%         ] nsys_report_db_30000_5_40.sqlite[2/7] [================71%         ] nsys_report_db_30000_5_40.sqlite[2/7] [=================72%        ] nsys_report_db_30000_5_40.sqlite[2/7] [=================73%        ] nsys_report_db_30000_5_40.sqlite[2/7] [=================74%        ] nsys_report_db_30000_5_40.sqlite[2/7] [==================75%       ] nsys_report_db_30000_5_40.sqlite[2/7] [==================76%       ] nsys_report_db_30000_5_40.sqlite[2/7] [==================77%       ] nsys_report_db_30000_5_40.sqlite[2/7] [==================78%       ] nsys_report_db_30000_5_40.sqlite[2/7] [===================79%      ] nsys_report_db_30000_5_40.sqlite[2/7] [===================80%      ] nsys_report_db_30000_5_40.sqlite[2/7] [===================81%      ] nsys_report_db_30000_5_40.sqlite[2/7] [===================82%      ] nsys_report_db_30000_5_40.sqlite[2/7] [====================83%     ] nsys_report_db_30000_5_40.sqlite[2/7] [====================84%     ] nsys_report_db_30000_5_40.sqlite[2/7] [====================85%     ] nsys_report_db_30000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_5_40.sqlite[2/7] [======================90%   ] nsys_report_db_30000_5_40.sqlite[2/7] [======================91%   ] nsys_report_db_30000_5_40.sqlite[2/7] [======================92%   ] nsys_report_db_30000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_5_40.sqlite[2/7] [========================97% ] nsys_report_db_30000_5_40.sqlite[2/7] [========================98% ] nsys_report_db_30000_5_40.sqlite[2/7] [========================99% ] nsys_report_db_30000_5_40.sqlite[2/7] [========================100%] nsys_report_db_30000_5_40.sqlite[2/7] [========================100%] nsys_report_db_30000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        277614424          1  277614424.0  277614424.0  277614424  277614424          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        154431911          1  154431911.0  154431911.0  154431911  154431911          0.0  cudaFree                      
      1.1          1777503          6     296250.5     261858.0       3711     698639     274502.6  cudaMalloc                    
      0.2           280624        814        344.7        300.0        120       1130        180.4  cuGetProcAddress_v2           
      0.0            33051          2      16525.5      16525.5       1910      31141      20669.4  cudaStreamCreateWithFlags     
      0.0            19560         18       1086.7        505.0        390       8480       1906.0  cudaEventCreateWithFlags      
      0.0             4670          3       1556.7       1590.0        840       2240        700.6  cuInit                        
      0.0             3820          3       1273.3        400.0        170       3250       1715.7  cuModuleGetLoadingMode        
      0.0              960          2        480.0        480.0        310        650        240.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 5 (num_steps = 40), identity_test = 0
Generating '/tmp/nsys-report-9aa8.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_5_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_5_40.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_5_40.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_5_40.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_5_40.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_40.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [1%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [2%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [3%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [4%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [5%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [6%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [7%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [8%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [9%                          ] nsys_report_fo_30000_5_40.sqlite[2/7] [10%                         ] nsys_report_fo_30000_5_40.sqlite[2/7] [11%                         ] nsys_report_fo_30000_5_40.sqlite[2/7] [12%                         ] nsys_report_fo_30000_5_40.sqlite[2/7] [13%                         ] nsys_report_fo_30000_5_40.sqlite[2/7] [14%                         ] nsys_report_fo_30000_5_40.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_5_40.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_5_40.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_5_40.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_5_40.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_5_40.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_5_40.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_5_40.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_5_40.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_5_40.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_5_40.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_5_40.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_5_40.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_5_40.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_5_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_5_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_5_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_5_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_5_40.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_5_40.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_5_40.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_5_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_5_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_5_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_5_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_5_40.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_5_40.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_5_40.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_5_40.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_5_40.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_5_40.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_5_40.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_5_40.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_5_40.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_5_40.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_5_40.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_5_40.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_5_40.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_5_40.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_5_40.sqlite[2/7] [============54%             ] nsys_report_fo_30000_5_40.sqlite[2/7] [============55%             ] nsys_report_fo_30000_5_40.sqlite[2/7] [============56%             ] nsys_report_fo_30000_5_40.sqlite[2/7] [============57%             ] nsys_report_fo_30000_5_40.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_5_40.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_5_40.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_5_40.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_5_40.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_5_40.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_5_40.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_5_40.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_5_40.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_5_40.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_5_40.sqlite[2/7] [================68%         ] nsys_report_fo_30000_5_40.sqlite[2/7] [================69%         ] nsys_report_fo_30000_5_40.sqlite[2/7] [================70%         ] nsys_report_fo_30000_5_40.sqlite[2/7] [================71%         ] nsys_report_fo_30000_5_40.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_5_40.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_5_40.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_5_40.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_5_40.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_5_40.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_5_40.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_5_40.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_5_40.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_5_40.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_5_40.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_5_40.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_5_40.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_5_40.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_5_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_5_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_5_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_5_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_5_40.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_5_40.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_5_40.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_5_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_5_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_5_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_5_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_5_40.sqlite[2/7] [========================97% ] nsys_report_fo_30000_5_40.sqlite[2/7] [========================98% ] nsys_report_fo_30000_5_40.sqlite[2/7] [========================99% ] nsys_report_fo_30000_5_40.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_40.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        251487337          1  251487337.0  251487337.0  251487337  251487337          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        145516154          1  145516154.0  145516154.0  145516154  145516154          0.0  cudaFree                      
      1.7          2515591          9     279510.1     407795.0       3740     466495     180208.0  cudaMalloc                    
      0.2           275214        814        338.1        290.0        120       1160        177.0  cuGetProcAddress_v2           
      0.0            34550          2      17275.0      17275.0       1890      32660      21757.7  cudaStreamCreateWithFlags     
      0.0            19381         18       1076.7        440.0        390       9200       2064.3  cudaEventCreateWithFlags      
      0.0             5170          3       1723.3       1770.0        600       2800       1100.7  cuInit                        
      0.0             3650          3       1216.7        400.0        270       2980       1528.5  cuModuleGetLoadingMode        
      0.0              830          2        415.0        415.0        290        540        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 5 (num_steps = 60)
number of batches= 12
Generating '/tmp/nsys-report-6bbb.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_5_60.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_5_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_5_60.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_60.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [1%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [2%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [3%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [4%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [5%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [6%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [7%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [8%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [9%                          ] nsys_report_ia_30000_5_60.sqlite[2/7] [10%                         ] nsys_report_ia_30000_5_60.sqlite[2/7] [11%                         ] nsys_report_ia_30000_5_60.sqlite[2/7] [12%                         ] nsys_report_ia_30000_5_60.sqlite[2/7] [13%                         ] nsys_report_ia_30000_5_60.sqlite[2/7] [14%                         ] nsys_report_ia_30000_5_60.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_5_60.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_5_60.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_5_60.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_5_60.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_5_60.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_5_60.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_5_60.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_5_60.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_5_60.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_5_60.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_5_60.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_5_60.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_5_60.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_5_60.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_5_60.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_5_60.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_5_60.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_5_60.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_5_60.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_5_60.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_5_60.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_5_60.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_5_60.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_5_60.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_5_60.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_5_60.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_5_60.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_5_60.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_5_60.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_5_60.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_5_60.sqlite[2/7] [============54%             ] nsys_report_ia_30000_5_60.sqlite[2/7] [============55%             ] nsys_report_ia_30000_5_60.sqlite[2/7] [============56%             ] nsys_report_ia_30000_5_60.sqlite[2/7] [============57%             ] nsys_report_ia_30000_5_60.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_5_60.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_5_60.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_5_60.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_5_60.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_5_60.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_5_60.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_5_60.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_5_60.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_5_60.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_5_60.sqlite[2/7] [================68%         ] nsys_report_ia_30000_5_60.sqlite[2/7] [================69%         ] nsys_report_ia_30000_5_60.sqlite[2/7] [================70%         ] nsys_report_ia_30000_5_60.sqlite[2/7] [================71%         ] nsys_report_ia_30000_5_60.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_5_60.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_5_60.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_5_60.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_5_60.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_5_60.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_5_60.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_5_60.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_5_60.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_5_60.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_5_60.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_5_60.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_5_60.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_5_60.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_5_60.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_5_60.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_5_60.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_5_60.sqlite[2/7] [========================97% ] nsys_report_ia_30000_5_60.sqlite[2/7] [========================98% ] nsys_report_ia_30000_5_60.sqlite[2/7] [========================99% ] nsys_report_ia_30000_5_60.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_60.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        246701453          1  246701453.0  246701453.0  246701453  246701453          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        130361331          1  130361331.0  130361331.0  130361331  130361331          0.0  cudaFree                      
      1.3          1758713          6     293118.8     261353.5       3750     701279     274967.9  cudaMalloc                    
      0.2           288123        814        354.0        300.0        120       1240        187.2  cuGetProcAddress_v2           
      0.0            32851          2      16425.5      16425.5       1940      30911      20485.6  cudaStreamCreateWithFlags     
      0.0            29960         18       1664.4        510.0        400      19710       4516.8  cudaEventCreateWithFlags      
      0.0             5130          3       1710.0       1550.0        610       2970       1188.1  cuInit                        
      0.0             3930          3       1310.0        400.0        380       3150       1593.5  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        320        610        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 5 (num_steps = 60)
number of batches= 12
Generating '/tmp/nsys-report-1ac4.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_5_60.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_5_60.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_5_60.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_60.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [1%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [2%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [3%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [4%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [5%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [6%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [7%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [8%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [9%                          ] nsys_report_db_30000_5_60.sqlite[2/7] [10%                         ] nsys_report_db_30000_5_60.sqlite[2/7] [11%                         ] nsys_report_db_30000_5_60.sqlite[2/7] [12%                         ] nsys_report_db_30000_5_60.sqlite[2/7] [13%                         ] nsys_report_db_30000_5_60.sqlite[2/7] [14%                         ] nsys_report_db_30000_5_60.sqlite[2/7] [=15%                        ] nsys_report_db_30000_5_60.sqlite[2/7] [=16%                        ] nsys_report_db_30000_5_60.sqlite[2/7] [=17%                        ] nsys_report_db_30000_5_60.sqlite[2/7] [==18%                       ] nsys_report_db_30000_5_60.sqlite[2/7] [==19%                       ] nsys_report_db_30000_5_60.sqlite[2/7] [==20%                       ] nsys_report_db_30000_5_60.sqlite[2/7] [==21%                       ] nsys_report_db_30000_5_60.sqlite[2/7] [===22%                      ] nsys_report_db_30000_5_60.sqlite[2/7] [===23%                      ] nsys_report_db_30000_5_60.sqlite[2/7] [===24%                      ] nsys_report_db_30000_5_60.sqlite[2/7] [====25%                     ] nsys_report_db_30000_5_60.sqlite[2/7] [====26%                     ] nsys_report_db_30000_5_60.sqlite[2/7] [====27%                     ] nsys_report_db_30000_5_60.sqlite[2/7] [====28%                     ] nsys_report_db_30000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_5_60.sqlite[2/7] [======33%                   ] nsys_report_db_30000_5_60.sqlite[2/7] [======34%                   ] nsys_report_db_30000_5_60.sqlite[2/7] [======35%                   ] nsys_report_db_30000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_5_60.sqlite[2/7] [========40%                 ] nsys_report_db_30000_5_60.sqlite[2/7] [========41%                 ] nsys_report_db_30000_5_60.sqlite[2/7] [========42%                 ] nsys_report_db_30000_5_60.sqlite[2/7] [=========43%                ] nsys_report_db_30000_5_60.sqlite[2/7] [=========44%                ] nsys_report_db_30000_5_60.sqlite[2/7] [=========45%                ] nsys_report_db_30000_5_60.sqlite[2/7] [=========46%                ] nsys_report_db_30000_5_60.sqlite[2/7] [==========47%               ] nsys_report_db_30000_5_60.sqlite[2/7] [==========48%               ] nsys_report_db_30000_5_60.sqlite[2/7] [==========49%               ] nsys_report_db_30000_5_60.sqlite[2/7] [===========50%              ] nsys_report_db_30000_5_60.sqlite[2/7] [===========51%              ] nsys_report_db_30000_5_60.sqlite[2/7] [===========52%              ] nsys_report_db_30000_5_60.sqlite[2/7] [===========53%              ] nsys_report_db_30000_5_60.sqlite[2/7] [============54%             ] nsys_report_db_30000_5_60.sqlite[2/7] [============55%             ] nsys_report_db_30000_5_60.sqlite[2/7] [============56%             ] nsys_report_db_30000_5_60.sqlite[2/7] [============57%             ] nsys_report_db_30000_5_60.sqlite[2/7] [=============58%            ] nsys_report_db_30000_5_60.sqlite[2/7] [=============59%            ] nsys_report_db_30000_5_60.sqlite[2/7] [=============60%            ] nsys_report_db_30000_5_60.sqlite[2/7] [==============61%           ] nsys_report_db_30000_5_60.sqlite[2/7] [==============62%           ] nsys_report_db_30000_5_60.sqlite[2/7] [==============63%           ] nsys_report_db_30000_5_60.sqlite[2/7] [==============64%           ] nsys_report_db_30000_5_60.sqlite[2/7] [===============65%          ] nsys_report_db_30000_5_60.sqlite[2/7] [===============66%          ] nsys_report_db_30000_5_60.sqlite[2/7] [===============67%          ] nsys_report_db_30000_5_60.sqlite[2/7] [================68%         ] nsys_report_db_30000_5_60.sqlite[2/7] [================69%         ] nsys_report_db_30000_5_60.sqlite[2/7] [================70%         ] nsys_report_db_30000_5_60.sqlite[2/7] [================71%         ] nsys_report_db_30000_5_60.sqlite[2/7] [=================72%        ] nsys_report_db_30000_5_60.sqlite[2/7] [=================73%        ] nsys_report_db_30000_5_60.sqlite[2/7] [=================74%        ] nsys_report_db_30000_5_60.sqlite[2/7] [==================75%       ] nsys_report_db_30000_5_60.sqlite[2/7] [==================76%       ] nsys_report_db_30000_5_60.sqlite[2/7] [==================77%       ] nsys_report_db_30000_5_60.sqlite[2/7] [==================78%       ] nsys_report_db_30000_5_60.sqlite[2/7] [===================79%      ] nsys_report_db_30000_5_60.sqlite[2/7] [===================80%      ] nsys_report_db_30000_5_60.sqlite[2/7] [===================81%      ] nsys_report_db_30000_5_60.sqlite[2/7] [===================82%      ] nsys_report_db_30000_5_60.sqlite[2/7] [====================83%     ] nsys_report_db_30000_5_60.sqlite[2/7] [====================84%     ] nsys_report_db_30000_5_60.sqlite[2/7] [====================85%     ] nsys_report_db_30000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_5_60.sqlite[2/7] [======================90%   ] nsys_report_db_30000_5_60.sqlite[2/7] [======================91%   ] nsys_report_db_30000_5_60.sqlite[2/7] [======================92%   ] nsys_report_db_30000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_5_60.sqlite[2/7] [========================97% ] nsys_report_db_30000_5_60.sqlite[2/7] [========================98% ] nsys_report_db_30000_5_60.sqlite[2/7] [========================99% ] nsys_report_db_30000_5_60.sqlite[2/7] [========================100%] nsys_report_db_30000_5_60.sqlite[2/7] [========================100%] nsys_report_db_30000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        274575628          1  274575628.0  274575628.0  274575628  274575628          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        167203639          1  167203639.0  167203639.0  167203639  167203639          0.0  cudaFree                      
      1.0          1772563          6     295427.2     263124.0       3780     697108     276182.5  cudaMalloc                    
      0.2           260601        814        320.1        280.0        120       1410        169.5  cuGetProcAddress_v2           
      0.0            39300          2      19650.0      19650.0       9430      29870      14453.3  cudaStreamCreateWithFlags     
      0.0            22140         18       1230.0        485.0        380      12000       2711.9  cudaEventCreateWithFlags      
      0.0             4670          3       1556.7       1390.0        620       2660       1030.2  cuInit                        
      0.0             3550          3       1183.3        260.0        170       3120       1677.8  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        300        590        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 5 (num_steps = 60), identity_test = 0
Generating '/tmp/nsys-report-53d2.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_5_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_5_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_5_60.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_5_60.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_5_60.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_60.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [1%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [2%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [3%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [4%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [5%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [6%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [7%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [8%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [9%                          ] nsys_report_fo_30000_5_60.sqlite[2/7] [10%                         ] nsys_report_fo_30000_5_60.sqlite[2/7] [11%                         ] nsys_report_fo_30000_5_60.sqlite[2/7] [12%                         ] nsys_report_fo_30000_5_60.sqlite[2/7] [13%                         ] nsys_report_fo_30000_5_60.sqlite[2/7] [14%                         ] nsys_report_fo_30000_5_60.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_5_60.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_5_60.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_5_60.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_5_60.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_5_60.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_5_60.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_5_60.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_5_60.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_5_60.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_5_60.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_5_60.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_5_60.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_5_60.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_5_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_5_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_5_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_5_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_5_60.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_5_60.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_5_60.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_5_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_5_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_5_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_5_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_5_60.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_5_60.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_5_60.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_5_60.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_5_60.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_5_60.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_5_60.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_5_60.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_5_60.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_5_60.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_5_60.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_5_60.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_5_60.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_5_60.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_5_60.sqlite[2/7] [============54%             ] nsys_report_fo_30000_5_60.sqlite[2/7] [============55%             ] nsys_report_fo_30000_5_60.sqlite[2/7] [============56%             ] nsys_report_fo_30000_5_60.sqlite[2/7] [============57%             ] nsys_report_fo_30000_5_60.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_5_60.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_5_60.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_5_60.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_5_60.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_5_60.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_5_60.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_5_60.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_5_60.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_5_60.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_5_60.sqlite[2/7] [================68%         ] nsys_report_fo_30000_5_60.sqlite[2/7] [================69%         ] nsys_report_fo_30000_5_60.sqlite[2/7] [================70%         ] nsys_report_fo_30000_5_60.sqlite[2/7] [================71%         ] nsys_report_fo_30000_5_60.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_5_60.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_5_60.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_5_60.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_5_60.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_5_60.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_5_60.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_5_60.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_5_60.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_5_60.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_5_60.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_5_60.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_5_60.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_5_60.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_5_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_5_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_5_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_5_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_5_60.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_5_60.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_5_60.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_5_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_5_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_5_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_5_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_5_60.sqlite[2/7] [========================97% ] nsys_report_fo_30000_5_60.sqlite[2/7] [========================98% ] nsys_report_fo_30000_5_60.sqlite[2/7] [========================99% ] nsys_report_fo_30000_5_60.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_60.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        270240901          1  270240901.0  270240901.0  270240901  270240901          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        156114526          1  156114526.0  156114526.0  156114526  156114526          0.0  cudaFree                      
      1.6          2534803          9     281644.8     407066.0       3700     465656     179443.4  cudaMalloc                    
      0.2           270645        814        332.5        290.0        130       1170        168.3  cuGetProcAddress_v2           
      0.0            38300          2      19150.0      19150.0       2100      36200      24112.3  cudaStreamCreateWithFlags     
      0.0            23860         18       1325.6        520.0        400      13170       2975.4  cudaEventCreateWithFlags      
      0.0             6450          3       2150.0       2780.0        830       2840       1143.5  cuInit                        
      0.0             3280          3       1093.3        270.0        160       2850       1522.3  cuModuleGetLoadingMode        
      0.0              900          2        450.0        450.0        330        570        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 5 (num_steps = 80)
number of batches= 16
Generating '/tmp/nsys-report-bb81.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_5_80.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_5_80.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_5_80.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_5_80.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_80.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [1%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [2%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [3%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [4%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [5%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [6%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [7%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [8%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [9%                          ] nsys_report_ia_30000_5_80.sqlite[2/7] [10%                         ] nsys_report_ia_30000_5_80.sqlite[2/7] [11%                         ] nsys_report_ia_30000_5_80.sqlite[2/7] [12%                         ] nsys_report_ia_30000_5_80.sqlite[2/7] [13%                         ] nsys_report_ia_30000_5_80.sqlite[2/7] [14%                         ] nsys_report_ia_30000_5_80.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_5_80.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_5_80.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_5_80.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_5_80.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_5_80.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_5_80.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_5_80.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_5_80.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_5_80.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_5_80.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_5_80.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_5_80.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_5_80.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_5_80.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_5_80.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_5_80.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_5_80.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_5_80.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_5_80.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_5_80.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_5_80.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_5_80.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_5_80.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_5_80.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_5_80.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_5_80.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_5_80.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_5_80.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_5_80.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_5_80.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_5_80.sqlite[2/7] [============54%             ] nsys_report_ia_30000_5_80.sqlite[2/7] [============55%             ] nsys_report_ia_30000_5_80.sqlite[2/7] [============56%             ] nsys_report_ia_30000_5_80.sqlite[2/7] [============57%             ] nsys_report_ia_30000_5_80.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_5_80.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_5_80.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_5_80.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_5_80.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_5_80.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_5_80.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_5_80.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_5_80.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_5_80.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_5_80.sqlite[2/7] [================68%         ] nsys_report_ia_30000_5_80.sqlite[2/7] [================69%         ] nsys_report_ia_30000_5_80.sqlite[2/7] [================70%         ] nsys_report_ia_30000_5_80.sqlite[2/7] [================71%         ] nsys_report_ia_30000_5_80.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_5_80.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_5_80.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_5_80.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_5_80.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_5_80.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_5_80.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_5_80.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_5_80.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_5_80.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_5_80.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_5_80.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_5_80.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_5_80.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_5_80.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_5_80.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_5_80.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_5_80.sqlite[2/7] [========================97% ] nsys_report_ia_30000_5_80.sqlite[2/7] [========================98% ] nsys_report_ia_30000_5_80.sqlite[2/7] [========================99% ] nsys_report_ia_30000_5_80.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_80.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        243428879          1  243428879.0  243428879.0  243428879  243428879          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        128850770          1  128850770.0  128850770.0  128850770  128850770          0.0  cudaFree                      
      1.3          1732592          6     288765.3     251883.0       3800     693529     271985.9  cudaMalloc                    
      0.2           280725        814        344.9        300.0        130       1280        177.5  cuGetProcAddress_v2           
      0.0            33120          2      16560.0      16560.0       1850      31270      20803.1  cudaStreamCreateWithFlags     
      0.0            22911         18       1272.8        490.0        390      12511       2831.4  cudaEventCreateWithFlags      
      0.0             5410          3       1803.3       2260.0        630       2520       1024.4  cuInit                        
      0.0             3600          3       1200.0        370.0        140       3090       1640.8  cuModuleGetLoadingMode        
      0.0              941          2        470.5        470.5        310        631        227.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 5 (num_steps = 80)
number of batches= 16
Generating '/tmp/nsys-report-5bee.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_5_80.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_5_80.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_5_80.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_5_80.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_80.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [1%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [2%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [3%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [4%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [5%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [6%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [7%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [8%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [9%                          ] nsys_report_db_30000_5_80.sqlite[2/7] [10%                         ] nsys_report_db_30000_5_80.sqlite[2/7] [11%                         ] nsys_report_db_30000_5_80.sqlite[2/7] [12%                         ] nsys_report_db_30000_5_80.sqlite[2/7] [13%                         ] nsys_report_db_30000_5_80.sqlite[2/7] [14%                         ] nsys_report_db_30000_5_80.sqlite[2/7] [=15%                        ] nsys_report_db_30000_5_80.sqlite[2/7] [=16%                        ] nsys_report_db_30000_5_80.sqlite[2/7] [=17%                        ] nsys_report_db_30000_5_80.sqlite[2/7] [==18%                       ] nsys_report_db_30000_5_80.sqlite[2/7] [==19%                       ] nsys_report_db_30000_5_80.sqlite[2/7] [==20%                       ] nsys_report_db_30000_5_80.sqlite[2/7] [==21%                       ] nsys_report_db_30000_5_80.sqlite[2/7] [===22%                      ] nsys_report_db_30000_5_80.sqlite[2/7] [===23%                      ] nsys_report_db_30000_5_80.sqlite[2/7] [===24%                      ] nsys_report_db_30000_5_80.sqlite[2/7] [====25%                     ] nsys_report_db_30000_5_80.sqlite[2/7] [====26%                     ] nsys_report_db_30000_5_80.sqlite[2/7] [====27%                     ] nsys_report_db_30000_5_80.sqlite[2/7] [====28%                     ] nsys_report_db_30000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_5_80.sqlite[2/7] [======33%                   ] nsys_report_db_30000_5_80.sqlite[2/7] [======34%                   ] nsys_report_db_30000_5_80.sqlite[2/7] [======35%                   ] nsys_report_db_30000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_5_80.sqlite[2/7] [========40%                 ] nsys_report_db_30000_5_80.sqlite[2/7] [========41%                 ] nsys_report_db_30000_5_80.sqlite[2/7] [========42%                 ] nsys_report_db_30000_5_80.sqlite[2/7] [=========43%                ] nsys_report_db_30000_5_80.sqlite[2/7] [=========44%                ] nsys_report_db_30000_5_80.sqlite[2/7] [=========45%                ] nsys_report_db_30000_5_80.sqlite[2/7] [=========46%                ] nsys_report_db_30000_5_80.sqlite[2/7] [==========47%               ] nsys_report_db_30000_5_80.sqlite[2/7] [==========48%               ] nsys_report_db_30000_5_80.sqlite[2/7] [==========49%               ] nsys_report_db_30000_5_80.sqlite[2/7] [===========50%              ] nsys_report_db_30000_5_80.sqlite[2/7] [===========51%              ] nsys_report_db_30000_5_80.sqlite[2/7] [===========52%              ] nsys_report_db_30000_5_80.sqlite[2/7] [===========53%              ] nsys_report_db_30000_5_80.sqlite[2/7] [============54%             ] nsys_report_db_30000_5_80.sqlite[2/7] [============55%             ] nsys_report_db_30000_5_80.sqlite[2/7] [============56%             ] nsys_report_db_30000_5_80.sqlite[2/7] [============57%             ] nsys_report_db_30000_5_80.sqlite[2/7] [=============58%            ] nsys_report_db_30000_5_80.sqlite[2/7] [=============59%            ] nsys_report_db_30000_5_80.sqlite[2/7] [=============60%            ] nsys_report_db_30000_5_80.sqlite[2/7] [==============61%           ] nsys_report_db_30000_5_80.sqlite[2/7] [==============62%           ] nsys_report_db_30000_5_80.sqlite[2/7] [==============63%           ] nsys_report_db_30000_5_80.sqlite[2/7] [==============64%           ] nsys_report_db_30000_5_80.sqlite[2/7] [===============65%          ] nsys_report_db_30000_5_80.sqlite[2/7] [===============66%          ] nsys_report_db_30000_5_80.sqlite[2/7] [===============67%          ] nsys_report_db_30000_5_80.sqlite[2/7] [================68%         ] nsys_report_db_30000_5_80.sqlite[2/7] [================69%         ] nsys_report_db_30000_5_80.sqlite[2/7] [================70%         ] nsys_report_db_30000_5_80.sqlite[2/7] [================71%         ] nsys_report_db_30000_5_80.sqlite[2/7] [=================72%        ] nsys_report_db_30000_5_80.sqlite[2/7] [=================73%        ] nsys_report_db_30000_5_80.sqlite[2/7] [=================74%        ] nsys_report_db_30000_5_80.sqlite[2/7] [==================75%       ] nsys_report_db_30000_5_80.sqlite[2/7] [==================76%       ] nsys_report_db_30000_5_80.sqlite[2/7] [==================77%       ] nsys_report_db_30000_5_80.sqlite[2/7] [==================78%       ] nsys_report_db_30000_5_80.sqlite[2/7] [===================79%      ] nsys_report_db_30000_5_80.sqlite[2/7] [===================80%      ] nsys_report_db_30000_5_80.sqlite[2/7] [===================81%      ] nsys_report_db_30000_5_80.sqlite[2/7] [===================82%      ] nsys_report_db_30000_5_80.sqlite[2/7] [====================83%     ] nsys_report_db_30000_5_80.sqlite[2/7] [====================84%     ] nsys_report_db_30000_5_80.sqlite[2/7] [====================85%     ] nsys_report_db_30000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_5_80.sqlite[2/7] [======================90%   ] nsys_report_db_30000_5_80.sqlite[2/7] [======================91%   ] nsys_report_db_30000_5_80.sqlite[2/7] [======================92%   ] nsys_report_db_30000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_5_80.sqlite[2/7] [========================97% ] nsys_report_db_30000_5_80.sqlite[2/7] [========================98% ] nsys_report_db_30000_5_80.sqlite[2/7] [========================99% ] nsys_report_db_30000_5_80.sqlite[2/7] [========================100%] nsys_report_db_30000_5_80.sqlite[2/7] [========================100%] nsys_report_db_30000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        270905073          1  270905073.0  270905073.0  270905073  270905073          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        163253192          1  163253192.0  163253192.0  163253192  163253192          0.0  cudaFree                      
      1.1          1779333          6     296555.5     262783.5       4050     704069     277901.7  cudaMalloc                    
      0.2           273394        814        335.9        290.0        120       1220        177.3  cuGetProcAddress_v2           
      0.0            33661          2      16830.5      16830.5       2050      31611      20902.8  cudaStreamCreateWithFlags     
      0.0            22340         18       1241.1        460.0        390      12440       2814.5  cudaEventCreateWithFlags      
      0.0             5660          3       1886.7       1980.0        560       3120       1282.5  cuInit                        
      0.0             3600          3       1200.0        270.0        160       3170       1707.0  cuModuleGetLoadingMode        
      0.0              980          2        490.0        490.0        320        660        240.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 5 (num_steps = 80), identity_test = 0
Generating '/tmp/nsys-report-1bf9.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_5_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_5_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_5_80.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_5_80.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_5_80.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_80.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [1%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [2%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [3%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [4%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [5%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [6%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [7%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [8%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [9%                          ] nsys_report_fo_30000_5_80.sqlite[2/7] [10%                         ] nsys_report_fo_30000_5_80.sqlite[2/7] [11%                         ] nsys_report_fo_30000_5_80.sqlite[2/7] [12%                         ] nsys_report_fo_30000_5_80.sqlite[2/7] [13%                         ] nsys_report_fo_30000_5_80.sqlite[2/7] [14%                         ] nsys_report_fo_30000_5_80.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_5_80.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_5_80.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_5_80.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_5_80.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_5_80.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_5_80.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_5_80.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_5_80.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_5_80.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_5_80.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_5_80.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_5_80.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_5_80.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_5_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_5_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_5_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_5_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_5_80.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_5_80.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_5_80.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_5_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_5_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_5_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_5_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_5_80.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_5_80.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_5_80.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_5_80.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_5_80.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_5_80.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_5_80.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_5_80.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_5_80.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_5_80.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_5_80.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_5_80.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_5_80.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_5_80.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_5_80.sqlite[2/7] [============54%             ] nsys_report_fo_30000_5_80.sqlite[2/7] [============55%             ] nsys_report_fo_30000_5_80.sqlite[2/7] [============56%             ] nsys_report_fo_30000_5_80.sqlite[2/7] [============57%             ] nsys_report_fo_30000_5_80.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_5_80.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_5_80.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_5_80.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_5_80.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_5_80.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_5_80.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_5_80.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_5_80.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_5_80.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_5_80.sqlite[2/7] [================68%         ] nsys_report_fo_30000_5_80.sqlite[2/7] [================69%         ] nsys_report_fo_30000_5_80.sqlite[2/7] [================70%         ] nsys_report_fo_30000_5_80.sqlite[2/7] [================71%         ] nsys_report_fo_30000_5_80.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_5_80.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_5_80.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_5_80.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_5_80.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_5_80.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_5_80.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_5_80.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_5_80.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_5_80.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_5_80.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_5_80.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_5_80.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_5_80.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_5_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_5_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_5_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_5_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_5_80.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_5_80.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_5_80.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_5_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_5_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_5_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_5_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_5_80.sqlite[2/7] [========================97% ] nsys_report_fo_30000_5_80.sqlite[2/7] [========================98% ] nsys_report_fo_30000_5_80.sqlite[2/7] [========================99% ] nsys_report_fo_30000_5_80.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_80.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        264134545          1  264134545.0  264134545.0  264134545  264134545          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        156166331          1  156166331.0  156166331.0  156166331  156166331          0.0  cudaFree                      
      1.6          2506211          9     278467.9     403975.0       3790     459246     180876.7  cudaMalloc                    
      0.2           266814        814        327.8        290.0        120       1220        171.4  cuGetProcAddress_v2           
      0.0            35871          2      17935.5      17935.5       1740      34131      22903.9  cudaStreamCreateWithFlags     
      0.0            27050         18       1502.8        515.0        410      10010       2794.9  cudaEventCreateWithFlags      
      0.0             5960          3       1986.7       2160.0        970       2830        942.0  cuInit                        
      0.0             3300          3       1100.0        380.0        170       2750       1432.8  cuModuleGetLoadingMode        
      0.0              940          2        470.0        470.0        350        590        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 5 (num_steps = 100)
number of batches= 20
Generating '/tmp/nsys-report-bc3a.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_5_100.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_5_100.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_5_100.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_5_100.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_100.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [1%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [2%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [3%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [4%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [5%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [6%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [7%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [8%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [9%                          ] nsys_report_ia_30000_5_100.sqlite[2/7] [10%                         ] nsys_report_ia_30000_5_100.sqlite[2/7] [11%                         ] nsys_report_ia_30000_5_100.sqlite[2/7] [12%                         ] nsys_report_ia_30000_5_100.sqlite[2/7] [13%                         ] nsys_report_ia_30000_5_100.sqlite[2/7] [14%                         ] nsys_report_ia_30000_5_100.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_5_100.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_5_100.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_5_100.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_5_100.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_5_100.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_5_100.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_5_100.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_5_100.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_5_100.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_5_100.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_5_100.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_5_100.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_5_100.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_5_100.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_5_100.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_5_100.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_5_100.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_5_100.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_5_100.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_5_100.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_5_100.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_5_100.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_5_100.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_5_100.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_5_100.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_5_100.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_5_100.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_5_100.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_5_100.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_5_100.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_5_100.sqlite[2/7] [============54%             ] nsys_report_ia_30000_5_100.sqlite[2/7] [============55%             ] nsys_report_ia_30000_5_100.sqlite[2/7] [============56%             ] nsys_report_ia_30000_5_100.sqlite[2/7] [============57%             ] nsys_report_ia_30000_5_100.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_5_100.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_5_100.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_5_100.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_5_100.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_5_100.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_5_100.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_5_100.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_5_100.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_5_100.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_5_100.sqlite[2/7] [================68%         ] nsys_report_ia_30000_5_100.sqlite[2/7] [================69%         ] nsys_report_ia_30000_5_100.sqlite[2/7] [================70%         ] nsys_report_ia_30000_5_100.sqlite[2/7] [================71%         ] nsys_report_ia_30000_5_100.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_5_100.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_5_100.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_5_100.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_5_100.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_5_100.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_5_100.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_5_100.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_5_100.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_5_100.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_5_100.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_5_100.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_5_100.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_5_100.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_5_100.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_5_100.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_5_100.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_5_100.sqlite[2/7] [========================97% ] nsys_report_ia_30000_5_100.sqlite[2/7] [========================98% ] nsys_report_ia_30000_5_100.sqlite[2/7] [========================99% ] nsys_report_ia_30000_5_100.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_100.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        243883723          1  243883723.0  243883723.0  243883723  243883723          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        128385093          1  128385093.0  128385093.0  128385093  128385093          0.0  cudaFree                      
      1.3          1727472          6     287912.0     253983.0       4020     700419     272472.1  cudaMalloc                    
      0.2           276423        814        339.6        285.0        110       9800        373.2  cuGetProcAddress_v2           
      0.0            47630          2      23815.0      23815.0       1760      45870      31190.5  cudaStreamCreateWithFlags     
      0.0            21520         18       1195.6        495.0        390      11620       2619.3  cudaEventCreateWithFlags      
      0.0             5480          3       1826.7       2220.0        640       2620       1047.0  cuInit                        
      0.0             3320          3       1106.7        260.0        170       2890       1545.1  cuModuleGetLoadingMode        
      0.0              920          2        460.0        460.0        340        580        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 5 (num_steps = 100)
number of batches= 20
Generating '/tmp/nsys-report-72fb.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_5_100.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_5_100.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_5_100.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_5_100.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_100.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [1%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [2%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [3%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [4%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [5%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [6%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [7%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [8%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [9%                          ] nsys_report_db_30000_5_100.sqlite[2/7] [10%                         ] nsys_report_db_30000_5_100.sqlite[2/7] [11%                         ] nsys_report_db_30000_5_100.sqlite[2/7] [12%                         ] nsys_report_db_30000_5_100.sqlite[2/7] [13%                         ] nsys_report_db_30000_5_100.sqlite[2/7] [14%                         ] nsys_report_db_30000_5_100.sqlite[2/7] [=15%                        ] nsys_report_db_30000_5_100.sqlite[2/7] [=16%                        ] nsys_report_db_30000_5_100.sqlite[2/7] [=17%                        ] nsys_report_db_30000_5_100.sqlite[2/7] [==18%                       ] nsys_report_db_30000_5_100.sqlite[2/7] [==19%                       ] nsys_report_db_30000_5_100.sqlite[2/7] [==20%                       ] nsys_report_db_30000_5_100.sqlite[2/7] [==21%                       ] nsys_report_db_30000_5_100.sqlite[2/7] [===22%                      ] nsys_report_db_30000_5_100.sqlite[2/7] [===23%                      ] nsys_report_db_30000_5_100.sqlite[2/7] [===24%                      ] nsys_report_db_30000_5_100.sqlite[2/7] [====25%                     ] nsys_report_db_30000_5_100.sqlite[2/7] [====26%                     ] nsys_report_db_30000_5_100.sqlite[2/7] [====27%                     ] nsys_report_db_30000_5_100.sqlite[2/7] [====28%                     ] nsys_report_db_30000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_5_100.sqlite[2/7] [======33%                   ] nsys_report_db_30000_5_100.sqlite[2/7] [======34%                   ] nsys_report_db_30000_5_100.sqlite[2/7] [======35%                   ] nsys_report_db_30000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_5_100.sqlite[2/7] [========40%                 ] nsys_report_db_30000_5_100.sqlite[2/7] [========41%                 ] nsys_report_db_30000_5_100.sqlite[2/7] [========42%                 ] nsys_report_db_30000_5_100.sqlite[2/7] [=========43%                ] nsys_report_db_30000_5_100.sqlite[2/7] [=========44%                ] nsys_report_db_30000_5_100.sqlite[2/7] [=========45%                ] nsys_report_db_30000_5_100.sqlite[2/7] [=========46%                ] nsys_report_db_30000_5_100.sqlite[2/7] [==========47%               ] nsys_report_db_30000_5_100.sqlite[2/7] [==========48%               ] nsys_report_db_30000_5_100.sqlite[2/7] [==========49%               ] nsys_report_db_30000_5_100.sqlite[2/7] [===========50%              ] nsys_report_db_30000_5_100.sqlite[2/7] [===========51%              ] nsys_report_db_30000_5_100.sqlite[2/7] [===========52%              ] nsys_report_db_30000_5_100.sqlite[2/7] [===========53%              ] nsys_report_db_30000_5_100.sqlite[2/7] [============54%             ] nsys_report_db_30000_5_100.sqlite[2/7] [============55%             ] nsys_report_db_30000_5_100.sqlite[2/7] [============56%             ] nsys_report_db_30000_5_100.sqlite[2/7] [============57%             ] nsys_report_db_30000_5_100.sqlite[2/7] [=============58%            ] nsys_report_db_30000_5_100.sqlite[2/7] [=============59%            ] nsys_report_db_30000_5_100.sqlite[2/7] [=============60%            ] nsys_report_db_30000_5_100.sqlite[2/7] [==============61%           ] nsys_report_db_30000_5_100.sqlite[2/7] [==============62%           ] nsys_report_db_30000_5_100.sqlite[2/7] [==============63%           ] nsys_report_db_30000_5_100.sqlite[2/7] [==============64%           ] nsys_report_db_30000_5_100.sqlite[2/7] [===============65%          ] nsys_report_db_30000_5_100.sqlite[2/7] [===============66%          ] nsys_report_db_30000_5_100.sqlite[2/7] [===============67%          ] nsys_report_db_30000_5_100.sqlite[2/7] [================68%         ] nsys_report_db_30000_5_100.sqlite[2/7] [================69%         ] nsys_report_db_30000_5_100.sqlite[2/7] [================70%         ] nsys_report_db_30000_5_100.sqlite[2/7] [================71%         ] nsys_report_db_30000_5_100.sqlite[2/7] [=================72%        ] nsys_report_db_30000_5_100.sqlite[2/7] [=================73%        ] nsys_report_db_30000_5_100.sqlite[2/7] [=================74%        ] nsys_report_db_30000_5_100.sqlite[2/7] [==================75%       ] nsys_report_db_30000_5_100.sqlite[2/7] [==================76%       ] nsys_report_db_30000_5_100.sqlite[2/7] [==================77%       ] nsys_report_db_30000_5_100.sqlite[2/7] [==================78%       ] nsys_report_db_30000_5_100.sqlite[2/7] [===================79%      ] nsys_report_db_30000_5_100.sqlite[2/7] [===================80%      ] nsys_report_db_30000_5_100.sqlite[2/7] [===================81%      ] nsys_report_db_30000_5_100.sqlite[2/7] [===================82%      ] nsys_report_db_30000_5_100.sqlite[2/7] [====================83%     ] nsys_report_db_30000_5_100.sqlite[2/7] [====================84%     ] nsys_report_db_30000_5_100.sqlite[2/7] [====================85%     ] nsys_report_db_30000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_5_100.sqlite[2/7] [======================90%   ] nsys_report_db_30000_5_100.sqlite[2/7] [======================91%   ] nsys_report_db_30000_5_100.sqlite[2/7] [======================92%   ] nsys_report_db_30000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_5_100.sqlite[2/7] [========================97% ] nsys_report_db_30000_5_100.sqlite[2/7] [========================98% ] nsys_report_db_30000_5_100.sqlite[2/7] [========================99% ] nsys_report_db_30000_5_100.sqlite[2/7] [========================100%] nsys_report_db_30000_5_100.sqlite[2/7] [========================100%] nsys_report_db_30000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        266290031          1  266290031.0  266290031.0  266290031  266290031          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        154049204          1  154049204.0  154049204.0  154049204  154049204          0.0  cudaFree                      
      1.1          1759933          6     293322.2     265498.0       4141     699969     275663.8  cudaMalloc                    
      0.2           294001        814        361.2        300.0        120       8900        353.8  cuGetProcAddress_v2           
      0.0            34290          2      17145.0      17145.0       1930      32360      21517.3  cudaStreamCreateWithFlags     
      0.0            23080         18       1282.2        500.0        380      12830       2905.2  cudaEventCreateWithFlags      
      0.0             4651          3       1550.3       1700.0        640       2311        845.5  cuInit                        
      0.0             3550          3       1183.3        390.0        160       3000       1577.5  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        310        570        183.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 5 (num_steps = 100), identity_test = 0
Generating '/tmp/nsys-report-df16.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_5_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_5_100.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_5_100.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_5_100.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_5_100.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_100.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [1%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [2%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [3%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [4%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [5%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [6%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [7%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [8%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [9%                          ] nsys_report_fo_30000_5_100.sqlite[2/7] [10%                         ] nsys_report_fo_30000_5_100.sqlite[2/7] [11%                         ] nsys_report_fo_30000_5_100.sqlite[2/7] [12%                         ] nsys_report_fo_30000_5_100.sqlite[2/7] [13%                         ] nsys_report_fo_30000_5_100.sqlite[2/7] [14%                         ] nsys_report_fo_30000_5_100.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_5_100.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_5_100.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_5_100.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_5_100.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_5_100.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_5_100.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_5_100.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_5_100.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_5_100.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_5_100.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_5_100.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_5_100.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_5_100.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_5_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_5_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_5_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_5_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_5_100.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_5_100.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_5_100.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_5_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_5_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_5_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_5_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_5_100.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_5_100.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_5_100.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_5_100.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_5_100.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_5_100.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_5_100.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_5_100.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_5_100.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_5_100.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_5_100.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_5_100.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_5_100.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_5_100.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_5_100.sqlite[2/7] [============54%             ] nsys_report_fo_30000_5_100.sqlite[2/7] [============55%             ] nsys_report_fo_30000_5_100.sqlite[2/7] [============56%             ] nsys_report_fo_30000_5_100.sqlite[2/7] [============57%             ] nsys_report_fo_30000_5_100.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_5_100.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_5_100.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_5_100.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_5_100.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_5_100.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_5_100.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_5_100.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_5_100.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_5_100.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_5_100.sqlite[2/7] [================68%         ] nsys_report_fo_30000_5_100.sqlite[2/7] [================69%         ] nsys_report_fo_30000_5_100.sqlite[2/7] [================70%         ] nsys_report_fo_30000_5_100.sqlite[2/7] [================71%         ] nsys_report_fo_30000_5_100.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_5_100.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_5_100.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_5_100.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_5_100.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_5_100.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_5_100.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_5_100.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_5_100.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_5_100.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_5_100.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_5_100.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_5_100.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_5_100.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_5_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_5_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_5_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_5_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_5_100.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_5_100.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_5_100.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_5_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_5_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_5_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_5_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_5_100.sqlite[2/7] [========================97% ] nsys_report_fo_30000_5_100.sqlite[2/7] [========================98% ] nsys_report_fo_30000_5_100.sqlite[2/7] [========================99% ] nsys_report_fo_30000_5_100.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_100.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        279826124          1  279826124.0  279826124.0  279826124  279826124          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        158563582          1  158563582.0  158563582.0  158563582  158563582          0.0  cudaFree                      
      1.6          2545172          9     282796.9     411845.0       3900     455106     184991.0  cudaMalloc                    
      0.2           283103        814        347.8        305.0        110       7330        303.2  cuGetProcAddress_v2           
      0.0            38220          2      19110.0      19110.0       1980      36240      24225.5  cudaStreamCreateWithFlags     
      0.0            22990         18       1277.2        505.0        380      12480       2818.4  cudaEventCreateWithFlags      
      0.0             4980          3       1660.0       1880.0        540       2560       1027.8  cuInit                        
      0.0             3560          3       1186.7        360.0        210       2990       1563.5  cuModuleGetLoadingMode        
      0.0              870          2        435.0        435.0        320        550        162.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 5 (num_steps = 150)
number of batches= 30
Generating '/tmp/nsys-report-8588.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_5_150.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_5_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_5_150.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_150.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [1%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [2%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [3%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [4%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [5%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [6%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [7%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [8%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [9%                          ] nsys_report_ia_30000_5_150.sqlite[2/7] [10%                         ] nsys_report_ia_30000_5_150.sqlite[2/7] [11%                         ] nsys_report_ia_30000_5_150.sqlite[2/7] [12%                         ] nsys_report_ia_30000_5_150.sqlite[2/7] [13%                         ] nsys_report_ia_30000_5_150.sqlite[2/7] [14%                         ] nsys_report_ia_30000_5_150.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_5_150.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_5_150.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_5_150.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_5_150.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_5_150.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_5_150.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_5_150.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_5_150.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_5_150.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_5_150.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_5_150.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_5_150.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_5_150.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_5_150.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_5_150.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_5_150.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_5_150.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_5_150.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_5_150.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_5_150.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_5_150.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_5_150.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_5_150.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_5_150.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_5_150.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_5_150.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_5_150.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_5_150.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_5_150.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_5_150.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_5_150.sqlite[2/7] [============54%             ] nsys_report_ia_30000_5_150.sqlite[2/7] [============55%             ] nsys_report_ia_30000_5_150.sqlite[2/7] [============56%             ] nsys_report_ia_30000_5_150.sqlite[2/7] [============57%             ] nsys_report_ia_30000_5_150.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_5_150.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_5_150.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_5_150.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_5_150.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_5_150.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_5_150.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_5_150.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_5_150.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_5_150.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_5_150.sqlite[2/7] [================68%         ] nsys_report_ia_30000_5_150.sqlite[2/7] [================69%         ] nsys_report_ia_30000_5_150.sqlite[2/7] [================70%         ] nsys_report_ia_30000_5_150.sqlite[2/7] [================71%         ] nsys_report_ia_30000_5_150.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_5_150.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_5_150.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_5_150.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_5_150.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_5_150.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_5_150.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_5_150.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_5_150.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_5_150.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_5_150.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_5_150.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_5_150.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_5_150.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_5_150.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_5_150.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_5_150.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_5_150.sqlite[2/7] [========================97% ] nsys_report_ia_30000_5_150.sqlite[2/7] [========================98% ] nsys_report_ia_30000_5_150.sqlite[2/7] [========================99% ] nsys_report_ia_30000_5_150.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_150.sqlite[2/7] [========================100%] nsys_report_ia_30000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245933091          1  245933091.0  245933091.0  245933091  245933091          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        130057810          1  130057810.0  130057810.0  130057810  130057810          0.0  cudaFree                      
      1.3          1766663          6     294443.8     261233.0       3931     693989     276048.8  cudaMalloc                    
      0.2           297093        814        365.0        310.0        110      10961        411.1  cuGetProcAddress_v2           
      0.0            35841          2      17920.5      17920.5       1930      33911      22614.0  cudaStreamCreateWithFlags     
      0.0            21780         18       1210.0        475.0        390      11650       2627.1  cudaEventCreateWithFlags      
      0.0             5080          3       1693.3       2010.0        660       2410        917.0  cuInit                        
      0.0             3720          3       1240.0        370.0        160       3190       1692.0  cuModuleGetLoadingMode        
      0.0              870          2        435.0        435.0        300        570        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_5_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 5 (num_steps = 150)
number of batches= 30
Generating '/tmp/nsys-report-6076.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_5_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_5_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_5_150.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_5_150.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_150.nsys-rep[1/7] [========================100%] nsys_report_db_30000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [1%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [2%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [3%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [4%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [5%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [6%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [7%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [8%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [9%                          ] nsys_report_db_30000_5_150.sqlite[2/7] [10%                         ] nsys_report_db_30000_5_150.sqlite[2/7] [11%                         ] nsys_report_db_30000_5_150.sqlite[2/7] [12%                         ] nsys_report_db_30000_5_150.sqlite[2/7] [13%                         ] nsys_report_db_30000_5_150.sqlite[2/7] [14%                         ] nsys_report_db_30000_5_150.sqlite[2/7] [=15%                        ] nsys_report_db_30000_5_150.sqlite[2/7] [=16%                        ] nsys_report_db_30000_5_150.sqlite[2/7] [=17%                        ] nsys_report_db_30000_5_150.sqlite[2/7] [==18%                       ] nsys_report_db_30000_5_150.sqlite[2/7] [==19%                       ] nsys_report_db_30000_5_150.sqlite[2/7] [==20%                       ] nsys_report_db_30000_5_150.sqlite[2/7] [==21%                       ] nsys_report_db_30000_5_150.sqlite[2/7] [===22%                      ] nsys_report_db_30000_5_150.sqlite[2/7] [===23%                      ] nsys_report_db_30000_5_150.sqlite[2/7] [===24%                      ] nsys_report_db_30000_5_150.sqlite[2/7] [====25%                     ] nsys_report_db_30000_5_150.sqlite[2/7] [====26%                     ] nsys_report_db_30000_5_150.sqlite[2/7] [====27%                     ] nsys_report_db_30000_5_150.sqlite[2/7] [====28%                     ] nsys_report_db_30000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_5_150.sqlite[2/7] [======33%                   ] nsys_report_db_30000_5_150.sqlite[2/7] [======34%                   ] nsys_report_db_30000_5_150.sqlite[2/7] [======35%                   ] nsys_report_db_30000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_5_150.sqlite[2/7] [========40%                 ] nsys_report_db_30000_5_150.sqlite[2/7] [========41%                 ] nsys_report_db_30000_5_150.sqlite[2/7] [========42%                 ] nsys_report_db_30000_5_150.sqlite[2/7] [=========43%                ] nsys_report_db_30000_5_150.sqlite[2/7] [=========44%                ] nsys_report_db_30000_5_150.sqlite[2/7] [=========45%                ] nsys_report_db_30000_5_150.sqlite[2/7] [=========46%                ] nsys_report_db_30000_5_150.sqlite[2/7] [==========47%               ] nsys_report_db_30000_5_150.sqlite[2/7] [==========48%               ] nsys_report_db_30000_5_150.sqlite[2/7] [==========49%               ] nsys_report_db_30000_5_150.sqlite[2/7] [===========50%              ] nsys_report_db_30000_5_150.sqlite[2/7] [===========51%              ] nsys_report_db_30000_5_150.sqlite[2/7] [===========52%              ] nsys_report_db_30000_5_150.sqlite[2/7] [===========53%              ] nsys_report_db_30000_5_150.sqlite[2/7] [============54%             ] nsys_report_db_30000_5_150.sqlite[2/7] [============55%             ] nsys_report_db_30000_5_150.sqlite[2/7] [============56%             ] nsys_report_db_30000_5_150.sqlite[2/7] [============57%             ] nsys_report_db_30000_5_150.sqlite[2/7] [=============58%            ] nsys_report_db_30000_5_150.sqlite[2/7] [=============59%            ] nsys_report_db_30000_5_150.sqlite[2/7] [=============60%            ] nsys_report_db_30000_5_150.sqlite[2/7] [==============61%           ] nsys_report_db_30000_5_150.sqlite[2/7] [==============62%           ] nsys_report_db_30000_5_150.sqlite[2/7] [==============63%           ] nsys_report_db_30000_5_150.sqlite[2/7] [==============64%           ] nsys_report_db_30000_5_150.sqlite[2/7] [===============65%          ] nsys_report_db_30000_5_150.sqlite[2/7] [===============66%          ] nsys_report_db_30000_5_150.sqlite[2/7] [===============67%          ] nsys_report_db_30000_5_150.sqlite[2/7] [================68%         ] nsys_report_db_30000_5_150.sqlite[2/7] [================69%         ] nsys_report_db_30000_5_150.sqlite[2/7] [================70%         ] nsys_report_db_30000_5_150.sqlite[2/7] [================71%         ] nsys_report_db_30000_5_150.sqlite[2/7] [=================72%        ] nsys_report_db_30000_5_150.sqlite[2/7] [=================73%        ] nsys_report_db_30000_5_150.sqlite[2/7] [=================74%        ] nsys_report_db_30000_5_150.sqlite[2/7] [==================75%       ] nsys_report_db_30000_5_150.sqlite[2/7] [==================76%       ] nsys_report_db_30000_5_150.sqlite[2/7] [==================77%       ] nsys_report_db_30000_5_150.sqlite[2/7] [==================78%       ] nsys_report_db_30000_5_150.sqlite[2/7] [===================79%      ] nsys_report_db_30000_5_150.sqlite[2/7] [===================80%      ] nsys_report_db_30000_5_150.sqlite[2/7] [===================81%      ] nsys_report_db_30000_5_150.sqlite[2/7] [===================82%      ] nsys_report_db_30000_5_150.sqlite[2/7] [====================83%     ] nsys_report_db_30000_5_150.sqlite[2/7] [====================84%     ] nsys_report_db_30000_5_150.sqlite[2/7] [====================85%     ] nsys_report_db_30000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_5_150.sqlite[2/7] [======================90%   ] nsys_report_db_30000_5_150.sqlite[2/7] [======================91%   ] nsys_report_db_30000_5_150.sqlite[2/7] [======================92%   ] nsys_report_db_30000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_5_150.sqlite[2/7] [========================97% ] nsys_report_db_30000_5_150.sqlite[2/7] [========================98% ] nsys_report_db_30000_5_150.sqlite[2/7] [========================99% ] nsys_report_db_30000_5_150.sqlite[2/7] [========================100%] nsys_report_db_30000_5_150.sqlite[2/7] [========================100%] nsys_report_db_30000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        291728619          1  291728619.0  291728619.0  291728619  291728619          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.8        170022533          1  170022533.0  170022533.0  170022533  170022533          0.0  cudaFree                      
      1.0          1774043          6     295673.8     267388.5       3800     700079     277063.9  cudaMalloc                    
      0.2           270164        814        331.9        290.0        120       1411        164.0  cuGetProcAddress_v2           
      0.0            41110          2      20555.0      20555.0       1940      39170      26325.6  cudaStreamCreateWithFlags     
      0.0            19900         18       1105.6        505.0        400       9430       2109.1  cudaEventCreateWithFlags      
      0.0             5590          3       1863.3       1830.0        710       3050       1170.4  cuInit                        
      0.0             3640          3       1213.3        520.0        180       2940       1505.0  cuModuleGetLoadingMode        
      0.0              910          2        455.0        455.0        320        590        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_5_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 5 (num_steps = 150), identity_test = 0
Generating '/tmp/nsys-report-e163.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_5_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_5_150.nsys-rep[1/7] [======34%                   ] nsys_report_fo_30000_5_150.nsys-rep[1/7] [================68%         ] nsys_report_fo_30000_5_150.nsys-rep[1/7] [================69%         ] nsys_report_fo_30000_5_150.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_5_150.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_150.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_5_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [1%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [2%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [3%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [4%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [5%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [6%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [7%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [8%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [9%                          ] nsys_report_fo_30000_5_150.sqlite[2/7] [10%                         ] nsys_report_fo_30000_5_150.sqlite[2/7] [11%                         ] nsys_report_fo_30000_5_150.sqlite[2/7] [12%                         ] nsys_report_fo_30000_5_150.sqlite[2/7] [13%                         ] nsys_report_fo_30000_5_150.sqlite[2/7] [14%                         ] nsys_report_fo_30000_5_150.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_5_150.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_5_150.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_5_150.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_5_150.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_5_150.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_5_150.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_5_150.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_5_150.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_5_150.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_5_150.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_5_150.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_5_150.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_5_150.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_5_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_5_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_5_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_5_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_5_150.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_5_150.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_5_150.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_5_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_5_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_5_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_5_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_5_150.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_5_150.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_5_150.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_5_150.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_5_150.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_5_150.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_5_150.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_5_150.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_5_150.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_5_150.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_5_150.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_5_150.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_5_150.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_5_150.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_5_150.sqlite[2/7] [============54%             ] nsys_report_fo_30000_5_150.sqlite[2/7] [============55%             ] nsys_report_fo_30000_5_150.sqlite[2/7] [============56%             ] nsys_report_fo_30000_5_150.sqlite[2/7] [============57%             ] nsys_report_fo_30000_5_150.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_5_150.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_5_150.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_5_150.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_5_150.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_5_150.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_5_150.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_5_150.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_5_150.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_5_150.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_5_150.sqlite[2/7] [================68%         ] nsys_report_fo_30000_5_150.sqlite[2/7] [================69%         ] nsys_report_fo_30000_5_150.sqlite[2/7] [================70%         ] nsys_report_fo_30000_5_150.sqlite[2/7] [================71%         ] nsys_report_fo_30000_5_150.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_5_150.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_5_150.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_5_150.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_5_150.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_5_150.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_5_150.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_5_150.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_5_150.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_5_150.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_5_150.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_5_150.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_5_150.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_5_150.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_5_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_5_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_5_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_5_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_5_150.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_5_150.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_5_150.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_5_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_5_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_5_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_5_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_5_150.sqlite[2/7] [========================97% ] nsys_report_fo_30000_5_150.sqlite[2/7] [========================98% ] nsys_report_fo_30000_5_150.sqlite[2/7] [========================99% ] nsys_report_fo_30000_5_150.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_150.sqlite[2/7] [========================100%] nsys_report_fo_30000_5_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        272465446          1  272465446.0  272465446.0  272465446  272465446          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        153255543          1  153255543.0  153255543.0  153255543  153255543          0.0  cudaFree                      
      1.6          2516903          9     279655.9     411605.0       4030     456346     181752.6  cudaMalloc                    
      0.2           291995        814        358.7        310.0        110       1220        189.8  cuGetProcAddress_v2           
      0.0            43601          2      21800.5      21800.5       2030      41571      27959.7  cudaStreamCreateWithFlags     
      0.0            22820         18       1267.8        490.0        390      12700       2871.6  cudaEventCreateWithFlags      
      0.0             6260          3       2086.7       2470.0        740       3050       1201.8  cuInit                        
      0.0             2990          3        996.7        250.0        160       2580       1371.9  cuModuleGetLoadingMode        
      0.0              940          2        470.0        470.0        310        630        226.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_5_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 10 (num_steps = 20)
number of batches= 2
Generating '/tmp/nsys-report-cf70.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_10_20.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_10_20.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_10_20.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_10_20.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_20.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [1%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [2%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [3%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [4%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [5%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [6%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [7%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [8%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [9%                          ] nsys_report_ia_30000_10_20.sqlite[2/7] [10%                         ] nsys_report_ia_30000_10_20.sqlite[2/7] [11%                         ] nsys_report_ia_30000_10_20.sqlite[2/7] [12%                         ] nsys_report_ia_30000_10_20.sqlite[2/7] [13%                         ] nsys_report_ia_30000_10_20.sqlite[2/7] [14%                         ] nsys_report_ia_30000_10_20.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_10_20.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_10_20.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_10_20.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_10_20.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_10_20.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_10_20.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_10_20.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_10_20.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_10_20.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_10_20.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_10_20.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_10_20.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_10_20.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_10_20.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_10_20.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_10_20.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_10_20.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_10_20.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_10_20.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_10_20.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_10_20.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_10_20.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_10_20.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_10_20.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_10_20.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_10_20.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_10_20.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_10_20.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_10_20.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_10_20.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_10_20.sqlite[2/7] [============54%             ] nsys_report_ia_30000_10_20.sqlite[2/7] [============55%             ] nsys_report_ia_30000_10_20.sqlite[2/7] [============56%             ] nsys_report_ia_30000_10_20.sqlite[2/7] [============57%             ] nsys_report_ia_30000_10_20.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_10_20.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_10_20.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_10_20.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_10_20.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_10_20.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_10_20.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_10_20.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_10_20.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_10_20.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_10_20.sqlite[2/7] [================68%         ] nsys_report_ia_30000_10_20.sqlite[2/7] [================69%         ] nsys_report_ia_30000_10_20.sqlite[2/7] [================70%         ] nsys_report_ia_30000_10_20.sqlite[2/7] [================71%         ] nsys_report_ia_30000_10_20.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_10_20.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_10_20.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_10_20.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_10_20.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_10_20.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_10_20.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_10_20.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_10_20.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_10_20.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_10_20.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_10_20.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_10_20.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_10_20.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_10_20.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_10_20.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_10_20.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_10_20.sqlite[2/7] [========================97% ] nsys_report_ia_30000_10_20.sqlite[2/7] [========================98% ] nsys_report_ia_30000_10_20.sqlite[2/7] [========================99% ] nsys_report_ia_30000_10_20.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_20.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        239631929          1  239631929.0  239631929.0  239631929  239631929          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        129563142          1  129563142.0  129563142.0  129563142  129563142          0.0  cudaFree                      
      1.4          1805173          6     300862.2     251883.0       3961     741099     289652.2  cudaMalloc                    
      0.2           294555        814        361.9        320.0        130       1400        180.5  cuGetProcAddress_v2           
      0.0            34250          2      17125.0      17125.0       1810      32440      21658.7  cudaStreamCreateWithFlags     
      0.0            24560         18       1364.4        510.0        390      14140       3205.4  cudaEventCreateWithFlags      
      0.0             4940          3       1646.7       1910.0        640       2390        904.2  cuInit                        
      0.0             3160          3       1053.3        320.0        170       2670       1402.1  cuModuleGetLoadingMode        
      0.0              901          2        450.5        450.5        310        591        198.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 10 (num_steps = 20)
number of batches= 2
Generating '/tmp/nsys-report-ccda.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_10_20.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_10_20.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_10_20.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_10_20.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_20.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [1%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [2%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [3%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [4%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [5%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [6%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [7%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [8%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [9%                          ] nsys_report_db_30000_10_20.sqlite[2/7] [10%                         ] nsys_report_db_30000_10_20.sqlite[2/7] [11%                         ] nsys_report_db_30000_10_20.sqlite[2/7] [12%                         ] nsys_report_db_30000_10_20.sqlite[2/7] [13%                         ] nsys_report_db_30000_10_20.sqlite[2/7] [14%                         ] nsys_report_db_30000_10_20.sqlite[2/7] [=15%                        ] nsys_report_db_30000_10_20.sqlite[2/7] [=16%                        ] nsys_report_db_30000_10_20.sqlite[2/7] [=17%                        ] nsys_report_db_30000_10_20.sqlite[2/7] [==18%                       ] nsys_report_db_30000_10_20.sqlite[2/7] [==19%                       ] nsys_report_db_30000_10_20.sqlite[2/7] [==20%                       ] nsys_report_db_30000_10_20.sqlite[2/7] [==21%                       ] nsys_report_db_30000_10_20.sqlite[2/7] [===22%                      ] nsys_report_db_30000_10_20.sqlite[2/7] [===23%                      ] nsys_report_db_30000_10_20.sqlite[2/7] [===24%                      ] nsys_report_db_30000_10_20.sqlite[2/7] [====25%                     ] nsys_report_db_30000_10_20.sqlite[2/7] [====26%                     ] nsys_report_db_30000_10_20.sqlite[2/7] [====27%                     ] nsys_report_db_30000_10_20.sqlite[2/7] [====28%                     ] nsys_report_db_30000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_10_20.sqlite[2/7] [======33%                   ] nsys_report_db_30000_10_20.sqlite[2/7] [======34%                   ] nsys_report_db_30000_10_20.sqlite[2/7] [======35%                   ] nsys_report_db_30000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_10_20.sqlite[2/7] [========40%                 ] nsys_report_db_30000_10_20.sqlite[2/7] [========41%                 ] nsys_report_db_30000_10_20.sqlite[2/7] [========42%                 ] nsys_report_db_30000_10_20.sqlite[2/7] [=========43%                ] nsys_report_db_30000_10_20.sqlite[2/7] [=========44%                ] nsys_report_db_30000_10_20.sqlite[2/7] [=========45%                ] nsys_report_db_30000_10_20.sqlite[2/7] [=========46%                ] nsys_report_db_30000_10_20.sqlite[2/7] [==========47%               ] nsys_report_db_30000_10_20.sqlite[2/7] [==========48%               ] nsys_report_db_30000_10_20.sqlite[2/7] [==========49%               ] nsys_report_db_30000_10_20.sqlite[2/7] [===========50%              ] nsys_report_db_30000_10_20.sqlite[2/7] [===========51%              ] nsys_report_db_30000_10_20.sqlite[2/7] [===========52%              ] nsys_report_db_30000_10_20.sqlite[2/7] [===========53%              ] nsys_report_db_30000_10_20.sqlite[2/7] [============54%             ] nsys_report_db_30000_10_20.sqlite[2/7] [============55%             ] nsys_report_db_30000_10_20.sqlite[2/7] [============56%             ] nsys_report_db_30000_10_20.sqlite[2/7] [============57%             ] nsys_report_db_30000_10_20.sqlite[2/7] [=============58%            ] nsys_report_db_30000_10_20.sqlite[2/7] [=============59%            ] nsys_report_db_30000_10_20.sqlite[2/7] [=============60%            ] nsys_report_db_30000_10_20.sqlite[2/7] [==============61%           ] nsys_report_db_30000_10_20.sqlite[2/7] [==============62%           ] nsys_report_db_30000_10_20.sqlite[2/7] [==============63%           ] nsys_report_db_30000_10_20.sqlite[2/7] [==============64%           ] nsys_report_db_30000_10_20.sqlite[2/7] [===============65%          ] nsys_report_db_30000_10_20.sqlite[2/7] [===============66%          ] nsys_report_db_30000_10_20.sqlite[2/7] [===============67%          ] nsys_report_db_30000_10_20.sqlite[2/7] [================68%         ] nsys_report_db_30000_10_20.sqlite[2/7] [================69%         ] nsys_report_db_30000_10_20.sqlite[2/7] [================70%         ] nsys_report_db_30000_10_20.sqlite[2/7] [================71%         ] nsys_report_db_30000_10_20.sqlite[2/7] [=================72%        ] nsys_report_db_30000_10_20.sqlite[2/7] [=================73%        ] nsys_report_db_30000_10_20.sqlite[2/7] [=================74%        ] nsys_report_db_30000_10_20.sqlite[2/7] [==================75%       ] nsys_report_db_30000_10_20.sqlite[2/7] [==================76%       ] nsys_report_db_30000_10_20.sqlite[2/7] [==================77%       ] nsys_report_db_30000_10_20.sqlite[2/7] [==================78%       ] nsys_report_db_30000_10_20.sqlite[2/7] [===================79%      ] nsys_report_db_30000_10_20.sqlite[2/7] [===================80%      ] nsys_report_db_30000_10_20.sqlite[2/7] [===================81%      ] nsys_report_db_30000_10_20.sqlite[2/7] [===================82%      ] nsys_report_db_30000_10_20.sqlite[2/7] [====================83%     ] nsys_report_db_30000_10_20.sqlite[2/7] [====================84%     ] nsys_report_db_30000_10_20.sqlite[2/7] [====================85%     ] nsys_report_db_30000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_10_20.sqlite[2/7] [======================90%   ] nsys_report_db_30000_10_20.sqlite[2/7] [======================91%   ] nsys_report_db_30000_10_20.sqlite[2/7] [======================92%   ] nsys_report_db_30000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_10_20.sqlite[2/7] [========================97% ] nsys_report_db_30000_10_20.sqlite[2/7] [========================98% ] nsys_report_db_30000_10_20.sqlite[2/7] [========================99% ] nsys_report_db_30000_10_20.sqlite[2/7] [========================100%] nsys_report_db_30000_10_20.sqlite[2/7] [========================100%] nsys_report_db_30000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        284650424          1  284650424.0  284650424.0  284650424  284650424          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        162940842          1  162940842.0  162940842.0  162940842  162940842          0.0  cudaFree                      
      1.1          1751523          6     291920.5     256719.0       3710     702409     275137.9  cudaMalloc                    
      0.2           271222        814        333.2        290.0        120       1100        167.6  cuGetProcAddress_v2           
      0.0            38331          2      19165.5      19165.5       2830      35501      23101.9  cudaStreamCreateWithFlags     
      0.0            19670         18       1092.8        505.0        390       9290       2070.3  cudaEventCreateWithFlags      
      0.0             4420          3       1473.3       1650.0        670       2100        731.2  cuInit                        
      0.0             3360          3       1120.0        260.0        160       2940       1577.0  cuModuleGetLoadingMode        
      0.0              970          2        485.0        485.0        410        560        106.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 10 (num_steps = 20), identity_test = 0
Generating '/tmp/nsys-report-e538.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_10_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_10_20.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_10_20.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_10_20.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_10_20.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_20.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [1%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [2%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [3%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [4%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [5%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [6%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [7%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [8%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [9%                          ] nsys_report_fo_30000_10_20.sqlite[2/7] [10%                         ] nsys_report_fo_30000_10_20.sqlite[2/7] [11%                         ] nsys_report_fo_30000_10_20.sqlite[2/7] [12%                         ] nsys_report_fo_30000_10_20.sqlite[2/7] [13%                         ] nsys_report_fo_30000_10_20.sqlite[2/7] [14%                         ] nsys_report_fo_30000_10_20.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_10_20.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_10_20.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_10_20.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_10_20.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_10_20.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_10_20.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_10_20.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_10_20.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_10_20.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_10_20.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_10_20.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_10_20.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_10_20.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_10_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_10_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_10_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_10_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_10_20.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_10_20.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_10_20.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_10_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_10_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_10_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_10_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_10_20.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_10_20.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_10_20.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_10_20.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_10_20.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_10_20.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_10_20.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_10_20.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_10_20.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_10_20.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_10_20.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_10_20.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_10_20.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_10_20.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_10_20.sqlite[2/7] [============54%             ] nsys_report_fo_30000_10_20.sqlite[2/7] [============55%             ] nsys_report_fo_30000_10_20.sqlite[2/7] [============56%             ] nsys_report_fo_30000_10_20.sqlite[2/7] [============57%             ] nsys_report_fo_30000_10_20.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_10_20.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_10_20.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_10_20.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_10_20.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_10_20.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_10_20.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_10_20.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_10_20.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_10_20.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_10_20.sqlite[2/7] [================68%         ] nsys_report_fo_30000_10_20.sqlite[2/7] [================69%         ] nsys_report_fo_30000_10_20.sqlite[2/7] [================70%         ] nsys_report_fo_30000_10_20.sqlite[2/7] [================71%         ] nsys_report_fo_30000_10_20.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_10_20.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_10_20.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_10_20.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_10_20.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_10_20.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_10_20.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_10_20.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_10_20.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_10_20.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_10_20.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_10_20.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_10_20.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_10_20.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_10_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_10_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_10_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_10_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_10_20.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_10_20.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_10_20.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_10_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_10_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_10_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_10_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_10_20.sqlite[2/7] [========================97% ] nsys_report_fo_30000_10_20.sqlite[2/7] [========================98% ] nsys_report_fo_30000_10_20.sqlite[2/7] [========================99% ] nsys_report_fo_30000_10_20.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_20.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        274197471          1  274197471.0  274197471.0  274197471  274197471          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        154206041          1  154206041.0  154206041.0  154206041  154206041          0.0  cudaFree                      
      1.6          2529312          9     281034.7     414245.0       3870     461396     183297.5  cudaMalloc                    
      0.2           283342        814        348.1        305.0        120       1170        177.7  cuGetProcAddress_v2           
      0.0            37500          2      18750.0      18750.0       1750      35750      24041.6  cudaStreamCreateWithFlags     
      0.0            22321         18       1240.1        470.0        390      12181       2752.1  cudaEventCreateWithFlags      
      0.0             4950          3       1650.0       1830.0        560       2560       1012.1  cuInit                        
      0.0             3490          3       1163.3        270.0        250       2970       1564.7  cuModuleGetLoadingMode        
      0.0             1010          2        505.0        505.0        310        700        275.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 10 (num_steps = 40)
number of batches= 4
Generating '/tmp/nsys-report-58ee.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_10_40.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_10_40.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_10_40.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_10_40.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_40.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [1%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [2%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [3%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [4%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [5%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [6%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [7%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [8%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [9%                          ] nsys_report_ia_30000_10_40.sqlite[2/7] [10%                         ] nsys_report_ia_30000_10_40.sqlite[2/7] [11%                         ] nsys_report_ia_30000_10_40.sqlite[2/7] [12%                         ] nsys_report_ia_30000_10_40.sqlite[2/7] [13%                         ] nsys_report_ia_30000_10_40.sqlite[2/7] [14%                         ] nsys_report_ia_30000_10_40.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_10_40.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_10_40.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_10_40.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_10_40.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_10_40.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_10_40.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_10_40.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_10_40.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_10_40.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_10_40.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_10_40.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_10_40.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_10_40.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_10_40.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_10_40.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_10_40.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_10_40.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_10_40.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_10_40.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_10_40.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_10_40.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_10_40.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_10_40.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_10_40.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_10_40.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_10_40.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_10_40.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_10_40.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_10_40.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_10_40.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_10_40.sqlite[2/7] [============54%             ] nsys_report_ia_30000_10_40.sqlite[2/7] [============55%             ] nsys_report_ia_30000_10_40.sqlite[2/7] [============56%             ] nsys_report_ia_30000_10_40.sqlite[2/7] [============57%             ] nsys_report_ia_30000_10_40.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_10_40.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_10_40.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_10_40.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_10_40.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_10_40.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_10_40.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_10_40.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_10_40.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_10_40.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_10_40.sqlite[2/7] [================68%         ] nsys_report_ia_30000_10_40.sqlite[2/7] [================69%         ] nsys_report_ia_30000_10_40.sqlite[2/7] [================70%         ] nsys_report_ia_30000_10_40.sqlite[2/7] [================71%         ] nsys_report_ia_30000_10_40.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_10_40.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_10_40.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_10_40.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_10_40.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_10_40.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_10_40.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_10_40.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_10_40.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_10_40.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_10_40.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_10_40.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_10_40.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_10_40.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_10_40.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_10_40.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_10_40.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_10_40.sqlite[2/7] [========================97% ] nsys_report_ia_30000_10_40.sqlite[2/7] [========================98% ] nsys_report_ia_30000_10_40.sqlite[2/7] [========================99% ] nsys_report_ia_30000_10_40.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_40.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        247665678          1  247665678.0  247665678.0  247665678  247665678          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        131714838          1  131714838.0  131714838.0  131714838  131714838          0.0  cudaFree                      
      1.3          1753703          6     292283.8     257584.0       3890     706669     275326.7  cudaMalloc                    
      0.2           283113        814        347.8        310.0        130       2130        167.6  cuGetProcAddress_v2           
      0.0            36871          2      18435.5      18435.5       1970      34901      23285.7  cudaStreamCreateWithFlags     
      0.0            23850         18       1325.0        515.0        400      12780       2892.4  cudaEventCreateWithFlags      
      0.0             5020          3       1673.3       2000.0        570       2450        981.6  cuInit                        
      0.0             4280          3       1426.7        390.0        180       3710       1980.2  cuModuleGetLoadingMode        
      0.0              900          2        450.0        450.0        330        570        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 10 (num_steps = 40)
number of batches= 4
Generating '/tmp/nsys-report-c823.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_10_40.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_10_40.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_10_40.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_10_40.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_40.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [1%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [2%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [3%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [4%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [5%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [6%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [7%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [8%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [9%                          ] nsys_report_db_30000_10_40.sqlite[2/7] [10%                         ] nsys_report_db_30000_10_40.sqlite[2/7] [11%                         ] nsys_report_db_30000_10_40.sqlite[2/7] [12%                         ] nsys_report_db_30000_10_40.sqlite[2/7] [13%                         ] nsys_report_db_30000_10_40.sqlite[2/7] [14%                         ] nsys_report_db_30000_10_40.sqlite[2/7] [=15%                        ] nsys_report_db_30000_10_40.sqlite[2/7] [=16%                        ] nsys_report_db_30000_10_40.sqlite[2/7] [=17%                        ] nsys_report_db_30000_10_40.sqlite[2/7] [==18%                       ] nsys_report_db_30000_10_40.sqlite[2/7] [==19%                       ] nsys_report_db_30000_10_40.sqlite[2/7] [==20%                       ] nsys_report_db_30000_10_40.sqlite[2/7] [==21%                       ] nsys_report_db_30000_10_40.sqlite[2/7] [===22%                      ] nsys_report_db_30000_10_40.sqlite[2/7] [===23%                      ] nsys_report_db_30000_10_40.sqlite[2/7] [===24%                      ] nsys_report_db_30000_10_40.sqlite[2/7] [====25%                     ] nsys_report_db_30000_10_40.sqlite[2/7] [====26%                     ] nsys_report_db_30000_10_40.sqlite[2/7] [====27%                     ] nsys_report_db_30000_10_40.sqlite[2/7] [====28%                     ] nsys_report_db_30000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_10_40.sqlite[2/7] [======33%                   ] nsys_report_db_30000_10_40.sqlite[2/7] [======34%                   ] nsys_report_db_30000_10_40.sqlite[2/7] [======35%                   ] nsys_report_db_30000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_10_40.sqlite[2/7] [========40%                 ] nsys_report_db_30000_10_40.sqlite[2/7] [========41%                 ] nsys_report_db_30000_10_40.sqlite[2/7] [========42%                 ] nsys_report_db_30000_10_40.sqlite[2/7] [=========43%                ] nsys_report_db_30000_10_40.sqlite[2/7] [=========44%                ] nsys_report_db_30000_10_40.sqlite[2/7] [=========45%                ] nsys_report_db_30000_10_40.sqlite[2/7] [=========46%                ] nsys_report_db_30000_10_40.sqlite[2/7] [==========47%               ] nsys_report_db_30000_10_40.sqlite[2/7] [==========48%               ] nsys_report_db_30000_10_40.sqlite[2/7] [==========49%               ] nsys_report_db_30000_10_40.sqlite[2/7] [===========50%              ] nsys_report_db_30000_10_40.sqlite[2/7] [===========51%              ] nsys_report_db_30000_10_40.sqlite[2/7] [===========52%              ] nsys_report_db_30000_10_40.sqlite[2/7] [===========53%              ] nsys_report_db_30000_10_40.sqlite[2/7] [============54%             ] nsys_report_db_30000_10_40.sqlite[2/7] [============55%             ] nsys_report_db_30000_10_40.sqlite[2/7] [============56%             ] nsys_report_db_30000_10_40.sqlite[2/7] [============57%             ] nsys_report_db_30000_10_40.sqlite[2/7] [=============58%            ] nsys_report_db_30000_10_40.sqlite[2/7] [=============59%            ] nsys_report_db_30000_10_40.sqlite[2/7] [=============60%            ] nsys_report_db_30000_10_40.sqlite[2/7] [==============61%           ] nsys_report_db_30000_10_40.sqlite[2/7] [==============62%           ] nsys_report_db_30000_10_40.sqlite[2/7] [==============63%           ] nsys_report_db_30000_10_40.sqlite[2/7] [==============64%           ] nsys_report_db_30000_10_40.sqlite[2/7] [===============65%          ] nsys_report_db_30000_10_40.sqlite[2/7] [===============66%          ] nsys_report_db_30000_10_40.sqlite[2/7] [===============67%          ] nsys_report_db_30000_10_40.sqlite[2/7] [================68%         ] nsys_report_db_30000_10_40.sqlite[2/7] [================69%         ] nsys_report_db_30000_10_40.sqlite[2/7] [================70%         ] nsys_report_db_30000_10_40.sqlite[2/7] [================71%         ] nsys_report_db_30000_10_40.sqlite[2/7] [=================72%        ] nsys_report_db_30000_10_40.sqlite[2/7] [=================73%        ] nsys_report_db_30000_10_40.sqlite[2/7] [=================74%        ] nsys_report_db_30000_10_40.sqlite[2/7] [==================75%       ] nsys_report_db_30000_10_40.sqlite[2/7] [==================76%       ] nsys_report_db_30000_10_40.sqlite[2/7] [==================77%       ] nsys_report_db_30000_10_40.sqlite[2/7] [==================78%       ] nsys_report_db_30000_10_40.sqlite[2/7] [===================79%      ] nsys_report_db_30000_10_40.sqlite[2/7] [===================80%      ] nsys_report_db_30000_10_40.sqlite[2/7] [===================81%      ] nsys_report_db_30000_10_40.sqlite[2/7] [===================82%      ] nsys_report_db_30000_10_40.sqlite[2/7] [====================83%     ] nsys_report_db_30000_10_40.sqlite[2/7] [====================84%     ] nsys_report_db_30000_10_40.sqlite[2/7] [====================85%     ] nsys_report_db_30000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_10_40.sqlite[2/7] [======================90%   ] nsys_report_db_30000_10_40.sqlite[2/7] [======================91%   ] nsys_report_db_30000_10_40.sqlite[2/7] [======================92%   ] nsys_report_db_30000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_10_40.sqlite[2/7] [========================97% ] nsys_report_db_30000_10_40.sqlite[2/7] [========================98% ] nsys_report_db_30000_10_40.sqlite[2/7] [========================99% ] nsys_report_db_30000_10_40.sqlite[2/7] [========================100%] nsys_report_db_30000_10_40.sqlite[2/7] [========================100%] nsys_report_db_30000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        279850487          1  279850487.0  279850487.0  279850487  279850487          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        159938490          1  159938490.0  159938490.0  159938490  159938490          0.0  cudaFree                      
      1.1          1769243          6     294873.8     265793.5       3900     704129     277763.4  cudaMalloc                    
      0.2           264842        814        325.4        280.0        120       1090        161.6  cuGetProcAddress_v2           
      0.0            32141          2      16070.5      16070.5       1880      30261      20068.4  cudaStreamCreateWithFlags     
      0.0            23400         18       1300.0        510.0        390      12690       2870.4  cudaEventCreateWithFlags      
      0.0             5450          3       1816.7       1890.0        600       2960       1181.7  cuInit                        
      0.0             3650          3       1216.7        470.0        240       2940       1496.9  cuModuleGetLoadingMode        
      0.0              870          2        435.0        435.0        310        560        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 10 (num_steps = 40), identity_test = 0
Generating '/tmp/nsys-report-0f11.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_10_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_10_40.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_10_40.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_10_40.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_10_40.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_40.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [1%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [2%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [3%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [4%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [5%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [6%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [7%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [8%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [9%                          ] nsys_report_fo_30000_10_40.sqlite[2/7] [10%                         ] nsys_report_fo_30000_10_40.sqlite[2/7] [11%                         ] nsys_report_fo_30000_10_40.sqlite[2/7] [12%                         ] nsys_report_fo_30000_10_40.sqlite[2/7] [13%                         ] nsys_report_fo_30000_10_40.sqlite[2/7] [14%                         ] nsys_report_fo_30000_10_40.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_10_40.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_10_40.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_10_40.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_10_40.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_10_40.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_10_40.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_10_40.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_10_40.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_10_40.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_10_40.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_10_40.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_10_40.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_10_40.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_10_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_10_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_10_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_10_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_10_40.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_10_40.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_10_40.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_10_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_10_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_10_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_10_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_10_40.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_10_40.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_10_40.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_10_40.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_10_40.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_10_40.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_10_40.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_10_40.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_10_40.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_10_40.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_10_40.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_10_40.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_10_40.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_10_40.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_10_40.sqlite[2/7] [============54%             ] nsys_report_fo_30000_10_40.sqlite[2/7] [============55%             ] nsys_report_fo_30000_10_40.sqlite[2/7] [============56%             ] nsys_report_fo_30000_10_40.sqlite[2/7] [============57%             ] nsys_report_fo_30000_10_40.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_10_40.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_10_40.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_10_40.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_10_40.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_10_40.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_10_40.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_10_40.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_10_40.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_10_40.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_10_40.sqlite[2/7] [================68%         ] nsys_report_fo_30000_10_40.sqlite[2/7] [================69%         ] nsys_report_fo_30000_10_40.sqlite[2/7] [================70%         ] nsys_report_fo_30000_10_40.sqlite[2/7] [================71%         ] nsys_report_fo_30000_10_40.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_10_40.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_10_40.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_10_40.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_10_40.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_10_40.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_10_40.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_10_40.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_10_40.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_10_40.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_10_40.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_10_40.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_10_40.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_10_40.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_10_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_10_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_10_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_10_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_10_40.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_10_40.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_10_40.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_10_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_10_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_10_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_10_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_10_40.sqlite[2/7] [========================97% ] nsys_report_fo_30000_10_40.sqlite[2/7] [========================98% ] nsys_report_fo_30000_10_40.sqlite[2/7] [========================99% ] nsys_report_fo_30000_10_40.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_40.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        258816364          1  258816364.0  258816364.0  258816364  258816364          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        143507114          1  143507114.0  143507114.0  143507114  143507114          0.0  cudaFree                      
      1.7          2519892          9     279988.0     396925.0       3650     452136     181497.3  cudaMalloc                    
      0.2           267043        814        328.1        280.0        120       1270        169.8  cuGetProcAddress_v2           
      0.0            38500          2      19250.0      19250.0       1810      36690      24663.9  cudaStreamCreateWithFlags     
      0.0            20400         18       1133.3        510.0        410       9480       2117.6  cudaEventCreateWithFlags      
      0.0             5190          3       1730.0       1890.0        570       2730       1088.9  cuInit                        
      0.0             3630          3       1210.0        260.0        250       3120       1654.1  cuModuleGetLoadingMode        
      0.0              960          2        480.0        480.0        330        630        212.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 10 (num_steps = 60)
number of batches= 6
Generating '/tmp/nsys-report-d9dd.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_10_60.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_10_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_10_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_10_60.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_60.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [1%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [2%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [3%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [4%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [5%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [6%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [7%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [8%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [9%                          ] nsys_report_ia_30000_10_60.sqlite[2/7] [10%                         ] nsys_report_ia_30000_10_60.sqlite[2/7] [11%                         ] nsys_report_ia_30000_10_60.sqlite[2/7] [12%                         ] nsys_report_ia_30000_10_60.sqlite[2/7] [13%                         ] nsys_report_ia_30000_10_60.sqlite[2/7] [14%                         ] nsys_report_ia_30000_10_60.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_10_60.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_10_60.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_10_60.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_10_60.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_10_60.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_10_60.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_10_60.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_10_60.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_10_60.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_10_60.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_10_60.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_10_60.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_10_60.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_10_60.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_10_60.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_10_60.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_10_60.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_10_60.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_10_60.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_10_60.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_10_60.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_10_60.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_10_60.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_10_60.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_10_60.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_10_60.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_10_60.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_10_60.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_10_60.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_10_60.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_10_60.sqlite[2/7] [============54%             ] nsys_report_ia_30000_10_60.sqlite[2/7] [============55%             ] nsys_report_ia_30000_10_60.sqlite[2/7] [============56%             ] nsys_report_ia_30000_10_60.sqlite[2/7] [============57%             ] nsys_report_ia_30000_10_60.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_10_60.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_10_60.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_10_60.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_10_60.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_10_60.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_10_60.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_10_60.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_10_60.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_10_60.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_10_60.sqlite[2/7] [================68%         ] nsys_report_ia_30000_10_60.sqlite[2/7] [================69%         ] nsys_report_ia_30000_10_60.sqlite[2/7] [================70%         ] nsys_report_ia_30000_10_60.sqlite[2/7] [================71%         ] nsys_report_ia_30000_10_60.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_10_60.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_10_60.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_10_60.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_10_60.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_10_60.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_10_60.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_10_60.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_10_60.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_10_60.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_10_60.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_10_60.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_10_60.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_10_60.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_10_60.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_10_60.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_10_60.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_10_60.sqlite[2/7] [========================97% ] nsys_report_ia_30000_10_60.sqlite[2/7] [========================98% ] nsys_report_ia_30000_10_60.sqlite[2/7] [========================99% ] nsys_report_ia_30000_10_60.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_60.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        244106916          1  244106916.0  244106916.0  244106916  244106916          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        129673298          1  129673298.0  129673298.0  129673298  129673298          0.0  cudaFree                      
      1.3          1751173          6     291862.2     265033.5       4790     691649     266680.2  cudaMalloc                    
      0.2           279124        814        342.9        290.0        110       1560        178.8  cuGetProcAddress_v2           
      0.0            34990          2      17495.0      17495.0       1890      33100      22068.8  cudaStreamCreateWithFlags     
      0.0            20510         18       1139.4        560.0        380       9520       2129.6  cudaEventCreateWithFlags      
      0.0             5320          3       1773.3       2010.0        740       2570        937.7  cuInit                        
      0.0             3560          3       1186.7        420.0        250       2890       1477.6  cuModuleGetLoadingMode        
      0.0             1120          2        560.0        560.0        310        810        353.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 10 (num_steps = 60)
number of batches= 6
Generating '/tmp/nsys-report-a7a5.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_10_60.nsys-rep[1/7] [======35%                   ] nsys_report_db_30000_10_60.nsys-rep[1/7] [================69%         ] nsys_report_db_30000_10_60.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_10_60.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_60.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [1%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [2%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [3%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [4%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [5%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [6%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [7%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [8%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [9%                          ] nsys_report_db_30000_10_60.sqlite[2/7] [10%                         ] nsys_report_db_30000_10_60.sqlite[2/7] [11%                         ] nsys_report_db_30000_10_60.sqlite[2/7] [12%                         ] nsys_report_db_30000_10_60.sqlite[2/7] [13%                         ] nsys_report_db_30000_10_60.sqlite[2/7] [14%                         ] nsys_report_db_30000_10_60.sqlite[2/7] [=15%                        ] nsys_report_db_30000_10_60.sqlite[2/7] [=16%                        ] nsys_report_db_30000_10_60.sqlite[2/7] [=17%                        ] nsys_report_db_30000_10_60.sqlite[2/7] [==18%                       ] nsys_report_db_30000_10_60.sqlite[2/7] [==19%                       ] nsys_report_db_30000_10_60.sqlite[2/7] [==20%                       ] nsys_report_db_30000_10_60.sqlite[2/7] [==21%                       ] nsys_report_db_30000_10_60.sqlite[2/7] [===22%                      ] nsys_report_db_30000_10_60.sqlite[2/7] [===23%                      ] nsys_report_db_30000_10_60.sqlite[2/7] [===24%                      ] nsys_report_db_30000_10_60.sqlite[2/7] [====25%                     ] nsys_report_db_30000_10_60.sqlite[2/7] [====26%                     ] nsys_report_db_30000_10_60.sqlite[2/7] [====27%                     ] nsys_report_db_30000_10_60.sqlite[2/7] [====28%                     ] nsys_report_db_30000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_10_60.sqlite[2/7] [======33%                   ] nsys_report_db_30000_10_60.sqlite[2/7] [======34%                   ] nsys_report_db_30000_10_60.sqlite[2/7] [======35%                   ] nsys_report_db_30000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_10_60.sqlite[2/7] [========40%                 ] nsys_report_db_30000_10_60.sqlite[2/7] [========41%                 ] nsys_report_db_30000_10_60.sqlite[2/7] [========42%                 ] nsys_report_db_30000_10_60.sqlite[2/7] [=========43%                ] nsys_report_db_30000_10_60.sqlite[2/7] [=========44%                ] nsys_report_db_30000_10_60.sqlite[2/7] [=========45%                ] nsys_report_db_30000_10_60.sqlite[2/7] [=========46%                ] nsys_report_db_30000_10_60.sqlite[2/7] [==========47%               ] nsys_report_db_30000_10_60.sqlite[2/7] [==========48%               ] nsys_report_db_30000_10_60.sqlite[2/7] [==========49%               ] nsys_report_db_30000_10_60.sqlite[2/7] [===========50%              ] nsys_report_db_30000_10_60.sqlite[2/7] [===========51%              ] nsys_report_db_30000_10_60.sqlite[2/7] [===========52%              ] nsys_report_db_30000_10_60.sqlite[2/7] [===========53%              ] nsys_report_db_30000_10_60.sqlite[2/7] [============54%             ] nsys_report_db_30000_10_60.sqlite[2/7] [============55%             ] nsys_report_db_30000_10_60.sqlite[2/7] [============56%             ] nsys_report_db_30000_10_60.sqlite[2/7] [============57%             ] nsys_report_db_30000_10_60.sqlite[2/7] [=============58%            ] nsys_report_db_30000_10_60.sqlite[2/7] [=============59%            ] nsys_report_db_30000_10_60.sqlite[2/7] [=============60%            ] nsys_report_db_30000_10_60.sqlite[2/7] [==============61%           ] nsys_report_db_30000_10_60.sqlite[2/7] [==============62%           ] nsys_report_db_30000_10_60.sqlite[2/7] [==============63%           ] nsys_report_db_30000_10_60.sqlite[2/7] [==============64%           ] nsys_report_db_30000_10_60.sqlite[2/7] [===============65%          ] nsys_report_db_30000_10_60.sqlite[2/7] [===============66%          ] nsys_report_db_30000_10_60.sqlite[2/7] [===============67%          ] nsys_report_db_30000_10_60.sqlite[2/7] [================68%         ] nsys_report_db_30000_10_60.sqlite[2/7] [================69%         ] nsys_report_db_30000_10_60.sqlite[2/7] [================70%         ] nsys_report_db_30000_10_60.sqlite[2/7] [================71%         ] nsys_report_db_30000_10_60.sqlite[2/7] [=================72%        ] nsys_report_db_30000_10_60.sqlite[2/7] [=================73%        ] nsys_report_db_30000_10_60.sqlite[2/7] [=================74%        ] nsys_report_db_30000_10_60.sqlite[2/7] [==================75%       ] nsys_report_db_30000_10_60.sqlite[2/7] [==================76%       ] nsys_report_db_30000_10_60.sqlite[2/7] [==================77%       ] nsys_report_db_30000_10_60.sqlite[2/7] [==================78%       ] nsys_report_db_30000_10_60.sqlite[2/7] [===================79%      ] nsys_report_db_30000_10_60.sqlite[2/7] [===================80%      ] nsys_report_db_30000_10_60.sqlite[2/7] [===================81%      ] nsys_report_db_30000_10_60.sqlite[2/7] [===================82%      ] nsys_report_db_30000_10_60.sqlite[2/7] [====================83%     ] nsys_report_db_30000_10_60.sqlite[2/7] [====================84%     ] nsys_report_db_30000_10_60.sqlite[2/7] [====================85%     ] nsys_report_db_30000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_10_60.sqlite[2/7] [======================90%   ] nsys_report_db_30000_10_60.sqlite[2/7] [======================91%   ] nsys_report_db_30000_10_60.sqlite[2/7] [======================92%   ] nsys_report_db_30000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_10_60.sqlite[2/7] [========================97% ] nsys_report_db_30000_10_60.sqlite[2/7] [========================98% ] nsys_report_db_30000_10_60.sqlite[2/7] [========================99% ] nsys_report_db_30000_10_60.sqlite[2/7] [========================100%] nsys_report_db_30000_10_60.sqlite[2/7] [========================100%] nsys_report_db_30000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        278626153          1  278626153.0  278626153.0  278626153  278626153          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        158270540          1  158270540.0  158270540.0  158270540  158270540          0.0  cudaFree                      
      1.1          1743951          6     290658.5     256233.5       4670     690438     271153.2  cudaMalloc                    
      0.2           281301        814        345.6        300.0        120       1270        174.0  cuGetProcAddress_v2           
      0.0            39251          2      19625.5      19625.5       1910      37341      25053.5  cudaStreamCreateWithFlags     
      0.0            24990         18       1388.3        540.0        400      13730       3097.7  cudaEventCreateWithFlags      
      0.0             5270          3       1756.7       1910.0        590       2770       1098.1  cuInit                        
      0.0             3700          3       1233.3        270.0        190       3240       1738.3  cuModuleGetLoadingMode        
      0.0              970          2        485.0        485.0        350        620        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 10 (num_steps = 60), identity_test = 0
Generating '/tmp/nsys-report-f19c.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_10_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_10_60.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_10_60.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_10_60.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_10_60.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_60.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [1%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [2%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [3%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [4%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [5%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [6%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [7%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [8%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [9%                          ] nsys_report_fo_30000_10_60.sqlite[2/7] [10%                         ] nsys_report_fo_30000_10_60.sqlite[2/7] [11%                         ] nsys_report_fo_30000_10_60.sqlite[2/7] [12%                         ] nsys_report_fo_30000_10_60.sqlite[2/7] [13%                         ] nsys_report_fo_30000_10_60.sqlite[2/7] [14%                         ] nsys_report_fo_30000_10_60.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_10_60.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_10_60.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_10_60.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_10_60.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_10_60.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_10_60.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_10_60.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_10_60.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_10_60.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_10_60.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_10_60.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_10_60.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_10_60.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_10_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_10_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_10_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_10_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_10_60.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_10_60.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_10_60.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_10_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_10_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_10_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_10_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_10_60.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_10_60.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_10_60.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_10_60.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_10_60.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_10_60.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_10_60.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_10_60.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_10_60.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_10_60.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_10_60.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_10_60.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_10_60.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_10_60.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_10_60.sqlite[2/7] [============54%             ] nsys_report_fo_30000_10_60.sqlite[2/7] [============55%             ] nsys_report_fo_30000_10_60.sqlite[2/7] [============56%             ] nsys_report_fo_30000_10_60.sqlite[2/7] [============57%             ] nsys_report_fo_30000_10_60.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_10_60.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_10_60.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_10_60.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_10_60.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_10_60.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_10_60.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_10_60.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_10_60.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_10_60.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_10_60.sqlite[2/7] [================68%         ] nsys_report_fo_30000_10_60.sqlite[2/7] [================69%         ] nsys_report_fo_30000_10_60.sqlite[2/7] [================70%         ] nsys_report_fo_30000_10_60.sqlite[2/7] [================71%         ] nsys_report_fo_30000_10_60.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_10_60.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_10_60.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_10_60.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_10_60.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_10_60.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_10_60.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_10_60.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_10_60.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_10_60.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_10_60.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_10_60.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_10_60.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_10_60.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_10_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_10_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_10_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_10_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_10_60.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_10_60.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_10_60.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_10_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_10_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_10_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_10_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_10_60.sqlite[2/7] [========================97% ] nsys_report_fo_30000_10_60.sqlite[2/7] [========================98% ] nsys_report_fo_30000_10_60.sqlite[2/7] [========================99% ] nsys_report_fo_30000_10_60.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_60.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        273787418          1  273787418.0  273787418.0  273787418  273787418          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        153892972          1  153892972.0  153892972.0  153892972  153892972          0.0  cudaFree                      
      1.6          2545841          9     282871.2     414385.0       3890     474406     184633.4  cudaMalloc                    
      0.2           249892        814        307.0        280.0        120       1090        154.7  cuGetProcAddress_v2           
      0.0            43490          2      21745.0      21745.0       2350      41140      27428.7  cudaStreamCreateWithFlags     
      0.0            20621         18       1145.6        505.0        390       9771       2195.1  cudaEventCreateWithFlags      
      0.0             4981          3       1660.3       1850.0        710       2421        871.1  cuInit                        
      0.0             3410          3       1136.7        260.0        160       2990       1605.8  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        320        610        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 10 (num_steps = 80)
number of batches= 8
Generating '/tmp/nsys-report-f17e.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_10_80.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_10_80.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_10_80.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_80.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [1%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [2%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [3%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [4%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [5%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [6%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [7%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [8%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [9%                          ] nsys_report_ia_30000_10_80.sqlite[2/7] [10%                         ] nsys_report_ia_30000_10_80.sqlite[2/7] [11%                         ] nsys_report_ia_30000_10_80.sqlite[2/7] [12%                         ] nsys_report_ia_30000_10_80.sqlite[2/7] [13%                         ] nsys_report_ia_30000_10_80.sqlite[2/7] [14%                         ] nsys_report_ia_30000_10_80.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_10_80.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_10_80.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_10_80.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_10_80.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_10_80.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_10_80.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_10_80.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_10_80.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_10_80.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_10_80.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_10_80.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_10_80.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_10_80.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_10_80.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_10_80.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_10_80.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_10_80.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_10_80.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_10_80.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_10_80.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_10_80.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_10_80.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_10_80.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_10_80.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_10_80.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_10_80.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_10_80.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_10_80.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_10_80.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_10_80.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_10_80.sqlite[2/7] [============54%             ] nsys_report_ia_30000_10_80.sqlite[2/7] [============55%             ] nsys_report_ia_30000_10_80.sqlite[2/7] [============56%             ] nsys_report_ia_30000_10_80.sqlite[2/7] [============57%             ] nsys_report_ia_30000_10_80.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_10_80.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_10_80.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_10_80.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_10_80.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_10_80.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_10_80.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_10_80.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_10_80.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_10_80.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_10_80.sqlite[2/7] [================68%         ] nsys_report_ia_30000_10_80.sqlite[2/7] [================69%         ] nsys_report_ia_30000_10_80.sqlite[2/7] [================70%         ] nsys_report_ia_30000_10_80.sqlite[2/7] [================71%         ] nsys_report_ia_30000_10_80.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_10_80.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_10_80.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_10_80.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_10_80.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_10_80.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_10_80.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_10_80.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_10_80.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_10_80.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_10_80.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_10_80.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_10_80.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_10_80.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_10_80.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_10_80.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_10_80.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_10_80.sqlite[2/7] [========================97% ] nsys_report_ia_30000_10_80.sqlite[2/7] [========================98% ] nsys_report_ia_30000_10_80.sqlite[2/7] [========================99% ] nsys_report_ia_30000_10_80.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_80.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        246840719          1  246840719.0  246840719.0  246840719  246840719          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        130342657          1  130342657.0  130342657.0  130342657  130342657          0.0  cudaFree                      
      1.3          1743242          6     290540.3     249858.5       3890     704919     274489.8  cudaMalloc                    
      0.2           286355        814        351.8        290.0        120      12410        459.3  cuGetProcAddress_v2           
      0.0            40751          2      20375.5      20375.5       2080      38671      25873.7  cudaStreamCreateWithFlags     
      0.0            26370         18       1465.0        520.0        400      16130       3672.3  cudaEventCreateWithFlags      
      0.0             5980          3       1993.3       2570.0        700       2710       1122.2  cuInit                        
      0.0             3430          3       1143.3        290.0        160       2980       1591.9  cuModuleGetLoadingMode        
      0.0              980          2        490.0        490.0        340        640        212.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 10 (num_steps = 80)
number of batches= 8
Generating '/tmp/nsys-report-a247.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_10_80.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_10_80.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_10_80.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_80.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [1%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [2%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [3%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [4%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [5%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [6%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [7%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [8%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [9%                          ] nsys_report_db_30000_10_80.sqlite[2/7] [10%                         ] nsys_report_db_30000_10_80.sqlite[2/7] [11%                         ] nsys_report_db_30000_10_80.sqlite[2/7] [12%                         ] nsys_report_db_30000_10_80.sqlite[2/7] [13%                         ] nsys_report_db_30000_10_80.sqlite[2/7] [14%                         ] nsys_report_db_30000_10_80.sqlite[2/7] [=15%                        ] nsys_report_db_30000_10_80.sqlite[2/7] [=16%                        ] nsys_report_db_30000_10_80.sqlite[2/7] [=17%                        ] nsys_report_db_30000_10_80.sqlite[2/7] [==18%                       ] nsys_report_db_30000_10_80.sqlite[2/7] [==19%                       ] nsys_report_db_30000_10_80.sqlite[2/7] [==20%                       ] nsys_report_db_30000_10_80.sqlite[2/7] [==21%                       ] nsys_report_db_30000_10_80.sqlite[2/7] [===22%                      ] nsys_report_db_30000_10_80.sqlite[2/7] [===23%                      ] nsys_report_db_30000_10_80.sqlite[2/7] [===24%                      ] nsys_report_db_30000_10_80.sqlite[2/7] [====25%                     ] nsys_report_db_30000_10_80.sqlite[2/7] [====26%                     ] nsys_report_db_30000_10_80.sqlite[2/7] [====27%                     ] nsys_report_db_30000_10_80.sqlite[2/7] [====28%                     ] nsys_report_db_30000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_10_80.sqlite[2/7] [======33%                   ] nsys_report_db_30000_10_80.sqlite[2/7] [======34%                   ] nsys_report_db_30000_10_80.sqlite[2/7] [======35%                   ] nsys_report_db_30000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_10_80.sqlite[2/7] [========40%                 ] nsys_report_db_30000_10_80.sqlite[2/7] [========41%                 ] nsys_report_db_30000_10_80.sqlite[2/7] [========42%                 ] nsys_report_db_30000_10_80.sqlite[2/7] [=========43%                ] nsys_report_db_30000_10_80.sqlite[2/7] [=========44%                ] nsys_report_db_30000_10_80.sqlite[2/7] [=========45%                ] nsys_report_db_30000_10_80.sqlite[2/7] [=========46%                ] nsys_report_db_30000_10_80.sqlite[2/7] [==========47%               ] nsys_report_db_30000_10_80.sqlite[2/7] [==========48%               ] nsys_report_db_30000_10_80.sqlite[2/7] [==========49%               ] nsys_report_db_30000_10_80.sqlite[2/7] [===========50%              ] nsys_report_db_30000_10_80.sqlite[2/7] [===========51%              ] nsys_report_db_30000_10_80.sqlite[2/7] [===========52%              ] nsys_report_db_30000_10_80.sqlite[2/7] [===========53%              ] nsys_report_db_30000_10_80.sqlite[2/7] [============54%             ] nsys_report_db_30000_10_80.sqlite[2/7] [============55%             ] nsys_report_db_30000_10_80.sqlite[2/7] [============56%             ] nsys_report_db_30000_10_80.sqlite[2/7] [============57%             ] nsys_report_db_30000_10_80.sqlite[2/7] [=============58%            ] nsys_report_db_30000_10_80.sqlite[2/7] [=============59%            ] nsys_report_db_30000_10_80.sqlite[2/7] [=============60%            ] nsys_report_db_30000_10_80.sqlite[2/7] [==============61%           ] nsys_report_db_30000_10_80.sqlite[2/7] [==============62%           ] nsys_report_db_30000_10_80.sqlite[2/7] [==============63%           ] nsys_report_db_30000_10_80.sqlite[2/7] [==============64%           ] nsys_report_db_30000_10_80.sqlite[2/7] [===============65%          ] nsys_report_db_30000_10_80.sqlite[2/7] [===============66%          ] nsys_report_db_30000_10_80.sqlite[2/7] [===============67%          ] nsys_report_db_30000_10_80.sqlite[2/7] [================68%         ] nsys_report_db_30000_10_80.sqlite[2/7] [================69%         ] nsys_report_db_30000_10_80.sqlite[2/7] [================70%         ] nsys_report_db_30000_10_80.sqlite[2/7] [================71%         ] nsys_report_db_30000_10_80.sqlite[2/7] [=================72%        ] nsys_report_db_30000_10_80.sqlite[2/7] [=================73%        ] nsys_report_db_30000_10_80.sqlite[2/7] [=================74%        ] nsys_report_db_30000_10_80.sqlite[2/7] [==================75%       ] nsys_report_db_30000_10_80.sqlite[2/7] [==================76%       ] nsys_report_db_30000_10_80.sqlite[2/7] [==================77%       ] nsys_report_db_30000_10_80.sqlite[2/7] [==================78%       ] nsys_report_db_30000_10_80.sqlite[2/7] [===================79%      ] nsys_report_db_30000_10_80.sqlite[2/7] [===================80%      ] nsys_report_db_30000_10_80.sqlite[2/7] [===================81%      ] nsys_report_db_30000_10_80.sqlite[2/7] [===================82%      ] nsys_report_db_30000_10_80.sqlite[2/7] [====================83%     ] nsys_report_db_30000_10_80.sqlite[2/7] [====================84%     ] nsys_report_db_30000_10_80.sqlite[2/7] [====================85%     ] nsys_report_db_30000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_10_80.sqlite[2/7] [======================90%   ] nsys_report_db_30000_10_80.sqlite[2/7] [======================91%   ] nsys_report_db_30000_10_80.sqlite[2/7] [======================92%   ] nsys_report_db_30000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_10_80.sqlite[2/7] [========================97% ] nsys_report_db_30000_10_80.sqlite[2/7] [========================98% ] nsys_report_db_30000_10_80.sqlite[2/7] [========================99% ] nsys_report_db_30000_10_80.sqlite[2/7] [========================100%] nsys_report_db_30000_10_80.sqlite[2/7] [========================100%] nsys_report_db_30000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        268999234          1  268999234.0  268999234.0  268999234  268999234          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        152885408          1  152885408.0  152885408.0  152885408  152885408          0.0  cudaFree                      
      1.1          1758733          6     293122.2     263133.5       3990     695679     273359.3  cudaMalloc                    
      0.2           262681        814        322.7        290.0        120       1380        166.2  cuGetProcAddress_v2           
      0.0            32611          2      16305.5      16305.5       2010      30601      20216.9  cudaStreamCreateWithFlags     
      0.0            26510         18       1472.8        510.0        390      15490       3526.7  cudaEventCreateWithFlags      
      0.0             4340          3       1446.7        250.0        160       3930       2151.1  cuModuleGetLoadingMode        
      0.0             4260          3       1420.0       1500.0        620       2140        763.2  cuInit                        
      0.0              930          2        465.0        465.0        300        630        233.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 10 (num_steps = 80), identity_test = 0
Generating '/tmp/nsys-report-3a66.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_10_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_10_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_10_80.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_10_80.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_10_80.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_80.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [1%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [2%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [3%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [4%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [5%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [6%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [7%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [8%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [9%                          ] nsys_report_fo_30000_10_80.sqlite[2/7] [10%                         ] nsys_report_fo_30000_10_80.sqlite[2/7] [11%                         ] nsys_report_fo_30000_10_80.sqlite[2/7] [12%                         ] nsys_report_fo_30000_10_80.sqlite[2/7] [13%                         ] nsys_report_fo_30000_10_80.sqlite[2/7] [14%                         ] nsys_report_fo_30000_10_80.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_10_80.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_10_80.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_10_80.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_10_80.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_10_80.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_10_80.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_10_80.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_10_80.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_10_80.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_10_80.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_10_80.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_10_80.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_10_80.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_10_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_10_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_10_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_10_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_10_80.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_10_80.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_10_80.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_10_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_10_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_10_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_10_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_10_80.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_10_80.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_10_80.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_10_80.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_10_80.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_10_80.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_10_80.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_10_80.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_10_80.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_10_80.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_10_80.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_10_80.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_10_80.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_10_80.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_10_80.sqlite[2/7] [============54%             ] nsys_report_fo_30000_10_80.sqlite[2/7] [============55%             ] nsys_report_fo_30000_10_80.sqlite[2/7] [============56%             ] nsys_report_fo_30000_10_80.sqlite[2/7] [============57%             ] nsys_report_fo_30000_10_80.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_10_80.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_10_80.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_10_80.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_10_80.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_10_80.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_10_80.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_10_80.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_10_80.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_10_80.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_10_80.sqlite[2/7] [================68%         ] nsys_report_fo_30000_10_80.sqlite[2/7] [================69%         ] nsys_report_fo_30000_10_80.sqlite[2/7] [================70%         ] nsys_report_fo_30000_10_80.sqlite[2/7] [================71%         ] nsys_report_fo_30000_10_80.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_10_80.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_10_80.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_10_80.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_10_80.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_10_80.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_10_80.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_10_80.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_10_80.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_10_80.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_10_80.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_10_80.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_10_80.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_10_80.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_10_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_10_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_10_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_10_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_10_80.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_10_80.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_10_80.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_10_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_10_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_10_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_10_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_10_80.sqlite[2/7] [========================97% ] nsys_report_fo_30000_10_80.sqlite[2/7] [========================98% ] nsys_report_fo_30000_10_80.sqlite[2/7] [========================99% ] nsys_report_fo_30000_10_80.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_80.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        275034306          1  275034306.0  275034306.0  275034306  275034306          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        155173194          1  155173194.0  155173194.0  155173194  155173194          0.0  cudaFree                      
      1.6          2523251          9     280361.2     412375.0       4080     467216     181339.8  cudaMalloc                    
      0.2           275262        814        338.2        300.0        120       1490        167.4  cuGetProcAddress_v2           
      0.0            37551          2      18775.5      18775.5       1810      35741      23992.8  cudaStreamCreateWithFlags     
      0.0            23541         18       1307.8        485.0        410      12791       2892.8  cudaEventCreateWithFlags      
      0.0             5110          3       1703.3       2140.0        630       2340        934.9  cuInit                        
      0.0             3530          3       1176.7        280.0        260       2990       1570.4  cuModuleGetLoadingMode        
      0.0             1220          2        610.0        610.0        310        910        424.3  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 10 (num_steps = 100)
number of batches= 10
Generating '/tmp/nsys-report-f7d7.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_10_100.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_10_100.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_10_100.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_10_100.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_100.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [1%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [2%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [3%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [4%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [5%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [6%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [7%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [8%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [9%                          ] nsys_report_ia_30000_10_100.sqlite[2/7] [10%                         ] nsys_report_ia_30000_10_100.sqlite[2/7] [11%                         ] nsys_report_ia_30000_10_100.sqlite[2/7] [12%                         ] nsys_report_ia_30000_10_100.sqlite[2/7] [13%                         ] nsys_report_ia_30000_10_100.sqlite[2/7] [14%                         ] nsys_report_ia_30000_10_100.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_10_100.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_10_100.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_10_100.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_10_100.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_10_100.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_10_100.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_10_100.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_10_100.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_10_100.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_10_100.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_10_100.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_10_100.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_10_100.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_10_100.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_10_100.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_10_100.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_10_100.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_10_100.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_10_100.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_10_100.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_10_100.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_10_100.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_10_100.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_10_100.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_10_100.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_10_100.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_10_100.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_10_100.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_10_100.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_10_100.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_10_100.sqlite[2/7] [============54%             ] nsys_report_ia_30000_10_100.sqlite[2/7] [============55%             ] nsys_report_ia_30000_10_100.sqlite[2/7] [============56%             ] nsys_report_ia_30000_10_100.sqlite[2/7] [============57%             ] nsys_report_ia_30000_10_100.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_10_100.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_10_100.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_10_100.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_10_100.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_10_100.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_10_100.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_10_100.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_10_100.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_10_100.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_10_100.sqlite[2/7] [================68%         ] nsys_report_ia_30000_10_100.sqlite[2/7] [================69%         ] nsys_report_ia_30000_10_100.sqlite[2/7] [================70%         ] nsys_report_ia_30000_10_100.sqlite[2/7] [================71%         ] nsys_report_ia_30000_10_100.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_10_100.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_10_100.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_10_100.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_10_100.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_10_100.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_10_100.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_10_100.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_10_100.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_10_100.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_10_100.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_10_100.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_10_100.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_10_100.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_10_100.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_10_100.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_10_100.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_10_100.sqlite[2/7] [========================97% ] nsys_report_ia_30000_10_100.sqlite[2/7] [========================98% ] nsys_report_ia_30000_10_100.sqlite[2/7] [========================99% ] nsys_report_ia_30000_10_100.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_100.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245203013          1  245203013.0  245203013.0  245203013  245203013          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        129043277          1  129043277.0  129043277.0  129043277  129043277          0.0  cudaFree                      
      1.3          1733893          6     288982.2     251823.5       3720     691799     270916.8  cudaMalloc                    
      0.2           287605        814        353.3        310.0        120       1460        185.2  cuGetProcAddress_v2           
      0.0            37470          2      18735.0      18735.0       1960      35510      23723.4  cudaStreamCreateWithFlags     
      0.0            19510         18       1083.9        500.0        390       9170       2051.0  cudaEventCreateWithFlags      
      0.0             4850          3       1616.7       1520.0        620       2710       1048.3  cuInit                        
      0.0             3180          3       1060.0        260.0        150       2770       1481.9  cuModuleGetLoadingMode        
      0.0              910          2        455.0        455.0        330        580        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 10 (num_steps = 100)
number of batches= 10
Generating '/tmp/nsys-report-f76b.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_10_100.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_10_100.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_10_100.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_10_100.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_100.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [1%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [2%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [3%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [4%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [5%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [6%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [7%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [8%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [9%                          ] nsys_report_db_30000_10_100.sqlite[2/7] [10%                         ] nsys_report_db_30000_10_100.sqlite[2/7] [11%                         ] nsys_report_db_30000_10_100.sqlite[2/7] [12%                         ] nsys_report_db_30000_10_100.sqlite[2/7] [13%                         ] nsys_report_db_30000_10_100.sqlite[2/7] [14%                         ] nsys_report_db_30000_10_100.sqlite[2/7] [=15%                        ] nsys_report_db_30000_10_100.sqlite[2/7] [=16%                        ] nsys_report_db_30000_10_100.sqlite[2/7] [=17%                        ] nsys_report_db_30000_10_100.sqlite[2/7] [==18%                       ] nsys_report_db_30000_10_100.sqlite[2/7] [==19%                       ] nsys_report_db_30000_10_100.sqlite[2/7] [==20%                       ] nsys_report_db_30000_10_100.sqlite[2/7] [==21%                       ] nsys_report_db_30000_10_100.sqlite[2/7] [===22%                      ] nsys_report_db_30000_10_100.sqlite[2/7] [===23%                      ] nsys_report_db_30000_10_100.sqlite[2/7] [===24%                      ] nsys_report_db_30000_10_100.sqlite[2/7] [====25%                     ] nsys_report_db_30000_10_100.sqlite[2/7] [====26%                     ] nsys_report_db_30000_10_100.sqlite[2/7] [====27%                     ] nsys_report_db_30000_10_100.sqlite[2/7] [====28%                     ] nsys_report_db_30000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_10_100.sqlite[2/7] [======33%                   ] nsys_report_db_30000_10_100.sqlite[2/7] [======34%                   ] nsys_report_db_30000_10_100.sqlite[2/7] [======35%                   ] nsys_report_db_30000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_10_100.sqlite[2/7] [========40%                 ] nsys_report_db_30000_10_100.sqlite[2/7] [========41%                 ] nsys_report_db_30000_10_100.sqlite[2/7] [========42%                 ] nsys_report_db_30000_10_100.sqlite[2/7] [=========43%                ] nsys_report_db_30000_10_100.sqlite[2/7] [=========44%                ] nsys_report_db_30000_10_100.sqlite[2/7] [=========45%                ] nsys_report_db_30000_10_100.sqlite[2/7] [=========46%                ] nsys_report_db_30000_10_100.sqlite[2/7] [==========47%               ] nsys_report_db_30000_10_100.sqlite[2/7] [==========48%               ] nsys_report_db_30000_10_100.sqlite[2/7] [==========49%               ] nsys_report_db_30000_10_100.sqlite[2/7] [===========50%              ] nsys_report_db_30000_10_100.sqlite[2/7] [===========51%              ] nsys_report_db_30000_10_100.sqlite[2/7] [===========52%              ] nsys_report_db_30000_10_100.sqlite[2/7] [===========53%              ] nsys_report_db_30000_10_100.sqlite[2/7] [============54%             ] nsys_report_db_30000_10_100.sqlite[2/7] [============55%             ] nsys_report_db_30000_10_100.sqlite[2/7] [============56%             ] nsys_report_db_30000_10_100.sqlite[2/7] [============57%             ] nsys_report_db_30000_10_100.sqlite[2/7] [=============58%            ] nsys_report_db_30000_10_100.sqlite[2/7] [=============59%            ] nsys_report_db_30000_10_100.sqlite[2/7] [=============60%            ] nsys_report_db_30000_10_100.sqlite[2/7] [==============61%           ] nsys_report_db_30000_10_100.sqlite[2/7] [==============62%           ] nsys_report_db_30000_10_100.sqlite[2/7] [==============63%           ] nsys_report_db_30000_10_100.sqlite[2/7] [==============64%           ] nsys_report_db_30000_10_100.sqlite[2/7] [===============65%          ] nsys_report_db_30000_10_100.sqlite[2/7] [===============66%          ] nsys_report_db_30000_10_100.sqlite[2/7] [===============67%          ] nsys_report_db_30000_10_100.sqlite[2/7] [================68%         ] nsys_report_db_30000_10_100.sqlite[2/7] [================69%         ] nsys_report_db_30000_10_100.sqlite[2/7] [================70%         ] nsys_report_db_30000_10_100.sqlite[2/7] [================71%         ] nsys_report_db_30000_10_100.sqlite[2/7] [=================72%        ] nsys_report_db_30000_10_100.sqlite[2/7] [=================73%        ] nsys_report_db_30000_10_100.sqlite[2/7] [=================74%        ] nsys_report_db_30000_10_100.sqlite[2/7] [==================75%       ] nsys_report_db_30000_10_100.sqlite[2/7] [==================76%       ] nsys_report_db_30000_10_100.sqlite[2/7] [==================77%       ] nsys_report_db_30000_10_100.sqlite[2/7] [==================78%       ] nsys_report_db_30000_10_100.sqlite[2/7] [===================79%      ] nsys_report_db_30000_10_100.sqlite[2/7] [===================80%      ] nsys_report_db_30000_10_100.sqlite[2/7] [===================81%      ] nsys_report_db_30000_10_100.sqlite[2/7] [===================82%      ] nsys_report_db_30000_10_100.sqlite[2/7] [====================83%     ] nsys_report_db_30000_10_100.sqlite[2/7] [====================84%     ] nsys_report_db_30000_10_100.sqlite[2/7] [====================85%     ] nsys_report_db_30000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_10_100.sqlite[2/7] [======================90%   ] nsys_report_db_30000_10_100.sqlite[2/7] [======================91%   ] nsys_report_db_30000_10_100.sqlite[2/7] [======================92%   ] nsys_report_db_30000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_10_100.sqlite[2/7] [========================97% ] nsys_report_db_30000_10_100.sqlite[2/7] [========================98% ] nsys_report_db_30000_10_100.sqlite[2/7] [========================99% ] nsys_report_db_30000_10_100.sqlite[2/7] [========================100%] nsys_report_db_30000_10_100.sqlite[2/7] [========================100%] nsys_report_db_30000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        274782731          1  274782731.0  274782731.0  274782731  274782731          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        155097542          1  155097542.0  155097542.0  155097542  155097542          0.0  cudaFree                      
      1.1          1764872          6     294145.3     264223.0       3560     702419     276170.4  cudaMalloc                    
      0.2           278533        814        342.2        300.0        120       1210        172.0  cuGetProcAddress_v2           
      0.0            33950          2      16975.0      16975.0       1870      32080      21361.7  cudaStreamCreateWithFlags     
      0.0            19611         18       1089.5        520.0        400       8931       1990.7  cudaEventCreateWithFlags      
      0.0             4640          3       1546.7       1310.0        790       2540        898.7  cuInit                        
      0.0             3530          3       1176.7        270.0        170       3090       1657.7  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        330        600        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 10 (num_steps = 100), identity_test = 0
Generating '/tmp/nsys-report-a0b9.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_10_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_10_100.nsys-rep[1/7] [=====32%                    ] nsys_report_fo_30000_10_100.nsys-rep[1/7] [===============65%          ] nsys_report_fo_30000_10_100.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_10_100.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_100.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [1%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [2%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [3%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [4%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [5%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [6%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [7%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [8%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [9%                          ] nsys_report_fo_30000_10_100.sqlite[2/7] [10%                         ] nsys_report_fo_30000_10_100.sqlite[2/7] [11%                         ] nsys_report_fo_30000_10_100.sqlite[2/7] [12%                         ] nsys_report_fo_30000_10_100.sqlite[2/7] [13%                         ] nsys_report_fo_30000_10_100.sqlite[2/7] [14%                         ] nsys_report_fo_30000_10_100.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_10_100.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_10_100.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_10_100.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_10_100.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_10_100.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_10_100.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_10_100.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_10_100.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_10_100.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_10_100.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_10_100.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_10_100.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_10_100.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_10_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_10_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_10_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_10_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_10_100.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_10_100.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_10_100.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_10_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_10_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_10_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_10_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_10_100.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_10_100.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_10_100.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_10_100.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_10_100.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_10_100.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_10_100.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_10_100.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_10_100.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_10_100.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_10_100.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_10_100.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_10_100.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_10_100.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_10_100.sqlite[2/7] [============54%             ] nsys_report_fo_30000_10_100.sqlite[2/7] [============55%             ] nsys_report_fo_30000_10_100.sqlite[2/7] [============56%             ] nsys_report_fo_30000_10_100.sqlite[2/7] [============57%             ] nsys_report_fo_30000_10_100.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_10_100.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_10_100.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_10_100.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_10_100.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_10_100.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_10_100.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_10_100.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_10_100.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_10_100.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_10_100.sqlite[2/7] [================68%         ] nsys_report_fo_30000_10_100.sqlite[2/7] [================69%         ] nsys_report_fo_30000_10_100.sqlite[2/7] [================70%         ] nsys_report_fo_30000_10_100.sqlite[2/7] [================71%         ] nsys_report_fo_30000_10_100.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_10_100.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_10_100.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_10_100.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_10_100.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_10_100.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_10_100.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_10_100.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_10_100.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_10_100.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_10_100.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_10_100.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_10_100.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_10_100.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_10_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_10_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_10_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_10_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_10_100.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_10_100.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_10_100.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_10_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_10_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_10_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_10_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_10_100.sqlite[2/7] [========================97% ] nsys_report_fo_30000_10_100.sqlite[2/7] [========================98% ] nsys_report_fo_30000_10_100.sqlite[2/7] [========================99% ] nsys_report_fo_30000_10_100.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_100.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        275554329          1  275554329.0  275554329.0  275554329  275554329          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        155084972          1  155084972.0  155084972.0  155084972  155084972          0.0  cudaFree                      
      1.6          2507571          9     278619.0     401785.0       4340     451975     180701.8  cudaMalloc                    
      0.2           288204        814        354.1        300.0        110       1270        181.4  cuGetProcAddress_v2           
      0.0            44641          2      22320.5      22320.5       1960      42681      28794.1  cudaStreamCreateWithFlags     
      0.0            29420         18       1634.4        520.0        390      18790       4295.5  cudaEventCreateWithFlags      
      0.0             5020          3       1673.3       1740.0        840       2440        802.1  cuInit                        
      0.0             3160          3       1053.3        370.0        160       2630       1369.5  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        320        610        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 10 (num_steps = 150)
number of batches= 15
Generating '/tmp/nsys-report-3a42.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_10_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_10_150.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_150.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [1%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [2%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [3%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [4%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [5%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [6%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [7%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [8%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [9%                          ] nsys_report_ia_30000_10_150.sqlite[2/7] [10%                         ] nsys_report_ia_30000_10_150.sqlite[2/7] [11%                         ] nsys_report_ia_30000_10_150.sqlite[2/7] [12%                         ] nsys_report_ia_30000_10_150.sqlite[2/7] [13%                         ] nsys_report_ia_30000_10_150.sqlite[2/7] [14%                         ] nsys_report_ia_30000_10_150.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_10_150.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_10_150.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_10_150.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_10_150.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_10_150.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_10_150.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_10_150.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_10_150.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_10_150.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_10_150.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_10_150.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_10_150.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_10_150.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_10_150.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_10_150.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_10_150.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_10_150.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_10_150.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_10_150.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_10_150.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_10_150.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_10_150.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_10_150.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_10_150.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_10_150.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_10_150.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_10_150.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_10_150.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_10_150.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_10_150.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_10_150.sqlite[2/7] [============54%             ] nsys_report_ia_30000_10_150.sqlite[2/7] [============55%             ] nsys_report_ia_30000_10_150.sqlite[2/7] [============56%             ] nsys_report_ia_30000_10_150.sqlite[2/7] [============57%             ] nsys_report_ia_30000_10_150.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_10_150.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_10_150.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_10_150.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_10_150.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_10_150.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_10_150.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_10_150.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_10_150.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_10_150.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_10_150.sqlite[2/7] [================68%         ] nsys_report_ia_30000_10_150.sqlite[2/7] [================69%         ] nsys_report_ia_30000_10_150.sqlite[2/7] [================70%         ] nsys_report_ia_30000_10_150.sqlite[2/7] [================71%         ] nsys_report_ia_30000_10_150.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_10_150.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_10_150.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_10_150.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_10_150.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_10_150.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_10_150.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_10_150.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_10_150.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_10_150.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_10_150.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_10_150.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_10_150.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_10_150.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_10_150.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_10_150.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_10_150.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_10_150.sqlite[2/7] [========================97% ] nsys_report_ia_30000_10_150.sqlite[2/7] [========================98% ] nsys_report_ia_30000_10_150.sqlite[2/7] [========================99% ] nsys_report_ia_30000_10_150.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_150.sqlite[2/7] [========================100%] nsys_report_ia_30000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        242398193          1  242398193.0  242398193.0  242398193  242398193          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.5        132839912          1  132839912.0  132839912.0  132839912  132839912          0.0  cudaFree                      
      1.3          1720712          6     286785.3     248478.5       5140     700189     270732.2  cudaMalloc                    
      0.2           293195        814        360.2        310.0        120       1160        182.7  cuGetProcAddress_v2           
      0.0            33321          2      16660.5      16660.5       2110      31211      20577.5  cudaStreamCreateWithFlags     
      0.0            19020         18       1056.7        535.0        410       9310       2075.1  cudaEventCreateWithFlags      
      0.0             4470          3       1490.0       1810.0        610       2050        771.5  cuInit                        
      0.0             3630          3       1210.0        280.0        200       3150       1680.6  cuModuleGetLoadingMode        
      0.0              970          2        485.0        485.0        330        640        219.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_10_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 10 (num_steps = 150)
number of batches= 15
Generating '/tmp/nsys-report-511e.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_10_150.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_10_150.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_150.nsys-rep[1/7] [========================100%] nsys_report_db_30000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [1%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [2%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [3%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [4%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [5%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [6%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [7%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [8%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [9%                          ] nsys_report_db_30000_10_150.sqlite[2/7] [10%                         ] nsys_report_db_30000_10_150.sqlite[2/7] [11%                         ] nsys_report_db_30000_10_150.sqlite[2/7] [12%                         ] nsys_report_db_30000_10_150.sqlite[2/7] [13%                         ] nsys_report_db_30000_10_150.sqlite[2/7] [14%                         ] nsys_report_db_30000_10_150.sqlite[2/7] [=15%                        ] nsys_report_db_30000_10_150.sqlite[2/7] [=16%                        ] nsys_report_db_30000_10_150.sqlite[2/7] [=17%                        ] nsys_report_db_30000_10_150.sqlite[2/7] [==18%                       ] nsys_report_db_30000_10_150.sqlite[2/7] [==19%                       ] nsys_report_db_30000_10_150.sqlite[2/7] [==20%                       ] nsys_report_db_30000_10_150.sqlite[2/7] [==21%                       ] nsys_report_db_30000_10_150.sqlite[2/7] [===22%                      ] nsys_report_db_30000_10_150.sqlite[2/7] [===23%                      ] nsys_report_db_30000_10_150.sqlite[2/7] [===24%                      ] nsys_report_db_30000_10_150.sqlite[2/7] [====25%                     ] nsys_report_db_30000_10_150.sqlite[2/7] [====26%                     ] nsys_report_db_30000_10_150.sqlite[2/7] [====27%                     ] nsys_report_db_30000_10_150.sqlite[2/7] [====28%                     ] nsys_report_db_30000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_10_150.sqlite[2/7] [======33%                   ] nsys_report_db_30000_10_150.sqlite[2/7] [======34%                   ] nsys_report_db_30000_10_150.sqlite[2/7] [======35%                   ] nsys_report_db_30000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_10_150.sqlite[2/7] [========40%                 ] nsys_report_db_30000_10_150.sqlite[2/7] [========41%                 ] nsys_report_db_30000_10_150.sqlite[2/7] [========42%                 ] nsys_report_db_30000_10_150.sqlite[2/7] [=========43%                ] nsys_report_db_30000_10_150.sqlite[2/7] [=========44%                ] nsys_report_db_30000_10_150.sqlite[2/7] [=========45%                ] nsys_report_db_30000_10_150.sqlite[2/7] [=========46%                ] nsys_report_db_30000_10_150.sqlite[2/7] [==========47%               ] nsys_report_db_30000_10_150.sqlite[2/7] [==========48%               ] nsys_report_db_30000_10_150.sqlite[2/7] [==========49%               ] nsys_report_db_30000_10_150.sqlite[2/7] [===========50%              ] nsys_report_db_30000_10_150.sqlite[2/7] [===========51%              ] nsys_report_db_30000_10_150.sqlite[2/7] [===========52%              ] nsys_report_db_30000_10_150.sqlite[2/7] [===========53%              ] nsys_report_db_30000_10_150.sqlite[2/7] [============54%             ] nsys_report_db_30000_10_150.sqlite[2/7] [============55%             ] nsys_report_db_30000_10_150.sqlite[2/7] [============56%             ] nsys_report_db_30000_10_150.sqlite[2/7] [============57%             ] nsys_report_db_30000_10_150.sqlite[2/7] [=============58%            ] nsys_report_db_30000_10_150.sqlite[2/7] [=============59%            ] nsys_report_db_30000_10_150.sqlite[2/7] [=============60%            ] nsys_report_db_30000_10_150.sqlite[2/7] [==============61%           ] nsys_report_db_30000_10_150.sqlite[2/7] [==============62%           ] nsys_report_db_30000_10_150.sqlite[2/7] [==============63%           ] nsys_report_db_30000_10_150.sqlite[2/7] [==============64%           ] nsys_report_db_30000_10_150.sqlite[2/7] [===============65%          ] nsys_report_db_30000_10_150.sqlite[2/7] [===============66%          ] nsys_report_db_30000_10_150.sqlite[2/7] [===============67%          ] nsys_report_db_30000_10_150.sqlite[2/7] [================68%         ] nsys_report_db_30000_10_150.sqlite[2/7] [================69%         ] nsys_report_db_30000_10_150.sqlite[2/7] [================70%         ] nsys_report_db_30000_10_150.sqlite[2/7] [================71%         ] nsys_report_db_30000_10_150.sqlite[2/7] [=================72%        ] nsys_report_db_30000_10_150.sqlite[2/7] [=================73%        ] nsys_report_db_30000_10_150.sqlite[2/7] [=================74%        ] nsys_report_db_30000_10_150.sqlite[2/7] [==================75%       ] nsys_report_db_30000_10_150.sqlite[2/7] [==================76%       ] nsys_report_db_30000_10_150.sqlite[2/7] [==================77%       ] nsys_report_db_30000_10_150.sqlite[2/7] [==================78%       ] nsys_report_db_30000_10_150.sqlite[2/7] [===================79%      ] nsys_report_db_30000_10_150.sqlite[2/7] [===================80%      ] nsys_report_db_30000_10_150.sqlite[2/7] [===================81%      ] nsys_report_db_30000_10_150.sqlite[2/7] [===================82%      ] nsys_report_db_30000_10_150.sqlite[2/7] [====================83%     ] nsys_report_db_30000_10_150.sqlite[2/7] [====================84%     ] nsys_report_db_30000_10_150.sqlite[2/7] [====================85%     ] nsys_report_db_30000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_10_150.sqlite[2/7] [======================90%   ] nsys_report_db_30000_10_150.sqlite[2/7] [======================91%   ] nsys_report_db_30000_10_150.sqlite[2/7] [======================92%   ] nsys_report_db_30000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_10_150.sqlite[2/7] [========================97% ] nsys_report_db_30000_10_150.sqlite[2/7] [========================98% ] nsys_report_db_30000_10_150.sqlite[2/7] [========================99% ] nsys_report_db_30000_10_150.sqlite[2/7] [========================100%] nsys_report_db_30000_10_150.sqlite[2/7] [========================100%] nsys_report_db_30000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        266655966          1  266655966.0  266655966.0  266655966  266655966          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        144820752          1  144820752.0  144820752.0  144820752  144820752          0.0  cudaFree                      
      1.2          1768162          6     294693.7     258023.0       3840     703779     276433.0  cudaMalloc                    
      0.2           263494        814        323.7        280.0        120       1300        156.9  cuGetProcAddress_v2           
      0.0            34760          2      17380.0      17380.0       1980      32780      21778.9  cudaStreamCreateWithFlags     
      0.0            23870         18       1326.1        505.0        400      12720       2879.7  cudaEventCreateWithFlags      
      0.0             4110          3       1370.0       1520.0        610       1980        697.2  cuInit                        
      0.0             3360          3       1120.0        270.0        270       2820       1472.2  cuModuleGetLoadingMode        
      0.0             1000          2        500.0        500.0        320        680        254.6  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_10_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 10 (num_steps = 150), identity_test = 0
Generating '/tmp/nsys-report-d3d9.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_10_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_10_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_10_150.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_10_150.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_10_150.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_150.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_10_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [1%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [2%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [3%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [4%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [5%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [6%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [7%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [8%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [9%                          ] nsys_report_fo_30000_10_150.sqlite[2/7] [10%                         ] nsys_report_fo_30000_10_150.sqlite[2/7] [11%                         ] nsys_report_fo_30000_10_150.sqlite[2/7] [12%                         ] nsys_report_fo_30000_10_150.sqlite[2/7] [13%                         ] nsys_report_fo_30000_10_150.sqlite[2/7] [14%                         ] nsys_report_fo_30000_10_150.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_10_150.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_10_150.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_10_150.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_10_150.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_10_150.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_10_150.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_10_150.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_10_150.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_10_150.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_10_150.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_10_150.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_10_150.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_10_150.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_10_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_10_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_10_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_10_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_10_150.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_10_150.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_10_150.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_10_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_10_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_10_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_10_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_10_150.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_10_150.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_10_150.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_10_150.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_10_150.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_10_150.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_10_150.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_10_150.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_10_150.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_10_150.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_10_150.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_10_150.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_10_150.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_10_150.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_10_150.sqlite[2/7] [============54%             ] nsys_report_fo_30000_10_150.sqlite[2/7] [============55%             ] nsys_report_fo_30000_10_150.sqlite[2/7] [============56%             ] nsys_report_fo_30000_10_150.sqlite[2/7] [============57%             ] nsys_report_fo_30000_10_150.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_10_150.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_10_150.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_10_150.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_10_150.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_10_150.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_10_150.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_10_150.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_10_150.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_10_150.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_10_150.sqlite[2/7] [================68%         ] nsys_report_fo_30000_10_150.sqlite[2/7] [================69%         ] nsys_report_fo_30000_10_150.sqlite[2/7] [================70%         ] nsys_report_fo_30000_10_150.sqlite[2/7] [================71%         ] nsys_report_fo_30000_10_150.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_10_150.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_10_150.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_10_150.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_10_150.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_10_150.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_10_150.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_10_150.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_10_150.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_10_150.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_10_150.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_10_150.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_10_150.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_10_150.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_10_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_10_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_10_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_10_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_10_150.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_10_150.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_10_150.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_10_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_10_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_10_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_10_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_10_150.sqlite[2/7] [========================97% ] nsys_report_fo_30000_10_150.sqlite[2/7] [========================98% ] nsys_report_fo_30000_10_150.sqlite[2/7] [========================99% ] nsys_report_fo_30000_10_150.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_150.sqlite[2/7] [========================100%] nsys_report_fo_30000_10_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        249941508          1  249941508.0  249941508.0  249941508  249941508          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        144605619          1  144605619.0  144605619.0  144605619  144605619          0.0  cudaFree                      
      1.7          2520811          9     280090.1     408215.0       3600     467225     183581.4  cudaMalloc                    
      0.2           285814        814        351.1        310.0        120       1250        181.6  cuGetProcAddress_v2           
      0.0            36451          2      18225.5      18225.5       1920      34531      23059.5  cudaStreamCreateWithFlags     
      0.0            20060         18       1114.4        495.0        390       9890       2216.2  cudaEventCreateWithFlags      
      0.0             4490          3       1496.7       1550.0        610       2330        861.2  cuInit                        
      0.0             3480          3       1160.0        260.0        190       3030       1619.8  cuModuleGetLoadingMode        
      0.0              950          2        475.0        475.0        320        630        219.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_10_150.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 20 (num_steps = 20)
number of batches= 1
Generating '/tmp/nsys-report-ac05.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_20_20.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_20_20.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_20_20.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_20.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [1%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [2%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [3%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [4%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [5%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [6%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [7%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [8%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [9%                          ] nsys_report_ia_30000_20_20.sqlite[2/7] [10%                         ] nsys_report_ia_30000_20_20.sqlite[2/7] [11%                         ] nsys_report_ia_30000_20_20.sqlite[2/7] [12%                         ] nsys_report_ia_30000_20_20.sqlite[2/7] [13%                         ] nsys_report_ia_30000_20_20.sqlite[2/7] [14%                         ] nsys_report_ia_30000_20_20.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_20_20.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_20_20.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_20_20.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_20_20.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_20_20.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_20_20.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_20_20.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_20_20.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_20_20.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_20_20.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_20_20.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_20_20.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_20_20.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_20_20.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_20_20.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_20_20.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_20_20.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_20_20.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_20_20.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_20_20.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_20_20.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_20_20.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_20_20.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_20_20.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_20_20.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_20_20.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_20_20.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_20_20.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_20_20.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_20_20.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_20_20.sqlite[2/7] [============54%             ] nsys_report_ia_30000_20_20.sqlite[2/7] [============55%             ] nsys_report_ia_30000_20_20.sqlite[2/7] [============56%             ] nsys_report_ia_30000_20_20.sqlite[2/7] [============57%             ] nsys_report_ia_30000_20_20.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_20_20.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_20_20.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_20_20.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_20_20.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_20_20.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_20_20.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_20_20.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_20_20.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_20_20.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_20_20.sqlite[2/7] [================68%         ] nsys_report_ia_30000_20_20.sqlite[2/7] [================69%         ] nsys_report_ia_30000_20_20.sqlite[2/7] [================70%         ] nsys_report_ia_30000_20_20.sqlite[2/7] [================71%         ] nsys_report_ia_30000_20_20.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_20_20.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_20_20.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_20_20.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_20_20.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_20_20.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_20_20.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_20_20.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_20_20.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_20_20.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_20_20.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_20_20.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_20_20.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_20_20.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_20_20.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_20_20.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_20_20.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_20_20.sqlite[2/7] [========================97% ] nsys_report_ia_30000_20_20.sqlite[2/7] [========================98% ] nsys_report_ia_30000_20_20.sqlite[2/7] [========================99% ] nsys_report_ia_30000_20_20.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_20.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        246265799          1  246265799.0  246265799.0  246265799  246265799          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        129649061          1  129649061.0  129649061.0  129649061  129649061          0.0  cudaFree                      
      1.4          1808274          6     301379.0     249593.5       3930     773390     296183.3  cudaMalloc                    
      0.2           287415        814        353.1        310.0        120       1540        183.6  cuGetProcAddress_v2           
      0.0            32590          2      16295.0      16295.0       1950      30640      20286.9  cudaStreamCreateWithFlags     
      0.0            19370         18       1076.1        515.0        390       8860       1976.3  cudaEventCreateWithFlags      
      0.0             5670          3       1890.0       2040.0        640       2990       1182.2  cuInit                        
      0.0             3430          3       1143.3        380.0        270       2780       1418.5  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        310        570        183.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_20.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 20 (num_steps = 20)
number of batches= 1
Generating '/tmp/nsys-report-791c.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_20_20.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_20_20.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_20_20.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_20.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [1%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [2%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [3%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [4%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [5%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [6%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [7%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [8%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [9%                          ] nsys_report_db_30000_20_20.sqlite[2/7] [10%                         ] nsys_report_db_30000_20_20.sqlite[2/7] [11%                         ] nsys_report_db_30000_20_20.sqlite[2/7] [12%                         ] nsys_report_db_30000_20_20.sqlite[2/7] [13%                         ] nsys_report_db_30000_20_20.sqlite[2/7] [14%                         ] nsys_report_db_30000_20_20.sqlite[2/7] [=15%                        ] nsys_report_db_30000_20_20.sqlite[2/7] [=16%                        ] nsys_report_db_30000_20_20.sqlite[2/7] [=17%                        ] nsys_report_db_30000_20_20.sqlite[2/7] [==18%                       ] nsys_report_db_30000_20_20.sqlite[2/7] [==19%                       ] nsys_report_db_30000_20_20.sqlite[2/7] [==20%                       ] nsys_report_db_30000_20_20.sqlite[2/7] [==21%                       ] nsys_report_db_30000_20_20.sqlite[2/7] [===22%                      ] nsys_report_db_30000_20_20.sqlite[2/7] [===23%                      ] nsys_report_db_30000_20_20.sqlite[2/7] [===24%                      ] nsys_report_db_30000_20_20.sqlite[2/7] [====25%                     ] nsys_report_db_30000_20_20.sqlite[2/7] [====26%                     ] nsys_report_db_30000_20_20.sqlite[2/7] [====27%                     ] nsys_report_db_30000_20_20.sqlite[2/7] [====28%                     ] nsys_report_db_30000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_20_20.sqlite[2/7] [======33%                   ] nsys_report_db_30000_20_20.sqlite[2/7] [======34%                   ] nsys_report_db_30000_20_20.sqlite[2/7] [======35%                   ] nsys_report_db_30000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_20_20.sqlite[2/7] [========40%                 ] nsys_report_db_30000_20_20.sqlite[2/7] [========41%                 ] nsys_report_db_30000_20_20.sqlite[2/7] [========42%                 ] nsys_report_db_30000_20_20.sqlite[2/7] [=========43%                ] nsys_report_db_30000_20_20.sqlite[2/7] [=========44%                ] nsys_report_db_30000_20_20.sqlite[2/7] [=========45%                ] nsys_report_db_30000_20_20.sqlite[2/7] [=========46%                ] nsys_report_db_30000_20_20.sqlite[2/7] [==========47%               ] nsys_report_db_30000_20_20.sqlite[2/7] [==========48%               ] nsys_report_db_30000_20_20.sqlite[2/7] [==========49%               ] nsys_report_db_30000_20_20.sqlite[2/7] [===========50%              ] nsys_report_db_30000_20_20.sqlite[2/7] [===========51%              ] nsys_report_db_30000_20_20.sqlite[2/7] [===========52%              ] nsys_report_db_30000_20_20.sqlite[2/7] [===========53%              ] nsys_report_db_30000_20_20.sqlite[2/7] [============54%             ] nsys_report_db_30000_20_20.sqlite[2/7] [============55%             ] nsys_report_db_30000_20_20.sqlite[2/7] [============56%             ] nsys_report_db_30000_20_20.sqlite[2/7] [============57%             ] nsys_report_db_30000_20_20.sqlite[2/7] [=============58%            ] nsys_report_db_30000_20_20.sqlite[2/7] [=============59%            ] nsys_report_db_30000_20_20.sqlite[2/7] [=============60%            ] nsys_report_db_30000_20_20.sqlite[2/7] [==============61%           ] nsys_report_db_30000_20_20.sqlite[2/7] [==============62%           ] nsys_report_db_30000_20_20.sqlite[2/7] [==============63%           ] nsys_report_db_30000_20_20.sqlite[2/7] [==============64%           ] nsys_report_db_30000_20_20.sqlite[2/7] [===============65%          ] nsys_report_db_30000_20_20.sqlite[2/7] [===============66%          ] nsys_report_db_30000_20_20.sqlite[2/7] [===============67%          ] nsys_report_db_30000_20_20.sqlite[2/7] [================68%         ] nsys_report_db_30000_20_20.sqlite[2/7] [================69%         ] nsys_report_db_30000_20_20.sqlite[2/7] [================70%         ] nsys_report_db_30000_20_20.sqlite[2/7] [================71%         ] nsys_report_db_30000_20_20.sqlite[2/7] [=================72%        ] nsys_report_db_30000_20_20.sqlite[2/7] [=================73%        ] nsys_report_db_30000_20_20.sqlite[2/7] [=================74%        ] nsys_report_db_30000_20_20.sqlite[2/7] [==================75%       ] nsys_report_db_30000_20_20.sqlite[2/7] [==================76%       ] nsys_report_db_30000_20_20.sqlite[2/7] [==================77%       ] nsys_report_db_30000_20_20.sqlite[2/7] [==================78%       ] nsys_report_db_30000_20_20.sqlite[2/7] [===================79%      ] nsys_report_db_30000_20_20.sqlite[2/7] [===================80%      ] nsys_report_db_30000_20_20.sqlite[2/7] [===================81%      ] nsys_report_db_30000_20_20.sqlite[2/7] [===================82%      ] nsys_report_db_30000_20_20.sqlite[2/7] [====================83%     ] nsys_report_db_30000_20_20.sqlite[2/7] [====================84%     ] nsys_report_db_30000_20_20.sqlite[2/7] [====================85%     ] nsys_report_db_30000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_20_20.sqlite[2/7] [======================90%   ] nsys_report_db_30000_20_20.sqlite[2/7] [======================91%   ] nsys_report_db_30000_20_20.sqlite[2/7] [======================92%   ] nsys_report_db_30000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_20_20.sqlite[2/7] [========================97% ] nsys_report_db_30000_20_20.sqlite[2/7] [========================98% ] nsys_report_db_30000_20_20.sqlite[2/7] [========================99% ] nsys_report_db_30000_20_20.sqlite[2/7] [========================100%] nsys_report_db_30000_20_20.sqlite[2/7] [========================100%] nsys_report_db_30000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        284553699          1  284553699.0  284553699.0  284553699  284553699          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        163320213          1  163320213.0  163320213.0  163320213  163320213          0.0  cudaFree                      
      1.1          1859244          6     309874.0     262663.5       3770     784410     302115.6  cudaMalloc                    
      0.2           263643        814        323.9        280.0        120       1240        166.8  cuGetProcAddress_v2           
      0.0            35031          2      17515.5      17515.5       2050      32981      21871.5  cudaStreamCreateWithFlags     
      0.0            26410         18       1467.2        510.0        400      15290       3480.6  cudaEventCreateWithFlags      
      0.0             4730          3       1576.7       1420.0        640       2670       1024.0  cuInit                        
      0.0             3660          3       1220.0        280.0        160       3220       1733.1  cuModuleGetLoadingMode        
      0.0             1010          2        505.0        505.0        290        720        304.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_20.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 20 (num_steps = 20), identity_test = 0
Generating '/tmp/nsys-report-d082.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_20_20.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_20_20.nsys-rep[1/7] [=====31%                    ] nsys_report_fo_30000_20_20.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_20_20.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_20_20.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_20.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_20.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [1%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [2%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [3%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [4%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [5%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [6%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [7%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [8%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [9%                          ] nsys_report_fo_30000_20_20.sqlite[2/7] [10%                         ] nsys_report_fo_30000_20_20.sqlite[2/7] [11%                         ] nsys_report_fo_30000_20_20.sqlite[2/7] [12%                         ] nsys_report_fo_30000_20_20.sqlite[2/7] [13%                         ] nsys_report_fo_30000_20_20.sqlite[2/7] [14%                         ] nsys_report_fo_30000_20_20.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_20_20.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_20_20.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_20_20.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_20_20.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_20_20.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_20_20.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_20_20.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_20_20.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_20_20.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_20_20.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_20_20.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_20_20.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_20_20.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_20_20.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_20_20.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_20_20.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_20_20.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_20_20.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_20_20.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_20_20.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_20_20.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_20_20.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_20_20.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_20_20.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_20_20.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_20_20.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_20_20.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_20_20.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_20_20.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_20_20.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_20_20.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_20_20.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_20_20.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_20_20.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_20_20.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_20_20.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_20_20.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_20_20.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_20_20.sqlite[2/7] [============54%             ] nsys_report_fo_30000_20_20.sqlite[2/7] [============55%             ] nsys_report_fo_30000_20_20.sqlite[2/7] [============56%             ] nsys_report_fo_30000_20_20.sqlite[2/7] [============57%             ] nsys_report_fo_30000_20_20.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_20_20.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_20_20.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_20_20.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_20_20.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_20_20.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_20_20.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_20_20.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_20_20.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_20_20.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_20_20.sqlite[2/7] [================68%         ] nsys_report_fo_30000_20_20.sqlite[2/7] [================69%         ] nsys_report_fo_30000_20_20.sqlite[2/7] [================70%         ] nsys_report_fo_30000_20_20.sqlite[2/7] [================71%         ] nsys_report_fo_30000_20_20.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_20_20.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_20_20.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_20_20.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_20_20.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_20_20.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_20_20.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_20_20.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_20_20.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_20_20.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_20_20.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_20_20.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_20_20.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_20_20.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_20_20.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_20_20.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_20_20.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_20_20.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_20_20.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_20_20.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_20_20.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_20_20.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_20_20.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_20_20.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_20_20.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_20_20.sqlite[2/7] [========================97% ] nsys_report_fo_30000_20_20.sqlite[2/7] [========================98% ] nsys_report_fo_30000_20_20.sqlite[2/7] [========================99% ] nsys_report_fo_30000_20_20.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_20.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_20.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        268244657          1  268244657.0  268244657.0  268244657  268244657          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        149513081          1  149513081.0  149513081.0  149513081  149513081          0.0  cudaFree                      
      1.6          2493621          9     277069.0     402215.0       3741     458066     180821.4  cudaMalloc                    
      0.2           274435        814        337.1        290.0        120       6811        282.1  cuGetProcAddress_v2           
      0.0            39441          2      19720.5      19720.5       2210      37231      24763.6  cudaStreamCreateWithFlags     
      0.0            21000         18       1166.7        500.0        390      10350       2324.4  cudaEventCreateWithFlags      
      0.0             4410          3       1470.0       1670.0        610       2130        779.5  cuInit                        
      0.0             3260          3       1086.7        250.0        170       2840       1519.0  cuModuleGetLoadingMode        
      0.0             1030          2        515.0        515.0        420        610        134.4  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_20.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_20.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 20 (num_steps = 40)
number of batches= 2
Generating '/tmp/nsys-report-1099.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_20_40.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_20_40.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_20_40.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_20_40.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_40.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [1%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [2%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [3%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [4%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [5%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [6%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [7%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [8%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [9%                          ] nsys_report_ia_30000_20_40.sqlite[2/7] [10%                         ] nsys_report_ia_30000_20_40.sqlite[2/7] [11%                         ] nsys_report_ia_30000_20_40.sqlite[2/7] [12%                         ] nsys_report_ia_30000_20_40.sqlite[2/7] [13%                         ] nsys_report_ia_30000_20_40.sqlite[2/7] [14%                         ] nsys_report_ia_30000_20_40.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_20_40.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_20_40.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_20_40.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_20_40.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_20_40.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_20_40.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_20_40.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_20_40.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_20_40.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_20_40.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_20_40.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_20_40.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_20_40.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_20_40.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_20_40.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_20_40.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_20_40.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_20_40.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_20_40.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_20_40.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_20_40.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_20_40.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_20_40.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_20_40.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_20_40.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_20_40.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_20_40.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_20_40.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_20_40.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_20_40.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_20_40.sqlite[2/7] [============54%             ] nsys_report_ia_30000_20_40.sqlite[2/7] [============55%             ] nsys_report_ia_30000_20_40.sqlite[2/7] [============56%             ] nsys_report_ia_30000_20_40.sqlite[2/7] [============57%             ] nsys_report_ia_30000_20_40.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_20_40.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_20_40.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_20_40.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_20_40.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_20_40.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_20_40.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_20_40.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_20_40.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_20_40.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_20_40.sqlite[2/7] [================68%         ] nsys_report_ia_30000_20_40.sqlite[2/7] [================69%         ] nsys_report_ia_30000_20_40.sqlite[2/7] [================70%         ] nsys_report_ia_30000_20_40.sqlite[2/7] [================71%         ] nsys_report_ia_30000_20_40.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_20_40.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_20_40.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_20_40.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_20_40.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_20_40.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_20_40.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_20_40.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_20_40.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_20_40.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_20_40.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_20_40.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_20_40.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_20_40.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_20_40.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_20_40.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_20_40.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_20_40.sqlite[2/7] [========================97% ] nsys_report_ia_30000_20_40.sqlite[2/7] [========================98% ] nsys_report_ia_30000_20_40.sqlite[2/7] [========================99% ] nsys_report_ia_30000_20_40.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_40.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        245508373          1  245508373.0  245508373.0  245508373  245508373          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        136240849          1  136240849.0  136240849.0  136240849  136240849          0.0  cudaFree                      
      1.3          1833573          6     305595.5     261068.0       3730     784480     300769.8  cudaMalloc                    
      0.2           302545        814        371.7        340.0        120       1550        190.3  cuGetProcAddress_v2           
      0.0            31150          2      15575.0      15575.0       1920      29230      19311.1  cudaStreamCreateWithFlags     
      0.0            22201         18       1233.4        505.5        400      12060       2722.9  cudaEventCreateWithFlags      
      0.0             4920          3       1640.0       1530.0        660       2730       1039.4  cuInit                        
      0.0             3440          3       1146.7        390.0        140       2910       1532.2  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        300        590        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_40.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 20 (num_steps = 40)
number of batches= 2
Generating '/tmp/nsys-report-697d.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_20_40.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_20_40.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_20_40.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_20_40.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_40.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [1%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [2%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [3%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [4%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [5%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [6%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [7%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [8%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [9%                          ] nsys_report_db_30000_20_40.sqlite[2/7] [10%                         ] nsys_report_db_30000_20_40.sqlite[2/7] [11%                         ] nsys_report_db_30000_20_40.sqlite[2/7] [12%                         ] nsys_report_db_30000_20_40.sqlite[2/7] [13%                         ] nsys_report_db_30000_20_40.sqlite[2/7] [14%                         ] nsys_report_db_30000_20_40.sqlite[2/7] [=15%                        ] nsys_report_db_30000_20_40.sqlite[2/7] [=16%                        ] nsys_report_db_30000_20_40.sqlite[2/7] [=17%                        ] nsys_report_db_30000_20_40.sqlite[2/7] [==18%                       ] nsys_report_db_30000_20_40.sqlite[2/7] [==19%                       ] nsys_report_db_30000_20_40.sqlite[2/7] [==20%                       ] nsys_report_db_30000_20_40.sqlite[2/7] [==21%                       ] nsys_report_db_30000_20_40.sqlite[2/7] [===22%                      ] nsys_report_db_30000_20_40.sqlite[2/7] [===23%                      ] nsys_report_db_30000_20_40.sqlite[2/7] [===24%                      ] nsys_report_db_30000_20_40.sqlite[2/7] [====25%                     ] nsys_report_db_30000_20_40.sqlite[2/7] [====26%                     ] nsys_report_db_30000_20_40.sqlite[2/7] [====27%                     ] nsys_report_db_30000_20_40.sqlite[2/7] [====28%                     ] nsys_report_db_30000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_20_40.sqlite[2/7] [======33%                   ] nsys_report_db_30000_20_40.sqlite[2/7] [======34%                   ] nsys_report_db_30000_20_40.sqlite[2/7] [======35%                   ] nsys_report_db_30000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_20_40.sqlite[2/7] [========40%                 ] nsys_report_db_30000_20_40.sqlite[2/7] [========41%                 ] nsys_report_db_30000_20_40.sqlite[2/7] [========42%                 ] nsys_report_db_30000_20_40.sqlite[2/7] [=========43%                ] nsys_report_db_30000_20_40.sqlite[2/7] [=========44%                ] nsys_report_db_30000_20_40.sqlite[2/7] [=========45%                ] nsys_report_db_30000_20_40.sqlite[2/7] [=========46%                ] nsys_report_db_30000_20_40.sqlite[2/7] [==========47%               ] nsys_report_db_30000_20_40.sqlite[2/7] [==========48%               ] nsys_report_db_30000_20_40.sqlite[2/7] [==========49%               ] nsys_report_db_30000_20_40.sqlite[2/7] [===========50%              ] nsys_report_db_30000_20_40.sqlite[2/7] [===========51%              ] nsys_report_db_30000_20_40.sqlite[2/7] [===========52%              ] nsys_report_db_30000_20_40.sqlite[2/7] [===========53%              ] nsys_report_db_30000_20_40.sqlite[2/7] [============54%             ] nsys_report_db_30000_20_40.sqlite[2/7] [============55%             ] nsys_report_db_30000_20_40.sqlite[2/7] [============56%             ] nsys_report_db_30000_20_40.sqlite[2/7] [============57%             ] nsys_report_db_30000_20_40.sqlite[2/7] [=============58%            ] nsys_report_db_30000_20_40.sqlite[2/7] [=============59%            ] nsys_report_db_30000_20_40.sqlite[2/7] [=============60%            ] nsys_report_db_30000_20_40.sqlite[2/7] [==============61%           ] nsys_report_db_30000_20_40.sqlite[2/7] [==============62%           ] nsys_report_db_30000_20_40.sqlite[2/7] [==============63%           ] nsys_report_db_30000_20_40.sqlite[2/7] [==============64%           ] nsys_report_db_30000_20_40.sqlite[2/7] [===============65%          ] nsys_report_db_30000_20_40.sqlite[2/7] [===============66%          ] nsys_report_db_30000_20_40.sqlite[2/7] [===============67%          ] nsys_report_db_30000_20_40.sqlite[2/7] [================68%         ] nsys_report_db_30000_20_40.sqlite[2/7] [================69%         ] nsys_report_db_30000_20_40.sqlite[2/7] [================70%         ] nsys_report_db_30000_20_40.sqlite[2/7] [================71%         ] nsys_report_db_30000_20_40.sqlite[2/7] [=================72%        ] nsys_report_db_30000_20_40.sqlite[2/7] [=================73%        ] nsys_report_db_30000_20_40.sqlite[2/7] [=================74%        ] nsys_report_db_30000_20_40.sqlite[2/7] [==================75%       ] nsys_report_db_30000_20_40.sqlite[2/7] [==================76%       ] nsys_report_db_30000_20_40.sqlite[2/7] [==================77%       ] nsys_report_db_30000_20_40.sqlite[2/7] [==================78%       ] nsys_report_db_30000_20_40.sqlite[2/7] [===================79%      ] nsys_report_db_30000_20_40.sqlite[2/7] [===================80%      ] nsys_report_db_30000_20_40.sqlite[2/7] [===================81%      ] nsys_report_db_30000_20_40.sqlite[2/7] [===================82%      ] nsys_report_db_30000_20_40.sqlite[2/7] [====================83%     ] nsys_report_db_30000_20_40.sqlite[2/7] [====================84%     ] nsys_report_db_30000_20_40.sqlite[2/7] [====================85%     ] nsys_report_db_30000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_20_40.sqlite[2/7] [======================90%   ] nsys_report_db_30000_20_40.sqlite[2/7] [======================91%   ] nsys_report_db_30000_20_40.sqlite[2/7] [======================92%   ] nsys_report_db_30000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_20_40.sqlite[2/7] [========================97% ] nsys_report_db_30000_20_40.sqlite[2/7] [========================98% ] nsys_report_db_30000_20_40.sqlite[2/7] [========================99% ] nsys_report_db_30000_20_40.sqlite[2/7] [========================100%] nsys_report_db_30000_20_40.sqlite[2/7] [========================100%] nsys_report_db_30000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        271694131          1  271694131.0  271694131.0  271694131  271694131          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        164020277          1  164020277.0  164020277.0  164020277  164020277          0.0  cudaFree                      
      1.1          1849903          6     308317.2     256173.0       3790     784340     302640.8  cudaMalloc                    
      0.2           271383        814        333.4        290.0        120       1130        169.9  cuGetProcAddress_v2           
      0.0            39540          2      19770.0      19770.0       1930      37610      25229.6  cudaStreamCreateWithFlags     
      0.0            29521         18       1640.1        495.0        400      19201       4397.6  cudaEventCreateWithFlags      
      0.0             5070          3       1690.0       1930.0        580       2560       1011.6  cuInit                        
      0.0             3380          3       1126.7        290.0        170       2920       1554.2  cuModuleGetLoadingMode        
      0.0              960          2        480.0        480.0        330        630        212.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_40.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 20 (num_steps = 40), identity_test = 0
Generating '/tmp/nsys-report-2010.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_20_40.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_20_40.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_20_40.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_20_40.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_20_40.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_40.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_40.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [1%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [2%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [3%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [4%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [5%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [6%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [7%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [8%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [9%                          ] nsys_report_fo_30000_20_40.sqlite[2/7] [10%                         ] nsys_report_fo_30000_20_40.sqlite[2/7] [11%                         ] nsys_report_fo_30000_20_40.sqlite[2/7] [12%                         ] nsys_report_fo_30000_20_40.sqlite[2/7] [13%                         ] nsys_report_fo_30000_20_40.sqlite[2/7] [14%                         ] nsys_report_fo_30000_20_40.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_20_40.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_20_40.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_20_40.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_20_40.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_20_40.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_20_40.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_20_40.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_20_40.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_20_40.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_20_40.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_20_40.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_20_40.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_20_40.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_20_40.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_20_40.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_20_40.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_20_40.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_20_40.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_20_40.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_20_40.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_20_40.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_20_40.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_20_40.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_20_40.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_20_40.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_20_40.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_20_40.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_20_40.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_20_40.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_20_40.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_20_40.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_20_40.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_20_40.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_20_40.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_20_40.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_20_40.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_20_40.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_20_40.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_20_40.sqlite[2/7] [============54%             ] nsys_report_fo_30000_20_40.sqlite[2/7] [============55%             ] nsys_report_fo_30000_20_40.sqlite[2/7] [============56%             ] nsys_report_fo_30000_20_40.sqlite[2/7] [============57%             ] nsys_report_fo_30000_20_40.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_20_40.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_20_40.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_20_40.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_20_40.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_20_40.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_20_40.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_20_40.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_20_40.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_20_40.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_20_40.sqlite[2/7] [================68%         ] nsys_report_fo_30000_20_40.sqlite[2/7] [================69%         ] nsys_report_fo_30000_20_40.sqlite[2/7] [================70%         ] nsys_report_fo_30000_20_40.sqlite[2/7] [================71%         ] nsys_report_fo_30000_20_40.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_20_40.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_20_40.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_20_40.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_20_40.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_20_40.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_20_40.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_20_40.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_20_40.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_20_40.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_20_40.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_20_40.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_20_40.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_20_40.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_20_40.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_20_40.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_20_40.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_20_40.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_20_40.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_20_40.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_20_40.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_20_40.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_20_40.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_20_40.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_20_40.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_20_40.sqlite[2/7] [========================97% ] nsys_report_fo_30000_20_40.sqlite[2/7] [========================98% ] nsys_report_fo_30000_20_40.sqlite[2/7] [========================99% ] nsys_report_fo_30000_20_40.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_40.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_40.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        256151858          1  256151858.0  256151858.0  256151858  256151858          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.1        148455553          1  148455553.0  148455553.0  148455553  148455553          0.0  cudaFree                      
      1.7          2508941          9     278771.2     404725.0       4040     456005     180961.9  cudaMalloc                    
      0.2           283995        814        348.9        310.0        120       1560        184.0  cuGetProcAddress_v2           
      0.0            43291          2      21645.5      21645.5       1960      41331      27839.5  cudaStreamCreateWithFlags     
      0.0            21481         18       1193.4        465.0        390      11690       2638.4  cudaEventCreateWithFlags      
      0.0             4661          3       1553.7       1870.0        691       2100        755.9  cuInit                        
      0.0             3450          3       1150.0        260.0        180       3010       1611.3  cuModuleGetLoadingMode        
      0.0              870          2        435.0        435.0        300        570        190.9  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_40.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_40.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 20 (num_steps = 60)
number of batches= 3
Generating '/tmp/nsys-report-acfe.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_20_60.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_20_60.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_20_60.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_60.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [1%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [2%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [3%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [4%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [5%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [6%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [7%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [8%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [9%                          ] nsys_report_ia_30000_20_60.sqlite[2/7] [10%                         ] nsys_report_ia_30000_20_60.sqlite[2/7] [11%                         ] nsys_report_ia_30000_20_60.sqlite[2/7] [12%                         ] nsys_report_ia_30000_20_60.sqlite[2/7] [13%                         ] nsys_report_ia_30000_20_60.sqlite[2/7] [14%                         ] nsys_report_ia_30000_20_60.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_20_60.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_20_60.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_20_60.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_20_60.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_20_60.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_20_60.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_20_60.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_20_60.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_20_60.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_20_60.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_20_60.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_20_60.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_20_60.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_20_60.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_20_60.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_20_60.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_20_60.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_20_60.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_20_60.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_20_60.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_20_60.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_20_60.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_20_60.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_20_60.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_20_60.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_20_60.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_20_60.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_20_60.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_20_60.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_20_60.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_20_60.sqlite[2/7] [============54%             ] nsys_report_ia_30000_20_60.sqlite[2/7] [============55%             ] nsys_report_ia_30000_20_60.sqlite[2/7] [============56%             ] nsys_report_ia_30000_20_60.sqlite[2/7] [============57%             ] nsys_report_ia_30000_20_60.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_20_60.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_20_60.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_20_60.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_20_60.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_20_60.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_20_60.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_20_60.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_20_60.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_20_60.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_20_60.sqlite[2/7] [================68%         ] nsys_report_ia_30000_20_60.sqlite[2/7] [================69%         ] nsys_report_ia_30000_20_60.sqlite[2/7] [================70%         ] nsys_report_ia_30000_20_60.sqlite[2/7] [================71%         ] nsys_report_ia_30000_20_60.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_20_60.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_20_60.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_20_60.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_20_60.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_20_60.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_20_60.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_20_60.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_20_60.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_20_60.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_20_60.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_20_60.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_20_60.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_20_60.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_20_60.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_20_60.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_20_60.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_20_60.sqlite[2/7] [========================97% ] nsys_report_ia_30000_20_60.sqlite[2/7] [========================98% ] nsys_report_ia_30000_20_60.sqlite[2/7] [========================99% ] nsys_report_ia_30000_20_60.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_60.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        246020259          1  246020259.0  246020259.0  246020259  246020259          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        131764443          1  131764443.0  131764443.0  131764443  131764443          0.0  cudaFree                      
      1.4          1838733          6     306455.5     252503.0       3590     793140     303413.9  cudaMalloc                    
      0.2           295894        814        363.5        320.0        120       2140        190.4  cuGetProcAddress_v2           
      0.0            32061          2      16030.5      16030.5       1880      30181      20011.8  cudaStreamCreateWithFlags     
      0.0            20530         18       1140.6        515.0        400       9640       2155.5  cudaEventCreateWithFlags      
      0.0             4960          3       1653.3       1750.0        590       2620       1018.4  cuInit                        
      0.0             3531          3       1177.0        381.0        170       2980       1565.0  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        320        610        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_60.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 20 (num_steps = 60)
number of batches= 3
Generating '/tmp/nsys-report-b7eb.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_20_60.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_20_60.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_20_60.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_60.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [1%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [2%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [3%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [4%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [5%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [6%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [7%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [8%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [9%                          ] nsys_report_db_30000_20_60.sqlite[2/7] [10%                         ] nsys_report_db_30000_20_60.sqlite[2/7] [11%                         ] nsys_report_db_30000_20_60.sqlite[2/7] [12%                         ] nsys_report_db_30000_20_60.sqlite[2/7] [13%                         ] nsys_report_db_30000_20_60.sqlite[2/7] [14%                         ] nsys_report_db_30000_20_60.sqlite[2/7] [=15%                        ] nsys_report_db_30000_20_60.sqlite[2/7] [=16%                        ] nsys_report_db_30000_20_60.sqlite[2/7] [=17%                        ] nsys_report_db_30000_20_60.sqlite[2/7] [==18%                       ] nsys_report_db_30000_20_60.sqlite[2/7] [==19%                       ] nsys_report_db_30000_20_60.sqlite[2/7] [==20%                       ] nsys_report_db_30000_20_60.sqlite[2/7] [==21%                       ] nsys_report_db_30000_20_60.sqlite[2/7] [===22%                      ] nsys_report_db_30000_20_60.sqlite[2/7] [===23%                      ] nsys_report_db_30000_20_60.sqlite[2/7] [===24%                      ] nsys_report_db_30000_20_60.sqlite[2/7] [====25%                     ] nsys_report_db_30000_20_60.sqlite[2/7] [====26%                     ] nsys_report_db_30000_20_60.sqlite[2/7] [====27%                     ] nsys_report_db_30000_20_60.sqlite[2/7] [====28%                     ] nsys_report_db_30000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_20_60.sqlite[2/7] [======33%                   ] nsys_report_db_30000_20_60.sqlite[2/7] [======34%                   ] nsys_report_db_30000_20_60.sqlite[2/7] [======35%                   ] nsys_report_db_30000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_20_60.sqlite[2/7] [========40%                 ] nsys_report_db_30000_20_60.sqlite[2/7] [========41%                 ] nsys_report_db_30000_20_60.sqlite[2/7] [========42%                 ] nsys_report_db_30000_20_60.sqlite[2/7] [=========43%                ] nsys_report_db_30000_20_60.sqlite[2/7] [=========44%                ] nsys_report_db_30000_20_60.sqlite[2/7] [=========45%                ] nsys_report_db_30000_20_60.sqlite[2/7] [=========46%                ] nsys_report_db_30000_20_60.sqlite[2/7] [==========47%               ] nsys_report_db_30000_20_60.sqlite[2/7] [==========48%               ] nsys_report_db_30000_20_60.sqlite[2/7] [==========49%               ] nsys_report_db_30000_20_60.sqlite[2/7] [===========50%              ] nsys_report_db_30000_20_60.sqlite[2/7] [===========51%              ] nsys_report_db_30000_20_60.sqlite[2/7] [===========52%              ] nsys_report_db_30000_20_60.sqlite[2/7] [===========53%              ] nsys_report_db_30000_20_60.sqlite[2/7] [============54%             ] nsys_report_db_30000_20_60.sqlite[2/7] [============55%             ] nsys_report_db_30000_20_60.sqlite[2/7] [============56%             ] nsys_report_db_30000_20_60.sqlite[2/7] [============57%             ] nsys_report_db_30000_20_60.sqlite[2/7] [=============58%            ] nsys_report_db_30000_20_60.sqlite[2/7] [=============59%            ] nsys_report_db_30000_20_60.sqlite[2/7] [=============60%            ] nsys_report_db_30000_20_60.sqlite[2/7] [==============61%           ] nsys_report_db_30000_20_60.sqlite[2/7] [==============62%           ] nsys_report_db_30000_20_60.sqlite[2/7] [==============63%           ] nsys_report_db_30000_20_60.sqlite[2/7] [==============64%           ] nsys_report_db_30000_20_60.sqlite[2/7] [===============65%          ] nsys_report_db_30000_20_60.sqlite[2/7] [===============66%          ] nsys_report_db_30000_20_60.sqlite[2/7] [===============67%          ] nsys_report_db_30000_20_60.sqlite[2/7] [================68%         ] nsys_report_db_30000_20_60.sqlite[2/7] [================69%         ] nsys_report_db_30000_20_60.sqlite[2/7] [================70%         ] nsys_report_db_30000_20_60.sqlite[2/7] [================71%         ] nsys_report_db_30000_20_60.sqlite[2/7] [=================72%        ] nsys_report_db_30000_20_60.sqlite[2/7] [=================73%        ] nsys_report_db_30000_20_60.sqlite[2/7] [=================74%        ] nsys_report_db_30000_20_60.sqlite[2/7] [==================75%       ] nsys_report_db_30000_20_60.sqlite[2/7] [==================76%       ] nsys_report_db_30000_20_60.sqlite[2/7] [==================77%       ] nsys_report_db_30000_20_60.sqlite[2/7] [==================78%       ] nsys_report_db_30000_20_60.sqlite[2/7] [===================79%      ] nsys_report_db_30000_20_60.sqlite[2/7] [===================80%      ] nsys_report_db_30000_20_60.sqlite[2/7] [===================81%      ] nsys_report_db_30000_20_60.sqlite[2/7] [===================82%      ] nsys_report_db_30000_20_60.sqlite[2/7] [====================83%     ] nsys_report_db_30000_20_60.sqlite[2/7] [====================84%     ] nsys_report_db_30000_20_60.sqlite[2/7] [====================85%     ] nsys_report_db_30000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_20_60.sqlite[2/7] [======================90%   ] nsys_report_db_30000_20_60.sqlite[2/7] [======================91%   ] nsys_report_db_30000_20_60.sqlite[2/7] [======================92%   ] nsys_report_db_30000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_20_60.sqlite[2/7] [========================97% ] nsys_report_db_30000_20_60.sqlite[2/7] [========================98% ] nsys_report_db_30000_20_60.sqlite[2/7] [========================99% ] nsys_report_db_30000_20_60.sqlite[2/7] [========================100%] nsys_report_db_30000_20_60.sqlite[2/7] [========================100%] nsys_report_db_30000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        234311782          1  234311782.0  234311782.0  234311782  234311782          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.3        130383026          1  130383026.0  130383026.0  130383026  130383026          0.0  cudaFree                      
      1.4          1854073          6     309012.2     258058.0       3810     791590     304472.1  cudaMalloc                    
      0.2           283265        814        348.0        300.0        110       1560        180.5  cuGetProcAddress_v2           
      0.0            35021          2      17510.5      17510.5       1910      33111      22062.4  cudaStreamCreateWithFlags     
      0.0            25830         18       1435.0        530.0        400      15190       3450.5  cudaEventCreateWithFlags      
      0.0             4370          3       1456.7       1520.0        620       2230        806.9  cuInit                        
      0.0             3200          3       1066.7        270.0        240       2690       1405.9  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        310        570        183.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_60.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 20 (num_steps = 60), identity_test = 0
Generating '/tmp/nsys-report-10ae.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_20_60.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_20_60.nsys-rep[1/7] [======35%                   ] nsys_report_fo_30000_20_60.nsys-rep[1/7] [================68%         ] nsys_report_fo_30000_20_60.nsys-rep[1/7] [================69%         ] nsys_report_fo_30000_20_60.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_20_60.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_60.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_60.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [1%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [2%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [3%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [4%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [5%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [6%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [7%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [8%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [9%                          ] nsys_report_fo_30000_20_60.sqlite[2/7] [10%                         ] nsys_report_fo_30000_20_60.sqlite[2/7] [11%                         ] nsys_report_fo_30000_20_60.sqlite[2/7] [12%                         ] nsys_report_fo_30000_20_60.sqlite[2/7] [13%                         ] nsys_report_fo_30000_20_60.sqlite[2/7] [14%                         ] nsys_report_fo_30000_20_60.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_20_60.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_20_60.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_20_60.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_20_60.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_20_60.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_20_60.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_20_60.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_20_60.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_20_60.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_20_60.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_20_60.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_20_60.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_20_60.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_20_60.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_20_60.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_20_60.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_20_60.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_20_60.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_20_60.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_20_60.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_20_60.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_20_60.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_20_60.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_20_60.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_20_60.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_20_60.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_20_60.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_20_60.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_20_60.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_20_60.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_20_60.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_20_60.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_20_60.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_20_60.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_20_60.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_20_60.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_20_60.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_20_60.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_20_60.sqlite[2/7] [============54%             ] nsys_report_fo_30000_20_60.sqlite[2/7] [============55%             ] nsys_report_fo_30000_20_60.sqlite[2/7] [============56%             ] nsys_report_fo_30000_20_60.sqlite[2/7] [============57%             ] nsys_report_fo_30000_20_60.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_20_60.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_20_60.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_20_60.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_20_60.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_20_60.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_20_60.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_20_60.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_20_60.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_20_60.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_20_60.sqlite[2/7] [================68%         ] nsys_report_fo_30000_20_60.sqlite[2/7] [================69%         ] nsys_report_fo_30000_20_60.sqlite[2/7] [================70%         ] nsys_report_fo_30000_20_60.sqlite[2/7] [================71%         ] nsys_report_fo_30000_20_60.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_20_60.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_20_60.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_20_60.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_20_60.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_20_60.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_20_60.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_20_60.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_20_60.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_20_60.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_20_60.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_20_60.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_20_60.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_20_60.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_20_60.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_20_60.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_20_60.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_20_60.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_20_60.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_20_60.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_20_60.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_20_60.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_20_60.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_20_60.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_20_60.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_20_60.sqlite[2/7] [========================97% ] nsys_report_fo_30000_20_60.sqlite[2/7] [========================98% ] nsys_report_fo_30000_20_60.sqlite[2/7] [========================99% ] nsys_report_fo_30000_20_60.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_60.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_60.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        274213928          1  274213928.0  274213928.0  274213928  274213928          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.3        166439315          1  166439315.0  166439315.0  166439315  166439315          0.0  cudaFree                      
      1.5          2555002          9     283889.1     418975.0       3720     480846     186734.9  cudaMalloc                    
      0.2           271183        814        333.1        300.0        120       1360        170.7  cuGetProcAddress_v2           
      0.0            37460          2      18730.0      18730.0       1880      35580      23829.5  cudaStreamCreateWithFlags     
      0.0            19181         18       1065.6        500.0        400       8700       1945.2  cudaEventCreateWithFlags      
      0.0             4320          3       1440.0       1440.0        730       2150        710.0  cuInit                        
      0.0             3440          3       1146.7        370.0        280       2790       1423.9  cuModuleGetLoadingMode        
      0.0              910          2        455.0        455.0        330        580        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_60.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_60.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 20 (num_steps = 80)
number of batches= 4
Generating '/tmp/nsys-report-a2f9.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_20_80.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_20_80.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_20_80.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_20_80.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_80.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [1%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [2%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [3%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [4%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [5%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [6%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [7%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [8%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [9%                          ] nsys_report_ia_30000_20_80.sqlite[2/7] [10%                         ] nsys_report_ia_30000_20_80.sqlite[2/7] [11%                         ] nsys_report_ia_30000_20_80.sqlite[2/7] [12%                         ] nsys_report_ia_30000_20_80.sqlite[2/7] [13%                         ] nsys_report_ia_30000_20_80.sqlite[2/7] [14%                         ] nsys_report_ia_30000_20_80.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_20_80.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_20_80.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_20_80.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_20_80.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_20_80.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_20_80.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_20_80.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_20_80.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_20_80.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_20_80.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_20_80.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_20_80.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_20_80.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_20_80.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_20_80.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_20_80.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_20_80.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_20_80.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_20_80.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_20_80.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_20_80.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_20_80.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_20_80.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_20_80.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_20_80.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_20_80.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_20_80.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_20_80.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_20_80.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_20_80.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_20_80.sqlite[2/7] [============54%             ] nsys_report_ia_30000_20_80.sqlite[2/7] [============55%             ] nsys_report_ia_30000_20_80.sqlite[2/7] [============56%             ] nsys_report_ia_30000_20_80.sqlite[2/7] [============57%             ] nsys_report_ia_30000_20_80.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_20_80.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_20_80.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_20_80.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_20_80.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_20_80.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_20_80.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_20_80.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_20_80.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_20_80.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_20_80.sqlite[2/7] [================68%         ] nsys_report_ia_30000_20_80.sqlite[2/7] [================69%         ] nsys_report_ia_30000_20_80.sqlite[2/7] [================70%         ] nsys_report_ia_30000_20_80.sqlite[2/7] [================71%         ] nsys_report_ia_30000_20_80.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_20_80.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_20_80.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_20_80.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_20_80.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_20_80.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_20_80.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_20_80.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_20_80.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_20_80.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_20_80.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_20_80.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_20_80.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_20_80.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_20_80.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_20_80.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_20_80.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_20_80.sqlite[2/7] [========================97% ] nsys_report_ia_30000_20_80.sqlite[2/7] [========================98% ] nsys_report_ia_30000_20_80.sqlite[2/7] [========================99% ] nsys_report_ia_30000_20_80.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_80.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        240535477          1  240535477.0  240535477.0  240535477  240535477          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.3        130154501          1  130154501.0  130154501.0  130154501  130154501          0.0  cudaFree                      
      1.4          1890423          6     315070.5     261913.5       3740     827670     313931.5  cudaMalloc                    
      0.2           272722        814        335.0        290.0        120       1260        176.5  cuGetProcAddress_v2           
      0.0            34761          2      17380.5      17380.5       1900      32861      21892.7  cudaStreamCreateWithFlags     
      0.0            23020         18       1278.9        505.0        390      12770       2885.3  cudaEventCreateWithFlags      
      0.0             4051          3       1350.3       1170.0        660       2221        796.0  cuInit                        
      0.0             3570          3       1190.0        390.0        170       3010       1580.0  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        300        580        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_80.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 20 (num_steps = 80)
number of batches= 4
Generating '/tmp/nsys-report-2782.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_20_80.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_20_80.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_20_80.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_20_80.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_80.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [1%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [2%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [3%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [4%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [5%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [6%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [7%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [8%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [9%                          ] nsys_report_db_30000_20_80.sqlite[2/7] [10%                         ] nsys_report_db_30000_20_80.sqlite[2/7] [11%                         ] nsys_report_db_30000_20_80.sqlite[2/7] [12%                         ] nsys_report_db_30000_20_80.sqlite[2/7] [13%                         ] nsys_report_db_30000_20_80.sqlite[2/7] [14%                         ] nsys_report_db_30000_20_80.sqlite[2/7] [=15%                        ] nsys_report_db_30000_20_80.sqlite[2/7] [=16%                        ] nsys_report_db_30000_20_80.sqlite[2/7] [=17%                        ] nsys_report_db_30000_20_80.sqlite[2/7] [==18%                       ] nsys_report_db_30000_20_80.sqlite[2/7] [==19%                       ] nsys_report_db_30000_20_80.sqlite[2/7] [==20%                       ] nsys_report_db_30000_20_80.sqlite[2/7] [==21%                       ] nsys_report_db_30000_20_80.sqlite[2/7] [===22%                      ] nsys_report_db_30000_20_80.sqlite[2/7] [===23%                      ] nsys_report_db_30000_20_80.sqlite[2/7] [===24%                      ] nsys_report_db_30000_20_80.sqlite[2/7] [====25%                     ] nsys_report_db_30000_20_80.sqlite[2/7] [====26%                     ] nsys_report_db_30000_20_80.sqlite[2/7] [====27%                     ] nsys_report_db_30000_20_80.sqlite[2/7] [====28%                     ] nsys_report_db_30000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_20_80.sqlite[2/7] [======33%                   ] nsys_report_db_30000_20_80.sqlite[2/7] [======34%                   ] nsys_report_db_30000_20_80.sqlite[2/7] [======35%                   ] nsys_report_db_30000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_20_80.sqlite[2/7] [========40%                 ] nsys_report_db_30000_20_80.sqlite[2/7] [========41%                 ] nsys_report_db_30000_20_80.sqlite[2/7] [========42%                 ] nsys_report_db_30000_20_80.sqlite[2/7] [=========43%                ] nsys_report_db_30000_20_80.sqlite[2/7] [=========44%                ] nsys_report_db_30000_20_80.sqlite[2/7] [=========45%                ] nsys_report_db_30000_20_80.sqlite[2/7] [=========46%                ] nsys_report_db_30000_20_80.sqlite[2/7] [==========47%               ] nsys_report_db_30000_20_80.sqlite[2/7] [==========48%               ] nsys_report_db_30000_20_80.sqlite[2/7] [==========49%               ] nsys_report_db_30000_20_80.sqlite[2/7] [===========50%              ] nsys_report_db_30000_20_80.sqlite[2/7] [===========51%              ] nsys_report_db_30000_20_80.sqlite[2/7] [===========52%              ] nsys_report_db_30000_20_80.sqlite[2/7] [===========53%              ] nsys_report_db_30000_20_80.sqlite[2/7] [============54%             ] nsys_report_db_30000_20_80.sqlite[2/7] [============55%             ] nsys_report_db_30000_20_80.sqlite[2/7] [============56%             ] nsys_report_db_30000_20_80.sqlite[2/7] [============57%             ] nsys_report_db_30000_20_80.sqlite[2/7] [=============58%            ] nsys_report_db_30000_20_80.sqlite[2/7] [=============59%            ] nsys_report_db_30000_20_80.sqlite[2/7] [=============60%            ] nsys_report_db_30000_20_80.sqlite[2/7] [==============61%           ] nsys_report_db_30000_20_80.sqlite[2/7] [==============62%           ] nsys_report_db_30000_20_80.sqlite[2/7] [==============63%           ] nsys_report_db_30000_20_80.sqlite[2/7] [==============64%           ] nsys_report_db_30000_20_80.sqlite[2/7] [===============65%          ] nsys_report_db_30000_20_80.sqlite[2/7] [===============66%          ] nsys_report_db_30000_20_80.sqlite[2/7] [===============67%          ] nsys_report_db_30000_20_80.sqlite[2/7] [================68%         ] nsys_report_db_30000_20_80.sqlite[2/7] [================69%         ] nsys_report_db_30000_20_80.sqlite[2/7] [================70%         ] nsys_report_db_30000_20_80.sqlite[2/7] [================71%         ] nsys_report_db_30000_20_80.sqlite[2/7] [=================72%        ] nsys_report_db_30000_20_80.sqlite[2/7] [=================73%        ] nsys_report_db_30000_20_80.sqlite[2/7] [=================74%        ] nsys_report_db_30000_20_80.sqlite[2/7] [==================75%       ] nsys_report_db_30000_20_80.sqlite[2/7] [==================76%       ] nsys_report_db_30000_20_80.sqlite[2/7] [==================77%       ] nsys_report_db_30000_20_80.sqlite[2/7] [==================78%       ] nsys_report_db_30000_20_80.sqlite[2/7] [===================79%      ] nsys_report_db_30000_20_80.sqlite[2/7] [===================80%      ] nsys_report_db_30000_20_80.sqlite[2/7] [===================81%      ] nsys_report_db_30000_20_80.sqlite[2/7] [===================82%      ] nsys_report_db_30000_20_80.sqlite[2/7] [====================83%     ] nsys_report_db_30000_20_80.sqlite[2/7] [====================84%     ] nsys_report_db_30000_20_80.sqlite[2/7] [====================85%     ] nsys_report_db_30000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_20_80.sqlite[2/7] [======================90%   ] nsys_report_db_30000_20_80.sqlite[2/7] [======================91%   ] nsys_report_db_30000_20_80.sqlite[2/7] [======================92%   ] nsys_report_db_30000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_20_80.sqlite[2/7] [========================97% ] nsys_report_db_30000_20_80.sqlite[2/7] [========================98% ] nsys_report_db_30000_20_80.sqlite[2/7] [========================99% ] nsys_report_db_30000_20_80.sqlite[2/7] [========================100%] nsys_report_db_30000_20_80.sqlite[2/7] [========================100%] nsys_report_db_30000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        281057150          1  281057150.0  281057150.0  281057150  281057150          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        158259211          1  158259211.0  158259211.0  158259211  158259211          0.0  cudaFree                      
      1.2          1870784          6     311797.3     262683.5       3770     791550     305885.8  cudaMalloc                    
      0.2           256823        814        315.5        270.0        120       1320        174.1  cuGetProcAddress_v2           
      0.0            34620          2      17310.0      17310.0       1930      32690      21750.6  cudaStreamCreateWithFlags     
      0.0            22850         18       1269.4        515.0        390      12180       2754.3  cudaEventCreateWithFlags      
      0.0             4620          3       1540.0       1570.0        620       2430        905.4  cuInit                        
      0.0             4310          3       1436.7        500.0        380       3430       1727.3  cuModuleGetLoadingMode        
      0.0              910          2        455.0        455.0        310        600        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_80.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 20 (num_steps = 80), identity_test = 0
Generating '/tmp/nsys-report-9115.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_20_80.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_20_80.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_20_80.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_20_80.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_20_80.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_80.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_80.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [1%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [2%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [3%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [4%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [5%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [6%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [7%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [8%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [9%                          ] nsys_report_fo_30000_20_80.sqlite[2/7] [10%                         ] nsys_report_fo_30000_20_80.sqlite[2/7] [11%                         ] nsys_report_fo_30000_20_80.sqlite[2/7] [12%                         ] nsys_report_fo_30000_20_80.sqlite[2/7] [13%                         ] nsys_report_fo_30000_20_80.sqlite[2/7] [14%                         ] nsys_report_fo_30000_20_80.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_20_80.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_20_80.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_20_80.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_20_80.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_20_80.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_20_80.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_20_80.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_20_80.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_20_80.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_20_80.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_20_80.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_20_80.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_20_80.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_20_80.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_20_80.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_20_80.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_20_80.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_20_80.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_20_80.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_20_80.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_20_80.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_20_80.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_20_80.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_20_80.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_20_80.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_20_80.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_20_80.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_20_80.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_20_80.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_20_80.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_20_80.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_20_80.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_20_80.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_20_80.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_20_80.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_20_80.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_20_80.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_20_80.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_20_80.sqlite[2/7] [============54%             ] nsys_report_fo_30000_20_80.sqlite[2/7] [============55%             ] nsys_report_fo_30000_20_80.sqlite[2/7] [============56%             ] nsys_report_fo_30000_20_80.sqlite[2/7] [============57%             ] nsys_report_fo_30000_20_80.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_20_80.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_20_80.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_20_80.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_20_80.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_20_80.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_20_80.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_20_80.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_20_80.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_20_80.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_20_80.sqlite[2/7] [================68%         ] nsys_report_fo_30000_20_80.sqlite[2/7] [================69%         ] nsys_report_fo_30000_20_80.sqlite[2/7] [================70%         ] nsys_report_fo_30000_20_80.sqlite[2/7] [================71%         ] nsys_report_fo_30000_20_80.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_20_80.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_20_80.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_20_80.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_20_80.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_20_80.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_20_80.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_20_80.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_20_80.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_20_80.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_20_80.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_20_80.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_20_80.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_20_80.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_20_80.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_20_80.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_20_80.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_20_80.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_20_80.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_20_80.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_20_80.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_20_80.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_20_80.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_20_80.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_20_80.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_20_80.sqlite[2/7] [========================97% ] nsys_report_fo_30000_20_80.sqlite[2/7] [========================98% ] nsys_report_fo_30000_20_80.sqlite[2/7] [========================99% ] nsys_report_fo_30000_20_80.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_80.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_80.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        275180722          1  275180722.0  275180722.0  275180722  275180722          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.2        157681031          1  157681031.0  157681031.0  157681031  157681031          0.0  cudaFree                      
      1.6          2511261          9     279029.0     408965.0       4660     455125     179955.3  cudaMalloc                    
      0.2           269774        814        331.4        290.0        120       1170        171.0  cuGetProcAddress_v2           
      0.0            39101          2      19550.5      19550.5       1961      37140      24875.3  cudaStreamCreateWithFlags     
      0.0            19691         18       1093.9        465.0        390       9841       2217.6  cudaEventCreateWithFlags      
      0.0             5390          3       1796.7       1900.0        800       2690        949.2  cuInit                        
      0.0             3050          3       1016.7        270.0        190       2590       1363.1  cuModuleGetLoadingMode        
      0.0             1140          2        570.0        570.0        310        830        367.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_80.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_80.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 20 (num_steps = 100)
number of batches= 5
Generating '/tmp/nsys-report-0cb5.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_20_100.nsys-rep[1/7] [=====30%                    ] nsys_report_ia_30000_20_100.nsys-rep[1/7] [==============64%           ] nsys_report_ia_30000_20_100.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_20_100.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_100.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [1%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [2%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [3%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [4%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [5%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [6%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [7%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [8%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [9%                          ] nsys_report_ia_30000_20_100.sqlite[2/7] [10%                         ] nsys_report_ia_30000_20_100.sqlite[2/7] [11%                         ] nsys_report_ia_30000_20_100.sqlite[2/7] [12%                         ] nsys_report_ia_30000_20_100.sqlite[2/7] [13%                         ] nsys_report_ia_30000_20_100.sqlite[2/7] [14%                         ] nsys_report_ia_30000_20_100.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_20_100.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_20_100.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_20_100.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_20_100.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_20_100.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_20_100.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_20_100.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_20_100.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_20_100.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_20_100.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_20_100.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_20_100.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_20_100.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_20_100.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_20_100.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_20_100.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_20_100.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_20_100.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_20_100.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_20_100.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_20_100.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_20_100.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_20_100.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_20_100.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_20_100.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_20_100.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_20_100.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_20_100.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_20_100.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_20_100.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_20_100.sqlite[2/7] [============54%             ] nsys_report_ia_30000_20_100.sqlite[2/7] [============55%             ] nsys_report_ia_30000_20_100.sqlite[2/7] [============56%             ] nsys_report_ia_30000_20_100.sqlite[2/7] [============57%             ] nsys_report_ia_30000_20_100.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_20_100.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_20_100.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_20_100.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_20_100.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_20_100.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_20_100.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_20_100.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_20_100.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_20_100.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_20_100.sqlite[2/7] [================68%         ] nsys_report_ia_30000_20_100.sqlite[2/7] [================69%         ] nsys_report_ia_30000_20_100.sqlite[2/7] [================70%         ] nsys_report_ia_30000_20_100.sqlite[2/7] [================71%         ] nsys_report_ia_30000_20_100.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_20_100.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_20_100.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_20_100.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_20_100.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_20_100.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_20_100.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_20_100.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_20_100.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_20_100.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_20_100.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_20_100.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_20_100.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_20_100.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_20_100.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_20_100.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_20_100.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_20_100.sqlite[2/7] [========================97% ] nsys_report_ia_30000_20_100.sqlite[2/7] [========================98% ] nsys_report_ia_30000_20_100.sqlite[2/7] [========================99% ] nsys_report_ia_30000_20_100.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_100.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        244660516          1  244660516.0  244660516.0  244660516  244660516          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        128973956          1  128973956.0  128973956.0  128973956  128973956          0.0  cudaFree                      
      1.4          1804463          6     300743.8     253318.5       3760     777650     297318.9  cudaMalloc                    
      0.2           282803        814        347.4        300.0        120       1240        179.2  cuGetProcAddress_v2           
      0.0            38431          2      19215.5      19215.5       1911      36520      24472.3  cudaStreamCreateWithFlags     
      0.0            19990         18       1110.6        470.0        400       9100       2042.7  cudaEventCreateWithFlags      
      0.0             4710          3       1570.0       1720.0        660       2330        845.0  cuInit                        
      0.0             3210          3       1070.0        290.0        160       2760       1465.0  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        320        610        205.1  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_100.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 20 (num_steps = 100)
number of batches= 5
Generating '/tmp/nsys-report-0abc.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_20_100.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_20_100.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_20_100.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_20_100.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_100.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [1%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [2%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [3%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [4%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [5%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [6%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [7%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [8%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [9%                          ] nsys_report_db_30000_20_100.sqlite[2/7] [10%                         ] nsys_report_db_30000_20_100.sqlite[2/7] [11%                         ] nsys_report_db_30000_20_100.sqlite[2/7] [12%                         ] nsys_report_db_30000_20_100.sqlite[2/7] [13%                         ] nsys_report_db_30000_20_100.sqlite[2/7] [14%                         ] nsys_report_db_30000_20_100.sqlite[2/7] [=15%                        ] nsys_report_db_30000_20_100.sqlite[2/7] [=16%                        ] nsys_report_db_30000_20_100.sqlite[2/7] [=17%                        ] nsys_report_db_30000_20_100.sqlite[2/7] [==18%                       ] nsys_report_db_30000_20_100.sqlite[2/7] [==19%                       ] nsys_report_db_30000_20_100.sqlite[2/7] [==20%                       ] nsys_report_db_30000_20_100.sqlite[2/7] [==21%                       ] nsys_report_db_30000_20_100.sqlite[2/7] [===22%                      ] nsys_report_db_30000_20_100.sqlite[2/7] [===23%                      ] nsys_report_db_30000_20_100.sqlite[2/7] [===24%                      ] nsys_report_db_30000_20_100.sqlite[2/7] [====25%                     ] nsys_report_db_30000_20_100.sqlite[2/7] [====26%                     ] nsys_report_db_30000_20_100.sqlite[2/7] [====27%                     ] nsys_report_db_30000_20_100.sqlite[2/7] [====28%                     ] nsys_report_db_30000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_20_100.sqlite[2/7] [======33%                   ] nsys_report_db_30000_20_100.sqlite[2/7] [======34%                   ] nsys_report_db_30000_20_100.sqlite[2/7] [======35%                   ] nsys_report_db_30000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_20_100.sqlite[2/7] [========40%                 ] nsys_report_db_30000_20_100.sqlite[2/7] [========41%                 ] nsys_report_db_30000_20_100.sqlite[2/7] [========42%                 ] nsys_report_db_30000_20_100.sqlite[2/7] [=========43%                ] nsys_report_db_30000_20_100.sqlite[2/7] [=========44%                ] nsys_report_db_30000_20_100.sqlite[2/7] [=========45%                ] nsys_report_db_30000_20_100.sqlite[2/7] [=========46%                ] nsys_report_db_30000_20_100.sqlite[2/7] [==========47%               ] nsys_report_db_30000_20_100.sqlite[2/7] [==========48%               ] nsys_report_db_30000_20_100.sqlite[2/7] [==========49%               ] nsys_report_db_30000_20_100.sqlite[2/7] [===========50%              ] nsys_report_db_30000_20_100.sqlite[2/7] [===========51%              ] nsys_report_db_30000_20_100.sqlite[2/7] [===========52%              ] nsys_report_db_30000_20_100.sqlite[2/7] [===========53%              ] nsys_report_db_30000_20_100.sqlite[2/7] [============54%             ] nsys_report_db_30000_20_100.sqlite[2/7] [============55%             ] nsys_report_db_30000_20_100.sqlite[2/7] [============56%             ] nsys_report_db_30000_20_100.sqlite[2/7] [============57%             ] nsys_report_db_30000_20_100.sqlite[2/7] [=============58%            ] nsys_report_db_30000_20_100.sqlite[2/7] [=============59%            ] nsys_report_db_30000_20_100.sqlite[2/7] [=============60%            ] nsys_report_db_30000_20_100.sqlite[2/7] [==============61%           ] nsys_report_db_30000_20_100.sqlite[2/7] [==============62%           ] nsys_report_db_30000_20_100.sqlite[2/7] [==============63%           ] nsys_report_db_30000_20_100.sqlite[2/7] [==============64%           ] nsys_report_db_30000_20_100.sqlite[2/7] [===============65%          ] nsys_report_db_30000_20_100.sqlite[2/7] [===============66%          ] nsys_report_db_30000_20_100.sqlite[2/7] [===============67%          ] nsys_report_db_30000_20_100.sqlite[2/7] [================68%         ] nsys_report_db_30000_20_100.sqlite[2/7] [================69%         ] nsys_report_db_30000_20_100.sqlite[2/7] [================70%         ] nsys_report_db_30000_20_100.sqlite[2/7] [================71%         ] nsys_report_db_30000_20_100.sqlite[2/7] [=================72%        ] nsys_report_db_30000_20_100.sqlite[2/7] [=================73%        ] nsys_report_db_30000_20_100.sqlite[2/7] [=================74%        ] nsys_report_db_30000_20_100.sqlite[2/7] [==================75%       ] nsys_report_db_30000_20_100.sqlite[2/7] [==================76%       ] nsys_report_db_30000_20_100.sqlite[2/7] [==================77%       ] nsys_report_db_30000_20_100.sqlite[2/7] [==================78%       ] nsys_report_db_30000_20_100.sqlite[2/7] [===================79%      ] nsys_report_db_30000_20_100.sqlite[2/7] [===================80%      ] nsys_report_db_30000_20_100.sqlite[2/7] [===================81%      ] nsys_report_db_30000_20_100.sqlite[2/7] [===================82%      ] nsys_report_db_30000_20_100.sqlite[2/7] [====================83%     ] nsys_report_db_30000_20_100.sqlite[2/7] [====================84%     ] nsys_report_db_30000_20_100.sqlite[2/7] [====================85%     ] nsys_report_db_30000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_20_100.sqlite[2/7] [======================90%   ] nsys_report_db_30000_20_100.sqlite[2/7] [======================91%   ] nsys_report_db_30000_20_100.sqlite[2/7] [======================92%   ] nsys_report_db_30000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_20_100.sqlite[2/7] [========================97% ] nsys_report_db_30000_20_100.sqlite[2/7] [========================98% ] nsys_report_db_30000_20_100.sqlite[2/7] [========================99% ] nsys_report_db_30000_20_100.sqlite[2/7] [========================100%] nsys_report_db_30000_20_100.sqlite[2/7] [========================100%] nsys_report_db_30000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        280949536          1  280949536.0  280949536.0  280949536  280949536          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.6        159476014          1  159476014.0  159476014.0  159476014  159476014          0.0  cudaFree                      
      1.1          1840152          6     306692.0     255318.5       3470     782979     301207.3  cudaMalloc                    
      0.2           279863        814        343.8        300.0        120       1220        174.9  cuGetProcAddress_v2           
      0.0            37930          2      18965.0      18965.0       1940      35990      24077.0  cudaStreamCreateWithFlags     
      0.0            20600         18       1144.4        490.0        400       9800       2207.8  cudaEventCreateWithFlags      
      0.0             4880          3       1626.7       1910.0        600       2370        918.4  cuInit                        
      0.0             3590          3       1196.7        340.0        270       2980       1544.8  cuModuleGetLoadingMode        
      0.0              880          2        440.0        440.0        320        560        169.7  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_100.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 20 (num_steps = 100), identity_test = 0
Generating '/tmp/nsys-report-9269.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_20_100.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_20_100.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_20_100.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_20_100.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_20_100.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_100.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_100.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [1%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [2%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [3%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [4%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [5%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [6%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [7%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [8%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [9%                          ] nsys_report_fo_30000_20_100.sqlite[2/7] [10%                         ] nsys_report_fo_30000_20_100.sqlite[2/7] [11%                         ] nsys_report_fo_30000_20_100.sqlite[2/7] [12%                         ] nsys_report_fo_30000_20_100.sqlite[2/7] [13%                         ] nsys_report_fo_30000_20_100.sqlite[2/7] [14%                         ] nsys_report_fo_30000_20_100.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_20_100.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_20_100.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_20_100.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_20_100.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_20_100.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_20_100.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_20_100.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_20_100.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_20_100.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_20_100.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_20_100.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_20_100.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_20_100.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_20_100.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_20_100.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_20_100.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_20_100.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_20_100.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_20_100.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_20_100.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_20_100.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_20_100.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_20_100.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_20_100.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_20_100.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_20_100.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_20_100.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_20_100.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_20_100.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_20_100.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_20_100.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_20_100.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_20_100.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_20_100.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_20_100.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_20_100.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_20_100.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_20_100.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_20_100.sqlite[2/7] [============54%             ] nsys_report_fo_30000_20_100.sqlite[2/7] [============55%             ] nsys_report_fo_30000_20_100.sqlite[2/7] [============56%             ] nsys_report_fo_30000_20_100.sqlite[2/7] [============57%             ] nsys_report_fo_30000_20_100.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_20_100.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_20_100.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_20_100.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_20_100.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_20_100.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_20_100.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_20_100.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_20_100.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_20_100.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_20_100.sqlite[2/7] [================68%         ] nsys_report_fo_30000_20_100.sqlite[2/7] [================69%         ] nsys_report_fo_30000_20_100.sqlite[2/7] [================70%         ] nsys_report_fo_30000_20_100.sqlite[2/7] [================71%         ] nsys_report_fo_30000_20_100.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_20_100.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_20_100.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_20_100.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_20_100.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_20_100.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_20_100.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_20_100.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_20_100.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_20_100.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_20_100.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_20_100.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_20_100.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_20_100.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_20_100.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_20_100.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_20_100.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_20_100.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_20_100.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_20_100.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_20_100.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_20_100.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_20_100.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_20_100.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_20_100.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_20_100.sqlite[2/7] [========================97% ] nsys_report_fo_30000_20_100.sqlite[2/7] [========================98% ] nsys_report_fo_30000_20_100.sqlite[2/7] [========================99% ] nsys_report_fo_30000_20_100.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_100.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_100.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        258169649          1  258169649.0  258169649.0  258169649  258169649          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.0        142183887          1  142183887.0  142183887.0  142183887  142183887          0.0  cudaFree                      
      1.7          2484040          9     276004.4     399585.0       4650     455385     179386.3  cudaMalloc                    
      0.2           294415        814        361.7        320.0        130       1340        177.0  cuGetProcAddress_v2           
      0.0            42851          2      21425.5      21425.5       1810      41041      27740.5  cudaStreamCreateWithFlags     
      0.0            22530         18       1251.7        425.0        400      11720       2668.5  cudaEventCreateWithFlags      
      0.0             4470          3       1490.0       1260.0        560       2650       1063.8  cuInit                        
      0.0             3150          3       1050.0        270.0        140       2740       1465.0  cuModuleGetLoadingMode        
      0.0              900          2        450.0        450.0        320        580        183.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_100.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_100.sqlite
--------------------------------------------------

==================================================



------------INITIAL APPROACH----------------------

Using N = 30000, batch_size = 20 (num_steps = 150)
number of batches= 8
Generating '/tmp/nsys-report-44ce.qdstrm'
[1/7] [0%                          ] nsys_report_ia_30000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_ia_30000_20_150.nsys-rep[1/7] [======34%                   ] nsys_report_ia_30000_20_150.nsys-rep[1/7] [================68%         ] nsys_report_ia_30000_20_150.nsys-rep[1/7] [================69%         ] nsys_report_ia_30000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_ia_30000_20_150.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_150.nsys-rep[1/7] [========================100%] nsys_report_ia_30000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [1%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [2%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [3%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [4%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [5%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [6%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [7%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [8%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [9%                          ] nsys_report_ia_30000_20_150.sqlite[2/7] [10%                         ] nsys_report_ia_30000_20_150.sqlite[2/7] [11%                         ] nsys_report_ia_30000_20_150.sqlite[2/7] [12%                         ] nsys_report_ia_30000_20_150.sqlite[2/7] [13%                         ] nsys_report_ia_30000_20_150.sqlite[2/7] [14%                         ] nsys_report_ia_30000_20_150.sqlite[2/7] [=15%                        ] nsys_report_ia_30000_20_150.sqlite[2/7] [=16%                        ] nsys_report_ia_30000_20_150.sqlite[2/7] [=17%                        ] nsys_report_ia_30000_20_150.sqlite[2/7] [==18%                       ] nsys_report_ia_30000_20_150.sqlite[2/7] [==19%                       ] nsys_report_ia_30000_20_150.sqlite[2/7] [==20%                       ] nsys_report_ia_30000_20_150.sqlite[2/7] [==21%                       ] nsys_report_ia_30000_20_150.sqlite[2/7] [===22%                      ] nsys_report_ia_30000_20_150.sqlite[2/7] [===23%                      ] nsys_report_ia_30000_20_150.sqlite[2/7] [===24%                      ] nsys_report_ia_30000_20_150.sqlite[2/7] [====25%                     ] nsys_report_ia_30000_20_150.sqlite[2/7] [====26%                     ] nsys_report_ia_30000_20_150.sqlite[2/7] [====27%                     ] nsys_report_ia_30000_20_150.sqlite[2/7] [====28%                     ] nsys_report_ia_30000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_ia_30000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_ia_30000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_ia_30000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_ia_30000_20_150.sqlite[2/7] [======33%                   ] nsys_report_ia_30000_20_150.sqlite[2/7] [======34%                   ] nsys_report_ia_30000_20_150.sqlite[2/7] [======35%                   ] nsys_report_ia_30000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_ia_30000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_ia_30000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_ia_30000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_ia_30000_20_150.sqlite[2/7] [========40%                 ] nsys_report_ia_30000_20_150.sqlite[2/7] [========41%                 ] nsys_report_ia_30000_20_150.sqlite[2/7] [========42%                 ] nsys_report_ia_30000_20_150.sqlite[2/7] [=========43%                ] nsys_report_ia_30000_20_150.sqlite[2/7] [=========44%                ] nsys_report_ia_30000_20_150.sqlite[2/7] [=========45%                ] nsys_report_ia_30000_20_150.sqlite[2/7] [=========46%                ] nsys_report_ia_30000_20_150.sqlite[2/7] [==========47%               ] nsys_report_ia_30000_20_150.sqlite[2/7] [==========48%               ] nsys_report_ia_30000_20_150.sqlite[2/7] [==========49%               ] nsys_report_ia_30000_20_150.sqlite[2/7] [===========50%              ] nsys_report_ia_30000_20_150.sqlite[2/7] [===========51%              ] nsys_report_ia_30000_20_150.sqlite[2/7] [===========52%              ] nsys_report_ia_30000_20_150.sqlite[2/7] [===========53%              ] nsys_report_ia_30000_20_150.sqlite[2/7] [============54%             ] nsys_report_ia_30000_20_150.sqlite[2/7] [============55%             ] nsys_report_ia_30000_20_150.sqlite[2/7] [============56%             ] nsys_report_ia_30000_20_150.sqlite[2/7] [============57%             ] nsys_report_ia_30000_20_150.sqlite[2/7] [=============58%            ] nsys_report_ia_30000_20_150.sqlite[2/7] [=============59%            ] nsys_report_ia_30000_20_150.sqlite[2/7] [=============60%            ] nsys_report_ia_30000_20_150.sqlite[2/7] [==============61%           ] nsys_report_ia_30000_20_150.sqlite[2/7] [==============62%           ] nsys_report_ia_30000_20_150.sqlite[2/7] [==============63%           ] nsys_report_ia_30000_20_150.sqlite[2/7] [==============64%           ] nsys_report_ia_30000_20_150.sqlite[2/7] [===============65%          ] nsys_report_ia_30000_20_150.sqlite[2/7] [===============66%          ] nsys_report_ia_30000_20_150.sqlite[2/7] [===============67%          ] nsys_report_ia_30000_20_150.sqlite[2/7] [================68%         ] nsys_report_ia_30000_20_150.sqlite[2/7] [================69%         ] nsys_report_ia_30000_20_150.sqlite[2/7] [================70%         ] nsys_report_ia_30000_20_150.sqlite[2/7] [================71%         ] nsys_report_ia_30000_20_150.sqlite[2/7] [=================72%        ] nsys_report_ia_30000_20_150.sqlite[2/7] [=================73%        ] nsys_report_ia_30000_20_150.sqlite[2/7] [=================74%        ] nsys_report_ia_30000_20_150.sqlite[2/7] [==================75%       ] nsys_report_ia_30000_20_150.sqlite[2/7] [==================76%       ] nsys_report_ia_30000_20_150.sqlite[2/7] [==================77%       ] nsys_report_ia_30000_20_150.sqlite[2/7] [==================78%       ] nsys_report_ia_30000_20_150.sqlite[2/7] [===================79%      ] nsys_report_ia_30000_20_150.sqlite[2/7] [===================80%      ] nsys_report_ia_30000_20_150.sqlite[2/7] [===================81%      ] nsys_report_ia_30000_20_150.sqlite[2/7] [===================82%      ] nsys_report_ia_30000_20_150.sqlite[2/7] [====================83%     ] nsys_report_ia_30000_20_150.sqlite[2/7] [====================84%     ] nsys_report_ia_30000_20_150.sqlite[2/7] [====================85%     ] nsys_report_ia_30000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_ia_30000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_ia_30000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_ia_30000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_ia_30000_20_150.sqlite[2/7] [======================90%   ] nsys_report_ia_30000_20_150.sqlite[2/7] [======================91%   ] nsys_report_ia_30000_20_150.sqlite[2/7] [======================92%   ] nsys_report_ia_30000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_ia_30000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_ia_30000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_ia_30000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_ia_30000_20_150.sqlite[2/7] [========================97% ] nsys_report_ia_30000_20_150.sqlite[2/7] [========================98% ] nsys_report_ia_30000_20_150.sqlite[2/7] [========================99% ] nsys_report_ia_30000_20_150.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_150.sqlite[2/7] [========================100%] nsys_report_ia_30000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        254005136          1  254005136.0  254005136.0  254005136  254005136          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.4        136376485          1  136376485.0  136376485.0  136376485  136376485          0.0  cudaFree                      
      1.3          1812731          6     302121.8     258113.5       3580     779719     298134.8  cudaMalloc                    
      0.2           273714        814        336.3        300.0        120       1190        174.9  cuGetProcAddress_v2           
      0.0            40861          2      20430.5      20430.5       2700      38161      25074.7  cudaStreamCreateWithFlags     
      0.0            20021         18       1112.3        530.0        410       9170       2045.4  cudaEventCreateWithFlags      
      0.0             4980          3       1660.0       1850.0        580       2550        998.6  cuInit                        
      0.0             3570          3       1190.0        300.0        190       3080       1637.7  cuModuleGetLoadingMode        
      0.0              930          2        465.0        465.0        310        620        219.2  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_ia_30000_20_150.sqlite
--------------------------------------------------


------------DOUBLE BUFFERING----------------------

Using N = 30000, batch_size = 20 (num_steps = 150)
number of batches= 8
Generating '/tmp/nsys-report-65e0.qdstrm'
[1/7] [0%                          ] nsys_report_db_30000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_db_30000_20_150.nsys-rep[1/7] [=====30%                    ] nsys_report_db_30000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_db_30000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_db_30000_20_150.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_150.nsys-rep[1/7] [========================100%] nsys_report_db_30000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [1%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [2%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [3%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [4%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [5%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [6%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [7%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [8%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [9%                          ] nsys_report_db_30000_20_150.sqlite[2/7] [10%                         ] nsys_report_db_30000_20_150.sqlite[2/7] [11%                         ] nsys_report_db_30000_20_150.sqlite[2/7] [12%                         ] nsys_report_db_30000_20_150.sqlite[2/7] [13%                         ] nsys_report_db_30000_20_150.sqlite[2/7] [14%                         ] nsys_report_db_30000_20_150.sqlite[2/7] [=15%                        ] nsys_report_db_30000_20_150.sqlite[2/7] [=16%                        ] nsys_report_db_30000_20_150.sqlite[2/7] [=17%                        ] nsys_report_db_30000_20_150.sqlite[2/7] [==18%                       ] nsys_report_db_30000_20_150.sqlite[2/7] [==19%                       ] nsys_report_db_30000_20_150.sqlite[2/7] [==20%                       ] nsys_report_db_30000_20_150.sqlite[2/7] [==21%                       ] nsys_report_db_30000_20_150.sqlite[2/7] [===22%                      ] nsys_report_db_30000_20_150.sqlite[2/7] [===23%                      ] nsys_report_db_30000_20_150.sqlite[2/7] [===24%                      ] nsys_report_db_30000_20_150.sqlite[2/7] [====25%                     ] nsys_report_db_30000_20_150.sqlite[2/7] [====26%                     ] nsys_report_db_30000_20_150.sqlite[2/7] [====27%                     ] nsys_report_db_30000_20_150.sqlite[2/7] [====28%                     ] nsys_report_db_30000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_db_30000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_db_30000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_db_30000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_db_30000_20_150.sqlite[2/7] [======33%                   ] nsys_report_db_30000_20_150.sqlite[2/7] [======34%                   ] nsys_report_db_30000_20_150.sqlite[2/7] [======35%                   ] nsys_report_db_30000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_db_30000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_db_30000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_db_30000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_db_30000_20_150.sqlite[2/7] [========40%                 ] nsys_report_db_30000_20_150.sqlite[2/7] [========41%                 ] nsys_report_db_30000_20_150.sqlite[2/7] [========42%                 ] nsys_report_db_30000_20_150.sqlite[2/7] [=========43%                ] nsys_report_db_30000_20_150.sqlite[2/7] [=========44%                ] nsys_report_db_30000_20_150.sqlite[2/7] [=========45%                ] nsys_report_db_30000_20_150.sqlite[2/7] [=========46%                ] nsys_report_db_30000_20_150.sqlite[2/7] [==========47%               ] nsys_report_db_30000_20_150.sqlite[2/7] [==========48%               ] nsys_report_db_30000_20_150.sqlite[2/7] [==========49%               ] nsys_report_db_30000_20_150.sqlite[2/7] [===========50%              ] nsys_report_db_30000_20_150.sqlite[2/7] [===========51%              ] nsys_report_db_30000_20_150.sqlite[2/7] [===========52%              ] nsys_report_db_30000_20_150.sqlite[2/7] [===========53%              ] nsys_report_db_30000_20_150.sqlite[2/7] [============54%             ] nsys_report_db_30000_20_150.sqlite[2/7] [============55%             ] nsys_report_db_30000_20_150.sqlite[2/7] [============56%             ] nsys_report_db_30000_20_150.sqlite[2/7] [============57%             ] nsys_report_db_30000_20_150.sqlite[2/7] [=============58%            ] nsys_report_db_30000_20_150.sqlite[2/7] [=============59%            ] nsys_report_db_30000_20_150.sqlite[2/7] [=============60%            ] nsys_report_db_30000_20_150.sqlite[2/7] [==============61%           ] nsys_report_db_30000_20_150.sqlite[2/7] [==============62%           ] nsys_report_db_30000_20_150.sqlite[2/7] [==============63%           ] nsys_report_db_30000_20_150.sqlite[2/7] [==============64%           ] nsys_report_db_30000_20_150.sqlite[2/7] [===============65%          ] nsys_report_db_30000_20_150.sqlite[2/7] [===============66%          ] nsys_report_db_30000_20_150.sqlite[2/7] [===============67%          ] nsys_report_db_30000_20_150.sqlite[2/7] [================68%         ] nsys_report_db_30000_20_150.sqlite[2/7] [================69%         ] nsys_report_db_30000_20_150.sqlite[2/7] [================70%         ] nsys_report_db_30000_20_150.sqlite[2/7] [================71%         ] nsys_report_db_30000_20_150.sqlite[2/7] [=================72%        ] nsys_report_db_30000_20_150.sqlite[2/7] [=================73%        ] nsys_report_db_30000_20_150.sqlite[2/7] [=================74%        ] nsys_report_db_30000_20_150.sqlite[2/7] [==================75%       ] nsys_report_db_30000_20_150.sqlite[2/7] [==================76%       ] nsys_report_db_30000_20_150.sqlite[2/7] [==================77%       ] nsys_report_db_30000_20_150.sqlite[2/7] [==================78%       ] nsys_report_db_30000_20_150.sqlite[2/7] [===================79%      ] nsys_report_db_30000_20_150.sqlite[2/7] [===================80%      ] nsys_report_db_30000_20_150.sqlite[2/7] [===================81%      ] nsys_report_db_30000_20_150.sqlite[2/7] [===================82%      ] nsys_report_db_30000_20_150.sqlite[2/7] [====================83%     ] nsys_report_db_30000_20_150.sqlite[2/7] [====================84%     ] nsys_report_db_30000_20_150.sqlite[2/7] [====================85%     ] nsys_report_db_30000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_db_30000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_db_30000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_db_30000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_db_30000_20_150.sqlite[2/7] [======================90%   ] nsys_report_db_30000_20_150.sqlite[2/7] [======================91%   ] nsys_report_db_30000_20_150.sqlite[2/7] [======================92%   ] nsys_report_db_30000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_db_30000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_db_30000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_db_30000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_db_30000_20_150.sqlite[2/7] [========================97% ] nsys_report_db_30000_20_150.sqlite[2/7] [========================98% ] nsys_report_db_30000_20_150.sqlite[2/7] [========================99% ] nsys_report_db_30000_20_150.sqlite[2/7] [========================100%] nsys_report_db_30000_20_150.sqlite[2/7] [========================100%] nsys_report_db_30000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        284485177          1  284485177.0  284485177.0  284485177  284485177          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.7        162979056          1  162979056.0  162979056.0  162979056  162979056          0.0  cudaFree                      
      1.1          1858254          6     309709.0     265403.5       3810     785270     302567.9  cudaMalloc                    
      0.2           265334        814        326.0        280.0        120       1370        172.9  cuGetProcAddress_v2           
      0.0            38970          2      19485.0      19485.0       2370      36600      24204.3  cudaStreamCreateWithFlags     
      0.0            24570         18       1365.0        425.0        380      13830       3155.8  cudaEventCreateWithFlags      
      0.0             5450          3       1816.7       1760.0        660       3030       1186.0  cuInit                        
      0.0             3731          3       1243.7        381.0        270       3080       1591.3  cuModuleGetLoadingMode        
      0.0              890          2        445.0        445.0        320        570        176.8  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_db_30000_20_150.sqlite
--------------------------------------------------


------------FULL OVERLAP----------------------

Using N = 30000, buff_size = 20 (num_steps = 150), identity_test = 0
Generating '/tmp/nsys-report-dd12.qdstrm'
[1/7] [0%                          ] nsys_report_fo_30000_20_150.nsys-rep[1/7] [0%                          ] nsys_report_fo_30000_20_150.nsys-rep[1/7] [=====30%                    ] nsys_report_fo_30000_20_150.nsys-rep[1/7] [==============64%           ] nsys_report_fo_30000_20_150.nsys-rep[1/7] [========================98% ] nsys_report_fo_30000_20_150.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_150.nsys-rep[1/7] [========================100%] nsys_report_fo_30000_20_150.nsys-rep
[2/7] [0%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [1%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [2%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [3%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [4%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [5%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [6%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [7%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [8%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [9%                          ] nsys_report_fo_30000_20_150.sqlite[2/7] [10%                         ] nsys_report_fo_30000_20_150.sqlite[2/7] [11%                         ] nsys_report_fo_30000_20_150.sqlite[2/7] [12%                         ] nsys_report_fo_30000_20_150.sqlite[2/7] [13%                         ] nsys_report_fo_30000_20_150.sqlite[2/7] [14%                         ] nsys_report_fo_30000_20_150.sqlite[2/7] [=15%                        ] nsys_report_fo_30000_20_150.sqlite[2/7] [=16%                        ] nsys_report_fo_30000_20_150.sqlite[2/7] [=17%                        ] nsys_report_fo_30000_20_150.sqlite[2/7] [==18%                       ] nsys_report_fo_30000_20_150.sqlite[2/7] [==19%                       ] nsys_report_fo_30000_20_150.sqlite[2/7] [==20%                       ] nsys_report_fo_30000_20_150.sqlite[2/7] [==21%                       ] nsys_report_fo_30000_20_150.sqlite[2/7] [===22%                      ] nsys_report_fo_30000_20_150.sqlite[2/7] [===23%                      ] nsys_report_fo_30000_20_150.sqlite[2/7] [===24%                      ] nsys_report_fo_30000_20_150.sqlite[2/7] [====25%                     ] nsys_report_fo_30000_20_150.sqlite[2/7] [====26%                     ] nsys_report_fo_30000_20_150.sqlite[2/7] [====27%                     ] nsys_report_fo_30000_20_150.sqlite[2/7] [====28%                     ] nsys_report_fo_30000_20_150.sqlite[2/7] [=====29%                    ] nsys_report_fo_30000_20_150.sqlite[2/7] [=====30%                    ] nsys_report_fo_30000_20_150.sqlite[2/7] [=====31%                    ] nsys_report_fo_30000_20_150.sqlite[2/7] [=====32%                    ] nsys_report_fo_30000_20_150.sqlite[2/7] [======33%                   ] nsys_report_fo_30000_20_150.sqlite[2/7] [======34%                   ] nsys_report_fo_30000_20_150.sqlite[2/7] [======35%                   ] nsys_report_fo_30000_20_150.sqlite[2/7] [=======36%                  ] nsys_report_fo_30000_20_150.sqlite[2/7] [=======37%                  ] nsys_report_fo_30000_20_150.sqlite[2/7] [=======38%                  ] nsys_report_fo_30000_20_150.sqlite[2/7] [=======39%                  ] nsys_report_fo_30000_20_150.sqlite[2/7] [========40%                 ] nsys_report_fo_30000_20_150.sqlite[2/7] [========41%                 ] nsys_report_fo_30000_20_150.sqlite[2/7] [========42%                 ] nsys_report_fo_30000_20_150.sqlite[2/7] [=========43%                ] nsys_report_fo_30000_20_150.sqlite[2/7] [=========44%                ] nsys_report_fo_30000_20_150.sqlite[2/7] [=========45%                ] nsys_report_fo_30000_20_150.sqlite[2/7] [=========46%                ] nsys_report_fo_30000_20_150.sqlite[2/7] [==========47%               ] nsys_report_fo_30000_20_150.sqlite[2/7] [==========48%               ] nsys_report_fo_30000_20_150.sqlite[2/7] [==========49%               ] nsys_report_fo_30000_20_150.sqlite[2/7] [===========50%              ] nsys_report_fo_30000_20_150.sqlite[2/7] [===========51%              ] nsys_report_fo_30000_20_150.sqlite[2/7] [===========52%              ] nsys_report_fo_30000_20_150.sqlite[2/7] [===========53%              ] nsys_report_fo_30000_20_150.sqlite[2/7] [============54%             ] nsys_report_fo_30000_20_150.sqlite[2/7] [============55%             ] nsys_report_fo_30000_20_150.sqlite[2/7] [============56%             ] nsys_report_fo_30000_20_150.sqlite[2/7] [============57%             ] nsys_report_fo_30000_20_150.sqlite[2/7] [=============58%            ] nsys_report_fo_30000_20_150.sqlite[2/7] [=============59%            ] nsys_report_fo_30000_20_150.sqlite[2/7] [=============60%            ] nsys_report_fo_30000_20_150.sqlite[2/7] [==============61%           ] nsys_report_fo_30000_20_150.sqlite[2/7] [==============62%           ] nsys_report_fo_30000_20_150.sqlite[2/7] [==============63%           ] nsys_report_fo_30000_20_150.sqlite[2/7] [==============64%           ] nsys_report_fo_30000_20_150.sqlite[2/7] [===============65%          ] nsys_report_fo_30000_20_150.sqlite[2/7] [===============66%          ] nsys_report_fo_30000_20_150.sqlite[2/7] [===============67%          ] nsys_report_fo_30000_20_150.sqlite[2/7] [================68%         ] nsys_report_fo_30000_20_150.sqlite[2/7] [================69%         ] nsys_report_fo_30000_20_150.sqlite[2/7] [================70%         ] nsys_report_fo_30000_20_150.sqlite[2/7] [================71%         ] nsys_report_fo_30000_20_150.sqlite[2/7] [=================72%        ] nsys_report_fo_30000_20_150.sqlite[2/7] [=================73%        ] nsys_report_fo_30000_20_150.sqlite[2/7] [=================74%        ] nsys_report_fo_30000_20_150.sqlite[2/7] [==================75%       ] nsys_report_fo_30000_20_150.sqlite[2/7] [==================76%       ] nsys_report_fo_30000_20_150.sqlite[2/7] [==================77%       ] nsys_report_fo_30000_20_150.sqlite[2/7] [==================78%       ] nsys_report_fo_30000_20_150.sqlite[2/7] [===================79%      ] nsys_report_fo_30000_20_150.sqlite[2/7] [===================80%      ] nsys_report_fo_30000_20_150.sqlite[2/7] [===================81%      ] nsys_report_fo_30000_20_150.sqlite[2/7] [===================82%      ] nsys_report_fo_30000_20_150.sqlite[2/7] [====================83%     ] nsys_report_fo_30000_20_150.sqlite[2/7] [====================84%     ] nsys_report_fo_30000_20_150.sqlite[2/7] [====================85%     ] nsys_report_fo_30000_20_150.sqlite[2/7] [=====================86%    ] nsys_report_fo_30000_20_150.sqlite[2/7] [=====================87%    ] nsys_report_fo_30000_20_150.sqlite[2/7] [=====================88%    ] nsys_report_fo_30000_20_150.sqlite[2/7] [=====================89%    ] nsys_report_fo_30000_20_150.sqlite[2/7] [======================90%   ] nsys_report_fo_30000_20_150.sqlite[2/7] [======================91%   ] nsys_report_fo_30000_20_150.sqlite[2/7] [======================92%   ] nsys_report_fo_30000_20_150.sqlite[2/7] [=======================93%  ] nsys_report_fo_30000_20_150.sqlite[2/7] [=======================94%  ] nsys_report_fo_30000_20_150.sqlite[2/7] [=======================95%  ] nsys_report_fo_30000_20_150.sqlite[2/7] [=======================96%  ] nsys_report_fo_30000_20_150.sqlite[2/7] [========================97% ] nsys_report_fo_30000_20_150.sqlite[2/7] [========================98% ] nsys_report_fo_30000_20_150.sqlite[2/7] [========================99% ] nsys_report_fo_30000_20_150.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_150.sqlite[2/7] [========================100%] nsys_report_fo_30000_20_150.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style           Range         
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  ----------------------
    100.0        284547827          1  284547827.0  284547827.0  284547827  284547827          0.0  PushPop  cuBLAS:cublasCreate_v2

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)               Name             
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ------------------------------
     98.3        164810079          1  164810079.0  164810079.0  164810079  164810079          0.0  cudaFree                      
      1.5          2530221          9     281135.7     404685.0       3700     460316     183276.8  cudaMalloc                    
      0.2           279022        814        342.8        300.0        120       1310        181.7  cuGetProcAddress_v2           
      0.0            37911          2      18955.5      18955.5       2360      35551      23469.6  cudaStreamCreateWithFlags     
      0.0            20160         18       1120.0        510.0        420       9360       2088.6  cudaEventCreateWithFlags      
      0.0             4740          3       1580.0       1580.0        580       2580       1000.0  cuInit                        
      0.0             3060          3       1020.0        270.0        200       2590       1360.1  cuModuleGetLoadingMode        
      0.0              940          2        470.0        470.0        330        610        198.0  cudaGetDriverEntryPoint_v11030

[5/7] Executing 'cuda_gpu_kern_sum' stats report
[6/7] Executing 'cuda_gpu_mem_time_sum' stats report
[7/7] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_150.nsys-rep
    /home/users/amei/gemm_spmm_a100/gemm_pipeline_inference_like/./nsys_reports/nsys_report_fo_30000_20_150.sqlite
--------------------------------------------------

==================================================



